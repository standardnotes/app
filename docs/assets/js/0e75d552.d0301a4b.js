(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{141:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},b=Object.keys(e);for(a=0;a<b.length;a++)n=b[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(a=0;a<b.length;a++)n=b[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=r.a.createContext({}),s=function(e){var t=r.a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=s(e.components);return r.a.createElement(o.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},u=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,b=e.originalType,i=e.parentName,o=c(e,["components","mdxType","originalType","parentName"]),d=s(n),u=a,m=d["".concat(i,".").concat(u)]||d[u]||p[u]||b;return n?r.a.createElement(m,l(l({ref:t},o),{},{components:n})):r.a.createElement(m,l({ref:t},o))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var b=n.length,i=new Array(b);i[0]=u;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var o=2;o<b;o++)i[o]=n[o];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},72:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return l})),n.d(t,"metadata",(function(){return c})),n.d(t,"toc",(function(){return o})),n.d(t,"default",(function(){return d}));var a=n(3),r=n(7),b=(n(0),n(141)),i=["components"],l={id:"auth",title:"Auth API",sidebar_label:"Auth",description:"Authentication portion of the Standard Notes API.",keywords:["standard notes","docs","notes app","end-to-end encryption","sync"],image:"/img/logo.png",hide_title:!1,hide_table_of_contents:!1},c={unversionedId:"specification/auth",id:"specification/auth",isDocsHomePage:!1,title:"Auth API",description:"Authentication portion of the Standard Notes API.",source:"@site/docs/specification/auth.md",sourceDirName:"specification",slug:"/specification/auth",permalink:"/specification/auth",editUrl:"https://github.com/standardnotes/docs/edit/main/docs/specification/auth.md",version:"current",sidebar_label:"Auth",frontMatter:{id:"auth",title:"Auth API",sidebar_label:"Auth",description:"Authentication portion of the Standard Notes API.",keywords:["standard notes","docs","notes app","end-to-end encryption","sync"],image:"/img/logo.png",hide_title:!1,hide_table_of_contents:!1},sidebar:"mainSidebar",previous:{title:"Sync API",permalink:"/specification/sync"},next:{title:"Intro to Extensions",permalink:"/extensions/intro"}},o=[{value:"POST /auth",id:"post-auth",children:[]},{value:"POST /auth/sign_in",id:"post-authsign_in",children:[]},{value:"GET /auth/params",id:"get-authparams",children:[]},{value:"POST /auth/change_pw",id:"post-authchange_pw",children:[]},{value:"Sessions",id:"sessions",children:[{value:"Session Model",id:"session-model",children:[]},{value:"Authenticated requests",id:"authenticated-requests",children:[]},{value:"Expiration",id:"expiration",children:[]}]}],s={toc:o};function d(e){var t=e.components,n=Object(r.a)(e,i);return Object(b.b)("wrapper",Object(a.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(b.b)("h3",{id:"post-auth"},"POST /auth"),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"Registers a new user")),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",{parentName:"tr",align:null}),Object(b.b)("th",{parentName:"tr",align:null}),Object(b.b)("th",{parentName:"tr",align:null}))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"api"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},'The API version to use. Must not be null, otherwise oldest API version used. Latest value is "20200115"')),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"created"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},'Integer timestamp representing the date the client generated the account\'s encryption keys. Example "1622494310383"')),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"email"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"The account email.")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"ephemeral"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"boolean")),Object(b.b)("td",{parentName:"tr",align:null},'Whether the initial session created for this account is ephemeral ("Stay signed in" unchecked).')),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"identifier"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"Should equal the account email.")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"origination"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},'Should equal "registration"')),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"password"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"The server password generated by the client from the user's master password.")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"pw_nonce"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"The nonce generated by the client for the user's encryption key.")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"version"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},'The protocol version the client used to generate the user\'s encryption key. Latest is "004".')))),Object(b.b)("h4",{id:"response"},"Response"),Object(b.b)("pre",null,Object(b.b)("code",{parentName:"pre",className:"language-JSON"},'{\n    "session": {\n        "access_token": "1:457b1f4b-88c2-4328-bf32-fe7dd9431d62:WwKgTEDUoEhxECu6",\n        "refresh_token": "1:457b1f4b-88c2-4328-bf32-fe7dd9431d62:G-qEoZsFtoj~RLL-",\n        "access_expiration": 1627678312000,\n        "refresh_expiration": 1654051238000\n    },\n    "key_params": {\n        "created": "1622494310383",\n        "identifier": "foo@example.com",\n        "origination": "registration",\n        "pw_nonce": "d97ed41c581fe8c3e0dce7d2ee72afcb63f9f461ae875bae66e30ecf3d952900",\n        "version": "004"\n    },\n    "user": {\n        "uuid": "682f9deb-b75f-4d97-91fa-6fd82a482db1",\n        "email": "foo@example.com"\n    }\n}\n')),Object(b.b)("h3",{id:"post-authsign_in"},"POST /auth/sign_in"),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"Authenticates a user and returns a session.")),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",{parentName:"tr",align:null}),Object(b.b)("th",{parentName:"tr",align:null}),Object(b.b)("th",{parentName:"tr",align:null}))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"api"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},'The API version to use. Must not be null, otherwise oldest API version used. Latest value is "20200115"')),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"email"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"The account email.")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"ephemeral"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"boolean")),Object(b.b)("td",{parentName:"tr",align:null},'Whether the session created for this account is ephemeral ("Stay signed in" unchecked).')),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"password"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"The server password generated by the client from the user's master password.")))),Object(b.b)("h4",{id:"response-1"},"Response"),Object(b.b)("pre",null,Object(b.b)("code",{parentName:"pre",className:"language-JSON"},'{\n    "session": {\n        "access_token": "1:ee03808d-dd05-417c-9c87-d471e49bcc49:Q~-UoIpDhdtkii_t",\n        "refresh_token": "1:ee03808d-dd05-417c-9c87-d471e49bcc49:Jn8UWzeHx2H5nZI5",\n        "access_expiration": 1627678779000,\n        "refresh_expiration": 1654051705000\n    },\n    "key_params": {\n        "created": "1622494310383",\n        "identifier": "foo@example.com",\n        "origination": "registration",\n        "pw_nonce": "d97ed41c581fe8c3e0dce7d2ee72afcb63f9f461ae875bae66e30ecf3d952900",\n        "version": "004"\n    },\n    "user": {\n        "uuid": "682f9deb-b75f-4d97-91fa-6fd82a482db1",\n        "email": "foo@example.com"\n    }\n}\n')),Object(b.b)("h3",{id:"get-authparams"},"GET /auth/params"),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"Queries the parameters used for key generation for an email address. Queried before signing into an account.")),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",{parentName:"tr",align:null}),Object(b.b)("th",{parentName:"tr",align:null}),Object(b.b)("th",{parentName:"tr",align:null}))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"api"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},'The API version to use. Must not be null, otherwise oldest API version used. Latest value is "20200115"')),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"email"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"The account email.")))),Object(b.b)("h4",{id:"response-2"},"Response"),Object(b.b)("pre",null,Object(b.b)("code",{parentName:"pre",className:"language-JSON"},'{\n    "identifier": "foo@example.com",\n    "pw_nonce": "d97ed41c581fe8c3e0dce7d2ee72afcb63f9f461ae875bae66e30ecf3d952900",\n    "version": "004"\n}\n')),Object(b.b)("h3",{id:"post-authchange_pw"},"POST /auth/change_pw"),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"Changes a user's password.")),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",{parentName:"tr",align:null}),Object(b.b)("th",{parentName:"tr",align:null}),Object(b.b)("th",{parentName:"tr",align:null}))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"api"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},'The API version to use. Must not be null, otherwise oldest API version used. Latest value is "20200115"')),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"created"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},'Integer timestamp representing the date the client generated the account\'s new encryption keys. Example "1622494310383"')),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"identifier"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"The account email.")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"origination"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},'Should equal "password-change"')),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"current_password"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"The old server password generated by the client from the user's master password.")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"new_password"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"The new server password generated by the client from the user's master password.")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"pw_nonce"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"The nonce generated by the client for the user's encryption key.")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"version"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},'The protocol version the client used to generate the user\'s encryption key. Latest is "004".')))),Object(b.b)("h4",{id:"response-3"},"Response"),Object(b.b)("pre",null,Object(b.b)("code",{parentName:"pre",className:"language-JSON"},'{\n    "session": {\n        "access_token": "1:27d4fd8f-b730-4e0a-afd3-1600fb466aaa:HMgmZwV5k5ePt0vj",\n        "refresh_token": "1:27d4fd8f-b730-4e0a-afd3-1600fb466aaa:wHuTeOB-qWGP3AE3",\n        "access_expiration": 1627679129000,\n        "refresh_expiration": 1654052055000\n    },\n    "key_params": {\n        "created": "1622494310383",\n        "identifier": "foo@example.com",\n        "origination": "password-change",\n        "pw_nonce": "be1974ff6fb1c541aa8c71fd3c66851b6492cf224b661c72daf44e0bef3096bb",\n        "version": "004"\n    },\n    "user": {\n        "uuid": "682f9deb-b75f-4d97-91fa-6fd82a482db1",\n        "email": "foo@example.com"\n    }\n}\n')),Object(b.b)("h2",{id:"sessions"},"Sessions"),Object(b.b)("h3",{id:"session-model"},"Session Model"),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",{parentName:"tr",align:null},"Field"),Object(b.b)("th",{parentName:"tr",align:null},"Type"),Object(b.b)("th",{parentName:"tr",align:null},"Description"))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"uuid"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"Unique identifier of the session")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"user_uuid"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"Unique identifier of the user")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"user_agent"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"The user agent used to create the session")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"api_version"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"The server API version used to create the session")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"access_token"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"The access token used to authenticate requests")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"refresh_token"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"string")),Object(b.b)("td",{parentName:"tr",align:null},"The refresh token used to extend tokens")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"access_expiration"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"datetime")),Object(b.b)("td",{parentName:"tr",align:null},"The expiration time of the access token")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"refresh_expiration"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"datetime")),Object(b.b)("td",{parentName:"tr",align:null},"The expiration time of the refresh token")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"created_at"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"datetime")),Object(b.b)("td",{parentName:"tr",align:null},"Date and time of creation of the session")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},"updated_at"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"datetime")),Object(b.b)("td",{parentName:"tr",align:null},"Last updated date and time of the session")))),Object(b.b)("ul",null,Object(b.b)("li",{parentName:"ul"},"Each ",Object(b.b)("inlineCode",{parentName:"li"},"session")," includes the API version they were created with. This way we can deny sessions for a given API version if we detect a vulnerability with that version in the future"),Object(b.b)("li",{parentName:"ul"},"Sessions are created in the following cases:",Object(b.b)("ul",{parentName:"li"},Object(b.b)("li",{parentName:"ul"},"When a user signs in"),Object(b.b)("li",{parentName:"ul"},"When a user registers a new account")))),Object(b.b)("hr",null),Object(b.b)("h3",{id:"authenticated-requests"},"Authenticated requests"),Object(b.b)("p",null,"The ",Object(b.b)("inlineCode",{parentName:"p"},"Authorization")," request header field is used by clients to make authenticated request. ",Object(b.b)("inlineCode",{parentName:"p"},"Bearer")," is the only authentication scheme allowed."),Object(b.b)("p",null,"The client must send the ",Object(b.b)("inlineCode",{parentName:"p"},"access")," token generated by the session, in the ",Object(b.b)("inlineCode",{parentName:"p"},"Authorization")," header. For example:"),Object(b.b)("pre",null,Object(b.b)("code",{parentName:"pre"},"GET /sessions HTTP/1.1\nHost: sync.standardnotes.org\nAuthorization: Bearer <access token>\n")),Object(b.b)("hr",null),Object(b.b)("p",null,"Below is a list of endpoints related to session management:"),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",{parentName:"tr",align:null},"Method"),Object(b.b)("th",{parentName:"tr",align:null},"URL"),Object(b.b)("th",{parentName:"tr",align:null},"Params"),Object(b.b)("th",{parentName:"tr",align:null},"Description"),Object(b.b)("th",{parentName:"tr",align:null},"Successful response code"))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"POST")),Object(b.b)("td",{parentName:"tr",align:null},"/auth/sign_out"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("em",{parentName:"td"},"None")),Object(b.b)("td",{parentName:"tr",align:null},"Terminates the current session"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"204"))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"DELETE")),Object(b.b)("td",{parentName:"tr",align:null},"/session"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("strong",{parentName:"td"},"uuid")),Object(b.b)("td",{parentName:"tr",align:null},"Terminates the specified session by UUID"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"204"))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"DELETE")),Object(b.b)("td",{parentName:"tr",align:null},"/sessions"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("em",{parentName:"td"},"None")),Object(b.b)("td",{parentName:"tr",align:null},"Terminates all sessions, except the current one"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"204"))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"GET")),Object(b.b)("td",{parentName:"tr",align:null},"/sessions"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("em",{parentName:"td"},"None")),Object(b.b)("td",{parentName:"tr",align:null},"Lists all sessions active sessions"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"200"))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"POST")),Object(b.b)("td",{parentName:"tr",align:null},"/session/token/refresh"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("strong",{parentName:"td"},"refresh_token")),Object(b.b)("td",{parentName:"tr",align:null},"Obtains new pair of ",Object(b.b)("inlineCode",{parentName:"td"},"access_token")," and ",Object(b.b)("inlineCode",{parentName:"td"},"refresh_token")),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"200"))))),Object(b.b)("p",null,"A successful request to ",Object(b.b)("inlineCode",{parentName:"p"},"GET /sessions")," returns the following JSON response:"),Object(b.b)("pre",null,Object(b.b)("code",{parentName:"pre",className:"language-json"},'{\n  "sessions": [\n    {\n      "uuid": "xxxxxxxx-xxxx-Mxxx-Nxxx-xxxxxxxxxxxx",\n      "user_agent": "<product> / <product-version> <comment>",\n      "api_version": "xxxxyyzz",\n      "current": "<boolean>",\n      "created_at": "2020-01-01T00:00:00.000Z"\n    }\n    ...\n  ]\n}\n')),Object(b.b)("h4",{id:"obtaining-tokens"},"Obtaining tokens"),Object(b.b)("p",null,"Tokens can be obtained every time the user performs any of the following actions:"),Object(b.b)("ol",null,Object(b.b)("li",{parentName:"ol"},"When a user signs in"),Object(b.b)("li",{parentName:"ol"},"When a user registers an account"),Object(b.b)("li",{parentName:"ol"},"When the tokens are refreshed")),Object(b.b)("h4",{id:"refreshing-tokens"},"Refreshing tokens"),Object(b.b)("p",null,"When an expired ",Object(b.b)("inlineCode",{parentName:"p"},"access_token")," is provided in the ",Object(b.b)("inlineCode",{parentName:"p"},"Authorization")," HTTP header, the following JSON response is returned:"),Object(b.b)("p",null,"HTTP Status Code: ",Object(b.b)("inlineCode",{parentName:"p"},"498 Expired Access Token")),Object(b.b)("pre",null,Object(b.b)("code",{parentName:"pre",className:"language-json"},'{\n  "error": {\n    "tag": "expired-access-token",\n    "message": "The provided access token has expired."\n  }\n}\n')),Object(b.b)("p",null,"To continue accessing resources, the ",Object(b.b)("inlineCode",{parentName:"p"},"access_token")," must be refreshed. That is, the current ",Object(b.b)("inlineCode",{parentName:"p"},"access_token")," is replaced with a new one with an extended expiration date."),Object(b.b)("p",null,"To refresh an ",Object(b.b)("inlineCode",{parentName:"p"},"access_token"),", a valid ",Object(b.b)("inlineCode",{parentName:"p"},"refresh_token")," is needed. This ",Object(b.b)("inlineCode",{parentName:"p"},"refresh_token")," must meet the following requirements:"),Object(b.b)("ul",null,Object(b.b)("li",{parentName:"ul"},"It should belong to the session of the ",Object(b.b)("inlineCode",{parentName:"li"},"access_token")),Object(b.b)("li",{parentName:"ul"},"It should not be expired")),Object(b.b)("p",null,"Since the ",Object(b.b)("inlineCode",{parentName:"p"},"refresh_token")," is of single-use, a new ",Object(b.b)("inlineCode",{parentName:"p"},"refresh_token")," is obtained when the ",Object(b.b)("inlineCode",{parentName:"p"},"access_token")," is refreshed."),Object(b.b)("p",null,"Refreshing tokens is a process that is transparent to the user, meaning that the client will perform the requests to keep valid tokens without user intervention."),Object(b.b)("p",null,"Here's how to refresh tokens:"),Object(b.b)("ol",null,Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"Send a ",Object(b.b)("inlineCode",{parentName:"p"},"POST")," request to ",Object(b.b)("inlineCode",{parentName:"p"},"/session/token/refresh"),". The body should contain a JSON paylaod with the ",Object(b.b)("inlineCode",{parentName:"p"},"refresh_token"),":"),Object(b.b)("pre",{parentName:"li"},Object(b.b)("code",{parentName:"pre"},'POST /session/token/refresh HTTP/1.1\nHost: sync.standardnotes.org\nAuthorization: Bearer <access token>\n\n{\n  "refresh_token": "R_xxxxxxx-xxxx-Mxxx-Nxxx-xxxxxxxxxxxx"\n}\n'))),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"The ",Object(b.b)("inlineCode",{parentName:"p"},"refresh_token")," is validated on the server. Depending of the circumstances, there should be two outcomes:"),Object(b.b)("ol",{parentName:"li"},Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"The provided ",Object(b.b)("inlineCode",{parentName:"p"},"refresh_token")," is valid. If so, a new pair of tokens is generated and the following JSON response is returned:"),Object(b.b)("pre",{parentName:"li"},Object(b.b)("code",{parentName:"pre",className:"language-json"},'{\n  "token": "xxxxxxx-xxxx-Mxxx-Nxxx-xxxxxxxxxxxx",\n  "session": {\n    "refresh_expiration": 1583020800,\n    "refresh_token": "xxxxxxx-xxxx-Mxxx-Nxxx-xxxxxxxxxxxx",\n  }\n}\n'))),Object(b.b)("li",{parentName:"ol"},Object(b.b)("p",{parentName:"li"},"The provided ",Object(b.b)("inlineCode",{parentName:"p"},"refresh_token")," is expired. If so, the following JSON response is returned:"),Object(b.b)("p",{parentName:"li"},"HTTP Status Code: ",Object(b.b)("inlineCode",{parentName:"p"},"400 Bad Request")),Object(b.b)("pre",{parentName:"li"},Object(b.b)("code",{parentName:"pre",className:"language-json"},'{\n  "error": {\n    "tag": "expired-refresh-token",\n    "message": "The refresh token has expired."\n  }\n}\n')),Object(b.b)("p",{parentName:"li"},"User must start a new session by re-entering their credentials."))))),Object(b.b)("h3",{id:"expiration"},"Expiration"),Object(b.b)("h4",{id:"sessions-1"},"Sessions"),Object(b.b)("p",null,"Sessions should be terminated after a period of inactivity. This is for best security practices."),Object(b.b)("p",null,Object(b.b)("inlineCode",{parentName:"p"},"Long-lived sessions")," are a good choice for our use case, because it can build a better user experience than expiring sessions for a short idle-timeout."),Object(b.b)("ul",null,Object(b.b)("li",{parentName:"ul"},"A ",Object(b.b)("inlineCode",{parentName:"li"},"session")," that remains inactive for ",Object(b.b)("inlineCode",{parentName:"li"},"1 year")," will be terminated, along with all ",Object(b.b)("inlineCode",{parentName:"li"},"tokens"))),Object(b.b)("h4",{id:"tokens"},"Tokens"),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",{parentName:"tr",align:null},"Name"),Object(b.b)("th",{parentName:"tr",align:null},"Type"),Object(b.b)("th",{parentName:"tr",align:null},"Expiration"))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"access")),Object(b.b)("td",{parentName:"tr",align:null},"Short-lived"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"60 days"))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"refresh")),Object(b.b)("td",{parentName:"tr",align:null},"Long-lived"),Object(b.b)("td",{parentName:"tr",align:null},Object(b.b)("inlineCode",{parentName:"td"},"1 year"))))),Object(b.b)("ul",null,Object(b.b)("li",{parentName:"ul"},"A ",Object(b.b)("inlineCode",{parentName:"li"},"refresh")," token is of single-use, while an ",Object(b.b)("inlineCode",{parentName:"li"},"access")," token can be used as long as it is not expired")))}d.isMDXComponent=!0}}]);