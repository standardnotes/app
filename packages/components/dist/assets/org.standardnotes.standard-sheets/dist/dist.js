/*! For license information please see dist.js.LICENSE.txt */
(()=>{var e={914:e=>{"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function i(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,o){for(var a,s,c=i(e),l=1;l<arguments.length;l++){for(var u in a=Object(arguments[l]))n.call(a,u)&&(c[u]=a[u]);if(t){s=t(a);for(var d=0;d<s.length;d++)r.call(a,s[d])&&(c[s[d]]=a[s[d]])}}return c}},448:(e,t,n)=>{"use strict";var r=n(294),i=n(914),o=n(840);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(a(227));function s(e,t,n,r,i,o,a,s,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(e){this.onError(e)}}var c=!1,l=null,u=!1,d=null,p={onError:function(e){c=!0,l=e}};function h(e,t,n,r,i,o,a,u,d){c=!1,l=null,s.apply(p,arguments)}var y=null,f=null,v=null;function m(e,t,n){var r=e.type||"unknown-event";e.currentTarget=v(n),function(e,t,n,r,i,o,s,p,y){if(h.apply(this,arguments),c){if(!c)throw Error(a(198));var f=l;c=!1,l=null,u||(u=!0,d=f)}}(r,t,void 0,e),e.currentTarget=null}var g=null,S={};function b(){if(g)for(var e in S){var t=S[e],n=g.indexOf(e);if(!(-1<n))throw Error(a(96,e));if(!_[n]){if(!t.extractEvents)throw Error(a(97,e));for(var r in _[n]=t,n=t.eventTypes){var i=void 0,o=n[r],s=t,c=r;if(w.hasOwnProperty(c))throw Error(a(99,c));w[c]=o;var l=o.phasedRegistrationNames;if(l){for(i in l)l.hasOwnProperty(i)&&P(l[i],s,c);i=!0}else o.registrationName?(P(o.registrationName,s,c),i=!0):i=!1;if(!i)throw Error(a(98,r,e))}}}}function P(e,t,n){if(E[e])throw Error(a(100,e));E[e]=t,C[e]=t.eventTypes[n].dependencies}var _=[],w={},E={},C={};function O(e){var t,n=!1;for(t in e)if(e.hasOwnProperty(t)){var r=e[t];if(!S.hasOwnProperty(t)||S[t]!==r){if(S[t])throw Error(a(102,t));S[t]=r,n=!0}}n&&b()}var I=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),M=null,A=null,T=null;function k(e){if(e=f(e)){if("function"!=typeof M)throw Error(a(280));var t=e.stateNode;t&&(t=y(t),M(e.stateNode,e.type,t))}}function D(e){A?T?T.push(e):T=[e]:A=e}function R(){if(A){var e=A,t=T;if(T=A=null,k(e),t)for(e=0;e<t.length;e++)k(t[e])}}function N(e,t){return e(t)}function F(e,t,n,r,i){return e(t,n,r,i)}function x(){}var j=N,K=!1,L=!1;function U(){null===A&&null===T||(x(),R())}function V(e,t,n){if(L)return e(t,n);L=!0;try{return j(e,t,n)}finally{L=!1,U()}}var B=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,W=Object.prototype.hasOwnProperty,z={},H={};function G(e,t,n,r,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o}var q={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){q[e]=new G(e,0,!1,e,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];q[t]=new G(t,1,!1,e[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){q[e]=new G(e,2,!1,e.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){q[e]=new G(e,2,!1,e,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){q[e]=new G(e,3,!1,e.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(e){q[e]=new G(e,3,!0,e,null,!1)})),["capture","download"].forEach((function(e){q[e]=new G(e,4,!1,e,null,!1)})),["cols","rows","size","span"].forEach((function(e){q[e]=new G(e,6,!1,e,null,!1)})),["rowSpan","start"].forEach((function(e){q[e]=new G(e,5,!1,e.toLowerCase(),null,!1)}));var Q=/[\-:]([a-z])/g;function Y(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(Q,Y);q[t]=new G(t,1,!1,e,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(Q,Y);q[t]=new G(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(Q,Y);q[t]=new G(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(e){q[e]=new G(e,1,!1,e.toLowerCase(),null,!1)})),q.xlinkHref=new G("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(e){q[e]=new G(e,1,!1,e.toLowerCase(),null,!0)}));var $=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function J(e,t,n,r){var i=q.hasOwnProperty(t)?q[t]:null;(null!==i?0===i.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!W.call(H,e)||!W.call(z,e)&&(B.test(e)?H[e]=!0:(z[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}$.hasOwnProperty("ReactCurrentDispatcher")||($.ReactCurrentDispatcher={current:null}),$.hasOwnProperty("ReactCurrentBatchConfig")||($.ReactCurrentBatchConfig={suspense:null});var X=/^(.*)[\\\/]/,Z="function"==typeof Symbol&&Symbol.for,ee=Z?Symbol.for("react.element"):60103,te=Z?Symbol.for("react.portal"):60106,ne=Z?Symbol.for("react.fragment"):60107,re=Z?Symbol.for("react.strict_mode"):60108,ie=Z?Symbol.for("react.profiler"):60114,oe=Z?Symbol.for("react.provider"):60109,ae=Z?Symbol.for("react.context"):60110,se=Z?Symbol.for("react.concurrent_mode"):60111,ce=Z?Symbol.for("react.forward_ref"):60112,le=Z?Symbol.for("react.suspense"):60113,ue=Z?Symbol.for("react.suspense_list"):60120,de=Z?Symbol.for("react.memo"):60115,pe=Z?Symbol.for("react.lazy"):60116,he=Z?Symbol.for("react.block"):60121,ye="function"==typeof Symbol&&Symbol.iterator;function fe(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=ye&&e[ye]||e["@@iterator"])?e:null}function ve(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case ne:return"Fragment";case te:return"Portal";case ie:return"Profiler";case re:return"StrictMode";case le:return"Suspense";case ue:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case ae:return"Context.Consumer";case oe:return"Context.Provider";case ce:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case de:return ve(e.type);case he:return ve(e.render);case pe:if(e=1===e._status?e._result:null)return ve(e)}return null}function me(e){var t="";do{e:switch(e.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break e;default:var r=e._debugOwner,i=e._debugSource,o=ve(e.type);n=null,r&&(n=ve(r.type)),r=o,o="",i?o=" (at "+i.fileName.replace(X,"")+":"+i.lineNumber+")":n&&(o=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+o}t+=n,e=e.return}while(e);return t}function ge(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function Se(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function be(e){e._valueTracker||(e._valueTracker=function(e){var t=Se(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Pe(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Se(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function _e(e,t){var n=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function we(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=ge(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Ee(e,t){null!=(t=t.checked)&&J(e,"checked",t,!1)}function Ce(e,t){Ee(e,t);var n=ge(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?Ie(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ie(e,t.type,ge(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Oe(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function Ie(e,t,n){"number"===t&&e.ownerDocument.activeElement===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function Me(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function Ae(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ge(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function Te(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ke(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:ge(n)}}function De(e,t){var n=ge(t.value),r=ge(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function Re(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var Ne="http://www.w3.org/1999/xhtml",Fe="http://www.w3.org/2000/svg";function xe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function je(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?xe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var Ke,Le,Ue=(Le=function(e,t){if(e.namespaceURI!==Fe||"innerHTML"in e)e.innerHTML=t;else{for((Ke=Ke||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ke.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return Le(e,t)}))}:Le);function Ve(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}function Be(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var We={animationend:Be("Animation","AnimationEnd"),animationiteration:Be("Animation","AnimationIteration"),animationstart:Be("Animation","AnimationStart"),transitionend:Be("Transition","TransitionEnd")},ze={},He={};function Ge(e){if(ze[e])return ze[e];if(!We[e])return e;var t,n=We[e];for(t in n)if(n.hasOwnProperty(t)&&t in He)return ze[e]=n[t];return e}I&&(He=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);var qe=Ge("animationend"),Qe=Ge("animationiteration"),Ye=Ge("animationstart"),$e=Ge("transitionend"),Je="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Xe=new("function"==typeof WeakMap?WeakMap:Map);function Ze(e){var t=Xe.get(e);return void 0===t&&(t=new Map,Xe.set(e,t)),t}function et(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(1026&(t=e).effectTag)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function tt(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function nt(e){if(et(e)!==e)throw Error(a(188))}function rt(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=et(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return nt(i),e;if(o===r)return nt(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,c=i.child;c;){if(c===n){s=!0,n=i,r=o;break}if(c===r){s=!0,r=i,n=o;break}c=c.sibling}if(!s){for(c=o.child;c;){if(c===n){s=!0,n=o,r=i;break}if(c===r){s=!0,r=o,n=i;break}c=c.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function it(e,t){if(null==t)throw Error(a(30));return null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function ot(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)}var at=null;function st(e){if(e){var t=e._dispatchListeners,n=e._dispatchInstances;if(Array.isArray(t))for(var r=0;r<t.length&&!e.isPropagationStopped();r++)m(e,t[r],n[r]);else t&&m(e,t,n);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}function ct(e){if(null!==e&&(at=it(at,e)),e=at,at=null,e){if(ot(e,st),at)throw Error(a(95));if(u)throw e=d,u=!1,d=null,e}}function lt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function ut(e){if(!I)return!1;var t=(e="on"+e)in document;return t||((t=document.createElement("div")).setAttribute(e,"return;"),t="function"==typeof t[e]),t}var dt=[];function pt(e){e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,10>dt.length&&dt.push(e)}function ht(e,t,n,r){if(dt.length){var i=dt.pop();return i.topLevelType=e,i.eventSystemFlags=r,i.nativeEvent=t,i.targetInst=n,i}return{topLevelType:e,eventSystemFlags:r,nativeEvent:t,targetInst:n,ancestors:[]}}function yt(e){var t=e.targetInst,n=t;do{if(!n){e.ancestors.push(n);break}var r=n;if(3===r.tag)r=r.stateNode.containerInfo;else{for(;r.return;)r=r.return;r=3!==r.tag?null:r.stateNode.containerInfo}if(!r)break;5!==(t=n.tag)&&6!==t||e.ancestors.push(n),n=kn(r)}while(n);for(n=0;n<e.ancestors.length;n++){t=e.ancestors[n];var i=lt(e.nativeEvent);r=e.topLevelType;var o=e.nativeEvent,a=e.eventSystemFlags;0===n&&(a|=64);for(var s=null,c=0;c<_.length;c++){var l=_[c];l&&(l=l.extractEvents(r,t,o,i,a))&&(s=it(s,l))}ct(s)}}function ft(e,t,n){if(!n.has(e)){switch(e){case"scroll":Yt(t,"scroll",!0);break;case"focus":case"blur":Yt(t,"focus",!0),Yt(t,"blur",!0),n.set("blur",null),n.set("focus",null);break;case"cancel":case"close":ut(e)&&Yt(t,e,!0);break;case"invalid":case"submit":case"reset":break;default:-1===Je.indexOf(e)&&Qt(e,t)}n.set(e,null)}}var vt,mt,gt,St=!1,bt=[],Pt=null,_t=null,wt=null,Et=new Map,Ct=new Map,Ot=[],It="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),Mt="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function At(e,t,n,r,i){return{blockedOn:e,topLevelType:t,eventSystemFlags:32|n,nativeEvent:i,container:r}}function Tt(e,t){switch(e){case"focus":case"blur":Pt=null;break;case"dragenter":case"dragleave":_t=null;break;case"mouseover":case"mouseout":wt=null;break;case"pointerover":case"pointerout":Et.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ct.delete(t.pointerId)}}function kt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e=At(t,n,r,i,o),null!==t&&(null!==(t=Dn(t))&&mt(t)),e):(e.eventSystemFlags|=r,e)}function Dt(e){var t=kn(e.target);if(null!==t){var n=et(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=tt(n)))return e.blockedOn=t,void o.unstable_runWithPriority(e.priority,(function(){gt(n)}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Rt(e){if(null!==e.blockedOn)return!1;var t=Zt(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);if(null!==t){var n=Dn(t);return null!==n&&mt(n),e.blockedOn=t,!1}return!0}function Nt(e,t,n){Rt(e)&&n.delete(t)}function Ft(){for(St=!1;0<bt.length;){var e=bt[0];if(null!==e.blockedOn){null!==(e=Dn(e.blockedOn))&&vt(e);break}var t=Zt(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);null!==t?e.blockedOn=t:bt.shift()}null!==Pt&&Rt(Pt)&&(Pt=null),null!==_t&&Rt(_t)&&(_t=null),null!==wt&&Rt(wt)&&(wt=null),Et.forEach(Nt),Ct.forEach(Nt)}function xt(e,t){e.blockedOn===t&&(e.blockedOn=null,St||(St=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Ft)))}function jt(e){function t(t){return xt(t,e)}if(0<bt.length){xt(bt[0],e);for(var n=1;n<bt.length;n++){var r=bt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Pt&&xt(Pt,e),null!==_t&&xt(_t,e),null!==wt&&xt(wt,e),Et.forEach(t),Ct.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Dt(n),null===n.blockedOn&&Ot.shift()}var Kt={},Lt=new Map,Ut=new Map,Vt=["abort","abort",qe,"animationEnd",Qe,"animationIteration",Ye,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",$e,"transitionEnd","waiting","waiting"];function Bt(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1],o="on"+(i[0].toUpperCase()+i.slice(1));o={phasedRegistrationNames:{bubbled:o,captured:o+"Capture"},dependencies:[r],eventPriority:t},Ut.set(r,t),Lt.set(r,o),Kt[i]=o}}Bt("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Bt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Bt(Vt,2);for(var Wt="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),zt=0;zt<Wt.length;zt++)Ut.set(Wt[zt],0);var Ht=o.unstable_UserBlockingPriority,Gt=o.unstable_runWithPriority,qt=!0;function Qt(e,t){Yt(t,e,!1)}function Yt(e,t,n){var r=Ut.get(t);switch(void 0===r?2:r){case 0:r=$t.bind(null,t,1,e);break;case 1:r=Jt.bind(null,t,1,e);break;default:r=Xt.bind(null,t,1,e)}n?e.addEventListener(t,r,!0):e.addEventListener(t,r,!1)}function $t(e,t,n,r){K||x();var i=Xt,o=K;K=!0;try{F(i,e,t,n,r)}finally{(K=o)||U()}}function Jt(e,t,n,r){Gt(Ht,Xt.bind(null,e,t,n,r))}function Xt(e,t,n,r){if(qt)if(0<bt.length&&-1<It.indexOf(e))e=At(null,e,t,n,r),bt.push(e);else{var i=Zt(e,t,n,r);if(null===i)Tt(e,r);else if(-1<It.indexOf(e))e=At(i,e,t,n,r),bt.push(e);else if(!function(e,t,n,r,i){switch(t){case"focus":return Pt=kt(Pt,e,t,n,r,i),!0;case"dragenter":return _t=kt(_t,e,t,n,r,i),!0;case"mouseover":return wt=kt(wt,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Et.set(o,kt(Et.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Ct.set(o,kt(Ct.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r)){Tt(e,r),e=ht(e,r,null,t);try{V(yt,e)}finally{pt(e)}}}}function Zt(e,t,n,r){if(null!==(n=kn(n=lt(r)))){var i=et(n);if(null===i)n=null;else{var o=i.tag;if(13===o){if(null!==(n=tt(i)))return n;n=null}else if(3===o){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}e=ht(e,r,n,t);try{V(yt,e)}finally{pt(e)}return null}var en={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tn=["Webkit","ms","Moz","O"];function nn(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||en.hasOwnProperty(e)&&en[e]?(""+t).trim():t+"px"}function rn(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=nn(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(en).forEach((function(e){tn.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),en[t]=en[e]}))}));var on=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function an(e,t){if(t){if(on[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e,""));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(a(62,""))}}function sn(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cn=Ne;function ln(e,t){var n=Ze(e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument);t=C[t];for(var r=0;r<t.length;r++)ft(t[r],e,n)}function un(){}function dn(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function pn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hn(e,t){var n,r=pn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=pn(r)}}function yn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?yn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fn(){for(var e=window,t=dn();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=dn((e=t.contentWindow).document)}return t}function vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var mn="$?",gn="$!",Sn=null,bn=null;function Pn(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function _n(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var wn="function"==typeof setTimeout?setTimeout:void 0,En="function"==typeof clearTimeout?clearTimeout:void 0;function Cn(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function On(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||n===gn||n===mn){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var In=Math.random().toString(36).slice(2),Mn="__reactInternalInstance$"+In,An="__reactEventHandlers$"+In,Tn="__reactContainere$"+In;function kn(e){var t=e[Mn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Tn]||n[Mn]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=On(e);null!==e;){if(n=e[Mn])return n;e=On(e)}return t}n=(e=n).parentNode}return null}function Dn(e){return!(e=e[Mn]||e[Tn])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Rn(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function Nn(e){return e[An]||null}function Fn(e){do{e=e.return}while(e&&5!==e.tag);return e||null}function xn(e,t){var n=e.stateNode;if(!n)return null;var r=y(n);if(!r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(a(231,t,typeof n));return n}function jn(e,t,n){(t=xn(e,n.dispatchConfig.phasedRegistrationNames[t]))&&(n._dispatchListeners=it(n._dispatchListeners,t),n._dispatchInstances=it(n._dispatchInstances,e))}function Kn(e){if(e&&e.dispatchConfig.phasedRegistrationNames){for(var t=e._targetInst,n=[];t;)n.push(t),t=Fn(t);for(t=n.length;0<t--;)jn(n[t],"captured",e);for(t=0;t<n.length;t++)jn(n[t],"bubbled",e)}}function Ln(e,t,n){e&&n&&n.dispatchConfig.registrationName&&(t=xn(e,n.dispatchConfig.registrationName))&&(n._dispatchListeners=it(n._dispatchListeners,t),n._dispatchInstances=it(n._dispatchInstances,e))}function Un(e){e&&e.dispatchConfig.registrationName&&Ln(e._targetInst,null,e)}function Vn(e){ot(e,Kn)}var Bn=null,Wn=null,zn=null;function Hn(){if(zn)return zn;var e,t,n=Wn,r=n.length,i="value"in Bn?Bn.value:Bn.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return zn=i.slice(e,1<t?1-t:void 0)}function Gn(){return!0}function qn(){return!1}function Qn(e,t,n,r){for(var i in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=n,e=this.constructor.Interface)e.hasOwnProperty(i)&&((t=e[i])?this[i]=t(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?Gn:qn,this.isPropagationStopped=qn,this}function Yn(e,t,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,e,t,n,r),i}return new this(e,t,n,r)}function $n(e){if(!(e instanceof this))throw Error(a(279));e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function Jn(e){e.eventPool=[],e.getPooled=Yn,e.release=$n}i(Qn.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Gn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Gn)},persist:function(){this.isPersistent=Gn},isPersistent:qn,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=qn,this._dispatchInstances=this._dispatchListeners=null}}),Qn.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},Qn.extend=function(e){function t(){}function n(){return r.apply(this,arguments)}var r=this;t.prototype=r.prototype;var o=new t;return i(o,n.prototype),n.prototype=o,n.prototype.constructor=n,n.Interface=i({},r.Interface,e),n.extend=r.extend,Jn(n),n},Jn(Qn);var Xn=Qn.extend({data:null}),Zn=Qn.extend({data:null}),er=[9,13,27,32],tr=I&&"CompositionEvent"in window,nr=null;I&&"documentMode"in document&&(nr=document.documentMode);var rr=I&&"TextEvent"in window&&!nr,ir=I&&(!tr||nr&&8<nr&&11>=nr),or=String.fromCharCode(32),ar={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},sr=!1;function cr(e,t){switch(e){case"keyup":return-1!==er.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function lr(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var ur=!1;var dr={eventTypes:ar,extractEvents:function(e,t,n,r){var i;if(tr)e:{switch(e){case"compositionstart":var o=ar.compositionStart;break e;case"compositionend":o=ar.compositionEnd;break e;case"compositionupdate":o=ar.compositionUpdate;break e}o=void 0}else ur?cr(e,n)&&(o=ar.compositionEnd):"keydown"===e&&229===n.keyCode&&(o=ar.compositionStart);return o?(ir&&"ko"!==n.locale&&(ur||o!==ar.compositionStart?o===ar.compositionEnd&&ur&&(i=Hn()):(Wn="value"in(Bn=r)?Bn.value:Bn.textContent,ur=!0)),o=Xn.getPooled(o,t,n,r),i?o.data=i:null!==(i=lr(n))&&(o.data=i),Vn(o),i=o):i=null,(e=rr?function(e,t){switch(e){case"compositionend":return lr(t);case"keypress":return 32!==t.which?null:(sr=!0,or);case"textInput":return(e=t.data)===or&&sr?null:e;default:return null}}(e,n):function(e,t){if(ur)return"compositionend"===e||!tr&&cr(e,t)?(e=Hn(),zn=Wn=Bn=null,ur=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ir&&"ko"!==t.locale?null:t.data}}(e,n))?((t=Zn.getPooled(ar.beforeInput,t,n,r)).data=e,Vn(t)):t=null,null===i?t:null===t?i:[i,t]}},pr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!pr[e.type]:"textarea"===t}var yr={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function fr(e,t,n){return(e=Qn.getPooled(yr.change,e,t,n)).type="change",D(n),Vn(e),e}var vr=null,mr=null;function gr(e){ct(e)}function Sr(e){if(Pe(Rn(e)))return e}function br(e,t){if("change"===e)return t}var Pr=!1;function _r(){vr&&(vr.detachEvent("onpropertychange",wr),mr=vr=null)}function wr(e){if("value"===e.propertyName&&Sr(mr))if(e=fr(mr,e,lt(e)),K)ct(e);else{K=!0;try{N(gr,e)}finally{K=!1,U()}}}function Er(e,t,n){"focus"===e?(_r(),mr=n,(vr=t).attachEvent("onpropertychange",wr)):"blur"===e&&_r()}function Cr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Sr(mr)}function Or(e,t){if("click"===e)return Sr(t)}function Ir(e,t){if("input"===e||"change"===e)return Sr(t)}I&&(Pr=ut("input")&&(!document.documentMode||9<document.documentMode));var Mr={eventTypes:yr,_isInputEventSupported:Pr,extractEvents:function(e,t,n,r){var i=t?Rn(t):window,o=i.nodeName&&i.nodeName.toLowerCase();if("select"===o||"input"===o&&"file"===i.type)var a=br;else if(hr(i))if(Pr)a=Ir;else{a=Cr;var s=Er}else(o=i.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(a=Or);if(a&&(a=a(e,t)))return fr(a,n,r);s&&s(e,i,t),"blur"===e&&(e=i._wrapperState)&&e.controlled&&"number"===i.type&&Ie(i,"number",i.value)}},Ar=Qn.extend({view:null,detail:null}),Tr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Tr[e])&&!!t[e]}function Dr(){return kr}var Rr=0,Nr=0,Fr=!1,xr=!1,jr=Ar.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Dr,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},movementX:function(e){if("movementX"in e)return e.movementX;var t=Rr;return Rr=e.screenX,Fr?"mousemove"===e.type?e.screenX-t:0:(Fr=!0,0)},movementY:function(e){if("movementY"in e)return e.movementY;var t=Nr;return Nr=e.screenY,xr?"mousemove"===e.type?e.screenY-t:0:(xr=!0,0)}}),Kr=jr.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Lr={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Ur={eventTypes:Lr,extractEvents:function(e,t,n,r,i){var o="mouseover"===e||"pointerover"===e,a="mouseout"===e||"pointerout"===e;if(o&&0==(32&i)&&(n.relatedTarget||n.fromElement)||!a&&!o)return null;(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,a)?(a=t,null!==(t=(t=n.relatedTarget||n.toElement)?kn(t):null)&&(t!==et(t)||5!==t.tag&&6!==t.tag)&&(t=null)):a=null;if(a===t)return null;if("mouseout"===e||"mouseover"===e)var s=jr,c=Lr.mouseLeave,l=Lr.mouseEnter,u="mouse";else"pointerout"!==e&&"pointerover"!==e||(s=Kr,c=Lr.pointerLeave,l=Lr.pointerEnter,u="pointer");if(e=null==a?o:Rn(a),o=null==t?o:Rn(t),(c=s.getPooled(c,a,n,r)).type=u+"leave",c.target=e,c.relatedTarget=o,(n=s.getPooled(l,t,n,r)).type=u+"enter",n.target=o,n.relatedTarget=e,u=t,(r=a)&&u)e:{for(l=u,a=0,e=s=r;e;e=Fn(e))a++;for(e=0,t=l;t;t=Fn(t))e++;for(;0<a-e;)s=Fn(s),a--;for(;0<e-a;)l=Fn(l),e--;for(;a--;){if(s===l||s===l.alternate)break e;s=Fn(s),l=Fn(l)}s=null}else s=null;for(l=s,s=[];r&&r!==l&&(null===(a=r.alternate)||a!==l);)s.push(r),r=Fn(r);for(r=[];u&&u!==l&&(null===(a=u.alternate)||a!==l);)r.push(u),u=Fn(u);for(u=0;u<s.length;u++)Ln(s[u],"bubbled",c);for(u=r.length;0<u--;)Ln(r[u],"captured",n);return 0==(64&i)?[c]:[c,n]}};var Vr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Br=Object.prototype.hasOwnProperty;function Wr(e,t){if(Vr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Br.call(t,n[r])||!Vr(e[n[r]],t[n[r]]))return!1;return!0}var zr=I&&"documentMode"in document&&11>=document.documentMode,Hr={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Gr=null,qr=null,Qr=null,Yr=!1;function $r(e,t){var n=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;return Yr||null==Gr||Gr!==dn(n)?null:("selectionStart"in(n=Gr)&&vn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Qr&&Wr(Qr,n)?null:(Qr=n,(e=Qn.getPooled(Hr.select,qr,e,t)).type="select",e.target=Gr,Vn(e),e))}var Jr={eventTypes:Hr,extractEvents:function(e,t,n,r,i,o){if(!(o=!(i=o||(r.window===r?r.document:9===r.nodeType?r:r.ownerDocument)))){e:{i=Ze(i),o=C.onSelect;for(var a=0;a<o.length;a++)if(!i.has(o[a])){i=!1;break e}i=!0}o=!i}if(o)return null;switch(i=t?Rn(t):window,e){case"focus":(hr(i)||"true"===i.contentEditable)&&(Gr=i,qr=t,Qr=null);break;case"blur":Qr=qr=Gr=null;break;case"mousedown":Yr=!0;break;case"contextmenu":case"mouseup":case"dragend":return Yr=!1,$r(n,r);case"selectionchange":if(zr)break;case"keydown":case"keyup":return $r(n,r)}return null}},Xr=Qn.extend({animationName:null,elapsedTime:null,pseudoElement:null}),Zr=Qn.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ei=Ar.extend({relatedTarget:null});function ti(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}var ni={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ri={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ii=Ar.extend({key:function(e){if(e.key){var t=ni[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ti(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?ri[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Dr,charCode:function(e){return"keypress"===e.type?ti(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ti(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),oi=jr.extend({dataTransfer:null}),ai=Ar.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Dr}),si=Qn.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),ci=jr.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),li={eventTypes:Kt,extractEvents:function(e,t,n,r){var i=Lt.get(e);if(!i)return null;switch(e){case"keypress":if(0===ti(n))return null;case"keydown":case"keyup":e=ii;break;case"blur":case"focus":e=ei;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=jr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=oi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=ai;break;case qe:case Qe:case Ye:e=Xr;break;case $e:e=si;break;case"scroll":e=Ar;break;case"wheel":e=ci;break;case"copy":case"cut":case"paste":e=Zr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=Kr;break;default:e=Qn}return Vn(t=e.getPooled(i,t,n,r)),t}};if(g)throw Error(a(101));g=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),b(),y=Nn,f=Dn,v=Rn,O({SimpleEventPlugin:li,EnterLeaveEventPlugin:Ur,ChangeEventPlugin:Mr,SelectEventPlugin:Jr,BeforeInputEventPlugin:dr});var ui=[],di=-1;function pi(e){0>di||(e.current=ui[di],ui[di]=null,di--)}function hi(e,t){di++,ui[di]=e.current,e.current=t}var yi={},fi={current:yi},vi={current:!1},mi=yi;function gi(e,t){var n=e.type.contextTypes;if(!n)return yi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Si(e){return null!=(e=e.childContextTypes)}function bi(){pi(vi),pi(fi)}function Pi(e,t,n){if(fi.current!==yi)throw Error(a(168));hi(fi,t),hi(vi,n)}function _i(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in e))throw Error(a(108,ve(t)||"Unknown",o));return i({},n,{},r)}function wi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||yi,mi=fi.current,hi(fi,e),hi(vi,vi.current),!0}function Ei(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=_i(e,t,mi),r.__reactInternalMemoizedMergedChildContext=e,pi(vi),pi(fi),hi(fi,e)):pi(vi),hi(vi,n)}var Ci=o.unstable_runWithPriority,Oi=o.unstable_scheduleCallback,Ii=o.unstable_cancelCallback,Mi=o.unstable_requestPaint,Ai=o.unstable_now,Ti=o.unstable_getCurrentPriorityLevel,ki=o.unstable_ImmediatePriority,Di=o.unstable_UserBlockingPriority,Ri=o.unstable_NormalPriority,Ni=o.unstable_LowPriority,Fi=o.unstable_IdlePriority,xi={},ji=o.unstable_shouldYield,Ki=void 0!==Mi?Mi:function(){},Li=null,Ui=null,Vi=!1,Bi=Ai(),Wi=1e4>Bi?Ai:function(){return Ai()-Bi};function zi(){switch(Ti()){case ki:return 99;case Di:return 98;case Ri:return 97;case Ni:return 96;case Fi:return 95;default:throw Error(a(332))}}function Hi(e){switch(e){case 99:return ki;case 98:return Di;case 97:return Ri;case 96:return Ni;case 95:return Fi;default:throw Error(a(332))}}function Gi(e,t){return e=Hi(e),Ci(e,t)}function qi(e,t,n){return e=Hi(e),Oi(e,t,n)}function Qi(e){return null===Li?(Li=[e],Ui=Oi(ki,$i)):Li.push(e),xi}function Yi(){if(null!==Ui){var e=Ui;Ui=null,Ii(e)}$i()}function $i(){if(!Vi&&null!==Li){Vi=!0;var e=0;try{var t=Li;Gi(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Li=null}catch(t){throw null!==Li&&(Li=Li.slice(e+1)),Oi(ki,Yi),t}finally{Vi=!1}}}function Ji(e,t,n){return 1073741821-(1+((1073741821-e+t/10)/(n/=10)|0))*n}function Xi(e,t){if(e&&e.defaultProps)for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}var Zi={current:null},eo=null,to=null,no=null;function ro(){no=to=eo=null}function io(e){var t=Zi.current;pi(Zi),e.type._context._currentValue=t}function oo(e,t){for(;null!==e;){var n=e.alternate;if(e.childExpirationTime<t)e.childExpirationTime=t,null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t);else{if(!(null!==n&&n.childExpirationTime<t))break;n.childExpirationTime=t}e=e.return}}function ao(e,t){eo=e,no=to=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(e.expirationTime>=t&&(Na=!0),e.firstContext=null)}function so(e,t){if(no!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(no=e,t=1073741823),t={context:e,observedBits:t,next:null},null===to){if(null===eo)throw Error(a(308));to=t,eo.dependencies={expirationTime:0,firstContext:t,responders:null}}else to=to.next=t;return e._currentValue}var co=!1;function lo(e){e.updateQueue={baseState:e.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function uo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,baseQueue:e.baseQueue,shared:e.shared,effects:e.effects})}function po(e,t){return(e={expirationTime:e,suspenseConfig:t,tag:0,payload:null,callback:null,next:null}).next=e}function ho(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function yo(e,t){var n=e.alternate;null!==n&&uo(n,e),null===(n=(e=e.updateQueue).baseQueue)?(e.baseQueue=t.next=t,t.next=t):(t.next=n.next,n.next=t)}function fo(e,t,n,r){var o=e.updateQueue;co=!1;var a=o.baseQueue,s=o.shared.pending;if(null!==s){if(null!==a){var c=a.next;a.next=s.next,s.next=c}a=s,o.shared.pending=null,null!==(c=e.alternate)&&(null!==(c=c.updateQueue)&&(c.baseQueue=s))}if(null!==a){c=a.next;var l=o.baseState,u=0,d=null,p=null,h=null;if(null!==c)for(var y=c;;){if((s=y.expirationTime)<r){var f={expirationTime:y.expirationTime,suspenseConfig:y.suspenseConfig,tag:y.tag,payload:y.payload,callback:y.callback,next:null};null===h?(p=h=f,d=l):h=h.next=f,s>u&&(u=s)}else{null!==h&&(h=h.next={expirationTime:1073741823,suspenseConfig:y.suspenseConfig,tag:y.tag,payload:y.payload,callback:y.callback,next:null}),hc(s,y.suspenseConfig);e:{var v=e,m=y;switch(s=t,f=n,m.tag){case 1:if("function"==typeof(v=m.payload)){l=v.call(f,l,s);break e}l=v;break e;case 3:v.effectTag=-4097&v.effectTag|64;case 0:if(null==(s="function"==typeof(v=m.payload)?v.call(f,l,s):v))break e;l=i({},l,s);break e;case 2:co=!0}}null!==y.callback&&(e.effectTag|=32,null===(s=o.effects)?o.effects=[y]:s.push(y))}if(null===(y=y.next)||y===c){if(null===(s=o.shared.pending))break;y=a.next=s.next,s.next=c,o.baseQueue=a=s,o.shared.pending=null}}null===h?d=l:h.next=p,o.baseState=d,o.baseQueue=h,yc(u),e.expirationTime=u,e.memoizedState=l}}function vo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=i,i=n,"function"!=typeof r)throw Error(a(191,r));r.call(i)}}}var mo=$.ReactCurrentBatchConfig,go=(new r.Component).refs;function So(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:i({},t,n),e.memoizedState=n,0===e.expirationTime&&(e.updateQueue.baseState=n)}var bo={isMounted:function(e){return!!(e=e._reactInternalFiber)&&et(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternalFiber;var r=ec(),i=mo.suspense;(i=po(r=tc(r,e,i),i)).payload=t,null!=n&&(i.callback=n),ho(e,i),nc(e,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternalFiber;var r=ec(),i=mo.suspense;(i=po(r=tc(r,e,i),i)).tag=1,i.payload=t,null!=n&&(i.callback=n),ho(e,i),nc(e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var n=ec(),r=mo.suspense;(r=po(n=tc(n,e,r),r)).tag=2,null!=t&&(r.callback=t),ho(e,r),nc(e,n)}};function Po(e,t,n,r,i,o,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!Wr(n,r)||!Wr(i,o))}function _o(e,t,n){var r=!1,i=yi,o=t.contextType;return"object"==typeof o&&null!==o?o=so(o):(i=Si(t)?mi:fi.current,o=(r=null!=(r=t.contextTypes))?gi(e,i):yi),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=bo,e.stateNode=t,t._reactInternalFiber=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function wo(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&bo.enqueueReplaceState(t,t.state,null)}function Eo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=go,lo(e);var o=t.contextType;"object"==typeof o&&null!==o?i.context=so(o):(o=Si(t)?mi:fi.current,i.context=gi(e,o)),fo(e,n,i,r),i.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(So(e,t,o,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&bo.enqueueReplaceState(i,i.state,null),fo(e,n,i,r),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.effectTag|=4)}var Co=Array.isArray;function Oo(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=r.refs;t===go&&(t=r.refs={}),null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!=typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function Io(e,t){if("textarea"!==e.type)throw Error(a(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,""))}function Mo(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Nc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.effectTag=2,n):r:(t.effectTag=2,n):n}function s(t){return e&&null===t.alternate&&(t.effectTag=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=jc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=Oo(e,t,n),r.return=e,r):((r=Fc(n.type,n.key,n.props,null,e.mode,r)).ref=Oo(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Kc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=xc(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function p(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=jc(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case ee:return(n=Fc(t.type,t.key,t.props,null,e.mode,n)).ref=Oo(e,null,t),n.return=e,n;case te:return(t=Kc(t,e.mode,n)).return=e,t}if(Co(t)||fe(t))return(t=xc(t,e.mode,n,null)).return=e,t;Io(e,t)}return null}function h(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==i?null:c(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case ee:return n.key===i?n.type===ne?d(e,t,n.props.children,r,i):l(e,t,n,r):null;case te:return n.key===i?u(e,t,n,r):null}if(Co(n)||fe(n))return null!==i?null:d(e,t,n,r,null);Io(e,n)}return null}function y(e,t,n,r,i){if("string"==typeof r||"number"==typeof r)return c(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case ee:return e=e.get(null===r.key?n:r.key)||null,r.type===ne?d(t,e,r.props.children,i,r.key):l(t,e,r,i);case te:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(Co(r)||fe(r))return d(t,e=e.get(n)||null,r,i,null);Io(t,r)}return null}function f(i,a,s,c){for(var l=null,u=null,d=a,f=a=0,v=null;null!==d&&f<s.length;f++){d.index>f?(v=d,d=null):v=d.sibling;var m=h(i,d,s[f],c);if(null===m){null===d&&(d=v);break}e&&d&&null===m.alternate&&t(i,d),a=o(m,a,f),null===u?l=m:u.sibling=m,u=m,d=v}if(f===s.length)return n(i,d),l;if(null===d){for(;f<s.length;f++)null!==(d=p(i,s[f],c))&&(a=o(d,a,f),null===u?l=d:u.sibling=d,u=d);return l}for(d=r(i,d);f<s.length;f++)null!==(v=y(d,i,f,s[f],c))&&(e&&null!==v.alternate&&d.delete(null===v.key?f:v.key),a=o(v,a,f),null===u?l=v:u.sibling=v,u=v);return e&&d.forEach((function(e){return t(i,e)})),l}function v(i,s,c,l){var u=fe(c);if("function"!=typeof u)throw Error(a(150));if(null==(c=u.call(c)))throw Error(a(151));for(var d=u=null,f=s,v=s=0,m=null,g=c.next();null!==f&&!g.done;v++,g=c.next()){f.index>v?(m=f,f=null):m=f.sibling;var S=h(i,f,g.value,l);if(null===S){null===f&&(f=m);break}e&&f&&null===S.alternate&&t(i,f),s=o(S,s,v),null===d?u=S:d.sibling=S,d=S,f=m}if(g.done)return n(i,f),u;if(null===f){for(;!g.done;v++,g=c.next())null!==(g=p(i,g.value,l))&&(s=o(g,s,v),null===d?u=g:d.sibling=g,d=g);return u}for(f=r(i,f);!g.done;v++,g=c.next())null!==(g=y(f,i,v,g.value,l))&&(e&&null!==g.alternate&&f.delete(null===g.key?v:g.key),s=o(g,s,v),null===d?u=g:d.sibling=g,d=g);return e&&f.forEach((function(e){return t(i,e)})),u}return function(e,r,o,c){var l="object"==typeof o&&null!==o&&o.type===ne&&null===o.key;l&&(o=o.props.children);var u="object"==typeof o&&null!==o;if(u)switch(o.$$typeof){case ee:e:{for(u=o.key,l=r;null!==l;){if(l.key===u){if(7===l.tag){if(o.type===ne){n(e,l.sibling),(r=i(l,o.props.children)).return=e,e=r;break e}}else if(l.elementType===o.type){n(e,l.sibling),(r=i(l,o.props)).ref=Oo(e,l,o),r.return=e,e=r;break e}n(e,l);break}t(e,l),l=l.sibling}o.type===ne?((r=xc(o.props.children,e.mode,c,o.key)).return=e,e=r):((c=Fc(o.type,o.key,o.props,null,e.mode,c)).ref=Oo(e,r,o),c.return=e,e=c)}return s(e);case te:e:{for(l=o.key;null!==r;){if(r.key===l){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),(r=i(r,o.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Kc(o,e.mode,c)).return=e,e=r}return s(e)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,o)).return=e,e=r):(n(e,r),(r=jc(o,e.mode,c)).return=e,e=r),s(e);if(Co(o))return f(e,r,o,c);if(fe(o))return v(e,r,o,c);if(u&&Io(e,o),void 0===o&&!l)switch(e.tag){case 1:case 0:throw e=e.type,Error(a(152,e.displayName||e.name||"Component"))}return n(e,r)}}var Ao=Mo(!0),To=Mo(!1),ko={},Do={current:ko},Ro={current:ko},No={current:ko};function Fo(e){if(e===ko)throw Error(a(174));return e}function xo(e,t){switch(hi(No,t),hi(Ro,e),hi(Do,ko),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:je(null,"");break;default:t=je(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}pi(Do),hi(Do,t)}function jo(){pi(Do),pi(Ro),pi(No)}function Ko(e){Fo(No.current);var t=Fo(Do.current),n=je(t,e.type);t!==n&&(hi(Ro,e),hi(Do,n))}function Lo(e){Ro.current===e&&(pi(Do),pi(Ro))}var Uo={current:0};function Vo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||n.data===mn||n.data===gn))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(64&t.effectTag))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Bo(e,t){return{responder:e,props:t}}var Wo=$.ReactCurrentDispatcher,zo=$.ReactCurrentBatchConfig,Ho=0,Go=null,qo=null,Qo=null,Yo=!1;function $o(){throw Error(a(321))}function Jo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Vr(e[n],t[n]))return!1;return!0}function Xo(e,t,n,r,i,o){if(Ho=o,Go=t,t.memoizedState=null,t.updateQueue=null,t.expirationTime=0,Wo.current=null===e||null===e.memoizedState?Pa:_a,e=n(r,i),t.expirationTime===Ho){o=0;do{if(t.expirationTime=0,!(25>o))throw Error(a(301));o+=1,Qo=qo=null,t.updateQueue=null,Wo.current=wa,e=n(r,i)}while(t.expirationTime===Ho)}if(Wo.current=ba,t=null!==qo&&null!==qo.next,Ho=0,Qo=qo=Go=null,Yo=!1,t)throw Error(a(300));return e}function Zo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Qo?Go.memoizedState=Qo=e:Qo=Qo.next=e,Qo}function ea(){if(null===qo){var e=Go.alternate;e=null!==e?e.memoizedState:null}else e=qo.next;var t=null===Qo?Go.memoizedState:Qo.next;if(null!==t)Qo=t,qo=e;else{if(null===e)throw Error(a(310));e={memoizedState:(qo=e).memoizedState,baseState:qo.baseState,baseQueue:qo.baseQueue,queue:qo.queue,next:null},null===Qo?Go.memoizedState=Qo=e:Qo=Qo.next=e}return Qo}function ta(e,t){return"function"==typeof t?t(e):t}function na(e){var t=ea(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=qo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var c=s=o=null,l=i;do{var u=l.expirationTime;if(u<Ho){var d={expirationTime:l.expirationTime,suspenseConfig:l.suspenseConfig,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};null===c?(s=c=d,o=r):c=c.next=d,u>Go.expirationTime&&(Go.expirationTime=u,yc(u))}else null!==c&&(c=c.next={expirationTime:1073741823,suspenseConfig:l.suspenseConfig,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),hc(u,l.suspenseConfig),r=l.eagerReducer===e?l.eagerState:e(r,l.action);l=l.next}while(null!==l&&l!==i);null===c?o=r:c.next=s,Vr(r,t.memoizedState)||(Na=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function ra(e){var t=ea(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);Vr(o,t.memoizedState)||(Na=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function ia(e){var t=Zo();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:ta,lastRenderedState:e}).dispatch=Sa.bind(null,Go,e),[t.memoizedState,e]}function oa(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Go.updateQueue)?(t={lastEffect:null},Go.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function aa(){return ea().memoizedState}function sa(e,t,n,r){var i=Zo();Go.effectTag|=e,i.memoizedState=oa(1|t,n,void 0,void 0===r?null:r)}function ca(e,t,n,r){var i=ea();r=void 0===r?null:r;var o=void 0;if(null!==qo){var a=qo.memoizedState;if(o=a.destroy,null!==r&&Jo(r,a.deps))return void oa(t,n,o,r)}Go.effectTag|=e,i.memoizedState=oa(1|t,n,o,r)}function la(e,t){return sa(516,4,e,t)}function ua(e,t){return ca(516,4,e,t)}function da(e,t){return ca(4,2,e,t)}function pa(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function ha(e,t,n){return n=null!=n?n.concat([e]):null,ca(4,2,pa.bind(null,t,e),n)}function ya(){}function fa(e,t){return Zo().memoizedState=[e,void 0===t?null:t],e}function va(e,t){var n=ea();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Jo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function ma(e,t){var n=ea();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Jo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ga(e,t,n){var r=zi();Gi(98>r?98:r,(function(){e(!0)})),Gi(97<r?97:r,(function(){var r=zo.suspense;zo.suspense=void 0===t?null:t;try{e(!1),n()}finally{zo.suspense=r}}))}function Sa(e,t,n){var r=ec(),i=mo.suspense;i={expirationTime:r=tc(r,e,i),suspenseConfig:i,action:n,eagerReducer:null,eagerState:null,next:null};var o=t.pending;if(null===o?i.next=i:(i.next=o.next,o.next=i),t.pending=i,o=e.alternate,e===Go||null!==o&&o===Go)Yo=!0,i.expirationTime=Ho,Go.expirationTime=Ho;else{if(0===e.expirationTime&&(null===o||0===o.expirationTime)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(i.eagerReducer=o,i.eagerState=s,Vr(s,a))return}catch(e){}nc(e,r)}}var ba={readContext:so,useCallback:$o,useContext:$o,useEffect:$o,useImperativeHandle:$o,useLayoutEffect:$o,useMemo:$o,useReducer:$o,useRef:$o,useState:$o,useDebugValue:$o,useResponder:$o,useDeferredValue:$o,useTransition:$o},Pa={readContext:so,useCallback:fa,useContext:so,useEffect:la,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,sa(4,2,pa.bind(null,t,e),n)},useLayoutEffect:function(e,t){return sa(4,2,e,t)},useMemo:function(e,t){var n=Zo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Zo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Sa.bind(null,Go,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Zo().memoizedState=e},useState:ia,useDebugValue:ya,useResponder:Bo,useDeferredValue:function(e,t){var n=ia(e),r=n[0],i=n[1];return la((function(){var n=zo.suspense;zo.suspense=void 0===t?null:t;try{i(e)}finally{zo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=ia(!1),n=t[0];return t=t[1],[fa(ga.bind(null,t,e),[t,e]),n]}},_a={readContext:so,useCallback:va,useContext:so,useEffect:ua,useImperativeHandle:ha,useLayoutEffect:da,useMemo:ma,useReducer:na,useRef:aa,useState:function(){return na(ta)},useDebugValue:ya,useResponder:Bo,useDeferredValue:function(e,t){var n=na(ta),r=n[0],i=n[1];return ua((function(){var n=zo.suspense;zo.suspense=void 0===t?null:t;try{i(e)}finally{zo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=na(ta),n=t[0];return t=t[1],[va(ga.bind(null,t,e),[t,e]),n]}},wa={readContext:so,useCallback:va,useContext:so,useEffect:ua,useImperativeHandle:ha,useLayoutEffect:da,useMemo:ma,useReducer:ra,useRef:aa,useState:function(){return ra(ta)},useDebugValue:ya,useResponder:Bo,useDeferredValue:function(e,t){var n=ra(ta),r=n[0],i=n[1];return ua((function(){var n=zo.suspense;zo.suspense=void 0===t?null:t;try{i(e)}finally{zo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=ra(ta),n=t[0];return t=t[1],[va(ga.bind(null,t,e),[t,e]),n]}},Ea=null,Ca=null,Oa=!1;function Ia(e,t){var n=Dc(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Ma(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function Aa(e){if(Oa){var t=Ca;if(t){var n=t;if(!Ma(e,t)){if(!(t=Cn(n.nextSibling))||!Ma(e,t))return e.effectTag=-1025&e.effectTag|2,Oa=!1,void(Ea=e);Ia(Ea,n)}Ea=e,Ca=Cn(t.firstChild)}else e.effectTag=-1025&e.effectTag|2,Oa=!1,Ea=e}}function Ta(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Ea=e}function ka(e){if(e!==Ea)return!1;if(!Oa)return Ta(e),Oa=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!_n(t,e.memoizedProps))for(t=Ca;t;)Ia(e,t),t=Cn(t.nextSibling);if(Ta(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Ca=Cn(e.nextSibling);break e}t--}else"$"!==n&&n!==gn&&n!==mn||t++}e=e.nextSibling}Ca=null}}else Ca=Ea?Cn(e.stateNode.nextSibling):null;return!0}function Da(){Ca=Ea=null,Oa=!1}var Ra=$.ReactCurrentOwner,Na=!1;function Fa(e,t,n,r){t.child=null===e?To(t,null,n,r):Ao(t,e.child,n,r)}function xa(e,t,n,r,i){n=n.render;var o=t.ref;return ao(t,i),r=Xo(e,t,n,r,o,i),null===e||Na?(t.effectTag|=1,Fa(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),Xa(e,t,i))}function ja(e,t,n,r,i,o){if(null===e){var a=n.type;return"function"!=typeof a||Rc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Fc(n.type,null,r,null,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Ka(e,t,a,r,i,o))}return a=e.child,i<o&&(i=a.memoizedProps,(n=null!==(n=n.compare)?n:Wr)(i,r)&&e.ref===t.ref)?Xa(e,t,o):(t.effectTag|=1,(e=Nc(a,r)).ref=t.ref,e.return=t,t.child=e)}function Ka(e,t,n,r,i,o){return null!==e&&Wr(e.memoizedProps,r)&&e.ref===t.ref&&(Na=!1,i<o)?(t.expirationTime=e.expirationTime,Xa(e,t,o)):Ua(e,t,n,r,o)}function La(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.effectTag|=128)}function Ua(e,t,n,r,i){var o=Si(n)?mi:fi.current;return o=gi(t,o),ao(t,i),n=Xo(e,t,n,r,o,i),null===e||Na?(t.effectTag|=1,Fa(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),Xa(e,t,i))}function Va(e,t,n,r,i){if(Si(n)){var o=!0;wi(t)}else o=!1;if(ao(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),_o(t,n,r),Eo(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var c=a.context,l=n.contextType;"object"==typeof l&&null!==l?l=so(l):l=gi(t,l=Si(n)?mi:fi.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof a.getSnapshotBeforeUpdate;d||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||c!==l)&&wo(t,a,r,l),co=!1;var p=t.memoizedState;a.state=p,fo(t,r,a,i),c=t.memoizedState,s!==r||p!==c||vi.current||co?("function"==typeof u&&(So(t,n,u,r),c=t.memoizedState),(s=co||Po(t,n,s,r,p,c,l))?(d||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.effectTag|=4)):("function"==typeof a.componentDidMount&&(t.effectTag|=4),t.memoizedProps=r,t.memoizedState=c),a.props=r,a.state=c,a.context=l,r=s):("function"==typeof a.componentDidMount&&(t.effectTag|=4),r=!1)}else a=t.stateNode,uo(e,t),s=t.memoizedProps,a.props=t.type===t.elementType?s:Xi(t.type,s),c=a.context,"object"==typeof(l=n.contextType)&&null!==l?l=so(l):l=gi(t,l=Si(n)?mi:fi.current),(d="function"==typeof(u=n.getDerivedStateFromProps)||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||c!==l)&&wo(t,a,r,l),co=!1,c=t.memoizedState,a.state=c,fo(t,r,a,i),p=t.memoizedState,s!==r||c!==p||vi.current||co?("function"==typeof u&&(So(t,n,u,r),p=t.memoizedState),(u=co||Po(t,n,s,r,c,p,l))?(d||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,l),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,l)),"function"==typeof a.componentDidUpdate&&(t.effectTag|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&c===e.memoizedState||(t.effectTag|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&c===e.memoizedState||(t.effectTag|=256),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=l,r=u):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&c===e.memoizedState||(t.effectTag|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&c===e.memoizedState||(t.effectTag|=256),r=!1);return Ba(e,t,n,r,o,i)}function Ba(e,t,n,r,i,o){La(e,t);var a=0!=(64&t.effectTag);if(!r&&!a)return i&&Ei(t,n,!1),Xa(e,t,o);r=t.stateNode,Ra.current=t;var s=a&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.effectTag|=1,null!==e&&a?(t.child=Ao(t,e.child,null,o),t.child=Ao(t,null,s,o)):Fa(e,t,s,o),t.memoizedState=r.state,i&&Ei(t,n,!0),t.child}function Wa(e){var t=e.stateNode;t.pendingContext?Pi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Pi(0,t.context,!1),xo(e,t.containerInfo)}var za,Ha,Ga,qa={dehydrated:null,retryTime:0};function Qa(e,t,n){var r,i=t.mode,o=t.pendingProps,a=Uo.current,s=!1;if((r=0!=(64&t.effectTag))||(r=0!=(2&a)&&(null===e||null!==e.memoizedState)),r?(s=!0,t.effectTag&=-65):null!==e&&null===e.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(a|=1),hi(Uo,1&a),null===e){if(void 0!==o.fallback&&Aa(t),s){if(s=o.fallback,(o=xc(null,i,0,null)).return=t,0==(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,o.child=e;null!==e;)e.return=o,e=e.sibling;return(n=xc(s,i,n,null)).return=t,o.sibling=n,t.memoizedState=qa,t.child=o,n}return i=o.children,t.memoizedState=null,t.child=To(t,null,i,n)}if(null!==e.memoizedState){if(i=(e=e.child).sibling,s){if(o=o.fallback,(n=Nc(e,e.pendingProps)).return=t,0==(2&t.mode)&&(s=null!==t.memoizedState?t.child.child:t.child)!==e.child)for(n.child=s;null!==s;)s.return=n,s=s.sibling;return(i=Nc(i,o)).return=t,n.sibling=i,n.childExpirationTime=0,t.memoizedState=qa,t.child=n,i}return n=Ao(t,e.child,o.children,n),t.memoizedState=null,t.child=n}if(e=e.child,s){if(s=o.fallback,(o=xc(null,i,0,null)).return=t,o.child=e,null!==e&&(e.return=o),0==(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,o.child=e;null!==e;)e.return=o,e=e.sibling;return(n=xc(s,i,n,null)).return=t,o.sibling=n,n.effectTag|=2,o.childExpirationTime=0,t.memoizedState=qa,t.child=o,n}return t.memoizedState=null,t.child=Ao(t,e,o.children,n)}function Ya(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t),oo(e.return,t)}function $a(e,t,n,r,i,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailExpiration:0,tailMode:i,lastEffect:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailExpiration=0,a.tailMode=i,a.lastEffect=o)}function Ja(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Fa(e,t,r.children,n),0!=(2&(r=Uo.current)))r=1&r|2,t.effectTag|=64;else{if(null!==e&&0!=(64&e.effectTag))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ya(e,n);else if(19===e.tag)Ya(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(hi(Uo,r),0==(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Vo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),$a(t,!1,i,n,o,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Vo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}$a(t,!0,n,null,o,t.lastEffect);break;case"together":$a(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function Xa(e,t,n){null!==e&&(t.dependencies=e.dependencies);var r=t.expirationTime;if(0!==r&&yc(r),t.childExpirationTime<n)return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Nc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Nc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Za(e,t){switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function es(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return Si(t.type)&&bi(),null;case 3:return jo(),pi(vi),pi(fi),(n=t.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||!ka(t)||(t.effectTag|=4),null;case 5:Lo(t),n=Fo(No.current);var o=t.type;if(null!==e&&null!=t.stateNode)Ha(e,t,o,r,n),e.ref!==t.ref&&(t.effectTag|=128);else{if(!r){if(null===t.stateNode)throw Error(a(166));return null}if(e=Fo(Do.current),ka(t)){r=t.stateNode,o=t.type;var s=t.memoizedProps;switch(r[Mn]=t,r[An]=s,o){case"iframe":case"object":case"embed":Qt("load",r);break;case"video":case"audio":for(e=0;e<Je.length;e++)Qt(Je[e],r);break;case"source":Qt("error",r);break;case"img":case"image":case"link":Qt("error",r),Qt("load",r);break;case"form":Qt("reset",r),Qt("submit",r);break;case"details":Qt("toggle",r);break;case"input":we(r,s),Qt("invalid",r),ln(n,"onChange");break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Qt("invalid",r),ln(n,"onChange");break;case"textarea":ke(r,s),Qt("invalid",r),ln(n,"onChange")}for(var c in an(o,s),e=null,s)if(s.hasOwnProperty(c)){var l=s[c];"children"===c?"string"==typeof l?r.textContent!==l&&(e=["children",l]):"number"==typeof l&&r.textContent!==""+l&&(e=["children",""+l]):E.hasOwnProperty(c)&&null!=l&&ln(n,c)}switch(o){case"input":be(r),Oe(r,s,!0);break;case"textarea":be(r),Re(r);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(r.onclick=un)}n=e,t.updateQueue=n,null!==n&&(t.effectTag|=4)}else{switch(c=9===n.nodeType?n:n.ownerDocument,e===cn&&(e=xe(o)),e===cn?"script"===o?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=c.createElement(o,{is:r.is}):(e=c.createElement(o),"select"===o&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,o),e[Mn]=t,e[An]=r,za(e,t),t.stateNode=e,c=sn(o,r),o){case"iframe":case"object":case"embed":Qt("load",e),l=r;break;case"video":case"audio":for(l=0;l<Je.length;l++)Qt(Je[l],e);l=r;break;case"source":Qt("error",e),l=r;break;case"img":case"image":case"link":Qt("error",e),Qt("load",e),l=r;break;case"form":Qt("reset",e),Qt("submit",e),l=r;break;case"details":Qt("toggle",e),l=r;break;case"input":we(e,r),l=_e(e,r),Qt("invalid",e),ln(n,"onChange");break;case"option":l=Me(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},l=i({},r,{value:void 0}),Qt("invalid",e),ln(n,"onChange");break;case"textarea":ke(e,r),l=Te(e,r),Qt("invalid",e),ln(n,"onChange");break;default:l=r}an(o,l);var u=l;for(s in u)if(u.hasOwnProperty(s)){var d=u[s];"style"===s?rn(e,d):"dangerouslySetInnerHTML"===s?null!=(d=d?d.__html:void 0)&&Ue(e,d):"children"===s?"string"==typeof d?("textarea"!==o||""!==d)&&Ve(e,d):"number"==typeof d&&Ve(e,""+d):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(E.hasOwnProperty(s)?null!=d&&ln(n,s):null!=d&&J(e,s,d,c))}switch(o){case"input":be(e),Oe(e,r,!1);break;case"textarea":be(e),Re(e);break;case"option":null!=r.value&&e.setAttribute("value",""+ge(r.value));break;case"select":e.multiple=!!r.multiple,null!=(n=r.value)?Ae(e,!!r.multiple,n,!1):null!=r.defaultValue&&Ae(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof l.onClick&&(e.onclick=un)}Pn(o,r)&&(t.effectTag|=4)}null!==t.ref&&(t.effectTag|=128)}return null;case 6:if(e&&null!=t.stateNode)Ga(0,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(a(166));n=Fo(No.current),Fo(Do.current),ka(t)?(n=t.stateNode,r=t.memoizedProps,n[Mn]=t,n.nodeValue!==r&&(t.effectTag|=4)):((n=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Mn]=t,t.stateNode=n)}return null;case 13:return pi(Uo),r=t.memoizedState,0!=(64&t.effectTag)?(t.expirationTime=n,t):(n=null!==r,r=!1,null===e?void 0!==t.memoizedProps.fallback&&ka(t):(r=null!==(o=e.memoizedState),n||null===o||null!==(o=e.child.sibling)&&(null!==(s=t.firstEffect)?(t.firstEffect=o,o.nextEffect=s):(t.firstEffect=t.lastEffect=o,o.nextEffect=null),o.effectTag=8)),n&&!r&&0!=(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!=(1&Uo.current)?Fs===Ms&&(Fs=As):(Fs!==Ms&&Fs!==As||(Fs=Ts),0!==Us&&null!==Ds&&(Vc(Ds,Ns),Bc(Ds,Us)))),(n||r)&&(t.effectTag|=4),null);case 4:return jo(),null;case 10:return io(t),null;case 19:if(pi(Uo),null===(r=t.memoizedState))return null;if(o=0!=(64&t.effectTag),null===(s=r.rendering)){if(o)Za(r,!1);else if(Fs!==Ms||null!==e&&0!=(64&e.effectTag))for(s=t.child;null!==s;){if(null!==(e=Vo(s))){for(t.effectTag|=64,Za(r,!1),null!==(o=e.updateQueue)&&(t.updateQueue=o,t.effectTag|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=t.child;null!==r;)s=n,(o=r).effectTag&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(e=o.alternate)?(o.childExpirationTime=0,o.expirationTime=s,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null):(o.childExpirationTime=e.childExpirationTime,o.expirationTime=e.expirationTime,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,s=e.dependencies,o.dependencies=null===s?null:{expirationTime:s.expirationTime,firstContext:s.firstContext,responders:s.responders}),r=r.sibling;return hi(Uo,1&Uo.current|2),t.child}s=s.sibling}}else{if(!o)if(null!==(e=Vo(s))){if(t.effectTag|=64,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.effectTag|=4),Za(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Wi()-r.renderingStartTime>r.tailExpiration&&1<n&&(t.effectTag|=64,o=!0,Za(r,!1),t.expirationTime=t.childExpirationTime=n-1);r.isBackwards?(s.sibling=t.child,t.child=s):(null!==(n=r.last)?n.sibling=s:t.child=s,r.last=s)}return null!==r.tail?(0===r.tailExpiration&&(r.tailExpiration=Wi()+500),n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Wi(),n.sibling=null,t=Uo.current,hi(Uo,o?1&t|2:1&t),n):null}throw Error(a(156,t.tag))}function ts(e){switch(e.tag){case 1:Si(e.type)&&bi();var t=e.effectTag;return 4096&t?(e.effectTag=-4097&t|64,e):null;case 3:if(jo(),pi(vi),pi(fi),0!=(64&(t=e.effectTag)))throw Error(a(285));return e.effectTag=-4097&t|64,e;case 5:return Lo(e),null;case 13:return pi(Uo),4096&(t=e.effectTag)?(e.effectTag=-4097&t|64,e):null;case 19:return pi(Uo),null;case 4:return jo(),null;case 10:return io(e),null;default:return null}}function ns(e,t){return{value:e,source:t,stack:me(t)}}za=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ha=function(e,t,n,r,o){var a=e.memoizedProps;if(a!==r){var s,c,l=t.stateNode;switch(Fo(Do.current),e=null,n){case"input":a=_e(l,a),r=_e(l,r),e=[];break;case"option":a=Me(l,a),r=Me(l,r),e=[];break;case"select":a=i({},a,{value:void 0}),r=i({},r,{value:void 0}),e=[];break;case"textarea":a=Te(l,a),r=Te(l,r),e=[];break;default:"function"!=typeof a.onClick&&"function"==typeof r.onClick&&(l.onclick=un)}for(s in an(n,r),n=null,a)if(!r.hasOwnProperty(s)&&a.hasOwnProperty(s)&&null!=a[s])if("style"===s)for(c in l=a[s])l.hasOwnProperty(c)&&(n||(n={}),n[c]="");else"dangerouslySetInnerHTML"!==s&&"children"!==s&&"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(E.hasOwnProperty(s)?e||(e=[]):(e=e||[]).push(s,null));for(s in r){var u=r[s];if(l=null!=a?a[s]:void 0,r.hasOwnProperty(s)&&u!==l&&(null!=u||null!=l))if("style"===s)if(l){for(c in l)!l.hasOwnProperty(c)||u&&u.hasOwnProperty(c)||(n||(n={}),n[c]="");for(c in u)u.hasOwnProperty(c)&&l[c]!==u[c]&&(n||(n={}),n[c]=u[c])}else n||(e||(e=[]),e.push(s,n)),n=u;else"dangerouslySetInnerHTML"===s?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(e=e||[]).push(s,u)):"children"===s?l===u||"string"!=typeof u&&"number"!=typeof u||(e=e||[]).push(s,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&(E.hasOwnProperty(s)?(null!=u&&ln(o,s),e||l===u||(e=[])):(e=e||[]).push(s,u))}n&&(e=e||[]).push("style",n),o=e,(t.updateQueue=o)&&(t.effectTag|=4)}},Ga=function(e,t,n,r){n!==r&&(t.effectTag|=4)};var rs="function"==typeof WeakSet?WeakSet:Set;function is(e,t){var n=t.source,r=t.stack;null===r&&null!==n&&(r=me(n)),null!==n&&ve(n.type),t=t.value,null!==e&&1===e.tag&&ve(e.type);try{console.error(t)}catch(e){setTimeout((function(){throw e}))}}function os(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){Oc(e,t)}else t.current=null}function as(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 3:case 5:case 6:case 4:case 17:return;case 1:if(256&t.effectTag&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Xi(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return}throw Error(a(163))}function ss(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.destroy;n.destroy=void 0,void 0!==r&&r()}n=n.next}while(n!==t)}}function cs(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ls(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:return void cs(3,n);case 1:if(e=n.stateNode,4&n.effectTag)if(null===t)e.componentDidMount();else{var r=n.elementType===n.type?t.memoizedProps:Xi(n.type,t.memoizedProps);e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate)}return void(null!==(t=n.updateQueue)&&vo(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}vo(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.effectTag&&Pn(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&jt(n)))))}throw Error(a(163))}function us(e,t,n){switch("function"==typeof Tc&&Tc(t),t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var r=e.next;Gi(97<n?97:n,(function(){var e=r;do{var n=e.destroy;if(void 0!==n){var i=t;try{n()}catch(e){Oc(i,e)}}e=e.next}while(e!==r)}))}break;case 1:os(t),"function"==typeof(n=t.stateNode).componentWillUnmount&&function(e,t){try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(t){Oc(e,t)}}(t,n);break;case 5:os(t);break;case 4:vs(e,t,n)}}function ds(e){var t=e.alternate;e.return=null,e.child=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.alternate=null,e.firstEffect=null,e.lastEffect=null,e.pendingProps=null,e.memoizedProps=null,e.stateNode=null,null!==t&&ds(t)}function ps(e){return 5===e.tag||3===e.tag||4===e.tag}function hs(e){e:{for(var t=e.return;null!==t;){if(ps(t)){var n=t;break e}t=t.return}throw Error(a(160))}switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(a(161))}16&n.effectTag&&(Ve(t,""),n.effectTag&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||ps(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break e}}r?ys(e,n,t):fs(e,n,t)}function ys(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=un));else if(4!==r&&null!==(e=e.child))for(ys(e,t,n),e=e.sibling;null!==e;)ys(e,t,n),e=e.sibling}function fs(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(fs(e,t,n),e=e.sibling;null!==e;)fs(e,t,n),e=e.sibling}function vs(e,t,n){for(var r,i,o=t,s=!1;;){if(!s){s=o.return;e:for(;;){if(null===s)throw Error(a(160));switch(r=s.stateNode,s.tag){case 5:i=!1;break e;case 3:case 4:r=r.containerInfo,i=!0;break e}s=s.return}s=!0}if(5===o.tag||6===o.tag){e:for(var c=e,l=o,u=n,d=l;;)if(us(c,d,u),null!==d.child&&4!==d.tag)d.child.return=d,d=d.child;else{if(d===l)break e;for(;null===d.sibling;){if(null===d.return||d.return===l)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}i?(c=r,l=o.stateNode,8===c.nodeType?c.parentNode.removeChild(l):c.removeChild(l)):r.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){r=o.stateNode.containerInfo,i=!0,o.child.return=o,o=o.child;continue}}else if(us(e,o,n),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(s=!1)}o.sibling.return=o.return,o=o.sibling}}function ms(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void ss(3,t);case 1:case 12:case 17:return;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps,i=null!==e?e.memoizedProps:r;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(n[An]=r,"input"===e&&"radio"===r.type&&null!=r.name&&Ee(n,r),sn(e,i),t=sn(e,r),i=0;i<o.length;i+=2){var s=o[i],c=o[i+1];"style"===s?rn(n,c):"dangerouslySetInnerHTML"===s?Ue(n,c):"children"===s?Ve(n,c):J(n,s,c,t)}switch(e){case"input":Ce(n,r);break;case"textarea":De(n,r);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(e=r.value)?Ae(n,!!r.multiple,e,!1):t!==!!r.multiple&&(null!=r.defaultValue?Ae(n,!!r.multiple,r.defaultValue,!0):Ae(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(a(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((t=t.stateNode).hydrate&&(t.hydrate=!1,jt(t.containerInfo)));case 13:if(n=t,null===t.memoizedState?r=!1:(r=!0,n=t.child,Bs=Wi()),null!==n)e:for(e=n;;){if(5===e.tag)o=e.stateNode,r?"function"==typeof(o=o.style).setProperty?o.setProperty("display","none","important"):o.display="none":(o=e.stateNode,i=null!=(i=e.memoizedProps.style)&&i.hasOwnProperty("display")?i.display:null,o.style.display=nn("display",i));else if(6===e.tag)e.stateNode.nodeValue=r?"":e.memoizedProps;else{if(13===e.tag&&null!==e.memoizedState&&null===e.memoizedState.dehydrated){(o=e.child.sibling).return=e,e=o;continue}if(null!==e.child){e.child.return=e,e=e.child;continue}}if(e===n)break;for(;null===e.sibling;){if(null===e.return||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}return void gs(t);case 19:return void gs(t)}throw Error(a(163))}function gs(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new rs),t.forEach((function(t){var r=Mc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}var Ss="function"==typeof WeakMap?WeakMap:Map;function bs(e,t,n){(n=po(n,null)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){zs||(zs=!0,Hs=r),is(e,t)},n}function Ps(e,t,n){(n=po(n,null)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var i=t.value;n.payload=function(){return is(e,t),r(i)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===Gs?Gs=new Set([this]):Gs.add(this),is(e,t));var n=t.stack;this.componentDidCatch(t.value,{componentStack:null!==n?n:""})}),n}var _s,ws=Math.ceil,Es=$.ReactCurrentDispatcher,Cs=$.ReactCurrentOwner,Os=16,Is=32,Ms=0,As=3,Ts=4,ks=0,Ds=null,Rs=null,Ns=0,Fs=Ms,xs=null,js=1073741823,Ks=1073741823,Ls=null,Us=0,Vs=!1,Bs=0,Ws=null,zs=!1,Hs=null,Gs=null,qs=!1,Qs=null,Ys=90,$s=null,Js=0,Xs=null,Zs=0;function ec(){return 0!=(48&ks)?1073741821-(Wi()/10|0):0!==Zs?Zs:Zs=1073741821-(Wi()/10|0)}function tc(e,t,n){if(0==(2&(t=t.mode)))return 1073741823;var r=zi();if(0==(4&t))return 99===r?1073741823:1073741822;if(0!=(ks&Os))return Ns;if(null!==n)e=Ji(e,0|n.timeoutMs||5e3,250);else switch(r){case 99:e=1073741823;break;case 98:e=Ji(e,150,100);break;case 97:case 96:e=Ji(e,5e3,250);break;case 95:e=2;break;default:throw Error(a(326))}return null!==Ds&&e===Ns&&--e,e}function nc(e,t){if(50<Js)throw Js=0,Xs=null,Error(a(185));if(null!==(e=rc(e,t))){var n=zi();1073741823===t?0!=(8&ks)&&0==(48&ks)?sc(e):(oc(e),0===ks&&Yi()):oc(e),0==(4&ks)||98!==n&&99!==n||(null===$s?$s=new Map([[e,t]]):(void 0===(n=$s.get(e))||n>t)&&$s.set(e,t))}}function rc(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t);var r=e.return,i=null;if(null===r&&3===e.tag)i=e.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<t&&(r.childExpirationTime=t),null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t),null===r.return&&3===r.tag){i=r.stateNode;break}r=r.return}return null!==i&&(Ds===i&&(yc(t),Fs===Ts&&Vc(i,Ns)),Bc(i,t)),i}function ic(e){var t=e.lastExpiredTime;if(0!==t)return t;if(!Uc(e,t=e.firstPendingTime))return t;var n=e.lastPingedTime;return 2>=(e=n>(e=e.nextKnownPendingLevel)?n:e)&&t!==e?0:e}function oc(e){if(0!==e.lastExpiredTime)e.callbackExpirationTime=1073741823,e.callbackPriority=99,e.callbackNode=Qi(sc.bind(null,e));else{var t=ic(e),n=e.callbackNode;if(0===t)null!==n&&(e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90);else{var r=ec();if(1073741823===t?r=99:1===t||2===t?r=95:r=0>=(r=10*(1073741821-t)-10*(1073741821-r))?99:250>=r?98:5250>=r?97:95,null!==n){var i=e.callbackPriority;if(e.callbackExpirationTime===t&&i>=r)return;n!==xi&&Ii(n)}e.callbackExpirationTime=t,e.callbackPriority=r,t=1073741823===t?Qi(sc.bind(null,e)):qi(r,ac.bind(null,e),{timeout:10*(1073741821-t)-Wi()}),e.callbackNode=t}}}function ac(e,t){if(Zs=0,t)return Wc(e,t=ec()),oc(e),null;var n=ic(e);if(0!==n){if(t=e.callbackNode,0!=(48&ks))throw Error(a(327));if(wc(),e===Ds&&n===Ns||uc(e,n),null!==Rs){var r=ks;ks|=Os;for(var i=pc();;)try{vc();break}catch(t){dc(e,t)}if(ro(),ks=r,Es.current=i,1===Fs)throw t=xs,uc(e,n),Vc(e,n),oc(e),t;if(null===Rs)switch(i=e.finishedWork=e.current.alternate,e.finishedExpirationTime=n,r=Fs,Ds=null,r){case Ms:case 1:throw Error(a(345));case 2:Wc(e,2<n?2:n);break;case As:if(Vc(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=Sc(i)),1073741823===js&&10<(i=Bs+500-Wi())){if(Vs){var o=e.lastPingedTime;if(0===o||o>=n){e.lastPingedTime=n,uc(e,n);break}}if(0!==(o=ic(e))&&o!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}e.timeoutHandle=wn(bc.bind(null,e),i);break}bc(e);break;case Ts:if(Vc(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=Sc(i)),Vs&&(0===(i=e.lastPingedTime)||i>=n)){e.lastPingedTime=n,uc(e,n);break}if(0!==(i=ic(e))&&i!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}if(1073741823!==Ks?r=10*(1073741821-Ks)-Wi():1073741823===js?r=0:(r=10*(1073741821-js)-5e3,0>(r=(i=Wi())-r)&&(r=0),(n=10*(1073741821-n)-i)<(r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ws(r/1960))-r)&&(r=n)),10<r){e.timeoutHandle=wn(bc.bind(null,e),r);break}bc(e);break;case 5:if(1073741823!==js&&null!==Ls){o=js;var s=Ls;if(0>=(r=0|s.busyMinDurationMs)?r=0:(i=0|s.busyDelayMs,r=(o=Wi()-(10*(1073741821-o)-(0|s.timeoutMs||5e3)))<=i?0:i+r-o),10<r){Vc(e,n),e.timeoutHandle=wn(bc.bind(null,e),r);break}}bc(e);break;default:throw Error(a(329))}if(oc(e),e.callbackNode===t)return ac.bind(null,e)}}return null}function sc(e){var t=e.lastExpiredTime;if(t=0!==t?t:1073741823,0!=(48&ks))throw Error(a(327));if(wc(),e===Ds&&t===Ns||uc(e,t),null!==Rs){var n=ks;ks|=Os;for(var r=pc();;)try{fc();break}catch(t){dc(e,t)}if(ro(),ks=n,Es.current=r,1===Fs)throw n=xs,uc(e,t),Vc(e,t),oc(e),n;if(null!==Rs)throw Error(a(261));e.finishedWork=e.current.alternate,e.finishedExpirationTime=t,Ds=null,bc(e),oc(e)}return null}function cc(e,t){var n=ks;ks|=1;try{return e(t)}finally{0===(ks=n)&&Yi()}}function lc(e,t){var n=ks;ks&=-2,ks|=8;try{return e(t)}finally{0===(ks=n)&&Yi()}}function uc(e,t){e.finishedWork=null,e.finishedExpirationTime=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,En(n)),null!==Rs)for(n=Rs.return;null!==n;){var r=n;switch(r.tag){case 1:null!=(r=r.type.childContextTypes)&&bi();break;case 3:jo(),pi(vi),pi(fi);break;case 5:Lo(r);break;case 4:jo();break;case 13:case 19:pi(Uo);break;case 10:io(r)}n=n.return}Ds=e,Rs=Nc(e.current,null),Ns=t,Fs=Ms,xs=null,Ks=js=1073741823,Ls=null,Us=0,Vs=!1}function dc(e,t){for(;;){try{if(ro(),Wo.current=ba,Yo)for(var n=Go.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}if(Ho=0,Qo=qo=Go=null,Yo=!1,null===Rs||null===Rs.return)return Fs=1,xs=t,Rs=null;e:{var i=e,o=Rs.return,a=Rs,s=t;if(t=Ns,a.effectTag|=2048,a.firstEffect=a.lastEffect=null,null!==s&&"object"==typeof s&&"function"==typeof s.then){var c=s;if(0==(2&a.mode)){var l=a.alternate;l?(a.updateQueue=l.updateQueue,a.memoizedState=l.memoizedState,a.expirationTime=l.expirationTime):(a.updateQueue=null,a.memoizedState=null)}var u=0!=(1&Uo.current),d=o;do{var p;if(p=13===d.tag){var h=d.memoizedState;if(null!==h)p=null!==h.dehydrated;else{var y=d.memoizedProps;p=void 0!==y.fallback&&(!0!==y.unstable_avoidThisFallback||!u)}}if(p){var f=d.updateQueue;if(null===f){var v=new Set;v.add(c),d.updateQueue=v}else f.add(c);if(0==(2&d.mode)){if(d.effectTag|=64,a.effectTag&=-2981,1===a.tag)if(null===a.alternate)a.tag=17;else{var m=po(1073741823,null);m.tag=2,ho(a,m)}a.expirationTime=1073741823;break e}s=void 0,a=t;var g=i.pingCache;if(null===g?(g=i.pingCache=new Ss,s=new Set,g.set(c,s)):void 0===(s=g.get(c))&&(s=new Set,g.set(c,s)),!s.has(a)){s.add(a);var S=Ic.bind(null,i,c,a);c.then(S,S)}d.effectTag|=4096,d.expirationTime=t;break e}d=d.return}while(null!==d);s=Error((ve(a.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+me(a))}5!==Fs&&(Fs=2),s=ns(s,a),d=o;do{switch(d.tag){case 3:c=s,d.effectTag|=4096,d.expirationTime=t,yo(d,bs(d,c,t));break e;case 1:c=s;var b=d.type,P=d.stateNode;if(0==(64&d.effectTag)&&("function"==typeof b.getDerivedStateFromError||null!==P&&"function"==typeof P.componentDidCatch&&(null===Gs||!Gs.has(P)))){d.effectTag|=4096,d.expirationTime=t,yo(d,Ps(d,c,t));break e}}d=d.return}while(null!==d)}Rs=gc(Rs)}catch(e){t=e;continue}break}}function pc(){var e=Es.current;return Es.current=ba,null===e?ba:e}function hc(e,t){e<js&&2<e&&(js=e),null!==t&&e<Ks&&2<e&&(Ks=e,Ls=t)}function yc(e){e>Us&&(Us=e)}function fc(){for(;null!==Rs;)Rs=mc(Rs)}function vc(){for(;null!==Rs&&!ji();)Rs=mc(Rs)}function mc(e){var t=_s(e.alternate,e,Ns);return e.memoizedProps=e.pendingProps,null===t&&(t=gc(e)),Cs.current=null,t}function gc(e){Rs=e;do{var t=Rs.alternate;if(e=Rs.return,0==(2048&Rs.effectTag)){if(t=es(t,Rs,Ns),1===Ns||1!==Rs.childExpirationTime){for(var n=0,r=Rs.child;null!==r;){var i=r.expirationTime,o=r.childExpirationTime;i>n&&(n=i),o>n&&(n=o),r=r.sibling}Rs.childExpirationTime=n}if(null!==t)return t;null!==e&&0==(2048&e.effectTag)&&(null===e.firstEffect&&(e.firstEffect=Rs.firstEffect),null!==Rs.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=Rs.firstEffect),e.lastEffect=Rs.lastEffect),1<Rs.effectTag&&(null!==e.lastEffect?e.lastEffect.nextEffect=Rs:e.firstEffect=Rs,e.lastEffect=Rs))}else{if(null!==(t=ts(Rs)))return t.effectTag&=2047,t;null!==e&&(e.firstEffect=e.lastEffect=null,e.effectTag|=2048)}if(null!==(t=Rs.sibling))return t;Rs=e}while(null!==Rs);return Fs===Ms&&(Fs=5),null}function Sc(e){var t=e.expirationTime;return t>(e=e.childExpirationTime)?t:e}function bc(e){var t=zi();return Gi(99,Pc.bind(null,e,t)),null}function Pc(e,t){do{wc()}while(null!==Qs);if(0!=(48&ks))throw Error(a(327));var n=e.finishedWork,r=e.finishedExpirationTime;if(null===n)return null;if(e.finishedWork=null,e.finishedExpirationTime=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90,e.nextKnownPendingLevel=0;var i=Sc(n);if(e.firstPendingTime=i,r<=e.lastSuspendedTime?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:r<=e.firstSuspendedTime&&(e.firstSuspendedTime=r-1),r<=e.lastPingedTime&&(e.lastPingedTime=0),r<=e.lastExpiredTime&&(e.lastExpiredTime=0),e===Ds&&(Rs=Ds=null,Ns=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,i=n.firstEffect):i=n:i=n.firstEffect,null!==i){var o=ks;ks|=Is,Cs.current=null,Sn=qt;var s=fn();if(vn(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{var l=(c=(c=s.ownerDocument)&&c.defaultView||window).getSelection&&c.getSelection();if(l&&0!==l.rangeCount){c=l.anchorNode;var u=l.anchorOffset,d=l.focusNode;l=l.focusOffset;try{c.nodeType,d.nodeType}catch(e){c=null;break e}var p=0,h=-1,y=-1,f=0,v=0,m=s,g=null;t:for(;;){for(var S;m!==c||0!==u&&3!==m.nodeType||(h=p+u),m!==d||0!==l&&3!==m.nodeType||(y=p+l),3===m.nodeType&&(p+=m.nodeValue.length),null!==(S=m.firstChild);)g=m,m=S;for(;;){if(m===s)break t;if(g===c&&++f===u&&(h=p),g===d&&++v===l&&(y=p),null!==(S=m.nextSibling))break;g=(m=g).parentNode}m=S}c=-1===h||-1===y?null:{start:h,end:y}}else c=null}c=c||{start:0,end:0}}else c=null;bn={activeElementDetached:null,focusedElem:s,selectionRange:c},qt=!1,Ws=i;do{try{_c()}catch(e){if(null===Ws)throw Error(a(330));Oc(Ws,e),Ws=Ws.nextEffect}}while(null!==Ws);Ws=i;do{try{for(s=e,c=t;null!==Ws;){var b=Ws.effectTag;if(16&b&&Ve(Ws.stateNode,""),128&b){var P=Ws.alternate;if(null!==P){var _=P.ref;null!==_&&("function"==typeof _?_(null):_.current=null)}}switch(1038&b){case 2:hs(Ws),Ws.effectTag&=-3;break;case 6:hs(Ws),Ws.effectTag&=-3,ms(Ws.alternate,Ws);break;case 1024:Ws.effectTag&=-1025;break;case 1028:Ws.effectTag&=-1025,ms(Ws.alternate,Ws);break;case 4:ms(Ws.alternate,Ws);break;case 8:vs(s,u=Ws,c),ds(u)}Ws=Ws.nextEffect}}catch(e){if(null===Ws)throw Error(a(330));Oc(Ws,e),Ws=Ws.nextEffect}}while(null!==Ws);if(_=bn,P=fn(),b=_.focusedElem,c=_.selectionRange,P!==b&&b&&b.ownerDocument&&yn(b.ownerDocument.documentElement,b)){null!==c&&vn(b)&&(P=c.start,void 0===(_=c.end)&&(_=P),"selectionStart"in b?(b.selectionStart=P,b.selectionEnd=Math.min(_,b.value.length)):(_=(P=b.ownerDocument||document)&&P.defaultView||window).getSelection&&(_=_.getSelection(),u=b.textContent.length,s=Math.min(c.start,u),c=void 0===c.end?s:Math.min(c.end,u),!_.extend&&s>c&&(u=c,c=s,s=u),u=hn(b,s),d=hn(b,c),u&&d&&(1!==_.rangeCount||_.anchorNode!==u.node||_.anchorOffset!==u.offset||_.focusNode!==d.node||_.focusOffset!==d.offset)&&((P=P.createRange()).setStart(u.node,u.offset),_.removeAllRanges(),s>c?(_.addRange(P),_.extend(d.node,d.offset)):(P.setEnd(d.node,d.offset),_.addRange(P))))),P=[];for(_=b;_=_.parentNode;)1===_.nodeType&&P.push({element:_,left:_.scrollLeft,top:_.scrollTop});for("function"==typeof b.focus&&b.focus(),b=0;b<P.length;b++)(_=P[b]).element.scrollLeft=_.left,_.element.scrollTop=_.top}qt=!!Sn,bn=Sn=null,e.current=n,Ws=i;do{try{for(b=e;null!==Ws;){var w=Ws.effectTag;if(36&w&&ls(b,Ws.alternate,Ws),128&w){P=void 0;var E=Ws.ref;if(null!==E){var C=Ws.stateNode;Ws.tag,P=C,"function"==typeof E?E(P):E.current=P}}Ws=Ws.nextEffect}}catch(e){if(null===Ws)throw Error(a(330));Oc(Ws,e),Ws=Ws.nextEffect}}while(null!==Ws);Ws=null,Ki(),ks=o}else e.current=n;if(qs)qs=!1,Qs=e,Ys=t;else for(Ws=i;null!==Ws;)t=Ws.nextEffect,Ws.nextEffect=null,Ws=t;if(0===(t=e.firstPendingTime)&&(Gs=null),1073741823===t?e===Xs?Js++:(Js=0,Xs=e):Js=0,"function"==typeof Ac&&Ac(n.stateNode,r),oc(e),zs)throw zs=!1,e=Hs,Hs=null,e;return 0!=(8&ks)||Yi(),null}function _c(){for(;null!==Ws;){var e=Ws.effectTag;0!=(256&e)&&as(Ws.alternate,Ws),0==(512&e)||qs||(qs=!0,qi(97,(function(){return wc(),null}))),Ws=Ws.nextEffect}}function wc(){if(90!==Ys){var e=97<Ys?97:Ys;return Ys=90,Gi(e,Ec)}}function Ec(){if(null===Qs)return!1;var e=Qs;if(Qs=null,0!=(48&ks))throw Error(a(331));var t=ks;for(ks|=Is,e=e.current.firstEffect;null!==e;){try{var n=e;if(0!=(512&n.effectTag))switch(n.tag){case 0:case 11:case 15:case 22:ss(5,n),cs(5,n)}}catch(t){if(null===e)throw Error(a(330));Oc(e,t)}n=e.nextEffect,e.nextEffect=null,e=n}return ks=t,Yi(),!0}function Cc(e,t,n){ho(e,t=bs(e,t=ns(n,t),1073741823)),null!==(e=rc(e,1073741823))&&oc(e)}function Oc(e,t){if(3===e.tag)Cc(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Cc(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Gs||!Gs.has(r))){ho(n,e=Ps(n,e=ns(t,e),1073741823)),null!==(n=rc(n,1073741823))&&oc(n);break}}n=n.return}}function Ic(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),Ds===e&&Ns===n?Fs===Ts||Fs===As&&1073741823===js&&Wi()-Bs<500?uc(e,Ns):Vs=!0:Uc(e,n)&&(0!==(t=e.lastPingedTime)&&t<n||(e.lastPingedTime=n,oc(e)))}function Mc(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(t=tc(t=ec(),e,null)),null!==(e=rc(e,t))&&oc(e)}_s=function(e,t,n){var r=t.expirationTime;if(null!==e){var i=t.pendingProps;if(e.memoizedProps!==i||vi.current)Na=!0;else{if(r<n){switch(Na=!1,t.tag){case 3:Wa(t),Da();break;case 5:if(Ko(t),4&t.mode&&1!==n&&i.hidden)return t.expirationTime=t.childExpirationTime=1,null;break;case 1:Si(t.type)&&wi(t);break;case 4:xo(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value,i=t.type._context,hi(Zi,i._currentValue),i._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(r=t.child.childExpirationTime)&&r>=n?Qa(e,t,n):(hi(Uo,1&Uo.current),null!==(t=Xa(e,t,n))?t.sibling:null);hi(Uo,1&Uo.current);break;case 19:if(r=t.childExpirationTime>=n,0!=(64&e.effectTag)){if(r)return Ja(e,t,n);t.effectTag|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null),hi(Uo,Uo.current),!r)return null}return Xa(e,t,n)}Na=!1}}else Na=!1;switch(t.expirationTime=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,i=gi(t,fi.current),ao(t,n),i=Xo(null,t,r,e,i,n),t.effectTag|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,Si(r)){var o=!0;wi(t)}else o=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,lo(t);var s=r.getDerivedStateFromProps;"function"==typeof s&&So(t,r,s,e),i.updater=bo,t.stateNode=i,i._reactInternalFiber=t,Eo(t,r,e,n),t=Ba(null,t,r,!0,o,n)}else t.tag=0,Fa(null,t,i,n),t=t.child;return t;case 16:e:{if(i=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,function(e){if(-1===e._status){e._status=0;var t=e._ctor;t=t(),e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}}(i),1!==i._status)throw i._result;switch(i=i._result,t.type=i,o=t.tag=function(e){if("function"==typeof e)return Rc(e)?1:0;if(null!=e){if((e=e.$$typeof)===ce)return 11;if(e===de)return 14}return 2}(i),e=Xi(i,e),o){case 0:t=Ua(null,t,i,e,n);break e;case 1:t=Va(null,t,i,e,n);break e;case 11:t=xa(null,t,i,e,n);break e;case 14:t=ja(null,t,i,Xi(i.type,e),r,n);break e}throw Error(a(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ua(e,t,r,i=t.elementType===r?i:Xi(r,i),n);case 1:return r=t.type,i=t.pendingProps,Va(e,t,r,i=t.elementType===r?i:Xi(r,i),n);case 3:if(Wa(t),r=t.updateQueue,null===e||null===r)throw Error(a(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,uo(e,t),fo(t,r,null,n),(r=t.memoizedState.element)===i)Da(),t=Xa(e,t,n);else{if((i=t.stateNode.hydrate)&&(Ca=Cn(t.stateNode.containerInfo.firstChild),Ea=t,i=Oa=!0),i)for(n=To(t,null,r,n),t.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else Fa(e,t,r,n),Da();t=t.child}return t;case 5:return Ko(t),null===e&&Aa(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,s=i.children,_n(r,i)?s=null:null!==o&&_n(r,o)&&(t.effectTag|=16),La(e,t),4&t.mode&&1!==n&&i.hidden?(t.expirationTime=t.childExpirationTime=1,t=null):(Fa(e,t,s,n),t=t.child),t;case 6:return null===e&&Aa(t),null;case 13:return Qa(e,t,n);case 4:return xo(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ao(t,null,r,n):Fa(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,xa(e,t,r,i=t.elementType===r?i:Xi(r,i),n);case 7:return Fa(e,t,t.pendingProps,n),t.child;case 8:case 12:return Fa(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value;var c=t.type._context;if(hi(Zi,c._currentValue),c._currentValue=o,null!==s)if(c=s.value,0===(o=Vr(c,o)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(c,o):1073741823))){if(s.children===i.children&&!vi.current){t=Xa(e,t,n);break e}}else for(null!==(c=t.child)&&(c.return=t);null!==c;){var l=c.dependencies;if(null!==l){s=c.child;for(var u=l.firstContext;null!==u;){if(u.context===r&&0!=(u.observedBits&o)){1===c.tag&&((u=po(n,null)).tag=2,ho(c,u)),c.expirationTime<n&&(c.expirationTime=n),null!==(u=c.alternate)&&u.expirationTime<n&&(u.expirationTime=n),oo(c.return,n),l.expirationTime<n&&(l.expirationTime=n);break}u=u.next}}else s=10===c.tag&&c.type===t.type?null:c.child;if(null!==s)s.return=c;else for(s=c;null!==s;){if(s===t){s=null;break}if(null!==(c=s.sibling)){c.return=s.return,s=c;break}s=s.return}c=s}Fa(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(o=t.pendingProps).children,ao(t,n),r=r(i=so(i,o.unstable_observedBits)),t.effectTag|=1,Fa(e,t,r,n),t.child;case 14:return o=Xi(i=t.type,t.pendingProps),ja(e,t,i,o=Xi(i.type,o),r,n);case 15:return Ka(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Xi(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),t.tag=1,Si(r)?(e=!0,wi(t)):e=!1,ao(t,n),_o(t,r,i),Eo(t,r,i,n),Ba(null,t,r,!0,e,n);case 19:return Ja(e,t,n)}throw Error(a(156,t.tag))};var Ac=null,Tc=null;function kc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function Dc(e,t,n,r){return new kc(e,t,n,r)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Nc(e,t){var n=e.alternate;return null===n?((n=Dc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=e.childExpirationTime,n.expirationTime=e.expirationTime,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{expirationTime:t.expirationTime,firstContext:t.firstContext,responders:t.responders},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Fc(e,t,n,r,i,o){var s=2;if(r=e,"function"==typeof e)Rc(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case ne:return xc(n.children,i,o,t);case se:s=8,i|=7;break;case re:s=8,i|=1;break;case ie:return(e=Dc(12,n,t,8|i)).elementType=ie,e.type=ie,e.expirationTime=o,e;case le:return(e=Dc(13,n,t,i)).type=le,e.elementType=le,e.expirationTime=o,e;case ue:return(e=Dc(19,n,t,i)).elementType=ue,e.expirationTime=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case oe:s=10;break e;case ae:s=9;break e;case ce:s=11;break e;case de:s=14;break e;case pe:s=16,r=null;break e;case he:s=22;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Dc(s,n,t,i)).elementType=e,t.type=r,t.expirationTime=o,t}function xc(e,t,n,r){return(e=Dc(7,e,r,t)).expirationTime=n,e}function jc(e,t,n){return(e=Dc(6,e,null,t)).expirationTime=n,e}function Kc(e,t,n){return(t=Dc(4,null!==e.children?e.children:[],e.key,t)).expirationTime=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Lc(e,t,n){this.tag=t,this.current=null,this.containerInfo=e,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Uc(e,t){var n=e.firstSuspendedTime;return e=e.lastSuspendedTime,0!==n&&n>=t&&e<=t}function Vc(e,t){var n=e.firstSuspendedTime,r=e.lastSuspendedTime;n<t&&(e.firstSuspendedTime=t),(r>t||0===n)&&(e.lastSuspendedTime=t),t<=e.lastPingedTime&&(e.lastPingedTime=0),t<=e.lastExpiredTime&&(e.lastExpiredTime=0)}function Bc(e,t){t>e.firstPendingTime&&(e.firstPendingTime=t);var n=e.firstSuspendedTime;0!==n&&(t>=n?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:t>=e.lastSuspendedTime&&(e.lastSuspendedTime=t+1),t>e.nextKnownPendingLevel&&(e.nextKnownPendingLevel=t))}function Wc(e,t){var n=e.lastExpiredTime;(0===n||n>t)&&(e.lastExpiredTime=t)}function zc(e,t,n,r){var i=t.current,o=ec(),s=mo.suspense;o=tc(o,i,s);e:if(n){t:{if(et(n=n._reactInternalFiber)!==n||1!==n.tag)throw Error(a(170));var c=n;do{switch(c.tag){case 3:c=c.stateNode.context;break t;case 1:if(Si(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break t}}c=c.return}while(null!==c);throw Error(a(171))}if(1===n.tag){var l=n.type;if(Si(l)){n=_i(n,l,c);break e}}n=c}else n=yi;return null===t.context?t.context=n:t.pendingContext=n,(t=po(o,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),ho(i,t),nc(i,o),o}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){null!==(e=e.memoizedState)&&null!==e.dehydrated&&e.retryTime<t&&(e.retryTime=t)}function qc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}function Qc(e,t,n){var r=new Lc(e,t,n=null!=n&&!0===n.hydrate),i=Dc(3,null,null,2===t?7:1===t?3:0);r.current=i,i.stateNode=r,lo(i),e[Tn]=r.current,n&&0!==t&&function(e,t){var n=Ze(t);It.forEach((function(e){ft(e,t,n)})),Mt.forEach((function(e){ft(e,t,n)}))}(0,9===e.nodeType?e:e.ownerDocument),this._internalRoot=r}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $c(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o._internalRoot;if("function"==typeof i){var s=i;i=function(){var e=Hc(a);s.call(e)}}zc(t,a,e,i)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new Qc(e,0,t?{hydrate:!0}:void 0)}(n,r),a=o._internalRoot,"function"==typeof i){var c=i;i=function(){var e=Hc(a);c.call(e)}}lc((function(){zc(t,a,e,i)}))}return Hc(a)}function Jc(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:te,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Xc(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(a(200));return Jc(e,t,null,n)}Qc.prototype.render=function(e){zc(e,this._internalRoot,null,null)},Qc.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;zc(null,e,null,(function(){t[Tn]=null}))},vt=function(e){if(13===e.tag){var t=Ji(ec(),150,100);nc(e,t),qc(e,t)}},mt=function(e){13===e.tag&&(nc(e,3),qc(e,3))},gt=function(e){if(13===e.tag){var t=ec();nc(e,t=tc(t,e,null)),qc(e,t)}},M=function(e,t,n){switch(t){case"input":if(Ce(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Nn(r);if(!i)throw Error(a(90));Pe(r),Ce(r,i)}}}break;case"textarea":De(e,n);break;case"select":null!=(t=n.value)&&Ae(e,!!n.multiple,t,!1)}},N=cc,F=function(e,t,n,r,i){var o=ks;ks|=4;try{return Gi(98,e.bind(null,t,n,r,i))}finally{0===(ks=o)&&Yi()}},x=function(){0==(49&ks)&&(function(){if(null!==$s){var e=$s;$s=null,e.forEach((function(e,t){Wc(t,e),oc(t)})),Yi()}}(),wc())},j=function(e,t){var n=ks;ks|=2;try{return e(t)}finally{0===(ks=n)&&Yi()}};var Zc={Events:[Dn,Rn,Nn,O,w,Vn,function(e){ot(e,Un)},D,R,Xt,ct,wc,{current:!1}]};!function(e){var t=e.findFiberByHostInstance;(function(e){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var n=t.inject(e);Ac=function(e){try{t.onCommitFiberRoot(n,e,void 0,64==(64&e.current.effectTag))}catch(e){}},Tc=function(e){try{t.onCommitFiberUnmount(n,e)}catch(e){}}}catch(e){}})(i({},e,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=rt(e))?null:e.stateNode},findFiberByHostInstance:function(e){return t?t(e):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}({findFiberByHostInstance:kn,bundleType:0,version:"16.14.0",rendererPackageName:"react-dom"}),t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zc,t.createPortal=Xc,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternalFiber;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw Error(a(268,Object.keys(e)))}return e=null===(e=rt(t))?null:e.stateNode},t.flushSync=function(e,t){if(0!=(48&ks))throw Error(a(187));var n=ks;ks|=1;try{return Gi(99,e.bind(null,t))}finally{ks=n,Yi()}},t.hydrate=function(e,t,n){if(!Yc(t))throw Error(a(200));return $c(null,e,t,!0,n)},t.render=function(e,t,n){if(!Yc(t))throw Error(a(200));return $c(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(a(40));return!!e._reactRootContainer&&(lc((function(){$c(null,null,e,!1,(function(){e._reactRootContainer=null,e[Tn]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_createPortal=function(e,t){return Xc(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Yc(n))throw Error(a(200));if(null==e||void 0===e._reactInternalFiber)throw Error(a(38));return $c(e,t,n,!1,r)},t.version="16.14.0"},935:(e,t,n)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(448)},408:(e,t,n)=>{"use strict";var r=n(914),i="function"==typeof Symbol&&Symbol.for,o=i?Symbol.for("react.element"):60103,a=i?Symbol.for("react.portal"):60106,s=i?Symbol.for("react.fragment"):60107,c=i?Symbol.for("react.strict_mode"):60108,l=i?Symbol.for("react.profiler"):60114,u=i?Symbol.for("react.provider"):60109,d=i?Symbol.for("react.context"):60110,p=i?Symbol.for("react.forward_ref"):60112,h=i?Symbol.for("react.suspense"):60113,y=i?Symbol.for("react.memo"):60115,f=i?Symbol.for("react.lazy"):60116,v="function"==typeof Symbol&&Symbol.iterator;function m(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S={};function b(e,t,n){this.props=e,this.context=t,this.refs=S,this.updater=n||g}function P(){}function _(e,t,n){this.props=e,this.context=t,this.refs=S,this.updater=n||g}b.prototype.isReactComponent={},b.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(m(85));this.updater.enqueueSetState(this,e,t,"setState")},b.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},P.prototype=b.prototype;var w=_.prototype=new P;w.constructor=_,r(w,b.prototype),w.isPureReactComponent=!0;var E={current:null},C=Object.prototype.hasOwnProperty,O={key:!0,ref:!0,__self:!0,__source:!0};function I(e,t,n){var r,i={},a=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)C.call(t,r)&&!O.hasOwnProperty(r)&&(i[r]=t[r]);var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(r in c=e.defaultProps)void 0===i[r]&&(i[r]=c[r]);return{$$typeof:o,type:e,key:a,ref:s,props:i,_owner:E.current}}function M(e){return"object"==typeof e&&null!==e&&e.$$typeof===o}var A=/\/+/g,T=[];function k(e,t,n,r){if(T.length){var i=T.pop();return i.result=e,i.keyPrefix=t,i.func=n,i.context=r,i.count=0,i}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function D(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>T.length&&T.push(e)}function R(e,t,n,r){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var s=!1;if(null===e)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case o:case a:s=!0}}if(s)return n(r,e,""===t?"."+F(e,0):t),1;if(s=0,t=""===t?".":t+":",Array.isArray(e))for(var c=0;c<e.length;c++){var l=t+F(i=e[c],c);s+=R(i,l,n,r)}else if(null===e||"object"!=typeof e?l=null:l="function"==typeof(l=v&&e[v]||e["@@iterator"])?l:null,"function"==typeof l)for(e=l.call(e),c=0;!(i=e.next()).done;)s+=R(i=i.value,l=t+F(i,c++),n,r);else if("object"===i)throw n=""+e,Error(m(31,"[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n,""));return s}function N(e,t,n){return null==e?0:R(e,"",t,n)}function F(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function x(e,t){e.func.call(e.context,t,e.count++)}function j(e,t,n){var r=e.result,i=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?K(e,r,n,(function(e){return e})):null!=e&&(M(e)&&(e=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,i+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(A,"$&/")+"/")+n)),r.push(e))}function K(e,t,n,r,i){var o="";null!=n&&(o=(""+n).replace(A,"$&/")+"/"),N(e,j,t=k(t,o,r,i)),D(t)}var L={current:null};function U(){var e=L.current;if(null===e)throw Error(m(321));return e}var V={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:E,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:function(e,t,n){if(null==e)return e;var r=[];return K(e,r,null,t,n),r},forEach:function(e,t,n){if(null==e)return e;N(e,x,t=k(null,null,t,n)),D(t)},count:function(e){return N(e,(function(){return null}),null)},toArray:function(e){var t=[];return K(e,t,null,(function(e){return e})),t},only:function(e){if(!M(e))throw Error(m(143));return e}},t.Component=b,t.Fragment=s,t.Profiler=l,t.PureComponent=_,t.StrictMode=c,t.Suspense=h,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V,t.cloneElement=function(e,t,n){if(null==e)throw Error(m(267,e));var i=r({},e.props),a=e.key,s=e.ref,c=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,c=E.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)C.call(t,u)&&!O.hasOwnProperty(u)&&(i[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];i.children=l}return{$$typeof:o,type:e.type,key:a,ref:s,props:i,_owner:c}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:d,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:u,_context:e},e.Consumer=e},t.createElement=I,t.createFactory=function(e){var t=I.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:p,render:e}},t.isValidElement=M,t.lazy=function(e){return{$$typeof:f,_ctor:e,_status:-1,_result:null}},t.memo=function(e,t){return{$$typeof:y,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return U().useCallback(e,t)},t.useContext=function(e,t){return U().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return U().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return U().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return U().useLayoutEffect(e,t)},t.useMemo=function(e,t){return U().useMemo(e,t)},t.useReducer=function(e,t,n){return U().useReducer(e,t,n)},t.useRef=function(e){return U().useRef(e)},t.useState=function(e){return U().useState(e)},t.version="16.14.0"},294:(e,t,n)=>{"use strict";e.exports=n(408)},53:(e,t)=>{"use strict";var n,r,i,o,a;if("undefined"==typeof window||"function"!=typeof MessageChannel){var s=null,c=null,l=function(){if(null!==s)try{var e=t.unstable_now();s(!0,e),s=null}catch(e){throw setTimeout(l,0),e}},u=Date.now();t.unstable_now=function(){return Date.now()-u},n=function(e){null!==s?setTimeout(n,0,e):(s=e,setTimeout(l,0))},r=function(e,t){c=setTimeout(e,t)},i=function(){clearTimeout(c)},o=function(){return!1},a=t.unstable_forceFrameRate=function(){}}else{var d=window.performance,p=window.Date,h=window.setTimeout,y=window.clearTimeout;if("undefined"!=typeof console){var f=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof f&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"==typeof d&&"function"==typeof d.now)t.unstable_now=function(){return d.now()};else{var v=p.now();t.unstable_now=function(){return p.now()-v}}var m=!1,g=null,S=-1,b=5,P=0;o=function(){return t.unstable_now()>=P},a=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):b=0<e?Math.floor(1e3/e):5};var _=new MessageChannel,w=_.port2;_.port1.onmessage=function(){if(null!==g){var e=t.unstable_now();P=e+b;try{g(!0,e)?w.postMessage(null):(m=!1,g=null)}catch(e){throw w.postMessage(null),e}}else m=!1},n=function(e){g=e,m||(m=!0,w.postMessage(null))},r=function(e,n){S=h((function(){e(t.unstable_now())}),n)},i=function(){y(S),S=-1}}function E(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<I(i,t)))break e;e[r]=t,e[n]=i,n=r}}function C(e){return void 0===(e=e[0])?null:e}function O(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var o=2*(r+1)-1,a=e[o],s=o+1,c=e[s];if(void 0!==a&&0>I(a,n))void 0!==c&&0>I(c,a)?(e[r]=c,e[s]=n,r=s):(e[r]=a,e[o]=n,r=o);else{if(!(void 0!==c&&0>I(c,n)))break e;e[r]=c,e[s]=n,r=s}}}return t}return null}function I(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var M=[],A=[],T=1,k=null,D=3,R=!1,N=!1,F=!1;function x(e){for(var t=C(A);null!==t;){if(null===t.callback)O(A);else{if(!(t.startTime<=e))break;O(A),t.sortIndex=t.expirationTime,E(M,t)}t=C(A)}}function j(e){if(F=!1,x(e),!N)if(null!==C(M))N=!0,n(K);else{var t=C(A);null!==t&&r(j,t.startTime-e)}}function K(e,n){N=!1,F&&(F=!1,i()),R=!0;var a=D;try{for(x(n),k=C(M);null!==k&&(!(k.expirationTime>n)||e&&!o());){var s=k.callback;if(null!==s){k.callback=null,D=k.priorityLevel;var c=s(k.expirationTime<=n);n=t.unstable_now(),"function"==typeof c?k.callback=c:k===C(M)&&O(M),x(n)}else O(M);k=C(M)}if(null!==k)var l=!0;else{var u=C(A);null!==u&&r(j,u.startTime-n),l=!1}return l}finally{k=null,D=a,R=!1}}function L(e){switch(e){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var U=a;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){N||R||(N=!0,n(K))},t.unstable_getCurrentPriorityLevel=function(){return D},t.unstable_getFirstCallbackNode=function(){return C(M)},t.unstable_next=function(e){switch(D){case 1:case 2:case 3:var t=3;break;default:t=D}var n=D;D=t;try{return e()}finally{D=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=U,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=D;D=e;try{return t()}finally{D=n}},t.unstable_scheduleCallback=function(e,o,a){var s=t.unstable_now();if("object"==typeof a&&null!==a){var c=a.delay;c="number"==typeof c&&0<c?s+c:s,a="number"==typeof a.timeout?a.timeout:L(e)}else a=L(e),c=s;return e={id:T++,callback:o,priorityLevel:e,startTime:c,expirationTime:a=c+a,sortIndex:-1},c>s?(e.sortIndex=c,E(A,e),null===C(M)&&e===C(A)&&(F?i():F=!0,r(j,c-s))):(e.sortIndex=a,E(M,e),N||R||(N=!0,n(K))),e},t.unstable_shouldYield=function(){var e=t.unstable_now();x(e);var n=C(M);return n!==k&&null!==k&&null!==n&&null!==n.callback&&n.startTime<=e&&n.expirationTime<k.expirationTime||o()},t.unstable_wrapCallback=function(e){var t=D;return function(){var n=D;D=t;try{return e.apply(this,arguments)}finally{D=n}}}},840:(e,t,n)=>{"use strict";e.exports=n(53)},403:e=>{var t;self,t=()=>(()=>{var e={109:e=>{var t;self,t=()=>(()=>{"use strict";var e={31624:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ContentDecoder=void 0,t.ContentDecoder=class{decode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;try{const n=t>0?e.substring(t):e,r=Buffer.from(n,"base64").toString();return JSON.parse(r)}catch(e){return{}}}encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;const n=JSON.stringify(e),r=Buffer.from(n).toString("base64");return r.padStart(r.length+t,"0")}}},9457:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},19883:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DisplayStringForContentType=t.ContentType=void 0,function(e){e.Any="*",e.Item="SF|Item",e.RootKey="SN|RootKey|NoSync",e.ItemsKey="SN|ItemsKey",e.EncryptedStorage="SN|EncryptedStorage",e.Privileges="SN|Privileges",e.Note="Note",e.Tag="Tag",e.SmartView="SN|SmartTag",e.Component="SN|Component",e.Editor="SN|Editor",e.ActionsExtension="Extension",e.UserPrefs="SN|UserPreferences",e.HistorySession="SN|HistorySession",e.Theme="SN|Theme",e.File="SN|File",e.FilesafeCredentials="SN|FileSafe|Credentials",e.FilesafeFileMetadata="SN|FileSafe|FileMetadata",e.FilesafeIntegration="SN|FileSafe|Integration",e.ExtensionRepo="SN|ExtensionRepo",e.Unknown="Unknown"}(n=t.ContentType||(t.ContentType={})),t.DisplayStringForContentType=function(e){return{[n.ActionsExtension]:"action-based extension",[n.Component]:"component",[n.Editor]:"editor",[n.File]:"file",[n.FilesafeCredentials]:"FileSafe credential",[n.FilesafeFileMetadata]:"FileSafe file",[n.FilesafeIntegration]:"FileSafe integration",[n.ItemsKey]:"encryption key",[n.Note]:"note",[n.SmartView]:"smart view",[n.Tag]:"tag",[n.Theme]:"theme",[n.UserPrefs]:"user preferences"}[e]}},56380:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},95892:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},63465:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},60187:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},37693:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},46923:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.EmailMessageIdentifier=void 0,(n=t.EmailMessageIdentifier||(t.EmailMessageIdentifier={})).WELCOME_EMAIL="WELCOME_EMAIL",n.ACCOUNT_CLAIM="ACCOUNT_CLAIM",n.ACCOUNT_RESET="ACCOUNT_RESET",n.ACTIVATION_CODE="ACTIVATION_CODE",n.VERSION_ADOPTION_REPORT="VERSION_ADOPTION_REPORT",n.FAILED_DROPBOX_BACKUP="FAILED_DROPBOX_BACKUP",n.FAILED_GOOGLE_DRIVE_BACKUP="FAILED_GOOGLE_DRIVE_BACKUP",n.FAILED_ONE_DRIVE_BACKUP="FAILED_ONE_DRIVE_BACKUP",n.DATA_BACKUP="DATA_BACKUP",n.FAILED_BACKUP_ATTACHMENT_TOO_BIG="FAILED_BACKUP_ATTACHMENT_TOO_BIG",n.OFFLINE_SUBSCRIPTION_ACCESS="OFFLINE_SUBSCRIPTION_ACCESS",n.SIGN_IN="SIGN_IN",n.SHARED_SUBSCRIPTION_INVITATION="SHARED_SUBSCRIPTION_INVITATION",n.ENCOURAGE_EMAIL_BACKUPS="ENCOURAGE_EMAIL_BACKUPS",n.ENCOURAGE_SUBSCRIPTION_PURCHASING="ENCOURAGE_SUBSCRIPTION_PURCHASING",n.EXIT_INTERVIEW="EXIT_INTERVIEW",n.STUDENT_DISCOUNT_REQUESTED="STUDENT_DISCOUNT_REQUESTED",n.STUDENT_DISCOUNT_APPROVED="STUDENT_DISCOUNT_APPROVED",n.MARKETING_CAMPAIGN_FILES="MARKETING_CAMPAIGN_FILES",n.PAYMENT_FAILED="PAYMENT_FAILED",n.SEND_INVOICE="SEND_INVOICE",n.DISCOUNT_NOTICE="DISCOUNT_NOTICE",n.REFUND_NOTICE="REFUND_NOTICE",n.REFUND_REQUESTED="REFUND_REQUESTED",n.RATE_ADJUSTMENT_NOTICE="RATE_ADJUSTMENT_NOTICE",n.WORKSPACE_INVITE_CREATED="WORKSPACE_INVITE_CREATED",n.EXIT_DISCOUNT="EXIT_DISCOUNT"},58162:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorTag=void 0,(n=t.ErrorTag||(t.ErrorTag={})).MfaInvalid="mfa-invalid",n.MfaRequired="mfa-required",n.RefreshTokenInvalid="invalid-refresh-token",n.RefreshTokenExpired="expired-refresh-token",n.AccessTokenExpired="expired-access-token",n.ParametersInvalid="invalid-parameters",n.RevokedSession="revoked-session",n.AuthInvalid="invalid-auth",n.ReadOnlyAccess="read-only-access"},96148:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},44506:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},71411:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},81859:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},44021:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},15959:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},46278:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.KeyParamsOrigination=void 0,(n=t.KeyParamsOrigination||(t.KeyParamsOrigination={})).Registration="registration",n.EmailChange="email-change",n.PasswordChange="password-change",n.ProtocolUpgrade="protocol-upgrade",n.PasscodeCreate="passcode-create",n.PasscodeChange="passcode-change"},57658:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentType=void 0,(n=t.PaymentType||(t.PaymentType={})).Initial="initial",n.Renewal="renewal"},23562:(e,t)=>{var n;function r(e,t){return Number(e)-Number(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.isVersionLessThanOrEqualTo=t.leftVersionGreaterThanOrEqualToRight=t.compareVersions=t.protocolVersionFromEncryptedString=t.ProtocolVersionLength=t.isProtocolVersionExpired=t.ProtocolExpirationDates=t.ProtocolVersionLastNonrootItemsKey=t.ProtocolVersionLatest=t.ProtocolVersion=void 0,function(e){e.V001="001",e.V002="002",e.V003="003",e.V004="004",e.V005="005"}(n=t.ProtocolVersion||(t.ProtocolVersion={})),t.ProtocolVersionLatest=n.V004,t.ProtocolVersionLastNonrootItemsKey=n.V003,t.ProtocolExpirationDates=Object.freeze({[n.V001]:Date.parse("2018-01-01"),[n.V002]:Date.parse("2020-01-01")}),t.isProtocolVersionExpired=function(e){const n=t.ProtocolExpirationDates[e];return!!n&&(new Date).getTime()>n},t.ProtocolVersionLength=3,t.protocolVersionFromEncryptedString=function(e){const r=e.substring(0,t.ProtocolVersionLength);if(Object.values(n).includes(r))return r;throw Error("Unrecognized protocol version ".concat(r))},t.compareVersions=r,t.leftVersionGreaterThanOrEqualToRight=function(e,t){return r(e,t)>=0},t.isVersionLessThanOrEqualTo=function(e,t){return r(e,t)<=0}},89384:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PaidRoles=void 0;const r=n(16374);t.PaidRoles=[r.RoleName.CoreUser,r.RoleName.PlusUser,r.RoleName.ProUser]},16374:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.RoleName=void 0,(n=t.RoleName||(t.RoleName={})).CoreUser="CORE_USER",n.PlusUser="PLUS_USER",n.ProUser="PRO_USER",n.FilesBetaUser="FILES_BETA_USER"},4160:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptionBillingFrequency=void 0,(n=t.SubscriptionBillingFrequency||(t.SubscriptionBillingFrequency={}))[n.Monthly=1]="Monthly",n[n.Annual=12]="Annual"},38449:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptionName=void 0,(n=t.SubscriptionName||(t.SubscriptionName={})).PlusPlan="PLUS_PLAN",n.ProPlan="PRO_PLAN"},20494:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},76972:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},47781:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UserRequestType=void 0,(t.UserRequestType||(t.UserRequestType={})).ExitDiscount="exit-discount"},1649:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UuidValidator=void 0,t.UuidValidator=class{constructor(){var e,t;t=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-5][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}$/i,(e="UUID_REGEX")in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this[e]=t}validate(e){return null!==String(e).toLowerCase().match(this.UUID_REGEX)}}},18851:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},93726:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceAccessLevel=void 0,(n=t.WorkspaceAccessLevel||(t.WorkspaceAccessLevel={})).Owner="owner",n.Admin="admin",n.ReadOnly="read-only",n.WriteAndRead="write-and-read"},6976:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceType=void 0,(n=t.WorkspaceType||(t.WorkspaceType={})).Root="root",n.Team="team",n.Private="private"},8404:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceUserStatus=void 0,(n=t.WorkspaceUserStatus||(t.WorkspaceUserStatus={})).Active="active",n.PendingKeyshare="pending-keyshare"},31679:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(19883),t),i(n(31624),t),i(n(9457),t),i(n(56380),t),i(n(63465),t),i(n(60187),t),i(n(37693),t),i(n(95892),t),i(n(46923),t),i(n(58162),t),i(n(96148),t),i(n(44506),t),i(n(71411),t),i(n(81859),t),i(n(44021),t),i(n(15959),t),i(n(46278),t),i(n(57658),t),i(n(23562),t),i(n(89384),t),i(n(16374),t),i(n(4160),t),i(n(38449),t),i(n(20494),t),i(n(76972),t),i(n(47781),t),i(n(1649),t),i(n(18851),t),i(n(93726),t),i(n(6976),t),i(n(8404),t)},10256:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(31679),t)},29606:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CloudProvider=void 0,(n=t.CloudProvider||(t.CloudProvider={})).Dropbox="Dropbox",n.Google="Google Drive",n.OneDrive="OneDrive"},23234:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DropboxBackupFrequency=void 0,(n=t.DropboxBackupFrequency||(t.DropboxBackupFrequency={})).Disabled="disabled",n.Daily="daily",n.Weekly="weekly"},60468:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.EmailBackupFrequency=void 0,(n=t.EmailBackupFrequency||(t.EmailBackupFrequency={})).Disabled="disabled",n.Daily="daily",n.Weekly="weekly"},53757:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleDriveBackupFrequency=void 0,(n=t.GoogleDriveBackupFrequency||(t.GoogleDriveBackupFrequency={})).Disabled="disabled",n.Daily="daily",n.Weekly="weekly"},51032:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},93063:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LogSessionUserAgentOption=void 0,(n=t.LogSessionUserAgentOption||(t.LogSessionUserAgentOption={})).Disabled="disabled",n.Enabled="enabled"},50722:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MuteFailedBackupsEmailsOption=void 0,(n=t.MuteFailedBackupsEmailsOption||(t.MuteFailedBackupsEmailsOption={})).Muted="muted",n.NotMuted="not_muted"},92360:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MuteFailedCloudBackupsEmailsOption=void 0,(n=t.MuteFailedCloudBackupsEmailsOption||(t.MuteFailedCloudBackupsEmailsOption={})).Muted="muted",n.NotMuted="not_muted"},35325:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MuteMarketingEmailsOption=void 0,(n=t.MuteMarketingEmailsOption||(t.MuteMarketingEmailsOption={})).Muted="muted",n.NotMuted="not_muted"},84395:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MuteSignInEmailsOption=void 0,(n=t.MuteSignInEmailsOption||(t.MuteSignInEmailsOption={})).Muted="muted",n.NotMuted="not_muted"},14822:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.OneDriveBackupFrequency=void 0,(n=t.OneDriveBackupFrequency||(t.OneDriveBackupFrequency={})).Disabled="disabled",n.Daily="daily",n.Weekly="weekly"},54342:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},78245:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SettingName=void 0,(n=t.SettingName||(t.SettingName={})).MfaSecret="MFA_SECRET",n.ExtensionKey="EXTENSION_KEY",n.EmailBackupFrequency="EMAIL_BACKUP_FREQUENCY",n.DropboxBackupFrequency="DROPBOX_BACKUP_FREQUENCY",n.DropboxBackupToken="DROPBOX_BACKUP_TOKEN",n.OneDriveBackupFrequency="ONE_DRIVE_BACKUP_FREQUENCY",n.OneDriveBackupToken="ONE_DRIVE_BACKUP_TOKEN",n.GoogleDriveBackupFrequency="GOOGLE_DRIVE_BACKUP_FREQUENCY",n.GoogleDriveBackupToken="GOOGLE_DRIVE_BACKUP_TOKEN",n.MuteFailedBackupsEmails="MUTE_FAILED_BACKUPS_EMAILS",n.MuteFailedCloudBackupsEmails="MUTE_FAILED_CLOUD_BACKUPS_EMAILS",n.MuteSignInEmails="MUTE_SIGN_IN_EMAILS",n.MuteMarketingEmails="MUTE_MARKETING_EMAILS",n.ListedAuthorSecrets="LISTED_AUTHOR_SECRETS",n.LogSessionUserAgent="LOG_SESSION_USER_AGENT"},16355:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptionSettingName=void 0,(n=t.SubscriptionSettingName||(t.SubscriptionSettingName={})).FileUploadBytesLimit="FILE_UPLOAD_BYTES_LIMIT",n.FileUploadBytesUsed="FILE_UPLOAD_BYTES_USED"},91557:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(29606),t),i(n(23234),t),i(n(60468),t),i(n(53757),t),i(n(51032),t),i(n(93063),t),i(n(50722),t),i(n(92360),t),i(n(35325),t),i(n(84395),t),i(n(14822),t),i(n(54342),t),i(n(78245),t),i(n(16355),t)},9382:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(91557),t)},66181:function(e){e.exports=function(){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,n){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,n)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function r(e,i,o){return r=n()?Reflect.construct:function(e,n,r){var i=[null];i.push.apply(i,n);var o=new(Function.bind.apply(e,i));return r&&t(o,r.prototype),o},r.apply(null,arguments)}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=Object.hasOwnProperty,s=Object.setPrototypeOf,c=Object.isFrozen,l=Object.getPrototypeOf,u=Object.getOwnPropertyDescriptor,d=Object.freeze,p=Object.seal,h=Object.create,y="undefined"!=typeof Reflect&&Reflect,f=y.apply,v=y.construct;f||(f=function(e,t,n){return e.apply(t,n)}),d||(d=function(e){return e}),p||(p=function(e){return e}),v||(v=function(e,t){return r(e,i(t))});var m,g=M(Array.prototype.forEach),S=M(Array.prototype.pop),b=M(Array.prototype.push),P=M(String.prototype.toLowerCase),_=M(String.prototype.match),w=M(String.prototype.replace),E=M(String.prototype.indexOf),C=M(String.prototype.trim),O=M(RegExp.prototype.test),I=(m=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return v(m,t)});function M(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return f(e,t,r)}}function A(e,t,n){n=n||P,s&&s(e,null);for(var r=t.length;r--;){var i=t[r];if("string"==typeof i){var o=n(i);o!==i&&(c(t)||(t[r]=o),i=o)}e[i]=!0}return e}function T(e){var t,n=h(null);for(t in e)f(a,e,[t])&&(n[t]=e[t]);return n}function k(e,t){for(;null!==e;){var n=u(e,t);if(n){if(n.get)return M(n.get);if("function"==typeof n.value)return M(n.value)}e=l(e)}return function(e){return console.warn("fallback value for",e),null}}var D=d(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),R=d(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),N=d(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),F=d(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),x=d(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),j=d(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),K=d(["#text"]),L=d(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),U=d(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),V=d(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),B=d(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),W=p(/\{\{[\w\W]*|[\w\W]*\}\}/gm),z=p(/<%[\w\W]*|[\w\W]*%>/gm),H=p(/^data-[\-\w.\u00B7-\uFFFF]/),G=p(/^aria-[\-\w]+$/),q=p(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Q=p(/^(?:\w+script|data):/i),Y=p(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),$=p(/^html$/i),J=function(){return"undefined"==typeof window?null:window},X=function(t,n){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return t.createPolicy(o,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};return function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J(),r=function(e){return t(e)};if(r.version="2.4.0",r.removed=[],!n||!n.document||9!==n.document.nodeType)return r.isSupported=!1,r;var o=n.document,a=n.document,s=n.DocumentFragment,c=n.HTMLTemplateElement,l=n.Node,u=n.Element,p=n.NodeFilter,h=n.NamedNodeMap,y=void 0===h?n.NamedNodeMap||n.MozNamedAttrMap:h,f=n.HTMLFormElement,v=n.DOMParser,m=n.trustedTypes,M=u.prototype,Z=k(M,"cloneNode"),ee=k(M,"nextSibling"),te=k(M,"childNodes"),ne=k(M,"parentNode");if("function"==typeof c){var re=a.createElement("template");re.content&&re.content.ownerDocument&&(a=re.content.ownerDocument)}var ie=X(m,o),oe=ie?ie.createHTML(""):"",ae=a,se=ae.implementation,ce=ae.createNodeIterator,le=ae.createDocumentFragment,ue=ae.getElementsByTagName,de=o.importNode,pe={};try{pe=T(a).documentMode?a.documentMode:{}}catch(e){}var he={};r.isSupported="function"==typeof ne&&se&&void 0!==se.createHTMLDocument&&9!==pe;var ye,fe,ve=W,me=z,ge=H,Se=G,be=Q,Pe=Y,_e=q,we=null,Ee=A({},[].concat(i(D),i(R),i(N),i(x),i(K))),Ce=null,Oe=A({},[].concat(i(L),i(U),i(V),i(B))),Ie=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Me=null,Ae=null,Te=!0,ke=!0,De=!1,Re=!1,Ne=!1,Fe=!1,xe=!1,je=!1,Ke=!1,Le=!1,Ue=!0,Ve=!1,Be="user-content-",We=!0,ze=!1,He={},Ge=null,qe=A({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Qe=null,Ye=A({},["audio","video","img","source","image","track"]),$e=null,Je=A({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Xe="http://www.w3.org/1998/Math/MathML",Ze="http://www.w3.org/2000/svg",et="http://www.w3.org/1999/xhtml",tt=et,nt=!1,rt=["application/xhtml+xml","text/html"],it="text/html",ot=null,at=a.createElement("form"),st=function(e){return e instanceof RegExp||e instanceof Function},ct=function(t){ot&&ot===t||(t&&"object"===e(t)||(t={}),t=T(t),ye=ye=-1===rt.indexOf(t.PARSER_MEDIA_TYPE)?it:t.PARSER_MEDIA_TYPE,fe="application/xhtml+xml"===ye?function(e){return e}:P,we="ALLOWED_TAGS"in t?A({},t.ALLOWED_TAGS,fe):Ee,Ce="ALLOWED_ATTR"in t?A({},t.ALLOWED_ATTR,fe):Oe,$e="ADD_URI_SAFE_ATTR"in t?A(T(Je),t.ADD_URI_SAFE_ATTR,fe):Je,Qe="ADD_DATA_URI_TAGS"in t?A(T(Ye),t.ADD_DATA_URI_TAGS,fe):Ye,Ge="FORBID_CONTENTS"in t?A({},t.FORBID_CONTENTS,fe):qe,Me="FORBID_TAGS"in t?A({},t.FORBID_TAGS,fe):{},Ae="FORBID_ATTR"in t?A({},t.FORBID_ATTR,fe):{},He="USE_PROFILES"in t&&t.USE_PROFILES,Te=!1!==t.ALLOW_ARIA_ATTR,ke=!1!==t.ALLOW_DATA_ATTR,De=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Re=t.SAFE_FOR_TEMPLATES||!1,Ne=t.WHOLE_DOCUMENT||!1,je=t.RETURN_DOM||!1,Ke=t.RETURN_DOM_FRAGMENT||!1,Le=t.RETURN_TRUSTED_TYPE||!1,xe=t.FORCE_BODY||!1,Ue=!1!==t.SANITIZE_DOM,Ve=t.SANITIZE_NAMED_PROPS||!1,We=!1!==t.KEEP_CONTENT,ze=t.IN_PLACE||!1,_e=t.ALLOWED_URI_REGEXP||_e,tt=t.NAMESPACE||et,t.CUSTOM_ELEMENT_HANDLING&&st(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ie.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&st(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ie.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Ie.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Re&&(ke=!1),Ke&&(je=!0),He&&(we=A({},i(K)),Ce=[],!0===He.html&&(A(we,D),A(Ce,L)),!0===He.svg&&(A(we,R),A(Ce,U),A(Ce,B)),!0===He.svgFilters&&(A(we,N),A(Ce,U),A(Ce,B)),!0===He.mathMl&&(A(we,x),A(Ce,V),A(Ce,B))),t.ADD_TAGS&&(we===Ee&&(we=T(we)),A(we,t.ADD_TAGS,fe)),t.ADD_ATTR&&(Ce===Oe&&(Ce=T(Ce)),A(Ce,t.ADD_ATTR,fe)),t.ADD_URI_SAFE_ATTR&&A($e,t.ADD_URI_SAFE_ATTR,fe),t.FORBID_CONTENTS&&(Ge===qe&&(Ge=T(Ge)),A(Ge,t.FORBID_CONTENTS,fe)),We&&(we["#text"]=!0),Ne&&A(we,["html","head","body"]),we.table&&(A(we,["tbody"]),delete Me.tbody),d&&d(t),ot=t)},lt=A({},["mi","mo","mn","ms","mtext"]),ut=A({},["foreignobject","desc","title","annotation-xml"]),dt=A({},["title","style","font","a","script"]),pt=A({},R);A(pt,N),A(pt,F);var ht=A({},x);A(ht,j);var yt=function(e){var t=ne(e);t&&t.tagName||(t={namespaceURI:et,tagName:"template"});var n=P(e.tagName),r=P(t.tagName);return e.namespaceURI===Ze?t.namespaceURI===et?"svg"===n:t.namespaceURI===Xe?"svg"===n&&("annotation-xml"===r||lt[r]):Boolean(pt[n]):e.namespaceURI===Xe?t.namespaceURI===et?"math"===n:t.namespaceURI===Ze?"math"===n&&ut[r]:Boolean(ht[n]):e.namespaceURI===et&&!(t.namespaceURI===Ze&&!ut[r])&&!(t.namespaceURI===Xe&&!lt[r])&&!ht[n]&&(dt[n]||!pt[n])},ft=function(e){b(r.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=oe}catch(t){e.remove()}}},vt=function(e,t){try{b(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){b(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Ce[e])if(je||Ke)try{ft(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},mt=function(e){var t,n;if(xe)e="<remove></remove>"+e;else{var r=_(e,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===ye&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var i=ie?ie.createHTML(e):e;if(tt===et)try{t=(new v).parseFromString(i,ye)}catch(e){}if(!t||!t.documentElement){t=se.createDocument(tt,"template",null);try{t.documentElement.innerHTML=nt?"":i}catch(e){}}var o=t.body||t.documentElement;return e&&n&&o.insertBefore(a.createTextNode(n),o.childNodes[0]||null),tt===et?ue.call(t,Ne?"html":"body")[0]:Ne?t.documentElement:o},gt=function(e){return ce.call(e.ownerDocument||e,e,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT,null,!1)},St=function(e){return e instanceof f&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof y)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)},bt=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},Pt=function(e,t,n){he[e]&&g(he[e],(function(e){e.call(r,t,n,ot)}))},_t=function(e){var t;if(Pt("beforeSanitizeElements",e,null),St(e))return ft(e),!0;if(O(/[\u0080-\uFFFF]/,e.nodeName))return ft(e),!0;var n=fe(e.nodeName);if(Pt("uponSanitizeElement",e,{tagName:n,allowedTags:we}),e.hasChildNodes()&&!bt(e.firstElementChild)&&(!bt(e.content)||!bt(e.content.firstElementChild))&&O(/<[/\w]/g,e.innerHTML)&&O(/<[/\w]/g,e.textContent))return ft(e),!0;if("select"===n&&O(/<template/i,e.innerHTML))return ft(e),!0;if(!we[n]||Me[n]){if(!Me[n]&&Et(n)){if(Ie.tagNameCheck instanceof RegExp&&O(Ie.tagNameCheck,n))return!1;if(Ie.tagNameCheck instanceof Function&&Ie.tagNameCheck(n))return!1}if(We&&!Ge[n]){var i=ne(e)||e.parentNode,o=te(e)||e.childNodes;if(o&&i)for(var a=o.length-1;a>=0;--a)i.insertBefore(Z(o[a],!0),ee(e))}return ft(e),!0}return e instanceof u&&!yt(e)?(ft(e),!0):"noscript"!==n&&"noembed"!==n||!O(/<\/no(script|embed)/i,e.innerHTML)?(Re&&3===e.nodeType&&(t=e.textContent,t=w(t,ve," "),t=w(t,me," "),e.textContent!==t&&(b(r.removed,{element:e.cloneNode()}),e.textContent=t)),Pt("afterSanitizeElements",e,null),!1):(ft(e),!0)},wt=function(e,t,n){if(Ue&&("id"===t||"name"===t)&&(n in a||n in at))return!1;if(ke&&!Ae[t]&&O(ge,t));else if(Te&&O(Se,t));else if(!Ce[t]||Ae[t]){if(!(Et(e)&&(Ie.tagNameCheck instanceof RegExp&&O(Ie.tagNameCheck,e)||Ie.tagNameCheck instanceof Function&&Ie.tagNameCheck(e))&&(Ie.attributeNameCheck instanceof RegExp&&O(Ie.attributeNameCheck,t)||Ie.attributeNameCheck instanceof Function&&Ie.attributeNameCheck(t))||"is"===t&&Ie.allowCustomizedBuiltInElements&&(Ie.tagNameCheck instanceof RegExp&&O(Ie.tagNameCheck,n)||Ie.tagNameCheck instanceof Function&&Ie.tagNameCheck(n))))return!1}else if($e[t]);else if(O(_e,w(n,Pe,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==E(n,"data:")||!Qe[e])if(De&&!O(be,w(n,Pe,"")));else if(n)return!1;return!0},Et=function(e){return e.indexOf("-")>0},Ct=function(t){var n,i,o,a;Pt("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var c={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ce};for(a=s.length;a--;){var l=n=s[a],u=l.name,d=l.namespaceURI;if(i="value"===u?n.value:C(n.value),o=fe(u),c.attrName=o,c.attrValue=i,c.keepAttr=!0,c.forceKeepAttr=void 0,Pt("uponSanitizeAttribute",t,c),i=c.attrValue,!c.forceKeepAttr&&(vt(u,t),c.keepAttr))if(O(/\/>/i,i))vt(u,t);else{Re&&(i=w(i,ve," "),i=w(i,me," "));var p=fe(t.nodeName);if(wt(p,o,i)){if(!Ve||"id"!==o&&"name"!==o||(vt(u,t),i=Be+i),ie&&"object"===e(m)&&"function"==typeof m.getAttributeType)if(d);else switch(m.getAttributeType(p,o)){case"TrustedHTML":i=ie.createHTML(i);break;case"TrustedScriptURL":i=ie.createScriptURL(i)}try{d?t.setAttributeNS(d,u,i):t.setAttribute(u,i),S(r.removed)}catch(e){}}}}Pt("afterSanitizeAttributes",t,null)}},Ot=function e(t){var n,r=gt(t);for(Pt("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)Pt("uponSanitizeShadowNode",n,null),_t(n)||(n.content instanceof s&&e(n.content),Ct(n));Pt("afterSanitizeShadowDOM",t,null)};return r.sanitize=function(t){var i,a,c,u,d,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((nt=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!bt(t)){if("function"!=typeof t.toString)throw I("toString is not a function");if("string"!=typeof(t=t.toString()))throw I("dirty is not a string, aborting")}if(!r.isSupported){if("object"===e(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof t)return n.toStaticHTML(t);if(bt(t))return n.toStaticHTML(t.outerHTML)}return t}if(Fe||ct(p),r.removed=[],"string"==typeof t&&(ze=!1),ze){if(t.nodeName){var h=fe(t.nodeName);if(!we[h]||Me[h])throw I("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof l)1===(a=(i=mt("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?i=a:i.appendChild(a);else{if(!je&&!Re&&!Ne&&-1===t.indexOf("<"))return ie&&Le?ie.createHTML(t):t;if(!(i=mt(t)))return je?null:Le?oe:""}i&&xe&&ft(i.firstChild);for(var y=gt(ze?t:i);c=y.nextNode();)3===c.nodeType&&c===u||_t(c)||(c.content instanceof s&&Ot(c.content),Ct(c),u=c);if(u=null,ze)return t;if(je){if(Ke)for(d=le.call(i.ownerDocument);i.firstChild;)d.appendChild(i.firstChild);else d=i;return Ce.shadowroot&&(d=de.call(o,d,!0)),d}var f=Ne?i.outerHTML:i.innerHTML;return Ne&&we["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&O($,i.ownerDocument.doctype.name)&&(f="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+f),Re&&(f=w(f,ve," "),f=w(f,me," ")),ie&&Le?ie.createHTML(f):f},r.setConfig=function(e){ct(e),Fe=!0},r.clearConfig=function(){ot=null,Fe=!1},r.isValidAttribute=function(e,t,n){ot||ct({});var r=fe(e),i=fe(t);return wt(r,i,n)},r.addHook=function(e,t){"function"==typeof t&&(he[e]=he[e]||[],b(he[e],t))},r.removeHook=function(e){if(he[e])return S(he[e])},r.removeHooks=function(e){he[e]&&(he[e]=[])},r.removeAllHooks=function(){he={}},r}()}()},86200:(e,t,n)=>{var r=n(99805)(n(71188),"DataView");e.exports=r},45115:(e,t,n)=>{var r=n(70377),i=n(81239),o=n(31091),a=n(13932),s=n(69488);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=a,c.prototype.set=s,e.exports=c},71089:(e,t,n)=>{var r=n(45977),i=n(4395),o=n(44807),a=n(87930),s=n(99045);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=a,c.prototype.set=s,e.exports=c},16810:(e,t,n)=>{var r=n(99805)(n(71188),"Map");e.exports=r},10848:(e,t,n)=>{var r=n(19849),i=n(24184),o=n(24920),a=n(62638),s=n(60895);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=a,c.prototype.set=s,e.exports=c},39774:(e,t,n)=>{var r=n(99805)(n(71188),"Promise");e.exports=r},50965:(e,t,n)=>{var r=n(99805)(n(71188),"Set");e.exports=r},44870:(e,t,n)=>{var r=n(10848),i=n(68579),o=n(5162);function a(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=i,a.prototype.has=o,e.exports=a},41152:(e,t,n)=>{var r=n(71089),i=n(69064),o=n(45851),a=n(70927),s=n(10998),c=n(5108);function l(e){var t=this.__data__=new r(e);this.size=t.size}l.prototype.clear=i,l.prototype.delete=o,l.prototype.get=a,l.prototype.has=s,l.prototype.set=c,e.exports=l},89335:(e,t,n)=>{var r=n(71188).Symbol;e.exports=r},71293:(e,t,n)=>{var r=n(71188).Uint8Array;e.exports=r},62459:(e,t,n)=>{var r=n(99805)(n(71188),"WeakMap");e.exports=r},7359:e=>{e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},21058:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}},26728:(e,t,n)=>{var r=n(34049);e.exports=function(e,t){return!(null==e||!e.length)&&r(e,t,0)>-1}},64087:e=>{e.exports=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}},84427:(e,t,n)=>{var r=n(54805),i=n(41041),o=n(19041),a=n(18962),s=n(83574),c=n(90299),l=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),u=!n&&i(e),d=!n&&!u&&a(e),p=!n&&!u&&!d&&c(e),h=n||u||d||p,y=h?r(e.length,String):[],f=y.length;for(var v in e)!t&&!l.call(e,v)||h&&("length"==v||d&&("offset"==v||"parent"==v)||p&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||s(v,f))||y.push(v);return y}},39600:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},50534:e=>{e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},95681:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},36587:(e,t,n)=>{var r=n(95826),i=n(38288);e.exports=function(e,t,n){(void 0!==n&&!i(e[t],n)||void 0===n&&!(t in e))&&r(e,t,n)}},59521:(e,t,n)=>{var r=n(95826),i=n(38288),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var a=e[t];o.call(e,t)&&i(a,n)&&(void 0!==n||t in e)||r(e,t,n)}},25063:(e,t,n)=>{var r=n(38288);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},95826:(e,t,n)=>{var r=n(65745);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},92080:(e,t,n)=>{var r=n(57458),i=Object.create,o=function(){function e(){}return function(t){if(!r(t))return{};if(i)return i(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=o},36869:e=>{e.exports=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}},56609:(e,t,n)=>{var r=n(56345)();e.exports=r},34820:(e,t,n)=>{var r=n(67304),i=n(35657);e.exports=function(e,t){for(var n=0,o=(t=r(t,e)).length;null!=e&&n<o;)e=e[i(t[n++])];return n&&n==o?e:void 0}},48968:(e,t,n)=>{var r=n(50534),i=n(19041);e.exports=function(e,t,n){var o=t(e);return i(e)?o:r(o,n(e))}},84031:(e,t,n)=>{var r=n(89335),i=n(31307),o=n(95780),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?i(e):o(e)}},29043:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},34049:(e,t,n)=>{var r=n(36869),i=n(70439),o=n(63662);e.exports=function(e,t,n){return t==t?o(e,t,n):r(e,i,n)}},36720:(e,t,n)=>{var r=n(84031),i=n(85175);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},1570:(e,t,n)=>{var r=n(90930),i=n(85175);e.exports=function e(t,n,o,a,s){return t===n||(null==t||null==n||!i(t)&&!i(n)?t!=t&&n!=n:r(t,n,o,a,e,s))}},90930:(e,t,n)=>{var r=n(41152),i=n(39153),o=n(4237),a=n(92550),s=n(48584),c=n(19041),l=n(18962),u=n(90299),d="[object Arguments]",p="[object Array]",h="[object Object]",y=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,f,v,m){var g=c(e),S=c(t),b=g?p:s(e),P=S?p:s(t),_=(b=b==d?h:b)==h,w=(P=P==d?h:P)==h,E=b==P;if(E&&l(e)){if(!l(t))return!1;g=!0,_=!1}if(E&&!_)return m||(m=new r),g||u(e)?i(e,t,n,f,v,m):o(e,t,b,n,f,v,m);if(!(1&n)){var C=_&&y.call(e,"__wrapped__"),O=w&&y.call(t,"__wrapped__");if(C||O){var I=C?e.value():e,M=O?t.value():t;return m||(m=new r),v(I,M,n,f,m)}}return!!E&&(m||(m=new r),a(e,t,n,f,v,m))}},42382:(e,t,n)=>{var r=n(41152),i=n(1570);e.exports=function(e,t,n,o){var a=n.length,s=a,c=!o;if(null==e)return!s;for(e=Object(e);a--;){var l=n[a];if(c&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++a<s;){var u=(l=n[a])[0],d=e[u],p=l[1];if(c&&l[2]){if(void 0===d&&!(u in e))return!1}else{var h=new r;if(o)var y=o(d,p,u,e,t,h);if(!(void 0===y?i(p,d,3,o,h):y))return!1}}return!0}},70439:e=>{e.exports=function(e){return e!=e}},50558:(e,t,n)=>{var r=n(41033),i=n(41518),o=n(57458),a=n(14309),s=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,u=c.toString,d=l.hasOwnProperty,p=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(r(e)?p:s).test(a(e))}},28229:(e,t,n)=>{var r=n(84031),i=n(94111),o=n(85175),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!a[r(e)]}},24064:(e,t,n)=>{var r=n(7305),i=n(8308),o=n(46391),a=n(19041),s=n(47973);e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?a(e)?i(e[0],e[1]):r(e):s(e)}},13182:(e,t,n)=>{var r=n(58088),i=n(30622),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},78590:(e,t,n)=>{var r=n(57458),i=n(58088),o=n(83760),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=i(e),n=[];for(var s in e)("constructor"!=s||!t&&a.call(e,s))&&n.push(s);return n}},7305:(e,t,n)=>{var r=n(42382),i=n(74966),o=n(73356);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},8308:(e,t,n)=>{var r=n(1570),i=n(55772),o=n(42338),a=n(75374),s=n(39944),c=n(73356),l=n(35657);e.exports=function(e,t){return a(e)&&s(t)?c(l(e),t):function(n){var a=i(n,e);return void 0===a&&a===t?o(n,e):r(t,a,3)}}},90791:(e,t,n)=>{var r=n(41152),i=n(36587),o=n(56609),a=n(20005),s=n(57458),c=n(38929),l=n(19314);e.exports=function e(t,n,u,d,p){t!==n&&o(n,(function(o,c){if(p||(p=new r),s(o))a(t,n,c,u,e,d,p);else{var h=d?d(l(t,c),o,c+"",t,n,p):void 0;void 0===h&&(h=o),i(t,c,h)}}),c)}},20005:(e,t,n)=>{var r=n(36587),i=n(16971),o=n(96120),a=n(95531),s=n(24129),c=n(41041),l=n(19041),u=n(40541),d=n(18962),p=n(41033),h=n(57458),y=n(73748),f=n(90299),v=n(19314),m=n(95920);e.exports=function(e,t,n,g,S,b,P){var _=v(e,n),w=v(t,n),E=P.get(w);if(E)r(e,n,E);else{var C=b?b(_,w,n+"",e,t,P):void 0,O=void 0===C;if(O){var I=l(w),M=!I&&d(w),A=!I&&!M&&f(w);C=w,I||M||A?l(_)?C=_:u(_)?C=a(_):M?(O=!1,C=i(w,!0)):A?(O=!1,C=o(w,!0)):C=[]:y(w)||c(w)?(C=_,c(_)?C=m(_):h(_)&&!p(_)||(C=s(w))):O=!1}O&&(P.set(w,C),S(C,w,g,b,P),P.delete(w)),r(e,n,C)}}},91484:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},15571:(e,t,n)=>{var r=n(34820);e.exports=function(e){return function(t){return r(t,e)}}},70896:(e,t,n)=>{var r=n(79117),i=n(83574),o=Array.prototype.splice;e.exports=function(e,t){for(var n=e?t.length:0,a=n-1;n--;){var s=t[n];if(n==a||s!==c){var c=s;i(s)?o.call(e,s,1):r(e,s)}}return e}},49595:(e,t,n)=>{var r=n(46391),i=n(75969),o=n(34253);e.exports=function(e,t){return o(i(e,t,r),e+"")}},52920:(e,t,n)=>{var r=n(61845),i=n(65745),o=n(46391),a=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:o;e.exports=a},84539:e=>{e.exports=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}},54805:e=>{e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},84372:(e,t,n)=>{var r=n(89335),i=n(39600),o=n(19041),a=n(5847),s=r?r.prototype:void 0,c=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(a(t))return c?c.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},62555:(e,t,n)=>{var r=n(92456),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e}},45314:e=>{e.exports=function(e){return function(t){return e(t)}}},445:(e,t,n)=>{var r=n(44870),i=n(26728),o=n(64087),a=n(13359),s=n(19789),c=n(59805);e.exports=function(e,t,n){var l=-1,u=i,d=e.length,p=!0,h=[],y=h;if(n)p=!1,u=o;else if(d>=200){var f=t?null:s(e);if(f)return c(f);p=!1,u=a,y=new r}else y=t?[]:h;e:for(;++l<d;){var v=e[l],m=t?t(v):v;if(v=n||0!==v?v:0,p&&m==m){for(var g=y.length;g--;)if(y[g]===m)continue e;t&&y.push(m),h.push(v)}else u(y,m,n)||(y!==h&&y.push(m),h.push(v))}return h}},79117:(e,t,n)=>{var r=n(67304),i=n(4261),o=n(24719),a=n(35657);e.exports=function(e,t){return t=r(t,e),null==(e=o(e,t))||delete e[a(i(t))]}},13359:e=>{e.exports=function(e,t){return e.has(t)}},67304:(e,t,n)=>{var r=n(19041),i=n(75374),o=n(72996),a=n(40065);e.exports=function(e,t){return r(e)?e:i(e,t)?[e]:o(a(e))}},71402:(e,t,n)=>{var r=n(71293);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},16971:(e,t,n)=>{e=n.nmd(e);var r=n(71188),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,a=o&&o.exports===i?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=s?s(n):new e.constructor(n);return e.copy(r),r}},96120:(e,t,n)=>{var r=n(71402);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},95531:e=>{e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},98775:(e,t,n)=>{var r=n(59521),i=n(95826);e.exports=function(e,t,n,o){var a=!n;n||(n={});for(var s=-1,c=t.length;++s<c;){var l=t[s],u=o?o(n[l],e[l],l,n,e):void 0;void 0===u&&(u=e[l]),a?i(n,l,u):r(n,l,u)}return n}},96953:(e,t,n)=>{var r=n(71188)["__core-js_shared__"];e.exports=r},11143:(e,t,n)=>{var r=n(49595),i=n(28411);e.exports=function(e){return r((function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:void 0,s=o>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(o--,a):void 0,s&&i(n[0],n[1],s)&&(a=o<3?void 0:a,o=1),t=Object(t);++r<o;){var c=n[r];c&&e(t,c,r,a)}return t}))}},56345:e=>{e.exports=function(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var c=a[e?s:++i];if(!1===n(o[c],c,o))break}return t}}},63271:(e,t,n)=>{var r=n(24064),i=n(60798),o=n(75121);e.exports=function(e){return function(t,n,a){var s=Object(t);if(!i(t)){var c=r(n,3);t=o(t),n=function(e){return c(s[e],e,s)}}var l=e(t,n,a);return l>-1?s[c?t[l]:l]:void 0}}},19789:(e,t,n)=>{var r=n(50965),i=n(58569),o=n(59805),a=r&&1/o(new r([,-0]))[1]==1/0?function(e){return new r(e)}:i;e.exports=a},65745:(e,t,n)=>{var r=n(99805),i=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},39153:(e,t,n)=>{var r=n(44870),i=n(95681),o=n(13359);e.exports=function(e,t,n,a,s,c){var l=1&n,u=e.length,d=t.length;if(u!=d&&!(l&&d>u))return!1;var p=c.get(e),h=c.get(t);if(p&&h)return p==t&&h==e;var y=-1,f=!0,v=2&n?new r:void 0;for(c.set(e,t),c.set(t,e);++y<u;){var m=e[y],g=t[y];if(a)var S=l?a(g,m,y,t,e,c):a(m,g,y,e,t,c);if(void 0!==S){if(S)continue;f=!1;break}if(v){if(!i(t,(function(e,t){if(!o(v,t)&&(m===e||s(m,e,n,a,c)))return v.push(t)}))){f=!1;break}}else if(m!==g&&!s(m,g,n,a,c)){f=!1;break}}return c.delete(e),c.delete(t),f}},4237:(e,t,n)=>{var r=n(89335),i=n(71293),o=n(38288),a=n(39153),s=n(14857),c=n(59805),l=r?r.prototype:void 0,u=l?l.valueOf:void 0;e.exports=function(e,t,n,r,l,d,p){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new i(e),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var h=s;case"[object Set]":var y=1&r;if(h||(h=c),e.size!=t.size&&!y)return!1;var f=p.get(e);if(f)return f==t;r|=2,p.set(e,t);var v=a(h(e),h(t),r,l,d,p);return p.delete(e),v;case"[object Symbol]":if(u)return u.call(e)==u.call(t)}return!1}},92550:(e,t,n)=>{var r=n(86717),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,a,s){var c=1&n,l=r(e),u=l.length;if(u!=r(t).length&&!c)return!1;for(var d=u;d--;){var p=l[d];if(!(c?p in t:i.call(t,p)))return!1}var h=s.get(e),y=s.get(t);if(h&&y)return h==t&&y==e;var f=!0;s.set(e,t),s.set(t,e);for(var v=c;++d<u;){var m=e[p=l[d]],g=t[p];if(o)var S=c?o(g,m,p,t,e,s):o(m,g,p,e,t,s);if(!(void 0===S?m===g||a(m,g,n,o,s):S)){f=!1;break}v||(v="constructor"==p)}if(f&&!v){var b=e.constructor,P=t.constructor;b==P||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof P&&P instanceof P||(f=!1)}return s.delete(e),s.delete(t),f}},96407:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},86717:(e,t,n)=>{var r=n(48968),i=n(56519),o=n(75121);e.exports=function(e){return r(e,o,i)}},45510:(e,t,n)=>{var r=n(47113);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},74966:(e,t,n)=>{var r=n(39944),i=n(75121);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var o=t[n],a=e[o];t[n]=[o,a,r(a)]}return t}},99805:(e,t,n)=>{var r=n(50558),i=n(74733);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},49722:(e,t,n)=>{var r=n(88605)(Object.getPrototypeOf,Object);e.exports=r},31307:(e,t,n)=>{var r=n(89335),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var i=a.call(e);return r&&(t?e[s]=n:delete e[s]),i}},56519:(e,t,n)=>{var r=n(21058),i=n(38819),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),r(a(e),(function(t){return o.call(e,t)})))}:i;e.exports=s},48584:(e,t,n)=>{var r=n(86200),i=n(16810),o=n(39774),a=n(50965),s=n(62459),c=n(84031),l=n(14309),u="[object Map]",d="[object Promise]",p="[object Set]",h="[object WeakMap]",y="[object DataView]",f=l(r),v=l(i),m=l(o),g=l(a),S=l(s),b=c;(r&&b(new r(new ArrayBuffer(1)))!=y||i&&b(new i)!=u||o&&b(o.resolve())!=d||a&&b(new a)!=p||s&&b(new s)!=h)&&(b=function(e){var t=c(e),n="[object Object]"==t?e.constructor:void 0,r=n?l(n):"";if(r)switch(r){case f:return y;case v:return u;case m:return d;case g:return p;case S:return h}return t}),e.exports=b},74733:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},6613:(e,t,n)=>{var r=n(67304),i=n(41041),o=n(19041),a=n(83574),s=n(94111),c=n(35657);e.exports=function(e,t,n){for(var l=-1,u=(t=r(t,e)).length,d=!1;++l<u;){var p=c(t[l]);if(!(d=null!=e&&n(e,p)))break;e=e[p]}return d||++l!=u?d:!!(u=null==e?0:e.length)&&s(u)&&a(p,u)&&(o(e)||i(e))}},70377:(e,t,n)=>{var r=n(42600);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},81239:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},31091:(e,t,n)=>{var r=n(42600),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},13932:(e,t,n)=>{var r=n(42600),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},69488:(e,t,n)=>{var r=n(42600);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},24129:(e,t,n)=>{var r=n(92080),i=n(49722),o=n(58088);e.exports=function(e){return"function"!=typeof e.constructor||o(e)?{}:r(i(e))}},83574:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n}},28411:(e,t,n)=>{var r=n(38288),i=n(60798),o=n(83574),a=n(57458);e.exports=function(e,t,n){if(!a(n))return!1;var s=typeof t;return!!("number"==s?i(n)&&o(t,n.length):"string"==s&&t in n)&&r(n[t],e)}},75374:(e,t,n)=>{var r=n(19041),i=n(5847),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!i(e))||a.test(e)||!o.test(e)||null!=t&&e in Object(t)}},47113:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},41518:(e,t,n)=>{var r,i=n(96953),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!o&&o in e}},58088:e=>{var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},39944:(e,t,n)=>{var r=n(57458);e.exports=function(e){return e==e&&!r(e)}},45977:e=>{e.exports=function(){this.__data__=[],this.size=0}},4395:(e,t,n)=>{var r=n(25063),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():i.call(t,n,1),--this.size,0))}},44807:(e,t,n)=>{var r=n(25063);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},87930:(e,t,n)=>{var r=n(25063);e.exports=function(e){return r(this.__data__,e)>-1}},99045:(e,t,n)=>{var r=n(25063);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},19849:(e,t,n)=>{var r=n(45115),i=n(71089),o=n(16810);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},24184:(e,t,n)=>{var r=n(45510);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},24920:(e,t,n)=>{var r=n(45510);e.exports=function(e){return r(this,e).get(e)}},62638:(e,t,n)=>{var r=n(45510);e.exports=function(e){return r(this,e).has(e)}},60895:(e,t,n)=>{var r=n(45510);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},14857:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},73356:e=>{e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},26993:(e,t,n)=>{var r=n(71608);e.exports=function(e){var t=r(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},42600:(e,t,n)=>{var r=n(99805)(Object,"create");e.exports=r},30622:(e,t,n)=>{var r=n(88605)(Object.keys,Object);e.exports=r},83760:e=>{e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},83434:(e,t,n)=>{e=n.nmd(e);var r=n(96407),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,a=o&&o.exports===i&&r.process,s=function(){try{return o&&o.require&&o.require("util").types||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s},95780:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},88605:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},75969:(e,t,n)=>{var r=n(7359),i=Math.max;e.exports=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,a=-1,s=i(o.length-t,0),c=Array(s);++a<s;)c[a]=o[t+a];a=-1;for(var l=Array(t+1);++a<t;)l[a]=o[a];return l[t]=n(c),r(e,this,l)}}},24719:(e,t,n)=>{var r=n(34820),i=n(84539);e.exports=function(e,t){return t.length<2?e:r(e,i(t,0,-1))}},71188:(e,t,n)=>{var r=n(96407),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},19314:e=>{e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},68579:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},5162:e=>{e.exports=function(e){return this.__data__.has(e)}},59805:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},34253:(e,t,n)=>{var r=n(52920),i=n(26254)(r);e.exports=i},26254:e=>{var t=Date.now;e.exports=function(e){var n=0,r=0;return function(){var i=t(),o=16-(i-r);if(r=i,o>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},69064:(e,t,n)=>{var r=n(71089);e.exports=function(){this.__data__=new r,this.size=0}},45851:e=>{e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},70927:e=>{e.exports=function(e){return this.__data__.get(e)}},10998:e=>{e.exports=function(e){return this.__data__.has(e)}},5108:(e,t,n)=>{var r=n(71089),i=n(16810),o=n(10848);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!i||a.length<199)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new o(a)}return n.set(e,t),this.size=n.size,this}},63662:e=>{e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}},72996:(e,t,n)=>{var r=n(26993),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,a=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,(function(e,n,r,i){t.push(r?i.replace(o,"$1"):n||e)})),t}));e.exports=a},35657:(e,t,n)=>{var r=n(5847);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},14309:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},92456:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},61845:e=>{e.exports=function(e){return function(){return e}}},38288:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},3270:(e,t,n)=>{var r=n(63271)(n(59129));e.exports=r},59129:(e,t,n)=>{var r=n(36869),i=n(24064),o=n(3506),a=Math.max;e.exports=function(e,t,n){var s=null==e?0:e.length;if(!s)return-1;var c=null==n?0:o(n);return c<0&&(c=a(s+c,0)),r(e,i(t,3),c)}},55772:(e,t,n)=>{var r=n(34820);e.exports=function(e,t,n){var i=null==e?void 0:r(e,t);return void 0===i?n:i}},42338:(e,t,n)=>{var r=n(29043),i=n(6613);e.exports=function(e,t){return null!=e&&i(e,t,r)}},46391:e=>{e.exports=function(e){return e}},41041:(e,t,n)=>{var r=n(36720),i=n(85175),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(e){return i(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=c},19041:e=>{var t=Array.isArray;e.exports=t},60798:(e,t,n)=>{var r=n(41033),i=n(94111);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},40541:(e,t,n)=>{var r=n(60798),i=n(85175);e.exports=function(e){return i(e)&&r(e)}},18962:(e,t,n)=>{e=n.nmd(e);var r=n(71188),i=n(67349),o=t&&!t.nodeType&&t,a=o&&e&&!e.nodeType&&e,s=a&&a.exports===o?r.Buffer:void 0,c=(s?s.isBuffer:void 0)||i;e.exports=c},41033:(e,t,n)=>{var r=n(84031),i=n(57458);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},94111:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},57458:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},85175:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},73748:(e,t,n)=>{var r=n(84031),i=n(49722),o=n(85175),a=Function.prototype,s=Object.prototype,c=a.toString,l=s.hasOwnProperty,u=c.call(Object);e.exports=function(e){if(!o(e)||"[object Object]"!=r(e))return!1;var t=i(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==u}},5847:(e,t,n)=>{var r=n(84031),i=n(85175);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},90299:(e,t,n)=>{var r=n(28229),i=n(45314),o=n(83434),a=o&&o.isTypedArray,s=a?i(a):r;e.exports=s},75121:(e,t,n)=>{var r=n(84427),i=n(13182),o=n(60798);e.exports=function(e){return o(e)?r(e):i(e)}},38929:(e,t,n)=>{var r=n(84427),i=n(78590),o=n(60798);e.exports=function(e){return o(e)?r(e,!0):i(e)}},4261:e=>{e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},31773:function(e,t,n){var r;e=n.nmd(e),function(){var i,o="Expected a function",a="__lodash_hash_undefined__",s="__lodash_placeholder__",c=32,l=128,u=1/0,d=9007199254740991,p=NaN,h=4294967295,y=[["ary",l],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",c],["partialRight",64],["rearg",256]],f="[object Arguments]",v="[object Array]",m="[object Boolean]",g="[object Date]",S="[object Error]",b="[object Function]",P="[object GeneratorFunction]",_="[object Map]",w="[object Number]",E="[object Object]",C="[object Promise]",O="[object RegExp]",I="[object Set]",M="[object String]",A="[object Symbol]",T="[object WeakMap]",k="[object ArrayBuffer]",D="[object DataView]",R="[object Float32Array]",N="[object Float64Array]",F="[object Int8Array]",x="[object Int16Array]",j="[object Int32Array]",K="[object Uint8Array]",L="[object Uint8ClampedArray]",U="[object Uint16Array]",V="[object Uint32Array]",B=/\b__p \+= '';/g,W=/\b(__p \+=) '' \+/g,z=/(__e\(.*?\)|\b__t\)) \+\n'';/g,H=/&(?:amp|lt|gt|quot|#39);/g,G=/[&<>"']/g,q=RegExp(H.source),Q=RegExp(G.source),Y=/<%-([\s\S]+?)%>/g,$=/<%([\s\S]+?)%>/g,J=/<%=([\s\S]+?)%>/g,X=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Z=/^\w*$/,ee=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,te=/[\\^$.*+?()[\]{}|]/g,ne=RegExp(te.source),re=/^\s+/,ie=/\s/,oe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ae=/\{\n\/\* \[wrapped with (.+)\] \*/,se=/,? & /,ce=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,le=/[()=,{}\[\]\/\s]/,ue=/\\(\\)?/g,de=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,pe=/\w*$/,he=/^[-+]0x[0-9a-f]+$/i,ye=/^0b[01]+$/i,fe=/^\[object .+?Constructor\]$/,ve=/^0o[0-7]+$/i,me=/^(?:0|[1-9]\d*)$/,ge=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Se=/($^)/,be=/['\n\r\u2028\u2029\\]/g,Pe="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",_e="a-z\\xdf-\\xf6\\xf8-\\xff",we="A-Z\\xc0-\\xd6\\xd8-\\xde",Ee="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ce="["+Ee+"]",Oe="["+Pe+"]",Ie="\\d+",Me="["+_e+"]",Ae="[^\\ud800-\\udfff"+Ee+Ie+"\\u2700-\\u27bf"+_e+we+"]",Te="\\ud83c[\\udffb-\\udfff]",ke="[^\\ud800-\\udfff]",De="(?:\\ud83c[\\udde6-\\uddff]){2}",Re="[\\ud800-\\udbff][\\udc00-\\udfff]",Ne="["+we+"]",Fe="(?:"+Me+"|"+Ae+")",xe="(?:"+Ne+"|"+Ae+")",je="(?:['’](?:d|ll|m|re|s|t|ve))?",Ke="(?:['’](?:D|LL|M|RE|S|T|VE))?",Le="(?:"+Oe+"|"+Te+")?",Ue="[\\ufe0e\\ufe0f]?",Ve=Ue+Le+"(?:\\u200d(?:"+[ke,De,Re].join("|")+")"+Ue+Le+")*",Be="(?:"+["[\\u2700-\\u27bf]",De,Re].join("|")+")"+Ve,We="(?:"+[ke+Oe+"?",Oe,De,Re,"[\\ud800-\\udfff]"].join("|")+")",ze=RegExp("['’]","g"),He=RegExp(Oe,"g"),Ge=RegExp(Te+"(?="+Te+")|"+We+Ve,"g"),qe=RegExp([Ne+"?"+Me+"+"+je+"(?="+[Ce,Ne,"$"].join("|")+")",xe+"+"+Ke+"(?="+[Ce,Ne+Fe,"$"].join("|")+")",Ne+"?"+Fe+"+"+je,Ne+"+"+Ke,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ie,Be].join("|"),"g"),Qe=RegExp("[\\u200d\\ud800-\\udfff"+Pe+"\\ufe0e\\ufe0f]"),Ye=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,$e=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Je=-1,Xe={};Xe[R]=Xe[N]=Xe[F]=Xe[x]=Xe[j]=Xe[K]=Xe[L]=Xe[U]=Xe[V]=!0,Xe[f]=Xe[v]=Xe[k]=Xe[m]=Xe[D]=Xe[g]=Xe[S]=Xe[b]=Xe[_]=Xe[w]=Xe[E]=Xe[O]=Xe[I]=Xe[M]=Xe[T]=!1;var Ze={};Ze[f]=Ze[v]=Ze[k]=Ze[D]=Ze[m]=Ze[g]=Ze[R]=Ze[N]=Ze[F]=Ze[x]=Ze[j]=Ze[_]=Ze[w]=Ze[E]=Ze[O]=Ze[I]=Ze[M]=Ze[A]=Ze[K]=Ze[L]=Ze[U]=Ze[V]=!0,Ze[S]=Ze[b]=Ze[T]=!1;var et={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},tt=parseFloat,nt=parseInt,rt="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,it="object"==typeof self&&self&&self.Object===Object&&self,ot=rt||it||Function("return this")(),at=t&&!t.nodeType&&t,st=at&&e&&!e.nodeType&&e,ct=st&&st.exports===at,lt=ct&&rt.process,ut=function(){try{return st&&st.require&&st.require("util").types||lt&&lt.binding&&lt.binding("util")}catch(e){}}(),dt=ut&&ut.isArrayBuffer,pt=ut&&ut.isDate,ht=ut&&ut.isMap,yt=ut&&ut.isRegExp,ft=ut&&ut.isSet,vt=ut&&ut.isTypedArray;function mt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function gt(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function St(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function bt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Pt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function _t(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function wt(e,t){return!(null==e||!e.length)&&Rt(e,t,0)>-1}function Et(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Ct(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function Ot(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function It(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function Mt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function At(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Tt=jt("length");function kt(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function Dt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function Rt(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):Dt(e,Ft,n)}function Nt(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function Ft(e){return e!=e}function xt(e,t){var n=null==e?0:e.length;return n?Ut(e,t)/n:p}function jt(e){return function(t){return null==t?i:t[e]}}function Kt(e){return function(t){return null==e?i:e[t]}}function Lt(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function Ut(e,t){for(var n,r=-1,o=e.length;++r<o;){var a=t(e[r]);a!==i&&(n=n===i?a:n+a)}return n}function Vt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Bt(e){return e?e.slice(0,an(e)+1).replace(re,""):e}function Wt(e){return function(t){return e(t)}}function zt(e,t){return Ct(t,(function(t){return e[t]}))}function Ht(e,t){return e.has(t)}function Gt(e,t){for(var n=-1,r=e.length;++n<r&&Rt(t,e[n],0)>-1;);return n}function qt(e,t){for(var n=e.length;n--&&Rt(t,e[n],0)>-1;);return n}function Qt(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}var Yt=Kt({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),$t=Kt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Jt(e){return"\\"+et[e]}function Xt(e){return Qe.test(e)}function Zt(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function en(e,t){return function(n){return e(t(n))}}function tn(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==s||(e[n]=s,o[i++]=n)}return o}function nn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function rn(e){return Xt(e)?function(e){for(var t=Ge.lastIndex=0;Ge.test(e);)++t;return t}(e):Tt(e)}function on(e){return Xt(e)?function(e){return e.match(Ge)||[]}(e):function(e){return e.split("")}(e)}function an(e){for(var t=e.length;t--&&ie.test(e.charAt(t)););return t}var sn=Kt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),cn=function e(t){var n,r=(t=null==t?ot:cn.defaults(ot.Object(),t,cn.pick(ot,$e))).Array,ie=t.Date,Pe=t.Error,_e=t.Function,we=t.Math,Ee=t.Object,Ce=t.RegExp,Oe=t.String,Ie=t.TypeError,Me=r.prototype,Ae=_e.prototype,Te=Ee.prototype,ke=t["__core-js_shared__"],De=Ae.toString,Re=Te.hasOwnProperty,Ne=0,Fe=(n=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",xe=Te.toString,je=De.call(Ee),Ke=ot._,Le=Ce("^"+De.call(Re).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ue=ct?t.Buffer:i,Ve=t.Symbol,Be=t.Uint8Array,We=Ue?Ue.allocUnsafe:i,Ge=en(Ee.getPrototypeOf,Ee),Qe=Ee.create,et=Te.propertyIsEnumerable,rt=Me.splice,it=Ve?Ve.isConcatSpreadable:i,at=Ve?Ve.iterator:i,st=Ve?Ve.toStringTag:i,lt=function(){try{var e=co(Ee,"defineProperty");return e({},"",{}),e}catch(e){}}(),ut=t.clearTimeout!==ot.clearTimeout&&t.clearTimeout,Tt=ie&&ie.now!==ot.Date.now&&ie.now,Kt=t.setTimeout!==ot.setTimeout&&t.setTimeout,ln=we.ceil,un=we.floor,dn=Ee.getOwnPropertySymbols,pn=Ue?Ue.isBuffer:i,hn=t.isFinite,yn=Me.join,fn=en(Ee.keys,Ee),vn=we.max,mn=we.min,gn=ie.now,Sn=t.parseInt,bn=we.random,Pn=Me.reverse,_n=co(t,"DataView"),wn=co(t,"Map"),En=co(t,"Promise"),Cn=co(t,"Set"),On=co(t,"WeakMap"),In=co(Ee,"create"),Mn=On&&new On,An={},Tn=Ko(_n),kn=Ko(wn),Dn=Ko(En),Rn=Ko(Cn),Nn=Ko(On),Fn=Ve?Ve.prototype:i,xn=Fn?Fn.valueOf:i,jn=Fn?Fn.toString:i;function Kn(e){if(ts(e)&&!za(e)&&!(e instanceof Bn)){if(e instanceof Vn)return e;if(Re.call(e,"__wrapped__"))return Lo(e)}return new Vn(e)}var Ln=function(){function e(){}return function(t){if(!es(t))return{};if(Qe)return Qe(t);e.prototype=t;var n=new e;return e.prototype=i,n}}();function Un(){}function Vn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function Bn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=h,this.__views__=[]}function Wn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function zn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Hn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Gn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Hn;++t<n;)this.add(e[t])}function qn(e){var t=this.__data__=new zn(e);this.size=t.size}function Qn(e,t){var n=za(e),r=!n&&Wa(e),i=!n&&!r&&Qa(e),o=!n&&!r&&!i&&ls(e),a=n||r||i||o,s=a?Vt(e.length,Oe):[],c=s.length;for(var l in e)!t&&!Re.call(e,l)||a&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||vo(l,c))||s.push(l);return s}function Yn(e){var t=e.length;return t?e[Hr(0,t-1)]:i}function $n(e,t){return Ro(Oi(e),or(t,0,e.length))}function Jn(e){return Ro(Oi(e))}function Xn(e,t,n){(n!==i&&!Ua(e[t],n)||n===i&&!(t in e))&&rr(e,t,n)}function Zn(e,t,n){var r=e[t];Re.call(e,t)&&Ua(r,n)&&(n!==i||t in e)||rr(e,t,n)}function er(e,t){for(var n=e.length;n--;)if(Ua(e[n][0],t))return n;return-1}function tr(e,t,n,r){return ur(e,(function(e,i,o){t(r,e,n(e),o)})),r}function nr(e,t){return e&&Ii(t,ks(t),e)}function rr(e,t,n){"__proto__"==t&&lt?lt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ir(e,t){for(var n=-1,o=t.length,a=r(o),s=null==e;++n<o;)a[n]=s?i:Os(e,t[n]);return a}function or(e,t,n){return e==e&&(n!==i&&(e=e<=n?e:n),t!==i&&(e=e>=t?e:t)),e}function ar(e,t,n,r,o,a){var s,c=1&t,l=2&t,u=4&t;if(n&&(s=o?n(e,r,o,a):n(e)),s!==i)return s;if(!es(e))return e;var d=za(e);if(d){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Re.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!c)return Oi(e,s)}else{var p=po(e),h=p==b||p==P;if(Qa(e))return bi(e,c);if(p==E||p==f||h&&!o){if(s=l||h?{}:yo(e),!c)return l?function(e,t){return Ii(e,uo(e),t)}(e,function(e,t){return e&&Ii(t,Ds(t),e)}(s,e)):function(e,t){return Ii(e,lo(e),t)}(e,nr(s,e))}else{if(!Ze[p])return o?e:{};s=function(e,t,n){var r,i=e.constructor;switch(t){case k:return Pi(e);case m:case g:return new i(+e);case D:return function(e,t){var n=t?Pi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case R:case N:case F:case x:case j:case K:case L:case U:case V:return _i(e,n);case _:return new i;case w:case M:return new i(e);case O:return function(e){var t=new e.constructor(e.source,pe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case I:return new i;case A:return r=e,xn?Ee(xn.call(r)):{}}}(e,p,c)}}a||(a=new qn);var y=a.get(e);if(y)return y;a.set(e,s),as(e)?e.forEach((function(r){s.add(ar(r,t,n,r,e,a))})):ns(e)&&e.forEach((function(r,i){s.set(i,ar(r,t,n,i,e,a))}));var v=d?i:(u?l?to:eo:l?Ds:ks)(e);return St(v||e,(function(r,i){v&&(r=e[i=r]),Zn(s,i,ar(r,t,n,i,e,a))})),s}function sr(e,t,n){var r=n.length;if(null==e)return!r;for(e=Ee(e);r--;){var o=n[r],a=t[o],s=e[o];if(s===i&&!(o in e)||!a(s))return!1}return!0}function cr(e,t,n){if("function"!=typeof e)throw new Ie(o);return Ao((function(){e.apply(i,n)}),t)}function lr(e,t,n,r){var i=-1,o=wt,a=!0,s=e.length,c=[],l=t.length;if(!s)return c;n&&(t=Ct(t,Wt(n))),r?(o=Et,a=!1):t.length>=200&&(o=Ht,a=!1,t=new Gn(t));e:for(;++i<s;){var u=e[i],d=null==n?u:n(u);if(u=r||0!==u?u:0,a&&d==d){for(var p=l;p--;)if(t[p]===d)continue e;c.push(u)}else o(t,d,r)||c.push(u)}return c}Kn.templateSettings={escape:Y,evaluate:$,interpolate:J,variable:"",imports:{_:Kn}},Kn.prototype=Un.prototype,Kn.prototype.constructor=Kn,Vn.prototype=Ln(Un.prototype),Vn.prototype.constructor=Vn,Bn.prototype=Ln(Un.prototype),Bn.prototype.constructor=Bn,Wn.prototype.clear=function(){this.__data__=In?In(null):{},this.size=0},Wn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Wn.prototype.get=function(e){var t=this.__data__;if(In){var n=t[e];return n===a?i:n}return Re.call(t,e)?t[e]:i},Wn.prototype.has=function(e){var t=this.__data__;return In?t[e]!==i:Re.call(t,e)},Wn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=In&&t===i?a:t,this},zn.prototype.clear=function(){this.__data__=[],this.size=0},zn.prototype.delete=function(e){var t=this.__data__,n=er(t,e);return!(n<0||(n==t.length-1?t.pop():rt.call(t,n,1),--this.size,0))},zn.prototype.get=function(e){var t=this.__data__,n=er(t,e);return n<0?i:t[n][1]},zn.prototype.has=function(e){return er(this.__data__,e)>-1},zn.prototype.set=function(e,t){var n=this.__data__,r=er(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Hn.prototype.clear=function(){this.size=0,this.__data__={hash:new Wn,map:new(wn||zn),string:new Wn}},Hn.prototype.delete=function(e){var t=ao(this,e).delete(e);return this.size-=t?1:0,t},Hn.prototype.get=function(e){return ao(this,e).get(e)},Hn.prototype.has=function(e){return ao(this,e).has(e)},Hn.prototype.set=function(e,t){var n=ao(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Gn.prototype.add=Gn.prototype.push=function(e){return this.__data__.set(e,a),this},Gn.prototype.has=function(e){return this.__data__.has(e)},qn.prototype.clear=function(){this.__data__=new zn,this.size=0},qn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},qn.prototype.get=function(e){return this.__data__.get(e)},qn.prototype.has=function(e){return this.__data__.has(e)},qn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof zn){var r=n.__data__;if(!wn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Hn(r)}return n.set(e,t),this.size=n.size,this};var ur=Ti(gr),dr=Ti(Sr,!0);function pr(e,t){var n=!0;return ur(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function hr(e,t,n){for(var r=-1,o=e.length;++r<o;){var a=e[r],s=t(a);if(null!=s&&(c===i?s==s&&!cs(s):n(s,c)))var c=s,l=a}return l}function yr(e,t){var n=[];return ur(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function fr(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=fo),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?fr(s,t-1,n,r,i):Ot(i,s):r||(i[i.length]=s)}return i}var vr=ki(),mr=ki(!0);function gr(e,t){return e&&vr(e,t,ks)}function Sr(e,t){return e&&mr(e,t,ks)}function br(e,t){return _t(t,(function(t){return Ja(e[t])}))}function Pr(e,t){for(var n=0,r=(t=vi(t,e)).length;null!=e&&n<r;)e=e[jo(t[n++])];return n&&n==r?e:i}function _r(e,t,n){var r=t(e);return za(e)?r:Ot(r,n(e))}function wr(e){return null==e?e===i?"[object Undefined]":"[object Null]":st&&st in Ee(e)?function(e){var t=Re.call(e,st),n=e[st];try{e[st]=i;var r=!0}catch(e){}var o=xe.call(e);return r&&(t?e[st]=n:delete e[st]),o}(e):function(e){return xe.call(e)}(e)}function Er(e,t){return e>t}function Cr(e,t){return null!=e&&Re.call(e,t)}function Or(e,t){return null!=e&&t in Ee(e)}function Ir(e,t,n){for(var o=n?Et:wt,a=e[0].length,s=e.length,c=s,l=r(s),u=1/0,d=[];c--;){var p=e[c];c&&t&&(p=Ct(p,Wt(t))),u=mn(p.length,u),l[c]=!n&&(t||a>=120&&p.length>=120)?new Gn(c&&p):i}p=e[0];var h=-1,y=l[0];e:for(;++h<a&&d.length<u;){var f=p[h],v=t?t(f):f;if(f=n||0!==f?f:0,!(y?Ht(y,v):o(d,v,n))){for(c=s;--c;){var m=l[c];if(!(m?Ht(m,v):o(e[c],v,n)))continue e}y&&y.push(v),d.push(f)}}return d}function Mr(e,t,n){var r=null==(e=Co(e,t=vi(t,e)))?e:e[jo($o(t))];return null==r?i:mt(r,e,n)}function Ar(e){return ts(e)&&wr(e)==f}function Tr(e,t,n,r,o){return e===t||(null==e||null==t||!ts(e)&&!ts(t)?e!=e&&t!=t:function(e,t,n,r,o,a){var s=za(e),c=za(t),l=s?v:po(e),u=c?v:po(t),d=(l=l==f?E:l)==E,p=(u=u==f?E:u)==E,h=l==u;if(h&&Qa(e)){if(!Qa(t))return!1;s=!0,d=!1}if(h&&!d)return a||(a=new qn),s||ls(e)?Xi(e,t,n,r,o,a):function(e,t,n,r,i,o,a){switch(n){case D:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case k:return!(e.byteLength!=t.byteLength||!o(new Be(e),new Be(t)));case m:case g:case w:return Ua(+e,+t);case S:return e.name==t.name&&e.message==t.message;case O:case M:return e==t+"";case _:var s=Zt;case I:var c=1&r;if(s||(s=nn),e.size!=t.size&&!c)return!1;var l=a.get(e);if(l)return l==t;r|=2,a.set(e,t);var u=Xi(s(e),s(t),r,i,o,a);return a.delete(e),u;case A:if(xn)return xn.call(e)==xn.call(t)}return!1}(e,t,l,n,r,o,a);if(!(1&n)){var y=d&&Re.call(e,"__wrapped__"),b=p&&Re.call(t,"__wrapped__");if(y||b){var P=y?e.value():e,C=b?t.value():t;return a||(a=new qn),o(P,C,n,r,a)}}return!!h&&(a||(a=new qn),function(e,t,n,r,o,a){var s=1&n,c=eo(e),l=c.length;if(l!=eo(t).length&&!s)return!1;for(var u=l;u--;){var d=c[u];if(!(s?d in t:Re.call(t,d)))return!1}var p=a.get(e),h=a.get(t);if(p&&h)return p==t&&h==e;var y=!0;a.set(e,t),a.set(t,e);for(var f=s;++u<l;){var v=e[d=c[u]],m=t[d];if(r)var g=s?r(m,v,d,t,e,a):r(v,m,d,e,t,a);if(!(g===i?v===m||o(v,m,n,r,a):g)){y=!1;break}f||(f="constructor"==d)}if(y&&!f){var S=e.constructor,b=t.constructor;S==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof S&&S instanceof S&&"function"==typeof b&&b instanceof b||(y=!1)}return a.delete(e),a.delete(t),y}(e,t,n,r,o,a))}(e,t,n,r,Tr,o))}function kr(e,t,n,r){var o=n.length,a=o,s=!r;if(null==e)return!a;for(e=Ee(e);o--;){var c=n[o];if(s&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<a;){var l=(c=n[o])[0],u=e[l],d=c[1];if(s&&c[2]){if(u===i&&!(l in e))return!1}else{var p=new qn;if(r)var h=r(u,d,l,e,t,p);if(!(h===i?Tr(d,u,3,r,p):h))return!1}}return!0}function Dr(e){return!(!es(e)||(t=e,Fe&&Fe in t))&&(Ja(e)?Le:fe).test(Ko(e));var t}function Rr(e){return"function"==typeof e?e:null==e?rc:"object"==typeof e?za(e)?Kr(e[0],e[1]):jr(e):pc(e)}function Nr(e){if(!Po(e))return fn(e);var t=[];for(var n in Ee(e))Re.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Fr(e,t){return e<t}function xr(e,t){var n=-1,i=Ga(e)?r(e.length):[];return ur(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function jr(e){var t=so(e);return 1==t.length&&t[0][2]?wo(t[0][0],t[0][1]):function(n){return n===e||kr(n,e,t)}}function Kr(e,t){return go(e)&&_o(t)?wo(jo(e),t):function(n){var r=Os(n,e);return r===i&&r===t?Is(n,e):Tr(t,r,3)}}function Lr(e,t,n,r,o){e!==t&&vr(t,(function(a,s){if(o||(o=new qn),es(a))!function(e,t,n,r,o,a,s){var c=Io(e,n),l=Io(t,n),u=s.get(l);if(u)Xn(e,n,u);else{var d=a?a(c,l,n+"",e,t,s):i,p=d===i;if(p){var h=za(l),y=!h&&Qa(l),f=!h&&!y&&ls(l);d=l,h||y||f?za(c)?d=c:qa(c)?d=Oi(c):y?(p=!1,d=bi(l,!0)):f?(p=!1,d=_i(l,!0)):d=[]:is(l)||Wa(l)?(d=c,Wa(c)?d=ms(c):es(c)&&!Ja(c)||(d=yo(l))):p=!1}p&&(s.set(l,d),o(d,l,r,a,s),s.delete(l)),Xn(e,n,d)}}(e,t,s,n,Lr,r,o);else{var c=r?r(Io(e,s),a,s+"",e,t,o):i;c===i&&(c=a),Xn(e,s,c)}}),Ds)}function Ur(e,t){var n=e.length;if(n)return vo(t+=t<0?n:0,n)?e[t]:i}function Vr(e,t,n){t=t.length?Ct(t,(function(e){return za(e)?function(t){return Pr(t,1===e.length?e[0]:e)}:e})):[rc];var r=-1;t=Ct(t,Wt(oo()));var i=xr(e,(function(e,n,i){var o=Ct(t,(function(t){return t(e)}));return{criteria:o,index:++r,value:e}}));return function(e,t){var r=e.length;for(e.sort((function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var c=wi(i[r],o[r]);if(c)return r>=s?c:c*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}));r--;)e[r]=e[r].value;return e}(i)}function Br(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=Pr(e,a);n(s,a)&&$r(o,vi(a,e),s)}return o}function Wr(e,t,n,r){var i=r?Nt:Rt,o=-1,a=t.length,s=e;for(e===t&&(t=Oi(t)),n&&(s=Ct(e,Wt(n)));++o<a;)for(var c=0,l=t[o],u=n?n(l):l;(c=i(s,u,c,r))>-1;)s!==e&&rt.call(s,c,1),rt.call(e,c,1);return e}function zr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;vo(i)?rt.call(e,i,1):ci(e,i)}}return e}function Hr(e,t){return e+un(bn()*(t-e+1))}function Gr(e,t){var n="";if(!e||t<1||t>d)return n;do{t%2&&(n+=e),(t=un(t/2))&&(e+=e)}while(t);return n}function qr(e,t){return To(Eo(e,t,rc),e+"")}function Qr(e){return Yn(Us(e))}function Yr(e,t){var n=Us(e);return Ro(n,or(t,0,n.length))}function $r(e,t,n,r){if(!es(e))return e;for(var o=-1,a=(t=vi(t,e)).length,s=a-1,c=e;null!=c&&++o<a;){var l=jo(t[o]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(o!=s){var d=c[l];(u=r?r(d,l,c):i)===i&&(u=es(d)?d:vo(t[o+1])?[]:{})}Zn(c,l,u),c=c[l]}return e}var Jr=Mn?function(e,t){return Mn.set(e,t),e}:rc,Xr=lt?function(e,t){return lt(e,"toString",{configurable:!0,enumerable:!1,value:ec(t),writable:!0})}:rc;function Zr(e){return Ro(Us(e))}function ei(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var a=r(o);++i<o;)a[i]=e[i+t];return a}function ti(e,t){var n;return ur(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function ni(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!cs(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return ri(e,t,rc,n)}function ri(e,t,n,r){var o=0,a=null==e?0:e.length;if(0===a)return 0;for(var s=(t=n(t))!=t,c=null===t,l=cs(t),u=t===i;o<a;){var d=un((o+a)/2),p=n(e[d]),h=p!==i,y=null===p,f=p==p,v=cs(p);if(s)var m=r||f;else m=u?f&&(r||h):c?f&&h&&(r||!y):l?f&&h&&!y&&(r||!v):!y&&!v&&(r?p<=t:p<t);m?o=d+1:a=d}return mn(a,4294967294)}function ii(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!Ua(s,c)){var c=s;o[i++]=0===a?0:a}}return o}function oi(e){return"number"==typeof e?e:cs(e)?p:+e}function ai(e){if("string"==typeof e)return e;if(za(e))return Ct(e,ai)+"";if(cs(e))return jn?jn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function si(e,t,n){var r=-1,i=wt,o=e.length,a=!0,s=[],c=s;if(n)a=!1,i=Et;else if(o>=200){var l=t?null:Gi(e);if(l)return nn(l);a=!1,i=Ht,c=new Gn}else c=t?[]:s;e:for(;++r<o;){var u=e[r],d=t?t(u):u;if(u=n||0!==u?u:0,a&&d==d){for(var p=c.length;p--;)if(c[p]===d)continue e;t&&c.push(d),s.push(u)}else i(c,d,n)||(c!==s&&c.push(d),s.push(u))}return s}function ci(e,t){return null==(e=Co(e,t=vi(t,e)))||delete e[jo($o(t))]}function li(e,t,n,r){return $r(e,t,n(Pr(e,t)),r)}function ui(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?ei(e,r?0:o,r?o+1:i):ei(e,r?o+1:0,r?i:o)}function di(e,t){var n=e;return n instanceof Bn&&(n=n.value()),It(t,(function(e,t){return t.func.apply(t.thisArg,Ot([e],t.args))}),n)}function pi(e,t,n){var i=e.length;if(i<2)return i?si(e[0]):[];for(var o=-1,a=r(i);++o<i;)for(var s=e[o],c=-1;++c<i;)c!=o&&(a[o]=lr(a[o]||s,e[c],t,n));return si(fr(a,1),t,n)}function hi(e,t,n){for(var r=-1,o=e.length,a=t.length,s={};++r<o;){var c=r<a?t[r]:i;n(s,e[r],c)}return s}function yi(e){return qa(e)?e:[]}function fi(e){return"function"==typeof e?e:rc}function vi(e,t){return za(e)?e:go(e,t)?[e]:xo(gs(e))}var mi=qr;function gi(e,t,n){var r=e.length;return n=n===i?r:n,!t&&n>=r?e:ei(e,t,n)}var Si=ut||function(e){return ot.clearTimeout(e)};function bi(e,t){if(t)return e.slice();var n=e.length,r=We?We(n):new e.constructor(n);return e.copy(r),r}function Pi(e){var t=new e.constructor(e.byteLength);return new Be(t).set(new Be(e)),t}function _i(e,t){var n=t?Pi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function wi(e,t){if(e!==t){var n=e!==i,r=null===e,o=e==e,a=cs(e),s=t!==i,c=null===t,l=t==t,u=cs(t);if(!c&&!u&&!a&&e>t||a&&s&&l&&!c&&!u||r&&s&&l||!n&&l||!o)return 1;if(!r&&!a&&!u&&e<t||u&&n&&o&&!r&&!a||c&&n&&o||!s&&o||!l)return-1}return 0}function Ei(e,t,n,i){for(var o=-1,a=e.length,s=n.length,c=-1,l=t.length,u=vn(a-s,0),d=r(l+u),p=!i;++c<l;)d[c]=t[c];for(;++o<s;)(p||o<a)&&(d[n[o]]=e[o]);for(;u--;)d[c++]=e[o++];return d}function Ci(e,t,n,i){for(var o=-1,a=e.length,s=-1,c=n.length,l=-1,u=t.length,d=vn(a-c,0),p=r(d+u),h=!i;++o<d;)p[o]=e[o];for(var y=o;++l<u;)p[y+l]=t[l];for(;++s<c;)(h||o<a)&&(p[y+n[s]]=e[o++]);return p}function Oi(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function Ii(e,t,n,r){var o=!n;n||(n={});for(var a=-1,s=t.length;++a<s;){var c=t[a],l=r?r(n[c],e[c],c,n,e):i;l===i&&(l=e[c]),o?rr(n,c,l):Zn(n,c,l)}return n}function Mi(e,t){return function(n,r){var i=za(n)?gt:tr,o=t?t():{};return i(n,e,oo(r,2),o)}}function Ai(e){return qr((function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:i,s=o>2?n[2]:i;for(a=e.length>3&&"function"==typeof a?(o--,a):i,s&&mo(n[0],n[1],s)&&(a=o<3?i:a,o=1),t=Ee(t);++r<o;){var c=n[r];c&&e(t,c,r,a)}return t}))}function Ti(e,t){return function(n,r){if(null==n)return n;if(!Ga(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=Ee(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function ki(e){return function(t,n,r){for(var i=-1,o=Ee(t),a=r(t),s=a.length;s--;){var c=a[e?s:++i];if(!1===n(o[c],c,o))break}return t}}function Di(e){return function(t){var n=Xt(t=gs(t))?on(t):i,r=n?n[0]:t.charAt(0),o=n?gi(n,1).join(""):t.slice(1);return r[e]()+o}}function Ri(e){return function(t){return It(Js(Ws(t).replace(ze,"")),e,"")}}function Ni(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Ln(e.prototype),r=e.apply(n,t);return es(r)?r:n}}function Fi(e){return function(t,n,r){var o=Ee(t);if(!Ga(t)){var a=oo(n,3);t=ks(t),n=function(e){return a(o[e],e,o)}}var s=e(t,n,r);return s>-1?o[a?t[s]:s]:i}}function xi(e){return Zi((function(t){var n=t.length,r=n,a=Vn.prototype.thru;for(e&&t.reverse();r--;){var s=t[r];if("function"!=typeof s)throw new Ie(o);if(a&&!c&&"wrapper"==ro(s))var c=new Vn([],!0)}for(r=c?r:n;++r<n;){var l=ro(s=t[r]),u="wrapper"==l?no(s):i;c=u&&So(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?c[ro(u[0])].apply(c,u[3]):1==s.length&&So(s)?c[l]():c.thru(s)}return function(){var e=arguments,r=e[0];if(c&&1==e.length&&za(r))return c.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}function ji(e,t,n,o,a,s,c,u,d,p){var h=t&l,y=1&t,f=2&t,v=24&t,m=512&t,g=f?i:Ni(e);return function i(){for(var l=arguments.length,S=r(l),b=l;b--;)S[b]=arguments[b];if(v)var P=io(i),_=Qt(S,P);if(o&&(S=Ei(S,o,a,v)),s&&(S=Ci(S,s,c,v)),l-=_,v&&l<p){var w=tn(S,P);return zi(e,t,ji,i.placeholder,n,S,w,u,d,p-l)}var E=y?n:this,C=f?E[e]:e;return l=S.length,u?S=Oo(S,u):m&&l>1&&S.reverse(),h&&d<l&&(S.length=d),this&&this!==ot&&this instanceof i&&(C=g||Ni(C)),C.apply(E,S)}}function Ki(e,t){return function(n,r){return function(e,t,n,r){return gr(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function Li(e,t){return function(n,r){var o;if(n===i&&r===i)return t;if(n!==i&&(o=n),r!==i){if(o===i)return r;"string"==typeof n||"string"==typeof r?(n=ai(n),r=ai(r)):(n=oi(n),r=oi(r)),o=e(n,r)}return o}}function Ui(e){return Zi((function(t){return t=Ct(t,Wt(oo())),qr((function(n){var r=this;return e(t,(function(e){return mt(e,r,n)}))}))}))}function Vi(e,t){var n=(t=t===i?" ":ai(t)).length;if(n<2)return n?Gr(t,e):t;var r=Gr(t,ln(e/rn(t)));return Xt(t)?gi(on(r),0,e).join(""):r.slice(0,e)}function Bi(e){return function(t,n,o){return o&&"number"!=typeof o&&mo(t,n,o)&&(n=o=i),t=hs(t),n===i?(n=t,t=0):n=hs(n),function(e,t,n,i){for(var o=-1,a=vn(ln((t-e)/(n||1)),0),s=r(a);a--;)s[i?a:++o]=e,e+=n;return s}(t,n,o=o===i?t<n?1:-1:hs(o),e)}}function Wi(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=vs(t),n=vs(n)),e(t,n)}}function zi(e,t,n,r,o,a,s,l,u,d){var p=8&t;t|=p?c:64,4&(t&=~(p?64:c))||(t&=-4);var h=[e,t,o,p?a:i,p?s:i,p?i:a,p?i:s,l,u,d],y=n.apply(i,h);return So(e)&&Mo(y,h),y.placeholder=r,ko(y,e,t)}function Hi(e){var t=we[e];return function(e,n){if(e=vs(e),(n=null==n?0:mn(ys(n),292))&&hn(e)){var r=(gs(e)+"e").split("e");return+((r=(gs(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Gi=Cn&&1/nn(new Cn([,-0]))[1]==u?function(e){return new Cn(e)}:cc;function qi(e){return function(t){var n=po(t);return n==_?Zt(t):n==I?function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}(t):function(e,t){return Ct(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Qi(e,t,n,a,u,d,p,h){var y=2&t;if(!y&&"function"!=typeof e)throw new Ie(o);var f=a?a.length:0;if(f||(t&=-97,a=u=i),p=p===i?p:vn(ys(p),0),h=h===i?h:ys(h),f-=u?u.length:0,64&t){var v=a,m=u;a=u=i}var g=y?i:no(e),S=[e,t,n,a,u,v,m,d,p,h];if(g&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,a=r==l&&8==n||r==l&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!a)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var c=t[3];if(c){var u=e[3];e[3]=u?Ei(u,c,t[4]):c,e[4]=u?tn(e[3],s):t[4]}(c=t[5])&&(u=e[5],e[5]=u?Ci(u,c,t[6]):c,e[6]=u?tn(e[5],s):t[6]),(c=t[7])&&(e[7]=c),r&l&&(e[8]=null==e[8]?t[8]:mn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(S,g),e=S[0],t=S[1],n=S[2],a=S[3],u=S[4],!(h=S[9]=S[9]===i?y?0:e.length:vn(S[9]-f,0))&&24&t&&(t&=-25),t&&1!=t)b=8==t||16==t?function(e,t,n){var o=Ni(e);return function a(){for(var s=arguments.length,c=r(s),l=s,u=io(a);l--;)c[l]=arguments[l];var d=s<3&&c[0]!==u&&c[s-1]!==u?[]:tn(c,u);return(s-=d.length)<n?zi(e,t,ji,a.placeholder,i,c,d,i,i,n-s):mt(this&&this!==ot&&this instanceof a?o:e,this,c)}}(e,t,h):t!=c&&33!=t||u.length?ji.apply(i,S):function(e,t,n,i){var o=1&t,a=Ni(e);return function t(){for(var s=-1,c=arguments.length,l=-1,u=i.length,d=r(u+c),p=this&&this!==ot&&this instanceof t?a:e;++l<u;)d[l]=i[l];for(;c--;)d[l++]=arguments[++s];return mt(p,o?n:this,d)}}(e,t,n,a);else var b=function(e,t,n){var r=1&t,i=Ni(e);return function t(){return(this&&this!==ot&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return ko((g?Jr:Mo)(b,S),e,t)}function Yi(e,t,n,r){return e===i||Ua(e,Te[n])&&!Re.call(r,n)?t:e}function $i(e,t,n,r,o,a){return es(e)&&es(t)&&(a.set(t,e),Lr(e,t,i,$i,a),a.delete(t)),e}function Ji(e){return is(e)?i:e}function Xi(e,t,n,r,o,a){var s=1&n,c=e.length,l=t.length;if(c!=l&&!(s&&l>c))return!1;var u=a.get(e),d=a.get(t);if(u&&d)return u==t&&d==e;var p=-1,h=!0,y=2&n?new Gn:i;for(a.set(e,t),a.set(t,e);++p<c;){var f=e[p],v=t[p];if(r)var m=s?r(v,f,p,t,e,a):r(f,v,p,e,t,a);if(m!==i){if(m)continue;h=!1;break}if(y){if(!At(t,(function(e,t){if(!Ht(y,t)&&(f===e||o(f,e,n,r,a)))return y.push(t)}))){h=!1;break}}else if(f!==v&&!o(f,v,n,r,a)){h=!1;break}}return a.delete(e),a.delete(t),h}function Zi(e){return To(Eo(e,i,Ho),e+"")}function eo(e){return _r(e,ks,lo)}function to(e){return _r(e,Ds,uo)}var no=Mn?function(e){return Mn.get(e)}:cc;function ro(e){for(var t=e.name+"",n=An[t],r=Re.call(An,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function io(e){return(Re.call(Kn,"placeholder")?Kn:e).placeholder}function oo(){var e=Kn.iteratee||ic;return e=e===ic?Rr:e,arguments.length?e(arguments[0],arguments[1]):e}function ao(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function so(e){for(var t=ks(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,_o(i)]}return t}function co(e,t){var n=function(e,t){return null==e?i:e[t]}(e,t);return Dr(n)?n:i}var lo=dn?function(e){return null==e?[]:(e=Ee(e),_t(dn(e),(function(t){return et.call(e,t)})))}:fc,uo=dn?function(e){for(var t=[];e;)Ot(t,lo(e)),e=Ge(e);return t}:fc,po=wr;function ho(e,t,n){for(var r=-1,i=(t=vi(t,e)).length,o=!1;++r<i;){var a=jo(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Za(i)&&vo(a,i)&&(za(e)||Wa(e))}function yo(e){return"function"!=typeof e.constructor||Po(e)?{}:Ln(Ge(e))}function fo(e){return za(e)||Wa(e)||!!(it&&e&&e[it])}function vo(e,t){var n=typeof e;return!!(t=null==t?d:t)&&("number"==n||"symbol"!=n&&me.test(e))&&e>-1&&e%1==0&&e<t}function mo(e,t,n){if(!es(n))return!1;var r=typeof t;return!!("number"==r?Ga(n)&&vo(t,n.length):"string"==r&&t in n)&&Ua(n[t],e)}function go(e,t){if(za(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!cs(e))||Z.test(e)||!X.test(e)||null!=t&&e in Ee(t)}function So(e){var t=ro(e),n=Kn[t];if("function"!=typeof n||!(t in Bn.prototype))return!1;if(e===n)return!0;var r=no(n);return!!r&&e===r[0]}(_n&&po(new _n(new ArrayBuffer(1)))!=D||wn&&po(new wn)!=_||En&&po(En.resolve())!=C||Cn&&po(new Cn)!=I||On&&po(new On)!=T)&&(po=function(e){var t=wr(e),n=t==E?e.constructor:i,r=n?Ko(n):"";if(r)switch(r){case Tn:return D;case kn:return _;case Dn:return C;case Rn:return I;case Nn:return T}return t});var bo=ke?Ja:vc;function Po(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Te)}function _o(e){return e==e&&!es(e)}function wo(e,t){return function(n){return null!=n&&n[e]===t&&(t!==i||e in Ee(n))}}function Eo(e,t,n){return t=vn(t===i?e.length-1:t,0),function(){for(var i=arguments,o=-1,a=vn(i.length-t,0),s=r(a);++o<a;)s[o]=i[t+o];o=-1;for(var c=r(t+1);++o<t;)c[o]=i[o];return c[t]=n(s),mt(e,this,c)}}function Co(e,t){return t.length<2?e:Pr(e,ei(t,0,-1))}function Oo(e,t){for(var n=e.length,r=mn(t.length,n),o=Oi(e);r--;){var a=t[r];e[r]=vo(a,n)?o[a]:i}return e}function Io(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Mo=Do(Jr),Ao=Kt||function(e,t){return ot.setTimeout(e,t)},To=Do(Xr);function ko(e,t,n){var r=t+"";return To(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(oe,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return St(y,(function(n){var r="_."+n[0];t&n[1]&&!wt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(ae);return t?t[1].split(se):[]}(r),n)))}function Do(e){var t=0,n=0;return function(){var r=gn(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Ro(e,t){var n=-1,r=e.length,o=r-1;for(t=t===i?r:t;++n<t;){var a=Hr(n,o),s=e[a];e[a]=e[n],e[n]=s}return e.length=t,e}var No,Fo,xo=(No=Na((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ee,(function(e,n,r,i){t.push(r?i.replace(ue,"$1"):n||e)})),t}),(function(e){return 500===Fo.size&&Fo.clear(),e})),Fo=No.cache,No);function jo(e){if("string"==typeof e||cs(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Ko(e){if(null!=e){try{return De.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Lo(e){if(e instanceof Bn)return e.clone();var t=new Vn(e.__wrapped__,e.__chain__);return t.__actions__=Oi(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Uo=qr((function(e,t){return qa(e)?lr(e,fr(t,1,qa,!0)):[]})),Vo=qr((function(e,t){var n=$o(t);return qa(n)&&(n=i),qa(e)?lr(e,fr(t,1,qa,!0),oo(n,2)):[]})),Bo=qr((function(e,t){var n=$o(t);return qa(n)&&(n=i),qa(e)?lr(e,fr(t,1,qa,!0),i,n):[]}));function Wo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ys(n);return i<0&&(i=vn(r+i,0)),Dt(e,oo(t,3),i)}function zo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return n!==i&&(o=ys(n),o=n<0?vn(r+o,0):mn(o,r-1)),Dt(e,oo(t,3),o,!0)}function Ho(e){return null!=e&&e.length?fr(e,1):[]}function Go(e){return e&&e.length?e[0]:i}var qo=qr((function(e){var t=Ct(e,yi);return t.length&&t[0]===e[0]?Ir(t):[]})),Qo=qr((function(e){var t=$o(e),n=Ct(e,yi);return t===$o(n)?t=i:n.pop(),n.length&&n[0]===e[0]?Ir(n,oo(t,2)):[]})),Yo=qr((function(e){var t=$o(e),n=Ct(e,yi);return(t="function"==typeof t?t:i)&&n.pop(),n.length&&n[0]===e[0]?Ir(n,i,t):[]}));function $o(e){var t=null==e?0:e.length;return t?e[t-1]:i}var Jo=qr(Xo);function Xo(e,t){return e&&e.length&&t&&t.length?Wr(e,t):e}var Zo=Zi((function(e,t){var n=null==e?0:e.length,r=ir(e,t);return zr(e,Ct(t,(function(e){return vo(e,n)?+e:e})).sort(wi)),r}));function ea(e){return null==e?e:Pn.call(e)}var ta=qr((function(e){return si(fr(e,1,qa,!0))})),na=qr((function(e){var t=$o(e);return qa(t)&&(t=i),si(fr(e,1,qa,!0),oo(t,2))})),ra=qr((function(e){var t=$o(e);return t="function"==typeof t?t:i,si(fr(e,1,qa,!0),i,t)}));function ia(e){if(!e||!e.length)return[];var t=0;return e=_t(e,(function(e){if(qa(e))return t=vn(e.length,t),!0})),Vt(t,(function(t){return Ct(e,jt(t))}))}function oa(e,t){if(!e||!e.length)return[];var n=ia(e);return null==t?n:Ct(n,(function(e){return mt(t,i,e)}))}var aa=qr((function(e,t){return qa(e)?lr(e,t):[]})),sa=qr((function(e){return pi(_t(e,qa))})),ca=qr((function(e){var t=$o(e);return qa(t)&&(t=i),pi(_t(e,qa),oo(t,2))})),la=qr((function(e){var t=$o(e);return t="function"==typeof t?t:i,pi(_t(e,qa),i,t)})),ua=qr(ia),da=qr((function(e){var t=e.length,n=t>1?e[t-1]:i;return n="function"==typeof n?(e.pop(),n):i,oa(e,n)}));function pa(e){var t=Kn(e);return t.__chain__=!0,t}function ha(e,t){return t(e)}var ya=Zi((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return ir(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Bn&&vo(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:ha,args:[o],thisArg:i}),new Vn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(i),e}))):this.thru(o)})),fa=Mi((function(e,t,n){Re.call(e,n)?++e[n]:rr(e,n,1)})),va=Fi(Wo),ma=Fi(zo);function ga(e,t){return(za(e)?St:ur)(e,oo(t,3))}function Sa(e,t){return(za(e)?bt:dr)(e,oo(t,3))}var ba=Mi((function(e,t,n){Re.call(e,n)?e[n].push(t):rr(e,n,[t])})),Pa=qr((function(e,t,n){var i=-1,o="function"==typeof t,a=Ga(e)?r(e.length):[];return ur(e,(function(e){a[++i]=o?mt(t,e,n):Mr(e,t,n)})),a})),_a=Mi((function(e,t,n){rr(e,n,t)}));function wa(e,t){return(za(e)?Ct:xr)(e,oo(t,3))}var Ea=Mi((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),Ca=qr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&mo(e,t[0],t[1])?t=[]:n>2&&mo(t[0],t[1],t[2])&&(t=[t[0]]),Vr(e,fr(t,1),[])})),Oa=Tt||function(){return ot.Date.now()};function Ia(e,t,n){return t=n?i:t,t=e&&null==t?e.length:t,Qi(e,l,i,i,i,i,t)}function Ma(e,t){var n;if("function"!=typeof t)throw new Ie(o);return e=ys(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=i),n}}var Aa=qr((function(e,t,n){var r=1;if(n.length){var i=tn(n,io(Aa));r|=c}return Qi(e,r,t,n,i)})),Ta=qr((function(e,t,n){var r=3;if(n.length){var i=tn(n,io(Ta));r|=c}return Qi(t,r,e,n,i)}));function ka(e,t,n){var r,a,s,c,l,u,d=0,p=!1,h=!1,y=!0;if("function"!=typeof e)throw new Ie(o);function f(t){var n=r,o=a;return r=a=i,d=t,c=e.apply(o,n)}function v(e){return d=e,l=Ao(g,t),p?f(e):c}function m(e){var n=e-u;return u===i||n>=t||n<0||h&&e-d>=s}function g(){var e=Oa();if(m(e))return S(e);l=Ao(g,function(e){var n=t-(e-u);return h?mn(n,s-(e-d)):n}(e))}function S(e){return l=i,y&&r?f(e):(r=a=i,c)}function b(){var e=Oa(),n=m(e);if(r=arguments,a=this,u=e,n){if(l===i)return v(u);if(h)return Si(l),l=Ao(g,t),f(u)}return l===i&&(l=Ao(g,t)),c}return t=vs(t)||0,es(n)&&(p=!!n.leading,s=(h="maxWait"in n)?vn(vs(n.maxWait)||0,t):s,y="trailing"in n?!!n.trailing:y),b.cancel=function(){l!==i&&Si(l),d=0,r=u=a=l=i},b.flush=function(){return l===i?c:S(Oa())},b}var Da=qr((function(e,t){return cr(e,1,t)})),Ra=qr((function(e,t,n){return cr(e,vs(t)||0,n)}));function Na(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Ie(o);var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Na.Cache||Hn),n}function Fa(e){if("function"!=typeof e)throw new Ie(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Na.Cache=Hn;var xa=mi((function(e,t){var n=(t=1==t.length&&za(t[0])?Ct(t[0],Wt(oo())):Ct(fr(t,1),Wt(oo()))).length;return qr((function(r){for(var i=-1,o=mn(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return mt(e,this,r)}))})),ja=qr((function(e,t){var n=tn(t,io(ja));return Qi(e,c,i,t,n)})),Ka=qr((function(e,t){var n=tn(t,io(Ka));return Qi(e,64,i,t,n)})),La=Zi((function(e,t){return Qi(e,256,i,i,i,t)}));function Ua(e,t){return e===t||e!=e&&t!=t}var Va=Wi(Er),Ba=Wi((function(e,t){return e>=t})),Wa=Ar(function(){return arguments}())?Ar:function(e){return ts(e)&&Re.call(e,"callee")&&!et.call(e,"callee")},za=r.isArray,Ha=dt?Wt(dt):function(e){return ts(e)&&wr(e)==k};function Ga(e){return null!=e&&Za(e.length)&&!Ja(e)}function qa(e){return ts(e)&&Ga(e)}var Qa=pn||vc,Ya=pt?Wt(pt):function(e){return ts(e)&&wr(e)==g};function $a(e){if(!ts(e))return!1;var t=wr(e);return t==S||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!is(e)}function Ja(e){if(!es(e))return!1;var t=wr(e);return t==b||t==P||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Xa(e){return"number"==typeof e&&e==ys(e)}function Za(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=d}function es(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ts(e){return null!=e&&"object"==typeof e}var ns=ht?Wt(ht):function(e){return ts(e)&&po(e)==_};function rs(e){return"number"==typeof e||ts(e)&&wr(e)==w}function is(e){if(!ts(e)||wr(e)!=E)return!1;var t=Ge(e);if(null===t)return!0;var n=Re.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&De.call(n)==je}var os=yt?Wt(yt):function(e){return ts(e)&&wr(e)==O},as=ft?Wt(ft):function(e){return ts(e)&&po(e)==I};function ss(e){return"string"==typeof e||!za(e)&&ts(e)&&wr(e)==M}function cs(e){return"symbol"==typeof e||ts(e)&&wr(e)==A}var ls=vt?Wt(vt):function(e){return ts(e)&&Za(e.length)&&!!Xe[wr(e)]},us=Wi(Fr),ds=Wi((function(e,t){return e<=t}));function ps(e){if(!e)return[];if(Ga(e))return ss(e)?on(e):Oi(e);if(at&&e[at])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[at]());var t=po(e);return(t==_?Zt:t==I?nn:Us)(e)}function hs(e){return e?(e=vs(e))===u||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function ys(e){var t=hs(e),n=t%1;return t==t?n?t-n:t:0}function fs(e){return e?or(ys(e),0,h):0}function vs(e){if("number"==typeof e)return e;if(cs(e))return p;if(es(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=es(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Bt(e);var n=ye.test(e);return n||ve.test(e)?nt(e.slice(2),n?2:8):he.test(e)?p:+e}function ms(e){return Ii(e,Ds(e))}function gs(e){return null==e?"":ai(e)}var Ss=Ai((function(e,t){if(Po(t)||Ga(t))Ii(t,ks(t),e);else for(var n in t)Re.call(t,n)&&Zn(e,n,t[n])})),bs=Ai((function(e,t){Ii(t,Ds(t),e)})),Ps=Ai((function(e,t,n,r){Ii(t,Ds(t),e,r)})),_s=Ai((function(e,t,n,r){Ii(t,ks(t),e,r)})),ws=Zi(ir),Es=qr((function(e,t){e=Ee(e);var n=-1,r=t.length,o=r>2?t[2]:i;for(o&&mo(t[0],t[1],o)&&(r=1);++n<r;)for(var a=t[n],s=Ds(a),c=-1,l=s.length;++c<l;){var u=s[c],d=e[u];(d===i||Ua(d,Te[u])&&!Re.call(e,u))&&(e[u]=a[u])}return e})),Cs=qr((function(e){return e.push(i,$i),mt(Ns,i,e)}));function Os(e,t,n){var r=null==e?i:Pr(e,t);return r===i?n:r}function Is(e,t){return null!=e&&ho(e,t,Or)}var Ms=Ki((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=xe.call(t)),e[t]=n}),ec(rc)),As=Ki((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=xe.call(t)),Re.call(e,t)?e[t].push(n):e[t]=[n]}),oo),Ts=qr(Mr);function ks(e){return Ga(e)?Qn(e):Nr(e)}function Ds(e){return Ga(e)?Qn(e,!0):function(e){if(!es(e))return function(e){var t=[];if(null!=e)for(var n in Ee(e))t.push(n);return t}(e);var t=Po(e),n=[];for(var r in e)("constructor"!=r||!t&&Re.call(e,r))&&n.push(r);return n}(e)}var Rs=Ai((function(e,t,n){Lr(e,t,n)})),Ns=Ai((function(e,t,n,r){Lr(e,t,n,r)})),Fs=Zi((function(e,t){var n={};if(null==e)return n;var r=!1;t=Ct(t,(function(t){return t=vi(t,e),r||(r=t.length>1),t})),Ii(e,to(e),n),r&&(n=ar(n,7,Ji));for(var i=t.length;i--;)ci(n,t[i]);return n})),xs=Zi((function(e,t){return null==e?{}:function(e,t){return Br(e,t,(function(t,n){return Is(e,n)}))}(e,t)}));function js(e,t){if(null==e)return{};var n=Ct(to(e),(function(e){return[e]}));return t=oo(t),Br(e,n,(function(e,n){return t(e,n[0])}))}var Ks=qi(ks),Ls=qi(Ds);function Us(e){return null==e?[]:zt(e,ks(e))}var Vs=Ri((function(e,t,n){return t=t.toLowerCase(),e+(n?Bs(t):t)}));function Bs(e){return $s(gs(e).toLowerCase())}function Ws(e){return(e=gs(e))&&e.replace(ge,Yt).replace(He,"")}var zs=Ri((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Hs=Ri((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Gs=Di("toLowerCase"),qs=Ri((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),Qs=Ri((function(e,t,n){return e+(n?" ":"")+$s(t)})),Ys=Ri((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),$s=Di("toUpperCase");function Js(e,t,n){return e=gs(e),(t=n?i:t)===i?function(e){return Ye.test(e)}(e)?function(e){return e.match(qe)||[]}(e):function(e){return e.match(ce)||[]}(e):e.match(t)||[]}var Xs=qr((function(e,t){try{return mt(e,i,t)}catch(e){return $a(e)?e:new Pe(e)}})),Zs=Zi((function(e,t){return St(t,(function(t){t=jo(t),rr(e,t,Aa(e[t],e))})),e}));function ec(e){return function(){return e}}var tc=xi(),nc=xi(!0);function rc(e){return e}function ic(e){return Rr("function"==typeof e?e:ar(e,1))}var oc=qr((function(e,t){return function(n){return Mr(n,e,t)}})),ac=qr((function(e,t){return function(n){return Mr(e,n,t)}}));function sc(e,t,n){var r=ks(t),i=br(t,r);null!=n||es(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=br(t,ks(t)));var o=!(es(n)&&"chain"in n&&!n.chain),a=Ja(e);return St(i,(function(n){var r=t[n];e[n]=r,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),i=n.__actions__=Oi(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Ot([this.value()],arguments))})})),e}function cc(){}var lc=Ui(Ct),uc=Ui(Pt),dc=Ui(At);function pc(e){return go(e)?jt(jo(e)):function(e){return function(t){return Pr(t,e)}}(e)}var hc=Bi(),yc=Bi(!0);function fc(){return[]}function vc(){return!1}var mc,gc=Li((function(e,t){return e+t}),0),Sc=Hi("ceil"),bc=Li((function(e,t){return e/t}),1),Pc=Hi("floor"),_c=Li((function(e,t){return e*t}),1),wc=Hi("round"),Ec=Li((function(e,t){return e-t}),0);return Kn.after=function(e,t){if("function"!=typeof t)throw new Ie(o);return e=ys(e),function(){if(--e<1)return t.apply(this,arguments)}},Kn.ary=Ia,Kn.assign=Ss,Kn.assignIn=bs,Kn.assignInWith=Ps,Kn.assignWith=_s,Kn.at=ws,Kn.before=Ma,Kn.bind=Aa,Kn.bindAll=Zs,Kn.bindKey=Ta,Kn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return za(e)?e:[e]},Kn.chain=pa,Kn.chunk=function(e,t,n){t=(n?mo(e,t,n):t===i)?1:vn(ys(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var a=0,s=0,c=r(ln(o/t));a<o;)c[s++]=ei(e,a,a+=t);return c},Kn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},Kn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Ot(za(n)?Oi(n):[n],fr(t,1))},Kn.cond=function(e){var t=null==e?0:e.length,n=oo();return e=t?Ct(e,(function(e){if("function"!=typeof e[1])throw new Ie(o);return[n(e[0]),e[1]]})):[],qr((function(n){for(var r=-1;++r<t;){var i=e[r];if(mt(i[0],this,n))return mt(i[1],this,n)}}))},Kn.conforms=function(e){return function(e){var t=ks(e);return function(n){return sr(n,e,t)}}(ar(e,1))},Kn.constant=ec,Kn.countBy=fa,Kn.create=function(e,t){var n=Ln(e);return null==t?n:nr(n,t)},Kn.curry=function e(t,n,r){var o=Qi(t,8,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Kn.curryRight=function e(t,n,r){var o=Qi(t,16,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Kn.debounce=ka,Kn.defaults=Es,Kn.defaultsDeep=Cs,Kn.defer=Da,Kn.delay=Ra,Kn.difference=Uo,Kn.differenceBy=Vo,Kn.differenceWith=Bo,Kn.drop=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,(t=n||t===i?1:ys(t))<0?0:t,r):[]},Kn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,0,(t=r-(t=n||t===i?1:ys(t)))<0?0:t):[]},Kn.dropRightWhile=function(e,t){return e&&e.length?ui(e,oo(t,3),!0,!0):[]},Kn.dropWhile=function(e,t){return e&&e.length?ui(e,oo(t,3),!0):[]},Kn.fill=function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&mo(e,t,n)&&(n=0,r=o),function(e,t,n,r){var o=e.length;for((n=ys(n))<0&&(n=-n>o?0:o+n),(r=r===i||r>o?o:ys(r))<0&&(r+=o),r=n>r?0:fs(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},Kn.filter=function(e,t){return(za(e)?_t:yr)(e,oo(t,3))},Kn.flatMap=function(e,t){return fr(wa(e,t),1)},Kn.flatMapDeep=function(e,t){return fr(wa(e,t),u)},Kn.flatMapDepth=function(e,t,n){return n=n===i?1:ys(n),fr(wa(e,t),n)},Kn.flatten=Ho,Kn.flattenDeep=function(e){return null!=e&&e.length?fr(e,u):[]},Kn.flattenDepth=function(e,t){return null!=e&&e.length?fr(e,t=t===i?1:ys(t)):[]},Kn.flip=function(e){return Qi(e,512)},Kn.flow=tc,Kn.flowRight=nc,Kn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},Kn.functions=function(e){return null==e?[]:br(e,ks(e))},Kn.functionsIn=function(e){return null==e?[]:br(e,Ds(e))},Kn.groupBy=ba,Kn.initial=function(e){return null!=e&&e.length?ei(e,0,-1):[]},Kn.intersection=qo,Kn.intersectionBy=Qo,Kn.intersectionWith=Yo,Kn.invert=Ms,Kn.invertBy=As,Kn.invokeMap=Pa,Kn.iteratee=ic,Kn.keyBy=_a,Kn.keys=ks,Kn.keysIn=Ds,Kn.map=wa,Kn.mapKeys=function(e,t){var n={};return t=oo(t,3),gr(e,(function(e,r,i){rr(n,t(e,r,i),e)})),n},Kn.mapValues=function(e,t){var n={};return t=oo(t,3),gr(e,(function(e,r,i){rr(n,r,t(e,r,i))})),n},Kn.matches=function(e){return jr(ar(e,1))},Kn.matchesProperty=function(e,t){return Kr(e,ar(t,1))},Kn.memoize=Na,Kn.merge=Rs,Kn.mergeWith=Ns,Kn.method=oc,Kn.methodOf=ac,Kn.mixin=sc,Kn.negate=Fa,Kn.nthArg=function(e){return e=ys(e),qr((function(t){return Ur(t,e)}))},Kn.omit=Fs,Kn.omitBy=function(e,t){return js(e,Fa(oo(t)))},Kn.once=function(e){return Ma(2,e)},Kn.orderBy=function(e,t,n,r){return null==e?[]:(za(t)||(t=null==t?[]:[t]),za(n=r?i:n)||(n=null==n?[]:[n]),Vr(e,t,n))},Kn.over=lc,Kn.overArgs=xa,Kn.overEvery=uc,Kn.overSome=dc,Kn.partial=ja,Kn.partialRight=Ka,Kn.partition=Ea,Kn.pick=xs,Kn.pickBy=js,Kn.property=pc,Kn.propertyOf=function(e){return function(t){return null==e?i:Pr(e,t)}},Kn.pull=Jo,Kn.pullAll=Xo,Kn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Wr(e,t,oo(n,2)):e},Kn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Wr(e,t,i,n):e},Kn.pullAt=Zo,Kn.range=hc,Kn.rangeRight=yc,Kn.rearg=La,Kn.reject=function(e,t){return(za(e)?_t:yr)(e,Fa(oo(t,3)))},Kn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=oo(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return zr(e,i),n},Kn.rest=function(e,t){if("function"!=typeof e)throw new Ie(o);return qr(e,t=t===i?t:ys(t))},Kn.reverse=ea,Kn.sampleSize=function(e,t,n){return t=(n?mo(e,t,n):t===i)?1:ys(t),(za(e)?$n:Yr)(e,t)},Kn.set=function(e,t,n){return null==e?e:$r(e,t,n)},Kn.setWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:$r(e,t,n,r)},Kn.shuffle=function(e){return(za(e)?Jn:Zr)(e)},Kn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&mo(e,t,n)?(t=0,n=r):(t=null==t?0:ys(t),n=n===i?r:ys(n)),ei(e,t,n)):[]},Kn.sortBy=Ca,Kn.sortedUniq=function(e){return e&&e.length?ii(e):[]},Kn.sortedUniqBy=function(e,t){return e&&e.length?ii(e,oo(t,2)):[]},Kn.split=function(e,t,n){return n&&"number"!=typeof n&&mo(e,t,n)&&(t=n=i),(n=n===i?h:n>>>0)?(e=gs(e))&&("string"==typeof t||null!=t&&!os(t))&&!(t=ai(t))&&Xt(e)?gi(on(e),0,n):e.split(t,n):[]},Kn.spread=function(e,t){if("function"!=typeof e)throw new Ie(o);return t=null==t?0:vn(ys(t),0),qr((function(n){var r=n[t],i=gi(n,0,t);return r&&Ot(i,r),mt(e,this,i)}))},Kn.tail=function(e){var t=null==e?0:e.length;return t?ei(e,1,t):[]},Kn.take=function(e,t,n){return e&&e.length?ei(e,0,(t=n||t===i?1:ys(t))<0?0:t):[]},Kn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,(t=r-(t=n||t===i?1:ys(t)))<0?0:t,r):[]},Kn.takeRightWhile=function(e,t){return e&&e.length?ui(e,oo(t,3),!1,!0):[]},Kn.takeWhile=function(e,t){return e&&e.length?ui(e,oo(t,3)):[]},Kn.tap=function(e,t){return t(e),e},Kn.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new Ie(o);return es(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),ka(e,t,{leading:r,maxWait:t,trailing:i})},Kn.thru=ha,Kn.toArray=ps,Kn.toPairs=Ks,Kn.toPairsIn=Ls,Kn.toPath=function(e){return za(e)?Ct(e,jo):cs(e)?[e]:Oi(xo(gs(e)))},Kn.toPlainObject=ms,Kn.transform=function(e,t,n){var r=za(e),i=r||Qa(e)||ls(e);if(t=oo(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:es(e)&&Ja(o)?Ln(Ge(e)):{}}return(i?St:gr)(e,(function(e,r,i){return t(n,e,r,i)})),n},Kn.unary=function(e){return Ia(e,1)},Kn.union=ta,Kn.unionBy=na,Kn.unionWith=ra,Kn.uniq=function(e){return e&&e.length?si(e):[]},Kn.uniqBy=function(e,t){return e&&e.length?si(e,oo(t,2)):[]},Kn.uniqWith=function(e,t){return t="function"==typeof t?t:i,e&&e.length?si(e,i,t):[]},Kn.unset=function(e,t){return null==e||ci(e,t)},Kn.unzip=ia,Kn.unzipWith=oa,Kn.update=function(e,t,n){return null==e?e:li(e,t,fi(n))},Kn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:li(e,t,fi(n),r)},Kn.values=Us,Kn.valuesIn=function(e){return null==e?[]:zt(e,Ds(e))},Kn.without=aa,Kn.words=Js,Kn.wrap=function(e,t){return ja(fi(t),e)},Kn.xor=sa,Kn.xorBy=ca,Kn.xorWith=la,Kn.zip=ua,Kn.zipObject=function(e,t){return hi(e||[],t||[],Zn)},Kn.zipObjectDeep=function(e,t){return hi(e||[],t||[],$r)},Kn.zipWith=da,Kn.entries=Ks,Kn.entriesIn=Ls,Kn.extend=bs,Kn.extendWith=Ps,sc(Kn,Kn),Kn.add=gc,Kn.attempt=Xs,Kn.camelCase=Vs,Kn.capitalize=Bs,Kn.ceil=Sc,Kn.clamp=function(e,t,n){return n===i&&(n=t,t=i),n!==i&&(n=(n=vs(n))==n?n:0),t!==i&&(t=(t=vs(t))==t?t:0),or(vs(e),t,n)},Kn.clone=function(e){return ar(e,4)},Kn.cloneDeep=function(e){return ar(e,5)},Kn.cloneDeepWith=function(e,t){return ar(e,5,t="function"==typeof t?t:i)},Kn.cloneWith=function(e,t){return ar(e,4,t="function"==typeof t?t:i)},Kn.conformsTo=function(e,t){return null==t||sr(e,t,ks(t))},Kn.deburr=Ws,Kn.defaultTo=function(e,t){return null==e||e!=e?t:e},Kn.divide=bc,Kn.endsWith=function(e,t,n){e=gs(e),t=ai(t);var r=e.length,o=n=n===i?r:or(ys(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},Kn.eq=Ua,Kn.escape=function(e){return(e=gs(e))&&Q.test(e)?e.replace(G,$t):e},Kn.escapeRegExp=function(e){return(e=gs(e))&&ne.test(e)?e.replace(te,"\\$&"):e},Kn.every=function(e,t,n){var r=za(e)?Pt:pr;return n&&mo(e,t,n)&&(t=i),r(e,oo(t,3))},Kn.find=va,Kn.findIndex=Wo,Kn.findKey=function(e,t){return kt(e,oo(t,3),gr)},Kn.findLast=ma,Kn.findLastIndex=zo,Kn.findLastKey=function(e,t){return kt(e,oo(t,3),Sr)},Kn.floor=Pc,Kn.forEach=ga,Kn.forEachRight=Sa,Kn.forIn=function(e,t){return null==e?e:vr(e,oo(t,3),Ds)},Kn.forInRight=function(e,t){return null==e?e:mr(e,oo(t,3),Ds)},Kn.forOwn=function(e,t){return e&&gr(e,oo(t,3))},Kn.forOwnRight=function(e,t){return e&&Sr(e,oo(t,3))},Kn.get=Os,Kn.gt=Va,Kn.gte=Ba,Kn.has=function(e,t){return null!=e&&ho(e,t,Cr)},Kn.hasIn=Is,Kn.head=Go,Kn.identity=rc,Kn.includes=function(e,t,n,r){e=Ga(e)?e:Us(e),n=n&&!r?ys(n):0;var i=e.length;return n<0&&(n=vn(i+n,0)),ss(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&Rt(e,t,n)>-1},Kn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ys(n);return i<0&&(i=vn(r+i,0)),Rt(e,t,i)},Kn.inRange=function(e,t,n){return t=hs(t),n===i?(n=t,t=0):n=hs(n),function(e,t,n){return e>=mn(t,n)&&e<vn(t,n)}(e=vs(e),t,n)},Kn.invoke=Ts,Kn.isArguments=Wa,Kn.isArray=za,Kn.isArrayBuffer=Ha,Kn.isArrayLike=Ga,Kn.isArrayLikeObject=qa,Kn.isBoolean=function(e){return!0===e||!1===e||ts(e)&&wr(e)==m},Kn.isBuffer=Qa,Kn.isDate=Ya,Kn.isElement=function(e){return ts(e)&&1===e.nodeType&&!is(e)},Kn.isEmpty=function(e){if(null==e)return!0;if(Ga(e)&&(za(e)||"string"==typeof e||"function"==typeof e.splice||Qa(e)||ls(e)||Wa(e)))return!e.length;var t=po(e);if(t==_||t==I)return!e.size;if(Po(e))return!Nr(e).length;for(var n in e)if(Re.call(e,n))return!1;return!0},Kn.isEqual=function(e,t){return Tr(e,t)},Kn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:i)?n(e,t):i;return r===i?Tr(e,t,i,n):!!r},Kn.isError=$a,Kn.isFinite=function(e){return"number"==typeof e&&hn(e)},Kn.isFunction=Ja,Kn.isInteger=Xa,Kn.isLength=Za,Kn.isMap=ns,Kn.isMatch=function(e,t){return e===t||kr(e,t,so(t))},Kn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:i,kr(e,t,so(t),n)},Kn.isNaN=function(e){return rs(e)&&e!=+e},Kn.isNative=function(e){if(bo(e))throw new Pe("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Dr(e)},Kn.isNil=function(e){return null==e},Kn.isNull=function(e){return null===e},Kn.isNumber=rs,Kn.isObject=es,Kn.isObjectLike=ts,Kn.isPlainObject=is,Kn.isRegExp=os,Kn.isSafeInteger=function(e){return Xa(e)&&e>=-9007199254740991&&e<=d},Kn.isSet=as,Kn.isString=ss,Kn.isSymbol=cs,Kn.isTypedArray=ls,Kn.isUndefined=function(e){return e===i},Kn.isWeakMap=function(e){return ts(e)&&po(e)==T},Kn.isWeakSet=function(e){return ts(e)&&"[object WeakSet]"==wr(e)},Kn.join=function(e,t){return null==e?"":yn.call(e,t)},Kn.kebabCase=zs,Kn.last=$o,Kn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return n!==i&&(o=(o=ys(n))<0?vn(r+o,0):mn(o,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):Dt(e,Ft,o,!0)},Kn.lowerCase=Hs,Kn.lowerFirst=Gs,Kn.lt=us,Kn.lte=ds,Kn.max=function(e){return e&&e.length?hr(e,rc,Er):i},Kn.maxBy=function(e,t){return e&&e.length?hr(e,oo(t,2),Er):i},Kn.mean=function(e){return xt(e,rc)},Kn.meanBy=function(e,t){return xt(e,oo(t,2))},Kn.min=function(e){return e&&e.length?hr(e,rc,Fr):i},Kn.minBy=function(e,t){return e&&e.length?hr(e,oo(t,2),Fr):i},Kn.stubArray=fc,Kn.stubFalse=vc,Kn.stubObject=function(){return{}},Kn.stubString=function(){return""},Kn.stubTrue=function(){return!0},Kn.multiply=_c,Kn.nth=function(e,t){return e&&e.length?Ur(e,ys(t)):i},Kn.noConflict=function(){return ot._===this&&(ot._=Ke),this},Kn.noop=cc,Kn.now=Oa,Kn.pad=function(e,t,n){e=gs(e);var r=(t=ys(t))?rn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Vi(un(i),n)+e+Vi(ln(i),n)},Kn.padEnd=function(e,t,n){e=gs(e);var r=(t=ys(t))?rn(e):0;return t&&r<t?e+Vi(t-r,n):e},Kn.padStart=function(e,t,n){e=gs(e);var r=(t=ys(t))?rn(e):0;return t&&r<t?Vi(t-r,n)+e:e},Kn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),Sn(gs(e).replace(re,""),t||0)},Kn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&mo(e,t,n)&&(t=n=i),n===i&&("boolean"==typeof t?(n=t,t=i):"boolean"==typeof e&&(n=e,e=i)),e===i&&t===i?(e=0,t=1):(e=hs(e),t===i?(t=e,e=0):t=hs(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=bn();return mn(e+o*(t-e+tt("1e-"+((o+"").length-1))),t)}return Hr(e,t)},Kn.reduce=function(e,t,n){var r=za(e)?It:Lt,i=arguments.length<3;return r(e,oo(t,4),n,i,ur)},Kn.reduceRight=function(e,t,n){var r=za(e)?Mt:Lt,i=arguments.length<3;return r(e,oo(t,4),n,i,dr)},Kn.repeat=function(e,t,n){return t=(n?mo(e,t,n):t===i)?1:ys(t),Gr(gs(e),t)},Kn.replace=function(){var e=arguments,t=gs(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Kn.result=function(e,t,n){var r=-1,o=(t=vi(t,e)).length;for(o||(o=1,e=i);++r<o;){var a=null==e?i:e[jo(t[r])];a===i&&(r=o,a=n),e=Ja(a)?a.call(e):a}return e},Kn.round=wc,Kn.runInContext=e,Kn.sample=function(e){return(za(e)?Yn:Qr)(e)},Kn.size=function(e){if(null==e)return 0;if(Ga(e))return ss(e)?rn(e):e.length;var t=po(e);return t==_||t==I?e.size:Nr(e).length},Kn.snakeCase=qs,Kn.some=function(e,t,n){var r=za(e)?At:ti;return n&&mo(e,t,n)&&(t=i),r(e,oo(t,3))},Kn.sortedIndex=function(e,t){return ni(e,t)},Kn.sortedIndexBy=function(e,t,n){return ri(e,t,oo(n,2))},Kn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=ni(e,t);if(r<n&&Ua(e[r],t))return r}return-1},Kn.sortedLastIndex=function(e,t){return ni(e,t,!0)},Kn.sortedLastIndexBy=function(e,t,n){return ri(e,t,oo(n,2),!0)},Kn.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=ni(e,t,!0)-1;if(Ua(e[n],t))return n}return-1},Kn.startCase=Qs,Kn.startsWith=function(e,t,n){return e=gs(e),n=null==n?0:or(ys(n),0,e.length),t=ai(t),e.slice(n,n+t.length)==t},Kn.subtract=Ec,Kn.sum=function(e){return e&&e.length?Ut(e,rc):0},Kn.sumBy=function(e,t){return e&&e.length?Ut(e,oo(t,2)):0},Kn.template=function(e,t,n){var r=Kn.templateSettings;n&&mo(e,t,n)&&(t=i),e=gs(e),t=Ps({},t,r,Yi);var o,a,s=Ps({},t.imports,r.imports,Yi),c=ks(s),l=zt(s,c),u=0,d=t.interpolate||Se,p="__p += '",h=Ce((t.escape||Se).source+"|"+d.source+"|"+(d===J?de:Se).source+"|"+(t.evaluate||Se).source+"|$","g"),y="//# sourceURL="+(Re.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Je+"]")+"\n";e.replace(h,(function(t,n,r,i,s,c){return r||(r=i),p+=e.slice(u,c).replace(be,Jt),n&&(o=!0,p+="' +\n__e("+n+") +\n'"),s&&(a=!0,p+="';\n"+s+";\n__p += '"),r&&(p+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=c+t.length,t})),p+="';\n";var f=Re.call(t,"variable")&&t.variable;if(f){if(le.test(f))throw new Pe("Invalid `variable` option passed into `_.template`")}else p="with (obj) {\n"+p+"\n}\n";p=(a?p.replace(B,""):p).replace(W,"$1").replace(z,"$1;"),p="function("+(f||"obj")+") {\n"+(f?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var v=Xs((function(){return _e(c,y+"return "+p).apply(i,l)}));if(v.source=p,$a(v))throw v;return v},Kn.times=function(e,t){if((e=ys(e))<1||e>d)return[];var n=h,r=mn(e,h);t=oo(t),e-=h;for(var i=Vt(r,t);++n<e;)t(n);return i},Kn.toFinite=hs,Kn.toInteger=ys,Kn.toLength=fs,Kn.toLower=function(e){return gs(e).toLowerCase()},Kn.toNumber=vs,Kn.toSafeInteger=function(e){return e?or(ys(e),-9007199254740991,d):0===e?e:0},Kn.toString=gs,Kn.toUpper=function(e){return gs(e).toUpperCase()},Kn.trim=function(e,t,n){if((e=gs(e))&&(n||t===i))return Bt(e);if(!e||!(t=ai(t)))return e;var r=on(e),o=on(t);return gi(r,Gt(r,o),qt(r,o)+1).join("")},Kn.trimEnd=function(e,t,n){if((e=gs(e))&&(n||t===i))return e.slice(0,an(e)+1);if(!e||!(t=ai(t)))return e;var r=on(e);return gi(r,0,qt(r,on(t))+1).join("")},Kn.trimStart=function(e,t,n){if((e=gs(e))&&(n||t===i))return e.replace(re,"");if(!e||!(t=ai(t)))return e;var r=on(e);return gi(r,Gt(r,on(t))).join("")},Kn.truncate=function(e,t){var n=30,r="...";if(es(t)){var o="separator"in t?t.separator:o;n="length"in t?ys(t.length):n,r="omission"in t?ai(t.omission):r}var a=(e=gs(e)).length;if(Xt(e)){var s=on(e);a=s.length}if(n>=a)return e;var c=n-rn(r);if(c<1)return r;var l=s?gi(s,0,c).join(""):e.slice(0,c);if(o===i)return l+r;if(s&&(c+=l.length-c),os(o)){if(e.slice(c).search(o)){var u,d=l;for(o.global||(o=Ce(o.source,gs(pe.exec(o))+"g")),o.lastIndex=0;u=o.exec(d);)var p=u.index;l=l.slice(0,p===i?c:p)}}else if(e.indexOf(ai(o),c)!=c){var h=l.lastIndexOf(o);h>-1&&(l=l.slice(0,h))}return l+r},Kn.unescape=function(e){return(e=gs(e))&&q.test(e)?e.replace(H,sn):e},Kn.uniqueId=function(e){var t=++Ne;return gs(e)+t},Kn.upperCase=Ys,Kn.upperFirst=$s,Kn.each=ga,Kn.eachRight=Sa,Kn.first=Go,sc(Kn,(mc={},gr(Kn,(function(e,t){Re.call(Kn.prototype,t)||(mc[t]=e)})),mc),{chain:!1}),Kn.VERSION="4.17.21",St(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Kn[e].placeholder=Kn})),St(["drop","take"],(function(e,t){Bn.prototype[e]=function(n){n=n===i?1:vn(ys(n),0);var r=this.__filtered__&&!t?new Bn(this):this.clone();return r.__filtered__?r.__takeCount__=mn(n,r.__takeCount__):r.__views__.push({size:mn(n,h),type:e+(r.__dir__<0?"Right":"")}),r},Bn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),St(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Bn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:oo(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),St(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Bn.prototype[e]=function(){return this[n](1).value()[0]}})),St(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Bn.prototype[e]=function(){return this.__filtered__?new Bn(this):this[n](1)}})),Bn.prototype.compact=function(){return this.filter(rc)},Bn.prototype.find=function(e){return this.filter(e).head()},Bn.prototype.findLast=function(e){return this.reverse().find(e)},Bn.prototype.invokeMap=qr((function(e,t){return"function"==typeof e?new Bn(this):this.map((function(n){return Mr(n,e,t)}))})),Bn.prototype.reject=function(e){return this.filter(Fa(oo(e)))},Bn.prototype.slice=function(e,t){e=ys(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Bn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==i&&(n=(t=ys(t))<0?n.dropRight(-t):n.take(t-e)),n)},Bn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Bn.prototype.toArray=function(){return this.take(h)},gr(Bn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=Kn[r?"take"+("last"==t?"Right":""):t],a=r||/^find/.test(t);o&&(Kn.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,c=t instanceof Bn,l=s[0],u=c||za(t),d=function(e){var t=o.apply(Kn,Ot([e],s));return r&&p?t[0]:t};u&&n&&"function"==typeof l&&1!=l.length&&(c=u=!1);var p=this.__chain__,h=!!this.__actions__.length,y=a&&!p,f=c&&!h;if(!a&&u){t=f?t:new Bn(this);var v=e.apply(t,s);return v.__actions__.push({func:ha,args:[d],thisArg:i}),new Vn(v,p)}return y&&f?e.apply(this,s):(v=this.thru(d),y?r?v.value()[0]:v.value():v)})})),St(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Me[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Kn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(za(i)?i:[],e)}return this[n]((function(n){return t.apply(za(n)?n:[],e)}))}})),gr(Bn.prototype,(function(e,t){var n=Kn[t];if(n){var r=n.name+"";Re.call(An,r)||(An[r]=[]),An[r].push({name:t,func:n})}})),An[ji(i,2).name]=[{name:"wrapper",func:i}],Bn.prototype.clone=function(){var e=new Bn(this.__wrapped__);return e.__actions__=Oi(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Oi(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Oi(this.__views__),e},Bn.prototype.reverse=function(){if(this.__filtered__){var e=new Bn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Bn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=za(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=mn(t,e+a);break;case"takeRight":e=vn(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,c=s-a,l=r?s:a-1,u=this.__iteratees__,d=u.length,p=0,h=mn(c,this.__takeCount__);if(!n||!r&&i==c&&h==c)return di(e,this.__actions__);var y=[];e:for(;c--&&p<h;){for(var f=-1,v=e[l+=t];++f<d;){var m=u[f],g=m.iteratee,S=m.type,b=g(v);if(2==S)v=b;else if(!b){if(1==S)continue e;break e}}y[p++]=v}return y},Kn.prototype.at=ya,Kn.prototype.chain=function(){return pa(this)},Kn.prototype.commit=function(){return new Vn(this.value(),this.__chain__)},Kn.prototype.next=function(){this.__values__===i&&(this.__values__=ps(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?i:this.__values__[this.__index__++]}},Kn.prototype.plant=function(e){for(var t,n=this;n instanceof Un;){var r=Lo(n);r.__index__=0,r.__values__=i,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},Kn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Bn){var t=e;return this.__actions__.length&&(t=new Bn(this)),(t=t.reverse()).__actions__.push({func:ha,args:[ea],thisArg:i}),new Vn(t,this.__chain__)}return this.thru(ea)},Kn.prototype.toJSON=Kn.prototype.valueOf=Kn.prototype.value=function(){return di(this.__wrapped__,this.__actions__)},Kn.prototype.first=Kn.prototype.head,at&&(Kn.prototype[at]=function(){return this}),Kn}();ot._=cn,(r=function(){return cn}.call(t,n,t,e))===i||(e.exports=r)}.call(this)},71608:(e,t,n)=>{var r=n(10848);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},3363:(e,t,n)=>{var r=n(90791),i=n(11143)((function(e,t,n){r(e,t,n)}));e.exports=i},58569:e=>{e.exports=function(){}},47973:(e,t,n)=>{var r=n(91484),i=n(15571),o=n(75374),a=n(35657);e.exports=function(e){return o(e)?r(a(e)):i(e)}},1494:(e,t,n)=>{var r=n(24064),i=n(70896);e.exports=function(e,t){var n=[];if(!e||!e.length)return n;var o=-1,a=[],s=e.length;for(t=r(t,3);++o<s;){var c=e[o];t(c,o,e)&&(n.push(c),a.push(o))}return i(e,a),n}},38819:e=>{e.exports=function(){return[]}},67349:e=>{e.exports=function(){return!1}},6529:(e,t,n)=>{var r=n(33248);e.exports=function(e){return e?1/0===(e=r(e))||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},3506:(e,t,n)=>{var r=n(6529);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},33248:(e,t,n)=>{var r=n(62555),i=n(57458),o=n(5847),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=s.test(e);return n||c.test(e)?l(e.slice(2),n?2:8):a.test(e)?NaN:+e}},95920:(e,t,n)=>{var r=n(98775),i=n(38929);e.exports=function(e){return r(e,i(e))}},40065:(e,t,n)=>{var r=n(84372);e.exports=function(e){return null==e?"":r(e)}},14293:(e,t,n)=>{var r=n(445);e.exports=function(e){return e&&e.length?r(e):[]}},962:(e,t,n)=>{const r=Symbol("SemVer ANY");class i{static get ANY(){return r}constructor(e,t){if(t=o(t),e instanceof i){if(e.loose===!!t.loose)return e;e=e.value}l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===r?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const t=this.options.loose?a[s.COMPARATORLOOSE]:a[s.COMPARATOR],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: ".concat(e));this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new u(n[2],this.options.loose):this.semver=r}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===r||e===r)return!0;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}return c(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof i))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new d(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new d(this.value,t).test(e.semver);const n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),r=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),s=c(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),l=c(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||r||o&&a||s||l}}e.exports=i;const o=n(2102),{re:a,t:s}=n(13857),c=n(47753),l=n(91738),u=n(48457),d=n(84239)},84239:(e,t,n)=>{class r{constructor(e,t){if(t=o(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof a)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(e));if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!y(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&f(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=Object.keys(this.options).join(","),n="parseRange:".concat(t,":").concat(e),r=i.get(n);if(r)return r;const o=this.options.loose,c=o?l[u.HYPHENRANGELOOSE]:l[u.HYPHENRANGE];e=e.replace(c,I(this.options.includePrerelease)),s("hyphen replace",e),e=e.replace(l[u.COMPARATORTRIM],d),s("comparator trim",e);let f=(e=(e=(e=e.replace(l[u.TILDETRIM],p)).replace(l[u.CARETTRIM],h)).split(/\s+/).join(" ")).split(" ").map((e=>m(e,this.options))).join(" ").split(/\s+/).map((e=>O(e,this.options)));o&&(f=f.filter((e=>(s("loose invalid filter",e,this.options),!!e.match(l[u.COMPARATORLOOSE]))))),s("range list",f);const v=new Map,g=f.map((e=>new a(e,this.options)));for(const e of g){if(y(e))return[e];v.set(e.value,e)}v.size>1&&v.has("")&&v.delete("");const S=[...v.values()];return i.set(n,S),S}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some((n=>v(n,t)&&e.set.some((e=>v(e,t)&&n.every((n=>e.every((e=>n.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(M(this.set[t],e,this.options))return!0;return!1}}e.exports=r;const i=new(n(65980))({max:1e3}),o=n(2102),a=n(962),s=n(91738),c=n(48457),{re:l,t:u,comparatorTrimReplace:d,tildeTrimReplace:p,caretTrimReplace:h}=n(13857),y=e=>"<0.0.0-0"===e.value,f=e=>""===e.value,v=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every((e=>i.intersects(e,t))),i=r.pop();return n},m=(e,t)=>(s("comp",e,t),e=P(e,t),s("caret",e),e=S(e,t),s("tildes",e),e=w(e,t),s("xrange",e),e=C(e,t),s("stars",e),e),g=e=>!e||"x"===e.toLowerCase()||"*"===e,S=(e,t)=>e.trim().split(/\s+/).map((e=>b(e,t))).join(" "),b=(e,t)=>{const n=t.loose?l[u.TILDELOOSE]:l[u.TILDE];return e.replace(n,((t,n,r,i,o)=>{let a;return s("tilde",e,t,n,r,i,o),g(n)?a="":g(r)?a=">=".concat(n,".0.0 <").concat(+n+1,".0.0-0"):g(i)?a=">=".concat(n,".").concat(r,".0 <").concat(n,".").concat(+r+1,".0-0"):o?(s("replaceTilde pr",o),a=">=".concat(n,".").concat(r,".").concat(i,"-").concat(o," <").concat(n,".").concat(+r+1,".0-0")):a=">=".concat(n,".").concat(r,".").concat(i," <").concat(n,".").concat(+r+1,".0-0"),s("tilde return",a),a}))},P=(e,t)=>e.trim().split(/\s+/).map((e=>_(e,t))).join(" "),_=(e,t)=>{s("caret",e,t);const n=t.loose?l[u.CARETLOOSE]:l[u.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,((t,n,i,o,a)=>{let c;return s("caret",e,t,n,i,o,a),g(n)?c="":g(i)?c=">=".concat(n,".0.0").concat(r," <").concat(+n+1,".0.0-0"):g(o)?c="0"===n?">=".concat(n,".").concat(i,".0").concat(r," <").concat(n,".").concat(+i+1,".0-0"):">=".concat(n,".").concat(i,".0").concat(r," <").concat(+n+1,".0.0-0"):a?(s("replaceCaret pr",a),c="0"===n?"0"===i?">=".concat(n,".").concat(i,".").concat(o,"-").concat(a," <").concat(n,".").concat(i,".").concat(+o+1,"-0"):">=".concat(n,".").concat(i,".").concat(o,"-").concat(a," <").concat(n,".").concat(+i+1,".0-0"):">=".concat(n,".").concat(i,".").concat(o,"-").concat(a," <").concat(+n+1,".0.0-0")):(s("no pr"),c="0"===n?"0"===i?">=".concat(n,".").concat(i,".").concat(o).concat(r," <").concat(n,".").concat(i,".").concat(+o+1,"-0"):">=".concat(n,".").concat(i,".").concat(o).concat(r," <").concat(n,".").concat(+i+1,".0-0"):">=".concat(n,".").concat(i,".").concat(o," <").concat(+n+1,".0.0-0")),s("caret return",c),c}))},w=(e,t)=>(s("replaceXRanges",e,t),e.split(/\s+/).map((e=>E(e,t))).join(" ")),E=(e,t)=>{e=e.trim();const n=t.loose?l[u.XRANGELOOSE]:l[u.XRANGE];return e.replace(n,((n,r,i,o,a,c)=>{s("xRange",e,n,r,i,o,a,c);const l=g(i),u=l||g(o),d=u||g(a),p=d;return"="===r&&p&&(r=""),c=t.includePrerelease?"-0":"",l?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&p?(u&&(o=0),a=0,">"===r?(r=">=",u?(i=+i+1,o=0,a=0):(o=+o+1,a=0)):"<="===r&&(r="<",u?i=+i+1:o=+o+1),"<"===r&&(c="-0"),n="".concat(r+i,".").concat(o,".").concat(a).concat(c)):u?n=">=".concat(i,".0.0").concat(c," <").concat(+i+1,".0.0-0"):d&&(n=">=".concat(i,".").concat(o,".0").concat(c," <").concat(i,".").concat(+o+1,".0-0")),s("xRange return",n),n}))},C=(e,t)=>(s("replaceStars",e,t),e.trim().replace(l[u.STAR],"")),O=(e,t)=>(s("replaceGTE0",e,t),e.trim().replace(l[t.includePrerelease?u.GTE0PRE:u.GTE0],"")),I=e=>(t,n,r,i,o,a,s,c,l,u,d,p,h)=>(n=g(r)?"":g(i)?">=".concat(r,".0.0").concat(e?"-0":""):g(o)?">=".concat(r,".").concat(i,".0").concat(e?"-0":""):a?">=".concat(n):">=".concat(n).concat(e?"-0":""),c=g(l)?"":g(u)?"<".concat(+l+1,".0.0-0"):g(d)?"<".concat(l,".").concat(+u+1,".0-0"):p?"<=".concat(l,".").concat(u,".").concat(d,"-").concat(p):e?"<".concat(l,".").concat(u,".").concat(+d+1,"-0"):"<=".concat(c),"".concat(n," ").concat(c).trim()),M=(e,t,n)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(s(e[n].semver),e[n].semver!==a.ANY&&e[n].semver.prerelease.length>0){const r=e[n].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0}},48457:(e,t,n)=>{const r=n(91738),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n(43845),{re:a,t:s}=n(13857),c=n(2102),{compareIdentifiers:l}=n(42024);class u{constructor(e,t){if(t=c(t),e instanceof u){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: ".concat(e));if(e.length>i)throw new TypeError("version is longer than ".concat(i," characters"));r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?a[s.LOOSE]:a[s.FULL]);if(!n)throw new TypeError("Invalid Version: ".concat(e));if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof u)){if("string"==typeof e&&e===this.version)return 0;e=new u(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof u||(e=new u(e,this.options)),l(this.major,e.major)||l(this.minor,e.minor)||l(this.patch,e.patch)}comparePre(e){if(e instanceof u||(e=new u(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return l(n,i)}while(++t)}compareBuild(e){e instanceof u||(e=new u(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return l(n,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(0===l(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: ".concat(e))}return this.format(),this.raw=this.version,this}}e.exports=u},83737:(e,t,n)=>{const r=n(86797);e.exports=(e,t)=>{const n=r(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},47753:(e,t,n)=>{const r=n(35115),i=n(10432),o=n(21260),a=n(16902),s=n(39154),c=n(65555);e.exports=(e,t,n,l)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return r(e,n,l);case"!=":return i(e,n,l);case">":return o(e,n,l);case">=":return a(e,n,l);case"<":return s(e,n,l);case"<=":return c(e,n,l);default:throw new TypeError("Invalid operator: ".concat(t))}}},87304:(e,t,n)=>{const r=n(48457),i=n(86797),{re:o,t:a}=n(13857);e.exports=(e,t)=>{if(e instanceof r)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let n=null;if((t=t||{}).rtl){let t;for(;(t=o[a.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&t.index+t[0].length===n.index+n[0].length||(n=t),o[a.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;o[a.COERCERTL].lastIndex=-1}else n=e.match(o[a.COERCE]);return null===n?null:i("".concat(n[2],".").concat(n[3]||"0",".").concat(n[4]||"0"),t)}},52814:(e,t,n)=>{const r=n(48457);e.exports=(e,t,n)=>{const i=new r(e,n),o=new r(t,n);return i.compare(o)||i.compareBuild(o)}},40315:(e,t,n)=>{const r=n(79496);e.exports=(e,t)=>r(e,t,!0)},79496:(e,t,n)=>{const r=n(48457);e.exports=(e,t,n)=>new r(e,n).compare(new r(t,n))},31813:(e,t,n)=>{const r=n(86797),i=n(35115);e.exports=(e,t)=>{if(i(e,t))return null;{const n=r(e),i=r(t),o=n.prerelease.length||i.prerelease.length,a=o?"pre":"",s=o?"prerelease":"";for(const e in n)if(("major"===e||"minor"===e||"patch"===e)&&n[e]!==i[e])return a+e;return s}}},35115:(e,t,n)=>{const r=n(79496);e.exports=(e,t,n)=>0===r(e,t,n)},21260:(e,t,n)=>{const r=n(79496);e.exports=(e,t,n)=>r(e,t,n)>0},16902:(e,t,n)=>{const r=n(79496);e.exports=(e,t,n)=>r(e,t,n)>=0},79098:(e,t,n)=>{const r=n(48457);e.exports=(e,t,n,i)=>{"string"==typeof n&&(i=n,n=void 0);try{return new r(e instanceof r?e.version:e,n).inc(t,i).version}catch(e){return null}}},39154:(e,t,n)=>{const r=n(79496);e.exports=(e,t,n)=>r(e,t,n)<0},65555:(e,t,n)=>{const r=n(79496);e.exports=(e,t,n)=>r(e,t,n)<=0},91741:(e,t,n)=>{const r=n(48457);e.exports=(e,t)=>new r(e,t).major},62458:(e,t,n)=>{const r=n(48457);e.exports=(e,t)=>new r(e,t).minor},10432:(e,t,n)=>{const r=n(79496);e.exports=(e,t,n)=>0!==r(e,t,n)},86797:(e,t,n)=>{const{MAX_LENGTH:r}=n(43845),{re:i,t:o}=n(13857),a=n(48457),s=n(2102);e.exports=(e,t)=>{if(t=s(t),e instanceof a)return e;if("string"!=typeof e)return null;if(e.length>r)return null;if(!(t.loose?i[o.LOOSE]:i[o.FULL]).test(e))return null;try{return new a(e,t)}catch(e){return null}}},50155:(e,t,n)=>{const r=n(48457);e.exports=(e,t)=>new r(e,t).patch},88243:(e,t,n)=>{const r=n(86797);e.exports=(e,t)=>{const n=r(e,t);return n&&n.prerelease.length?n.prerelease:null}},41383:(e,t,n)=>{const r=n(79496);e.exports=(e,t,n)=>r(t,e,n)},69664:(e,t,n)=>{const r=n(52814);e.exports=(e,t)=>e.sort(((e,n)=>r(n,e,t)))},35097:(e,t,n)=>{const r=n(84239);e.exports=(e,t,n)=>{try{t=new r(t,n)}catch(e){return!1}return t.test(e)}},66585:(e,t,n)=>{const r=n(52814);e.exports=(e,t)=>e.sort(((e,n)=>r(e,n,t)))},71294:(e,t,n)=>{const r=n(86797);e.exports=(e,t)=>{const n=r(e,t);return n?n.version:null}},21503:(e,t,n)=>{const r=n(13857),i=n(43845),o=n(48457),a=n(42024),s=n(86797),c=n(71294),l=n(83737),u=n(79098),d=n(31813),p=n(91741),h=n(62458),y=n(50155),f=n(88243),v=n(79496),m=n(41383),g=n(40315),S=n(52814),b=n(66585),P=n(69664),_=n(21260),w=n(39154),E=n(35115),C=n(10432),O=n(16902),I=n(65555),M=n(47753),A=n(87304),T=n(962),k=n(84239),D=n(35097),R=n(39938),N=n(35841),F=n(98719),x=n(68664),j=n(85036),K=n(52614),L=n(65829),U=n(41937),V=n(90744),B=n(96559),W=n(45307);e.exports={parse:s,valid:c,clean:l,inc:u,diff:d,major:p,minor:h,patch:y,prerelease:f,compare:v,rcompare:m,compareLoose:g,compareBuild:S,sort:b,rsort:P,gt:_,lt:w,eq:E,neq:C,gte:O,lte:I,cmp:M,coerce:A,Comparator:T,Range:k,satisfies:D,toComparators:R,maxSatisfying:N,minSatisfying:F,minVersion:x,validRange:j,outside:K,gtr:L,ltr:U,intersects:V,simplifyRange:B,subset:W,SemVer:o,re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,compareIdentifiers:a.compareIdentifiers,rcompareIdentifiers:a.rcompareIdentifiers}},43845:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:t,MAX_SAFE_COMPONENT_LENGTH:16}},91738:e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.error("SEMVER",...t)}:()=>{};e.exports=t},42024:e=>{const t=/^[0-9]+$/,n=(e,n)=>{const r=t.test(e),i=t.test(n);return r&&i&&(e=+e,n=+n),e===n?0:r&&!i?-1:i&&!r?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},2102:e=>{const t=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:t.filter((t=>e[t])).reduce(((e,t)=>(e[t]=!0,e)),{}):{}},13857:(e,t,n)=>{const{MAX_SAFE_COMPONENT_LENGTH:r}=n(43845),i=n(91738),o=(t=e.exports={}).re=[],a=t.src=[],s=t.t={};let c=0;const l=(e,t,n)=>{const r=c++;i(e,r,t),s[e]=r,a[r]=t,o[r]=new RegExp(t,n?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","[0-9]+"),l("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),l("MAINVERSION","(".concat(a[s.NUMERICIDENTIFIER],")\\.")+"(".concat(a[s.NUMERICIDENTIFIER],")\\.")+"(".concat(a[s.NUMERICIDENTIFIER],")")),l("MAINVERSIONLOOSE","(".concat(a[s.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(a[s.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(a[s.NUMERICIDENTIFIERLOOSE],")")),l("PRERELEASEIDENTIFIER","(?:".concat(a[s.NUMERICIDENTIFIER],"|").concat(a[s.NONNUMERICIDENTIFIER],")")),l("PRERELEASEIDENTIFIERLOOSE","(?:".concat(a[s.NUMERICIDENTIFIERLOOSE],"|").concat(a[s.NONNUMERICIDENTIFIER],")")),l("PRERELEASE","(?:-(".concat(a[s.PRERELEASEIDENTIFIER],"(?:\\.").concat(a[s.PRERELEASEIDENTIFIER],")*))")),l("PRERELEASELOOSE","(?:-?(".concat(a[s.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(a[s.PRERELEASEIDENTIFIERLOOSE],")*))")),l("BUILDIDENTIFIER","[0-9A-Za-z-]+"),l("BUILD","(?:\\+(".concat(a[s.BUILDIDENTIFIER],"(?:\\.").concat(a[s.BUILDIDENTIFIER],")*))")),l("FULLPLAIN","v?".concat(a[s.MAINVERSION]).concat(a[s.PRERELEASE],"?").concat(a[s.BUILD],"?")),l("FULL","^".concat(a[s.FULLPLAIN],"$")),l("LOOSEPLAIN","[v=\\s]*".concat(a[s.MAINVERSIONLOOSE]).concat(a[s.PRERELEASELOOSE],"?").concat(a[s.BUILD],"?")),l("LOOSE","^".concat(a[s.LOOSEPLAIN],"$")),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE","".concat(a[s.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),l("XRANGEIDENTIFIER","".concat(a[s.NUMERICIDENTIFIER],"|x|X|\\*")),l("XRANGEPLAIN","[v=\\s]*(".concat(a[s.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(a[s.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(a[s.XRANGEIDENTIFIER],")")+"(?:".concat(a[s.PRERELEASE],")?").concat(a[s.BUILD],"?")+")?)?"),l("XRANGEPLAINLOOSE","[v=\\s]*(".concat(a[s.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(a[s.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(a[s.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(a[s.PRERELEASELOOSE],")?").concat(a[s.BUILD],"?")+")?)?"),l("XRANGE","^".concat(a[s.GTLT],"\\s*").concat(a[s.XRANGEPLAIN],"$")),l("XRANGELOOSE","^".concat(a[s.GTLT],"\\s*").concat(a[s.XRANGEPLAINLOOSE],"$")),l("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(r,"})")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:$|[^\\d])"),l("COERCERTL",a[s.COERCE],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM","(\\s*)".concat(a[s.LONETILDE],"\\s+"),!0),t.tildeTrimReplace="$1~",l("TILDE","^".concat(a[s.LONETILDE]).concat(a[s.XRANGEPLAIN],"$")),l("TILDELOOSE","^".concat(a[s.LONETILDE]).concat(a[s.XRANGEPLAINLOOSE],"$")),l("LONECARET","(?:\\^)"),l("CARETTRIM","(\\s*)".concat(a[s.LONECARET],"\\s+"),!0),t.caretTrimReplace="$1^",l("CARET","^".concat(a[s.LONECARET]).concat(a[s.XRANGEPLAIN],"$")),l("CARETLOOSE","^".concat(a[s.LONECARET]).concat(a[s.XRANGEPLAINLOOSE],"$")),l("COMPARATORLOOSE","^".concat(a[s.GTLT],"\\s*(").concat(a[s.LOOSEPLAIN],")$|^$")),l("COMPARATOR","^".concat(a[s.GTLT],"\\s*(").concat(a[s.FULLPLAIN],")$|^$")),l("COMPARATORTRIM","(\\s*)".concat(a[s.GTLT],"\\s*(").concat(a[s.LOOSEPLAIN],"|").concat(a[s.XRANGEPLAIN],")"),!0),t.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE","^\\s*(".concat(a[s.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(a[s.XRANGEPLAIN],")")+"\\s*$"),l("HYPHENRANGELOOSE","^\\s*(".concat(a[s.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(a[s.XRANGEPLAINLOOSE],")")+"\\s*$"),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},65980:(e,t,n)=>{const r=n(26493),i=Symbol("max"),o=Symbol("length"),a=Symbol("lengthCalculator"),s=Symbol("allowStale"),c=Symbol("maxAge"),l=Symbol("dispose"),u=Symbol("noDisposeOnSet"),d=Symbol("lruList"),p=Symbol("cache"),h=Symbol("updateAgeOnGet"),y=()=>1,f=(e,t,n)=>{const r=e[p].get(t);if(r){const t=r.value;if(v(e,t)){if(g(e,r),!e[s])return}else n&&(e[h]&&(r.value.now=Date.now()),e[d].unshiftNode(r));return t.value}},v=(e,t)=>{if(!t||!t.maxAge&&!e[c])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[c]&&n>e[c]},m=e=>{if(e[o]>e[i])for(let t=e[d].tail;e[o]>e[i]&&null!==t;){const n=t.prev;g(e,t),t=n}},g=(e,t)=>{if(t){const n=t.value;e[l]&&e[l](n.key,n.value),e[o]-=n.length,e[p].delete(n.key),e[d].removeNode(t)}};class S{constructor(e,t,n,r,i){this.key=e,this.value=t,this.length=n,this.now=r,this.maxAge=i||0}}const b=(e,t,n,r)=>{let i=n.value;v(e,i)&&(g(e,n),e[s]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};e.exports=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[i]=e.max||1/0;const t=e.length||y;if(this[a]="function"!=typeof t?y:t,this[s]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[c]=e.maxAge||0,this[l]=e.dispose,this[u]=e.noDisposeOnSet||!1,this[h]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i]=e||1/0,m(this)}get max(){return this[i]}set allowStale(e){this[s]=!!e}get allowStale(){return this[s]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[c]=e,m(this)}get maxAge(){return this[c]}set lengthCalculator(e){"function"!=typeof e&&(e=y),e!==this[a]&&(this[a]=e,this[o]=0,this[d].forEach((e=>{e.length=this[a](e.value,e.key),this[o]+=e.length}))),m(this)}get lengthCalculator(){return this[a]}get length(){return this[o]}get itemCount(){return this[d].length}rforEach(e,t){t=t||this;for(let n=this[d].tail;null!==n;){const r=n.prev;b(this,e,n,t),n=r}}forEach(e,t){t=t||this;for(let n=this[d].head;null!==n;){const r=n.next;b(this,e,n,t),n=r}}keys(){return this[d].toArray().map((e=>e.key))}values(){return this[d].toArray().map((e=>e.value))}reset(){this[l]&&this[d]&&this[d].length&&this[d].forEach((e=>this[l](e.key,e.value))),this[p]=new Map,this[d]=new r,this[o]=0}dump(){return this[d].map((e=>!v(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[d]}set(e,t,n){if((n=n||this[c])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,s=this[a](t,e);if(this[p].has(e)){if(s>this[i])return g(this,this[p].get(e)),!1;const a=this[p].get(e).value;return this[l]&&(this[u]||this[l](e,a.value)),a.now=r,a.maxAge=n,a.value=t,this[o]+=s-a.length,a.length=s,this.get(e),m(this),!0}const h=new S(e,t,s,r,n);return h.length>this[i]?(this[l]&&this[l](e,t),!1):(this[o]+=h.length,this[d].unshift(h),this[p].set(e,this[d].head),m(this),!0)}has(e){if(!this[p].has(e))return!1;const t=this[p].get(e).value;return!v(this,t)}get(e){return f(this,e,!0)}peek(e){return f(this,e,!1)}pop(){const e=this[d].tail;return e?(g(this,e),e.value):null}del(e){g(this,this[p].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const r=e[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const e=i-t;e>0&&this.set(r.k,r.v,e)}}}prune(){this[p].forEach(((e,t)=>f(this,t,!1)))}}},65829:(e,t,n)=>{const r=n(52614);e.exports=(e,t,n)=>r(e,t,">",n)},90744:(e,t,n)=>{const r=n(84239);e.exports=(e,t,n)=>(e=new r(e,n),t=new r(t,n),e.intersects(t))},41937:(e,t,n)=>{const r=n(52614);e.exports=(e,t,n)=>r(e,t,"<",n)},35841:(e,t,n)=>{const r=n(48457),i=n(84239);e.exports=(e,t,n)=>{let o=null,a=null,s=null;try{s=new i(t,n)}catch(e){return null}return e.forEach((e=>{s.test(e)&&(o&&-1!==a.compare(e)||(o=e,a=new r(o,n)))})),o}},98719:(e,t,n)=>{const r=n(48457),i=n(84239);e.exports=(e,t,n)=>{let o=null,a=null,s=null;try{s=new i(t,n)}catch(e){return null}return e.forEach((e=>{s.test(e)&&(o&&1!==a.compare(e)||(o=e,a=new r(o,n)))})),o}},68664:(e,t,n)=>{const r=n(48457),i=n(84239),o=n(21260);e.exports=(e,t)=>{e=new i(e,t);let n=new r("0.0.0");if(e.test(n))return n;if(n=new r("0.0.0-0"),e.test(n))return n;n=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let a=null;i.forEach((e=>{const t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":a&&!o(t,a)||(a=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: ".concat(e.operator))}})),!a||n&&!o(n,a)||(n=a)}return n&&e.test(n)?n:null}},52614:(e,t,n)=>{const r=n(48457),i=n(962),{ANY:o}=i,a=n(84239),s=n(35097),c=n(21260),l=n(39154),u=n(65555),d=n(16902);e.exports=(e,t,n,p)=>{let h,y,f,v,m;switch(e=new r(e,p),t=new a(t,p),n){case">":h=c,y=u,f=l,v=">",m=">=";break;case"<":h=l,y=d,f=c,v="<",m="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(e,t,p))return!1;for(let n=0;n<t.set.length;++n){const r=t.set[n];let a=null,s=null;if(r.forEach((e=>{e.semver===o&&(e=new i(">=0.0.0")),a=a||e,s=s||e,h(e.semver,a.semver,p)?a=e:f(e.semver,s.semver,p)&&(s=e)})),a.operator===v||a.operator===m)return!1;if((!s.operator||s.operator===v)&&y(e,s.semver))return!1;if(s.operator===m&&f(e,s.semver))return!1}return!0}},96559:(e,t,n)=>{const r=n(35097),i=n(79496);e.exports=(e,t,n)=>{const o=[];let a=null,s=null;const c=e.sort(((e,t)=>i(e,t,n)));for(const e of c)r(e,t,n)?(s=e,a||(a=e)):(s&&o.push([a,s]),s=null,a=null);a&&o.push([a,null]);const l=[];for(const[e,t]of o)e===t?l.push(e):t||e!==c[0]?t?e===c[0]?l.push("<=".concat(t)):l.push("".concat(e," - ").concat(t)):l.push(">=".concat(e)):l.push("*");const u=l.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},45307:(e,t,n)=>{const r=n(84239),i=n(962),{ANY:o}=i,a=n(35097),s=n(79496),c=(e,t,n)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===o){if(1===t.length&&t[0].semver===o)return!0;e=n.includePrerelease?[new i(">=0.0.0-0")]:[new i(">=0.0.0")]}if(1===t.length&&t[0].semver===o){if(n.includePrerelease)return!0;t=[new i(">=0.0.0")]}const r=new Set;let c,d,p,h,y,f,v;for(const t of e)">"===t.operator||">="===t.operator?c=l(c,t,n):"<"===t.operator||"<="===t.operator?d=u(d,t,n):r.add(t.semver);if(r.size>1)return null;if(c&&d){if(p=s(c.semver,d.semver,n),p>0)return null;if(0===p&&(">="!==c.operator||"<="!==d.operator))return null}for(const e of r){if(c&&!a(e,String(c),n))return null;if(d&&!a(e,String(d),n))return null;for(const r of t)if(!a(e,String(r),n))return!1;return!0}let m=!(!d||n.includePrerelease||!d.semver.prerelease.length)&&d.semver,g=!(!c||n.includePrerelease||!c.semver.prerelease.length)&&c.semver;m&&1===m.prerelease.length&&"<"===d.operator&&0===m.prerelease[0]&&(m=!1);for(const e of t){if(v=v||">"===e.operator||">="===e.operator,f=f||"<"===e.operator||"<="===e.operator,c)if(g&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===g.major&&e.semver.minor===g.minor&&e.semver.patch===g.patch&&(g=!1),">"===e.operator||">="===e.operator){if(h=l(c,e,n),h===e&&h!==c)return!1}else if(">="===c.operator&&!a(c.semver,String(e),n))return!1;if(d)if(m&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===m.major&&e.semver.minor===m.minor&&e.semver.patch===m.patch&&(m=!1),"<"===e.operator||"<="===e.operator){if(y=u(d,e,n),y===e&&y!==d)return!1}else if("<="===d.operator&&!a(d.semver,String(e),n))return!1;if(!e.operator&&(d||c)&&0!==p)return!1}return!(c&&f&&!d&&0!==p||d&&v&&!c&&0!==p||g||m)},l=(e,t,n)=>{if(!e)return t;const r=s(e.semver,t.semver,n);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},u=(e,t,n)=>{if(!e)return t;const r=s(e.semver,t.semver,n);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===t)return!0;e=new r(e,n),t=new r(t,n);let i=!1;e:for(const r of e.set){for(const e of t.set){const t=c(r,e,n);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},39938:(e,t,n)=>{const r=n(84239);e.exports=(e,t)=>new r(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},85036:(e,t,n)=>{const r=n(84239);e.exports=(e,t)=>{try{return new r(e,t).range||"*"}catch(e){return null}}},10784:e=>{e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},26493:(e,t,n)=>{function r(e){var t=this;if(t instanceof r||(t=new r),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}function i(e,t,n){var r=t===e.head?new s(n,null,t,e):new s(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function o(e,t){e.tail=new s(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function a(e,t){e.head=new s(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function s(e,t,n,r){if(!(this instanceof s))return new s(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}e.exports=r,r.Node=s,r.create=r,r.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},r.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},r.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},r.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},r.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)a(this,arguments[e]);return this.length},r.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},r.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},r.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},r.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},r.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},r.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},r.prototype.map=function(e,t){t=t||this;for(var n=new r,i=this.head;null!==i;)n.push(e.call(t,i.value,this)),i=i.next;return n},r.prototype.mapReverse=function(e,t){t=t||this;for(var n=new r,i=this.tail;null!==i;)n.push(e.call(t,i.value,this)),i=i.prev;return n},r.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=e(n,r.value,i),r=r.next;return n},r.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=e(n,r.value,i),r=r.prev;return n},r.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},r.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},r.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,o=this.head;null!==o&&i<e;i++)o=o.next;for(;null!==o&&i<t;i++,o=o.next)n.push(o.value);return n},r.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,o=this.tail;null!==o&&i>t;i--)o=o.prev;for(;null!==o&&i>e;i--,o=o.prev)n.push(o.value);return n},r.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,r=this.head;null!==r&&n<e;n++)r=r.next;var o=[];for(n=0;r&&n<t;n++)o.push(r.value),r=this.removeNode(r);for(null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev),n=0;n<(arguments.length<=2?0:arguments.length-2);n++)r=i(this,r,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return o},r.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{n(10784)(r)}catch(e){}},9731:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ApiVersion=void 0,(t.ApiVersion||(t.ApiVersion={})).v0="20200115"},77415:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(9731),t)},58604:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptionApiOperations=void 0,(n=t.SubscriptionApiOperations||(t.SubscriptionApiOperations={}))[n.Inviting=0]="Inviting",n[n.CancelingInvite=1]="CancelingInvite",n[n.ListingInvites=2]="ListingInvites",n[n.AcceptingInvite=3]="AcceptingInvite"},88154:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptionApiService=void 0;const i=n(11039),o=n(87211),a=n(9731),s=n(72301),c=n(58604);t.SubscriptionApiService=class{constructor(e){this.subscriptionServer=e,this.operationsInProgress=new Map}listInvites(){return r(this,void 0,void 0,(function*(){if(this.operationsInProgress.get(c.SubscriptionApiOperations.ListingInvites))throw new o.ApiCallError(i.ErrorMessage.GenericInProgress);this.operationsInProgress.set(c.SubscriptionApiOperations.ListingInvites,!0);try{const e=yield this.subscriptionServer.listInvites({[s.ApiEndpointParam.ApiVersion]:a.ApiVersion.v0});return this.operationsInProgress.set(c.SubscriptionApiOperations.ListingInvites,!1),e}catch(e){throw new o.ApiCallError(i.ErrorMessage.GenericFail)}}))}cancelInvite(e){return r(this,void 0,void 0,(function*(){if(this.operationsInProgress.get(c.SubscriptionApiOperations.CancelingInvite))throw new o.ApiCallError(i.ErrorMessage.GenericInProgress);this.operationsInProgress.set(c.SubscriptionApiOperations.CancelingInvite,!0);try{const t=yield this.subscriptionServer.cancelInvite({[s.ApiEndpointParam.ApiVersion]:a.ApiVersion.v0,inviteUuid:e});return this.operationsInProgress.set(c.SubscriptionApiOperations.CancelingInvite,!1),t}catch(e){throw new o.ApiCallError(i.ErrorMessage.GenericFail)}}))}invite(e){return r(this,void 0,void 0,(function*(){if(this.operationsInProgress.get(c.SubscriptionApiOperations.Inviting))throw new o.ApiCallError(i.ErrorMessage.GenericInProgress);this.operationsInProgress.set(c.SubscriptionApiOperations.Inviting,!0);try{const t=yield this.subscriptionServer.invite({[s.ApiEndpointParam.ApiVersion]:a.ApiVersion.v0,identifier:e});return this.operationsInProgress.set(c.SubscriptionApiOperations.Inviting,!1),t}catch(e){throw new o.ApiCallError(i.ErrorMessage.GenericFail)}}))}acceptInvite(e){return r(this,void 0,void 0,(function*(){if(this.operationsInProgress.get(c.SubscriptionApiOperations.AcceptingInvite))throw new o.ApiCallError(i.ErrorMessage.GenericInProgress);this.operationsInProgress.set(c.SubscriptionApiOperations.AcceptingInvite,!0);try{const t=yield this.subscriptionServer.acceptInvite({inviteUuid:e});return this.operationsInProgress.set(c.SubscriptionApiOperations.AcceptingInvite,!1),t}catch(e){throw new o.ApiCallError(i.ErrorMessage.GenericFail)}}))}}},82045:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},44952:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.UserApiOperations=void 0,(n=t.UserApiOperations||(t.UserApiOperations={}))[n.Registering=0]="Registering",n[n.SubmittingRequest=1]="SubmittingRequest",n[n.DeletingAccount=2]="DeletingAccount"},93980:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UserApiService=void 0;const i=n(11039),o=n(87211),a=n(9731),s=n(72301),c=n(44952);t.UserApiService=class{constructor(e,t){this.userServer=e,this.userRequestServer=t,this.operationsInProgress=new Map}deleteAccount(e){return r(this,void 0,void 0,(function*(){this.lockOperation(c.UserApiOperations.DeletingAccount);try{const t=yield this.userServer.deleteAccount({userUuid:e});return this.unlockOperation(c.UserApiOperations.DeletingAccount),t}catch(e){throw new o.ApiCallError(i.ErrorMessage.GenericRegistrationFail)}}))}submitUserRequest(e){return r(this,void 0,void 0,(function*(){this.lockOperation(c.UserApiOperations.SubmittingRequest);try{const t=yield this.userRequestServer.submitUserRequest({userUuid:e.userUuid,requestType:e.requestType});return this.unlockOperation(c.UserApiOperations.SubmittingRequest),t}catch(e){throw new o.ApiCallError(i.ErrorMessage.GenericRegistrationFail)}}))}register(e){return r(this,void 0,void 0,(function*(){this.lockOperation(c.UserApiOperations.Registering);try{const t=yield this.userServer.register(Object.assign({[s.ApiEndpointParam.ApiVersion]:a.ApiVersion.v0,password:e.serverPassword,email:e.email,ephemeral:e.ephemeral},e.keyParams.getPortableValue()));return this.unlockOperation(c.UserApiOperations.Registering),t}catch(e){throw new o.ApiCallError(i.ErrorMessage.GenericRegistrationFail)}}))}lockOperation(e){if(this.operationsInProgress.get(e))throw new o.ApiCallError(i.ErrorMessage.GenericInProgress);this.operationsInProgress.set(e,!0)}unlockOperation(e){this.operationsInProgress.set(e,!1)}}},60790:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},92089:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketApiOperations=void 0,(n=t.WebSocketApiOperations||(t.WebSocketApiOperations={}))[n.CreatingConnectionToken=0]="CreatingConnectionToken"},15846:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketApiService=void 0;const i=n(11039),o=n(87211),a=n(92089);t.WebSocketApiService=class{constructor(e){this.webSocketServer=e,this.operationsInProgress=new Map}createConnectionToken(){return r(this,void 0,void 0,(function*(){if(this.operationsInProgress.get(a.WebSocketApiOperations.CreatingConnectionToken))throw new o.ApiCallError(i.ErrorMessage.GenericInProgress);this.operationsInProgress.set(a.WebSocketApiOperations.CreatingConnectionToken,!0);try{const e=yield this.webSocketServer.createConnectionToken({});return this.operationsInProgress.set(a.WebSocketApiOperations.CreatingConnectionToken,!1),e}catch(e){throw new o.ApiCallError(i.ErrorMessage.GenericFail)}}))}}},58714:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},90971:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceApiOperations=void 0,(n=t.WorkspaceApiOperations||(t.WorkspaceApiOperations={}))[n.Creating=0]="Creating",n[n.Inviting=1]="Inviting",n[n.Accepting=2]="Accepting",n[n.ListingWorkspaces=3]="ListingWorkspaces",n[n.ListingWorkspaceUsers=4]="ListingWorkspaceUsers",n[n.InitiatingKeyshare=5]="InitiatingKeyshare"},75542:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceApiService=void 0;const i=n(11039),o=n(87211),a=n(90971);t.WorkspaceApiService=class{constructor(e){this.workspaceServer=e,this.operationsInProgress=new Map}initiateKeyshare(e){return r(this,void 0,void 0,(function*(){this.lockOperation(a.WorkspaceApiOperations.InitiatingKeyshare);try{const t=yield this.workspaceServer.initiateKeyshare({workspaceUuid:e.workspaceUuid,userUuid:e.userUuid,encryptedWorkspaceKey:e.encryptedWorkspaceKey});return this.unlockOperation(a.WorkspaceApiOperations.InitiatingKeyshare),t}catch(e){throw new o.ApiCallError(i.ErrorMessage.GenericFail)}}))}listWorkspaceUsers(e){return r(this,void 0,void 0,(function*(){this.lockOperation(a.WorkspaceApiOperations.ListingWorkspaceUsers);try{const t=yield this.workspaceServer.listWorkspaceUsers({workspaceUuid:e.workspaceUuid});return this.unlockOperation(a.WorkspaceApiOperations.ListingWorkspaceUsers),t}catch(e){throw new o.ApiCallError(i.ErrorMessage.GenericFail)}}))}listWorkspaces(){return r(this,void 0,void 0,(function*(){this.lockOperation(a.WorkspaceApiOperations.ListingWorkspaces);try{const e=yield this.workspaceServer.listWorkspaces({});return this.unlockOperation(a.WorkspaceApiOperations.ListingWorkspaces),e}catch(e){throw new o.ApiCallError(i.ErrorMessage.GenericFail)}}))}acceptInvite(e){return r(this,void 0,void 0,(function*(){this.lockOperation(a.WorkspaceApiOperations.Accepting);try{const t=yield this.workspaceServer.acceptInvite({encryptedPrivateKey:e.encryptedPrivateKey,publicKey:e.publicKey,inviteUuid:e.inviteUuid,userUuid:e.userUuid});return this.unlockOperation(a.WorkspaceApiOperations.Accepting),t}catch(e){throw new o.ApiCallError(i.ErrorMessage.GenericFail)}}))}inviteToWorkspace(e){return r(this,void 0,void 0,(function*(){this.lockOperation(a.WorkspaceApiOperations.Inviting);try{const t=yield this.workspaceServer.inviteToWorkspace({inviteeEmail:e.inviteeEmail,workspaceUuid:e.workspaceUuid,accessLevel:e.accessLevel});return this.unlockOperation(a.WorkspaceApiOperations.Inviting),t}catch(e){throw new o.ApiCallError(i.ErrorMessage.GenericFail)}}))}createWorkspace(e){return r(this,void 0,void 0,(function*(){this.lockOperation(a.WorkspaceApiOperations.Creating);try{const t=yield this.workspaceServer.createWorkspace({workspaceType:e.workspaceType,encryptedPrivateKey:e.encryptedPrivateKey,encryptedWorkspaceKey:e.encryptedWorkspaceKey,publicKey:e.publicKey,workspaceName:e.workspaceName});return this.unlockOperation(a.WorkspaceApiOperations.Creating),t}catch(e){throw new o.ApiCallError(i.ErrorMessage.GenericFail)}}))}lockOperation(e){if(this.operationsInProgress.get(e))throw new o.ApiCallError(i.ErrorMessage.GenericInProgress);this.operationsInProgress.set(e,!0)}unlockOperation(e){this.operationsInProgress.set(e,!1)}}},46075:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},26636:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(58604),t),i(n(88154),t),i(n(82045),t),i(n(44952),t),i(n(93980),t),i(n(60790),t),i(n(15846),t),i(n(58714),t),i(n(75542),t),i(n(46075),t)},87211:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ApiCallError=void 0;class n extends Error{constructor(e){super(e),Object.setPrototypeOf(this,n.prototype)}}t.ApiCallError=n},11039:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorMessage=void 0,(n=t.ErrorMessage||(t.ErrorMessage={})).RegistrationInProgress="An existing registration request is already in progress.",n.GenericRegistrationFail="A server error occurred while trying to register. Please try again.",n.RateLimited="Too many successive server requests. Please wait a few minutes and try again.",n.InsufficientPasswordMessage="Your password must be at least %LENGTH% characters in length. For your security, please choose a longer password or, ideally, a passphrase, and try again.",n.PasscodeRequired="Your passcode is required in order to register for an account.",n.GenericInProgress="An existing request is already in progress.",n.GenericFail="A server error occurred. Please try again."},88994:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(87211),t),i(n(11039),t)},64607:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorTag=void 0,(n=t.ErrorTag||(t.ErrorTag={})).MfaInvalid="mfa-invalid",n.MfaRequired="mfa-required",n.RefreshTokenInvalid="invalid-refresh-token",n.RefreshTokenExpired="expired-refresh-token",n.AccessTokenExpired="expired-access-token",n.ParametersInvalid="invalid-parameters",n.RevokedSession="revoked-session",n.AuthInvalid="invalid-auth",n.ReadOnlyAccess="read-only-access"},43394:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},66089:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},75340:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7612:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},61392:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},25469:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},71914:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},93125:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.HttpService=void 0;const i=n(64657),o=n(16418),a=n(90510),s=n(50484),c=n(76098),l=n(11039);t.HttpService=class{constructor(e,t,n,r,i){this.environment=e,this.appVersion=t,this.snjsVersion=n,this.host=r,this.updateMetaCallback=i}setAuthorizationToken(e){this.authorizationToken=e}setHost(e){this.host=e}get(e,t,n){return r(this,void 0,void 0,(function*(){return this.runHttp({url:(0,i.joinPaths)(this.host,e),params:t,verb:a.HttpVerb.Get,authentication:null!=n?n:this.authorizationToken})}))}post(e,t,n){return r(this,void 0,void 0,(function*(){return this.runHttp({url:(0,i.joinPaths)(this.host,e),params:t,verb:a.HttpVerb.Post,authentication:null!=n?n:this.authorizationToken})}))}put(e,t,n){return r(this,void 0,void 0,(function*(){return this.runHttp({url:(0,i.joinPaths)(this.host,e),params:t,verb:a.HttpVerb.Put,authentication:null!=n?n:this.authorizationToken})}))}patch(e,t,n){return r(this,void 0,void 0,(function*(){return this.runHttp({url:(0,i.joinPaths)(this.host,e),params:t,verb:a.HttpVerb.Patch,authentication:null!=n?n:this.authorizationToken})}))}delete(e,t,n){return r(this,void 0,void 0,(function*(){return this.runHttp({url:(0,i.joinPaths)(this.host,e),params:t,verb:a.HttpVerb.Delete,authentication:null!=n?n:this.authorizationToken})}))}runHttp(e){return r(this,void 0,void 0,(function*(){const t=this.createXmlRequest(e),n=yield this.runRequest(t,this.createRequestBody(e));return n.meta&&this.updateMetaCallback(n.meta),n}))}createRequestBody(e){return void 0!==e.params&&[a.HttpVerb.Post,a.HttpVerb.Put,a.HttpVerb.Patch,a.HttpVerb.Delete].includes(e.verb)?JSON.stringify(e.params):e.rawBytes}createXmlRequest(e){var t;const n=new XMLHttpRequest;if(e.params&&e.verb===a.HttpVerb.Get&&Object.keys(e.params).length>0&&(e.url=this.urlForUrlAndParams(e.url,e.params)),n.open(e.verb,e.url,!0),n.responseType=null!==(t=e.responseType)&&void 0!==t?t:"",!e.external){n.setRequestHeader("X-SNJS-Version",this.snjsVersion);const t="".concat(o.Environment[this.environment],"-").concat(this.appVersion);n.setRequestHeader("X-Application-Version",t),e.authentication&&n.setRequestHeader("Authorization","Bearer "+e.authentication)}let r=!1;return e.customHeaders&&e.customHeaders.length>0&&e.customHeaders.forEach((e=>{let{key:t,value:i}=e;n.setRequestHeader(t,i),"Content-Type"===t&&(r=!0)})),r||e.external||n.setRequestHeader("Content-Type","application/json"),n}runRequest(e,t){return r(this,void 0,void 0,(function*(){return new Promise(((n,r)=>{e.onreadystatechange=()=>{this.stateChangeHandlerForRequest(e,n,r)},e.send(t)}))}))}stateChangeHandlerForRequest(e,t,n){var r,o,a;if(e.readyState!==c.XMLHttpRequestState.Completed)return;const u=e.status,d={status:u,headers:new Map},p=null===(r=e.getAllResponseHeaders())||void 0===r?void 0:r.trim().split(/[\r\n]+/);null==p||p.forEach((e=>{const t=e.split(": "),n=t.shift(),r=t.join(": ");d.headers.set(n,r)}));try{if(u!==s.HttpStatusCode.NoContent){let t;const n=(null===(o=d.headers)||void 0===o?void 0:o.get("content-type"))||(null===(a=d.headers)||void 0===a?void 0:a.get("Content-Type"));t=(null==n?void 0:n.includes("application/json"))?JSON.parse(e.responseText):e.response,t.data||(d.data=t),(0,i.isString)(t)||Object.assign(d,t)}}catch(e){console.error(e)}u>=s.HttpStatusCode.Success&&u<s.HttpStatusCode.MultipleChoices?t(d):(u===s.HttpStatusCode.Forbidden&&d.data&&void 0!==d.data.error&&(d.data.error.message=l.ErrorMessage.RateLimited),n(d))}urlForUrlAndParams(e,t){const n=Object.keys(t).map((e=>e+"="+encodeURIComponent(t[e]))).join("&");return e.includes("?")?e+"&"+n:e+"?"+n}}},78266:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},50484:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.HttpStatusCode=void 0,(n=t.HttpStatusCode||(t.HttpStatusCode={}))[n.Success=200]="Success",n[n.NoContent=204]="NoContent",n[n.MultipleChoices=300]="MultipleChoices",n[n.BadRequest=400]="BadRequest",n[n.Unauthorized=401]="Unauthorized",n[n.Forbidden=403]="Forbidden",n[n.Gone=410]="Gone",n[n.ExpiredAccessToken=498]="ExpiredAccessToken"},90510:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.HttpVerb=void 0,(n=t.HttpVerb||(t.HttpVerb={})).Get="GET",n.Post="POST",n.Put="PUT",n.Patch="PATCH",n.Delete="DELETE"},76098:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.XMLHttpRequestState=void 0,(n=t.XMLHttpRequestState||(t.XMLHttpRequestState={}))[n.Completed=4]="Completed"},19854:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(64607),t),i(n(43394),t),i(n(66089),t),i(n(75340),t),i(n(7612),t),i(n(61392),t),i(n(25469),t),i(n(71914),t),i(n(93125),t),i(n(78266),t),i(n(50484),t),i(n(90510),t),i(n(76098),t)},72301:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ApiEndpointParam=void 0,(n=t.ApiEndpointParam||(t.ApiEndpointParam={})).LastSyncToken="sync_token",n.PaginationToken="cursor_token",n.SyncDlLimit="limit",n.SyncPayloads="items",n.ApiVersion="api"},35133:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},54074:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),n(72301)},40849:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),n(72301)},19194:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),n(72301)},74210:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),n(72301)},37888:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),n(72301)},40891:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},13870:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},48911:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},69346:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},95440:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},73402:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},46226:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},18450:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},34779:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(72301),t),i(n(35133),t),i(n(54074),t),i(n(40849),t),i(n(19194),t),i(n(74210),t),i(n(37888),t),i(n(40891),t),i(n(13870),t),i(n(48911),t),i(n(69346),t),i(n(95440),t),i(n(73402),t),i(n(46226),t),i(n(18450),t)},55709:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},60427:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},69861:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},51715:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},24622:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8081:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},64999:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},51298:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},22034:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},42958:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},295:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},67206:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},59735:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},15189:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},78322:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},16590:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},12847:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},55676:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},43515:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},75983:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},83143:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},85785:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},91127:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},99417:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},44516:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},93476:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},93106:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},13785:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},92077:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5940:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},48179:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(55709),t),i(n(60427),t),i(n(69861),t),i(n(51715),t),i(n(24622),t),i(n(8081),t),i(n(64999),t),i(n(51298),t),i(n(22034),t),i(n(42958),t),i(n(295),t),i(n(67206),t),i(n(59735),t),i(n(15189),t),i(n(78322),t),i(n(16590),t),i(n(12847),t),i(n(55676),t),i(n(43515),t),i(n(75983),t),i(n(83143),t),i(n(85785),t),i(n(44516),t),i(n(93476),t),i(n(91127),t),i(n(99417),t),i(n(93106),t),i(n(13785),t),i(n(92077),t),i(n(5940),t)},24881:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Paths=void 0,t.Paths={v1:Object.assign({},{invite:"/v1/subscription-invites",acceptInvite:e=>"/v1/subscription-invites/".concat(e,"/accept"),declineInvite:e=>"/v1/subscription-invites/".concat(e,"/decline"),cancelInvite:e=>"/v1/subscription-invites/".concat(e),listInvites:"/v1/subscription-invites"})}},59005:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptionServer=void 0;const i=n(24881);t.SubscriptionServer=class{constructor(e){this.httpService=e}acceptInvite(e){return r(this,void 0,void 0,(function*(){return yield this.httpService.post(i.Paths.v1.acceptInvite(e.inviteUuid),e)}))}declineInvite(e){return r(this,void 0,void 0,(function*(){return yield this.httpService.get(i.Paths.v1.declineInvite(e.inviteUuid),e)}))}cancelInvite(e){return r(this,void 0,void 0,(function*(){return yield this.httpService.delete(i.Paths.v1.cancelInvite(e.inviteUuid),e)}))}listInvites(e){return r(this,void 0,void 0,(function*(){return yield this.httpService.get(i.Paths.v1.listInvites,e)}))}invite(e){return r(this,void 0,void 0,(function*(){return yield this.httpService.post(i.Paths.v1.invite,e)}))}}},99033:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},15290:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Paths=void 0,t.Paths={v1:Object.assign({},{register:"/v1/users",deleteAccount:e=>"/v1/users/".concat(e)})}},86930:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UserServer=void 0;const i=n(15290);t.UserServer=class{constructor(e){this.httpService=e}deleteAccount(e){return r(this,void 0,void 0,(function*(){return yield this.httpService.delete(i.Paths.v1.deleteAccount(e.userUuid),e)}))}register(e){return r(this,void 0,void 0,(function*(){return yield this.httpService.post(i.Paths.v1.register,e)}))}}},62890:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},60744:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Paths=void 0,t.Paths={v1:Object.assign({},{submitUserRequest:e=>"/v1/users/".concat(e,"/requests")})}},32510:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UserRequestServer=void 0;const i=n(60744);t.UserRequestServer=class{constructor(e){this.httpService=e}submitUserRequest(e){return r(this,void 0,void 0,(function*(){return yield this.httpService.post(i.Paths.v1.submitUserRequest(e.userUuid),e)}))}}},25336:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},63782:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Paths=void 0,t.Paths={v1:Object.assign({},{createConnectionToken:"/v1/sockets/tokens"})}},36604:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketServer=void 0;const i=n(63782);t.WebSocketServer=class{constructor(e){this.httpService=e}createConnectionToken(e){return r(this,void 0,void 0,(function*(){return yield this.httpService.post(i.Paths.v1.createConnectionToken,e)}))}}},40400:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},43853:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Paths=void 0,t.Paths={v1:Object.assign({},{createWorkspace:"/v1/workspaces",listWorkspaces:"/v1/workspaces",listWorkspaceUsers:e=>"/v1/workspaces/".concat(e,"/users"),initiateKeyshare:(e,t)=>"/v1/workspaces/".concat(e,"/users/").concat(t,"/keyshare"),inviteToWorkspace:e=>"/v1/workspaces/".concat(e,"/invites"),acceptInvite:e=>"/v1/invites/".concat(e,"/accept")})}},68986:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceServer=void 0;const i=n(43853);t.WorkspaceServer=class{constructor(e){this.httpService=e}initiateKeyshare(e){return r(this,void 0,void 0,(function*(){return yield this.httpService.post(i.Paths.v1.initiateKeyshare(e.workspaceUuid,e.userUuid),e)}))}listWorkspaceUsers(e){return r(this,void 0,void 0,(function*(){return yield this.httpService.get(i.Paths.v1.listWorkspaceUsers(e.workspaceUuid),e)}))}listWorkspaces(e){return r(this,void 0,void 0,(function*(){return yield this.httpService.get(i.Paths.v1.listWorkspaces,e)}))}acceptInvite(e){return r(this,void 0,void 0,(function*(){return yield this.httpService.post(i.Paths.v1.acceptInvite(e.inviteUuid),e)}))}inviteToWorkspace(e){return r(this,void 0,void 0,(function*(){return yield this.httpService.post(i.Paths.v1.inviteToWorkspace(e.workspaceUuid),e)}))}createWorkspace(e){return r(this,void 0,void 0,(function*(){return yield this.httpService.post(i.Paths.v1.createWorkspace,e)}))}}},87171:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},99131:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(59005),t),i(n(99033),t),i(n(86930),t),i(n(62890),t),i(n(32510),t),i(n(25336),t),i(n(36604),t),i(n(40400),t),i(n(68986),t),i(n(87171),t)},30991:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(77415),t),i(n(26636),t),i(n(88994),t),i(n(19854),t),i(n(34779),t),i(n(48179),t),i(n(99131),t)},70297:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(30991),t)},55665:(e,t)=>{var n,r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.V005Algorithm=t.V004Algorithm=t.V003Algorithm=t.V002Algorithm=t.V001Algorithm=void 0,t.V001Algorithm=Object.freeze({SaltSeedLength:128,PbkdfMinCost:3e3,PbkdfCostsUsed:[3e3,5e3,1e4,6e4],PbkdfOutputLength:512,EncryptionKeyLength:256}),t.V002Algorithm=Object.freeze({SaltSeedLength:128,PbkdfMinCost:3e3,PbkdfCostsUsed:t.V001Algorithm.PbkdfCostsUsed.concat([1e5,101e3,102e3,103e3]),ImprobablePbkdfCostsUsed:[3e3,5e3],PbkdfOutputLength:768,EncryptionKeyLength:256,EncryptionIvLength:128}),(i=t.V003Algorithm||(t.V003Algorithm={}))[i.SaltSeedLength=256]="SaltSeedLength",i[i.PbkdfCost=11e4]="PbkdfCost",i[i.PbkdfOutputLength=768]="PbkdfOutputLength",i[i.EncryptionKeyLength=256]="EncryptionKeyLength",i[i.EncryptionIvLength=128]="EncryptionIvLength",(r=t.V004Algorithm||(t.V004Algorithm={}))[r.ArgonSaltSeedLength=256]="ArgonSaltSeedLength",r[r.ArgonSaltLength=128]="ArgonSaltLength",r[r.ArgonIterations=5]="ArgonIterations",r[r.ArgonMemLimit=67108864]="ArgonMemLimit",r[r.ArgonOutputKeyBytes=64]="ArgonOutputKeyBytes",r[r.EncryptionKeyLength=256]="EncryptionKeyLength",r[r.EncryptionNonceLength=192]="EncryptionNonceLength",(n=t.V005Algorithm||(t.V005Algorithm={}))[n.AsymmetricEncryptionNonceLength=192]="AsymmetricEncryptionNonceLength",n[n.SymmetricEncryptionNonceLength=192]="SymmetricEncryptionNonceLength"},11393:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.BackupFileType=void 0,(n=t.BackupFileType||(t.BackupFileType={})).Encrypted="Encrypted",n.EncryptedWithNonEncryptedItemsKey="EncryptedWithNonEncryptedItemsKey",n.FullyDecrypted="FullyDecrypted",n.Corrupt="Corrupt"},20593:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SNItemsKey=t.isItemsKey=void 0;const r=n(10256),i=n(16418);t.isItemsKey=function(e){return e.content_type===r.ContentType.ItemsKey};class o extends i.DecryptedItem{constructor(e){super(e),this.keyVersion=e.content.version,this.isDefault=e.content.isDefault,this.itemsKey=this.payload.content.itemsKey}strategyWhenConflictingWithItem(e,t){return i.ConflictStrategy.KeepBase}get dataAuthenticationKey(){if(this.keyVersion===r.ProtocolVersion.V004)throw"Attempting to access legacy data authentication key.";return this.payload.content.dataAuthenticationKey}}t.SNItemsKey=o},73756:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ItemsKeyMutator=void 0;const r=n(16418);class i extends r.DecryptedItemMutator{set isDefault(e){this.mutableContent.isDefault=e}}t.ItemsKeyMutator=i},11542:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(10256),i=n(16418),o=n(20593),a=n(73756);(0,i.RegisterItemClass)(r.ContentType.ItemsKey,o.SNItemsKey,a.ItemsKeyMutator)},28809:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ItemContentTypeUsesRootKeyEncryption=t.ContentTypeUsesRootKeyEncryption=t.FillRootKeyContent=t.CreateNewRootKey=void 0;const r=n(10256),i=n(16418),o=n(64657),a=n(80026);function s(e){return e.version||(e.dataAuthenticationKey?e.version=r.ProtocolVersion.V002:e.version=r.ProtocolVersion.V001),(0,i.FillItemContentSpecialized)(e)}t.CreateNewRootKey=function(e){const t=o.UuidGenerator.GenerateUuid(),n=new i.DecryptedPayload(Object.assign({uuid:t,content_type:r.ContentType.RootKey,content:s(e)},(0,i.PayloadTimestampDefaults)()));return new a.SNRootKey(n)},t.FillRootKeyContent=s,t.ContentTypeUsesRootKeyEncryption=function(e){return e===r.ContentType.RootKey||e===r.ContentType.ItemsKey||e===r.ContentType.EncryptedStorage},t.ItemContentTypeUsesRootKeyEncryption=function(e){return e===r.ContentType.ItemsKey}},73913:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KeyParamsFromApiResponse=t.CreateAnyKeyParams=t.Create004KeyParams=t.Create003KeyParams=t.Create002KeyParams=t.Create001KeyParams=void 0;const r=n(41671),i=n(2392);function o(e){if("content"in e)throw Error("Raw key params shouldnt have content; perhaps you passed in a SNRootKeyParams object.");return new i.SNRootKeyParams(e)}t.Create001KeyParams=function(e){return o(e)},t.Create002KeyParams=function(e){return o(e)},t.Create003KeyParams=function(e){return o(e)},t.Create004KeyParams=function(e){return o(e)},t.CreateAnyKeyParams=o,t.KeyParamsFromApiResponse=function(e,t){return o({identifier:t||e.data.identifier,pw_cost:e.data.pw_cost,pw_nonce:e.data.pw_nonce,pw_salt:e.data.pw_salt,version:(0,r.ProtocolVersionForKeyParams)(e.data),origination:e.data.origination,created:e.data.created})}},41671:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolVersionForKeyParams=void 0;const r=n(10256),i=n(55665);t.ProtocolVersionForKeyParams=function(e){if(e.version)return e.version;const t=e.pw_cost,n=i.V001Algorithm.PbkdfCostsUsed.includes(t),o=i.V002Algorithm.PbkdfCostsUsed.includes(t);return n&&!o?r.ProtocolVersion.V001:o&&!n?r.ProtocolVersion.V002:o&&n&&e.pw_nonce&&i.V002Algorithm.ImprobablePbkdfCostsUsed.includes(t)?r.ProtocolVersion.V001:r.ProtocolVersion.V002}},80026:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SNRootKey=void 0;const r=n(16418),i=n(86553),o=n(2392);class a extends r.DecryptedItem{constructor(e){super(e),this.keyParams=new o.SNRootKeyParams(e.content.keyParams)}get keyVersion(){return this.content.version}get itemsKey(){return this.masterKey}get masterKey(){return this.content.masterKey}get serverPassword(){return this.content.serverPassword}get dataAuthenticationKey(){return this.content.dataAuthenticationKey}compare(e){return this.keyVersion===e.keyVersion&&(this.serverPassword&&e.serverPassword?(0,i.timingSafeEqual)(this.masterKey,e.masterKey)&&(0,i.timingSafeEqual)(this.serverPassword,e.serverPassword):(0,i.timingSafeEqual)(this.masterKey,e.masterKey))}persistableValueWhenWrapping(){return Object.assign(Object.assign({},this.getKeychainValue()),{keyParams:this.keyParams.getPortableValue()})}getKeychainValue(){const e={version:this.keyVersion,masterKey:this.masterKey};return this.dataAuthenticationKey&&(e.dataAuthenticationKey=this.dataAuthenticationKey),e}}t.SNRootKey=a},2392:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SNRootKeyParams=void 0;const r=n(10256),i=n(64657),o=n(41671),a=n(29153);t.SNRootKeyParams=class{constructor(e){this.content=Object.assign(Object.assign({},e),{origination:e.origination||r.KeyParamsOrigination.Registration,version:e.version||(0,o.ProtocolVersionForKeyParams)(e)})}get isKeyParamsObject(){return!0}get identifier(){return this.content004.identifier||this.content002.email}get version(){return this.content.version}get origination(){return this.content.origination}get content001(){return this.content}get content002(){return this.content}get content003(){return this.content}get content004(){return this.content}get createdDate(){if(this.content004.created)return new Date(Number(this.content004.created))}compare(e){if(this.version!==e.version)return!1;if([r.ProtocolVersion.V004,r.ProtocolVersion.V003].includes(this.version))return this.identifier===e.identifier&&this.content004.pw_nonce===e.content003.pw_nonce;if([r.ProtocolVersion.V002,r.ProtocolVersion.V001].includes(this.version))return this.identifier===e.identifier&&this.content002.pw_salt===e.content001.pw_salt;throw Error("Unhandled version in KeyParams.compare")}getPortableValue(){return(0,i.pickByCopy)(this.content,a.ValidKeyParamsKeys)}}},29153:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ValidKeyParamsKeys=void 0,t.ValidKeyParamsKeys=["identifier","pw_cost","pw_nonce","pw_salt","version","origination","created"]},83262:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KeyRecoveryStrings=void 0;const r=n(10256);t.KeyRecoveryStrings={KeyRecoveryLoginFlowPrompt:e=>{var t;const n=null===(t=e.createdDate)||void 0===t?void 0:t.toLocaleString();switch(e.origination){case r.KeyParamsOrigination.EmailChange:return"Enter your account password as it was when you changed your email on ".concat(n,".");case r.KeyParamsOrigination.PasswordChange:return"Enter your account password after it was changed on ".concat(n,".");case r.KeyParamsOrigination.Registration:return"Enter your account password as it was when you registered ".concat(n,".");case r.KeyParamsOrigination.ProtocolUpgrade:return"Enter your account password as it was when you upgraded your encryption version on ".concat(n,".");case r.KeyParamsOrigination.PasscodeChange:return"Enter your application passcode after it was changed on ".concat(n,".");case r.KeyParamsOrigination.PasscodeCreate:return"Enter your application passcode as it was when you created it on ".concat(n,".");default:throw Error("Unhandled KeyParamsOrigination case for KeyRecoveryLoginFlowPrompt")}},KeyRecoveryLoginFlowReason:"Your account password is required to revalidate your session.",KeyRecoveryLoginFlowInvalidPassword:"Incorrect credentials entered. Please try again.",KeyRecoveryRootKeyReplaced:"Your credentials have successfully been updated.",KeyRecoveryPasscodeRequiredTitle:"Passcode Required",KeyRecoveryPasscodeRequiredText:"You must enter your passcode in order to save your new credentials.",KeyRecoveryPasswordRequired:"Your account password is required to recover an encryption key.",KeyRecoveryKeyRecovered:"Your key has successfully been recovered.",KeyRecoveryUnableToRecover:"Unable to recover your key with the attempted password. Please try again."}},94466:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SNProtocolOperator001=void 0;const i=n(10256),o=n(16418),a=n(64657),s=n(55665),c=n(20593),l=n(28809),u=n(73913),d="00000000000000000000000000000000";t.SNProtocolOperator001=class{constructor(e){this.crypto=e}getEncryptionDisplayName(){return"AES-256"}get version(){return i.ProtocolVersion.V001}generateNewItemsKeyContent(){const e=s.V001Algorithm.EncryptionKeyLength,t=this.crypto.generateRandomKey(e);return(0,o.FillItemContent)({itemsKey:t,version:i.ProtocolVersion.V001})}createItemsKey(){const e=new o.DecryptedPayload(Object.assign({uuid:a.UuidGenerator.GenerateUuid(),content_type:i.ContentType.ItemsKey,content:this.generateNewItemsKeyContent()},(0,o.PayloadTimestampDefaults)()));return(0,o.CreateDecryptedItemFromPayload)(e)}createRootKey(e,t,n){return r(this,void 0,void 0,(function*(){const r=s.V001Algorithm.PbkdfMinCost,o=this.crypto.generateRandomKey(s.V001Algorithm.SaltSeedLength),a=yield this.crypto.unsafeSha1(e+"SN"+o),c=(0,u.Create001KeyParams)({email:e,pw_cost:r,pw_nonce:o,pw_salt:a,version:i.ProtocolVersion.V001,origination:n,created:"".concat(Date.now())});return this.deriveKey(t,c)}))}getPayloadAuthenticatedData(e){}computeRootKey(e,t){return r(this,void 0,void 0,(function*(){return this.deriveKey(e,t)}))}decryptString(e,t){return r(this,void 0,void 0,(function*(){return this.crypto.aes256CbcDecrypt(e,d,t)}))}encryptString(e,t){return r(this,void 0,void 0,(function*(){return this.crypto.aes256CbcEncrypt(e,d,t)}))}generateEncryptedParametersAsync(e,t){return r(this,void 0,void 0,(function*(){const n=this.crypto.generateRandomKey(2*s.V001Algorithm.EncryptionKeyLength),r=yield this.encryptString(n,t.itemsKey),i=(0,a.firstHalfOfString)(n),o=(0,a.secondHalfOfString)(n),l=yield this.encryptString(JSON.stringify(e.content),i),u=t.keyVersion+l,d=yield this.crypto.hmac256(u,o);if(!d)throw Error("Error generating hmac256 authHash");return{uuid:e.uuid,items_key_id:(0,c.isItemsKey)(t)?t.uuid:void 0,content:u,enc_item_key:r,auth_hash:d,version:this.version}}))}generateDecryptedParametersAsync(e,t){return r(this,void 0,void 0,(function*(){if(!e.enc_item_key)return console.error(Error("Missing item encryption key, skipping decryption.")),{uuid:e.uuid,errorDecrypting:!0};let n=e.enc_item_key;n=this.version+n;const r=this.encryptionComponentsFromString(n,t.itemsKey),i=yield this.decryptString(r.ciphertext,r.key);if(!i)return console.error("Error decrypting parameters",e),{uuid:e.uuid,errorDecrypting:!0};const o=(0,a.firstHalfOfString)(i),s=this.encryptionComponentsFromString(e.content,o),c=yield this.decryptString(s.ciphertext,s.key);return c?{uuid:e.uuid,content:JSON.parse(c)}:{uuid:e.uuid,errorDecrypting:!0}}))}encryptionComponentsFromString(e,t){const n=e.substring(0,i.ProtocolVersionLength);return{ciphertext:e.substring(i.ProtocolVersionLength,e.length),version:n,key:t}}deriveKey(e,t){return r(this,void 0,void 0,(function*(){const n=yield this.crypto.pbkdf2(e,t.content001.pw_salt,t.content001.pw_cost,s.V001Algorithm.PbkdfOutputLength);if(!n)throw Error("Error deriving PBKDF2 key");const r=(0,a.splitString)(n,2);return(0,l.CreateNewRootKey)({serverPassword:r[0],masterKey:r[1],version:i.ProtocolVersion.V001,keyParams:t.getPortableValue()})}))}}},91938:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SNProtocolOperator002=void 0;const i=n(10256),o=n(16418),a=n(16418),s=n(64657),c=n(64657),l=n(55665),u=n(20593),d=n(28809),p=n(73913),h=n(80026),y=n(94466);class f extends y.SNProtocolOperator001{get version(){return i.ProtocolVersion.V002}generateNewItemsKeyContent(){const e=l.V002Algorithm.EncryptionKeyLength,t=this.crypto.generateRandomKey(e),n=this.crypto.generateRandomKey(e);return o.FillItemContent({itemsKey:t,dataAuthenticationKey:n,version:i.ProtocolVersion.V002})}createItemsKey(){const e=new o.DecryptedPayload(Object.assign({uuid:c.UuidGenerator.GenerateUuid(),content_type:i.ContentType.ItemsKey,content:this.generateNewItemsKeyContent()},(0,a.PayloadTimestampDefaults)()));return o.CreateDecryptedItemFromPayload(e)}createRootKey(e,t,n){return r(this,void 0,void 0,(function*(){const r=s.lastElement(l.V002Algorithm.PbkdfCostsUsed),o=this.crypto.generateRandomKey(l.V002Algorithm.SaltSeedLength),a=yield this.crypto.unsafeSha1(e+":"+o),c=(0,p.Create002KeyParams)({email:e,pw_nonce:o,pw_cost:r,pw_salt:a,version:i.ProtocolVersion.V002,origination:n,created:"".concat(Date.now())});return this.deriveKey(t,c)}))}computeRootKey(e,t){return r(this,void 0,void 0,(function*(){return this.deriveKey(e,t)}))}decryptString002(e,t,n){return r(this,void 0,void 0,(function*(){return this.crypto.aes256CbcDecrypt(e,n,t)}))}encryptString002(e,t,n){return r(this,void 0,void 0,(function*(){return this.crypto.aes256CbcEncrypt(e,n,t)}))}encryptTextParams(e,t,n,i,o,a){return r(this,void 0,void 0,(function*(){const r=this.crypto.generateRandomKey(l.V002Algorithm.EncryptionIvLength),s=yield this.encryptString002(e,t,r),c=[o,i,r,s].join(":"),u=yield this.crypto.hmac256(c,n);if(!u)throw Error("Error generating hmac256 authHash");const d=[o,u,i,r,s];if(a){const e=this.crypto.base64Encode(JSON.stringify(a.content));d.push(e)}return d.join(":")}))}decryptTextParams(e,t,n,i,o,a){return r(this,void 0,void 0,(function*(){if(!n)throw"Attempting to decryptTextParams with null encryptionKey";const r=yield this.crypto.hmac256(e,a);if(!r)throw Error("Error generating hmac256 localAuthHash");return!1===this.crypto.timingSafeEqual(o,r)?(console.error(Error("Auth hash does not match.")),null):this.decryptString002(t,n,i)}))}getPayloadAuthenticatedData(e){const t=this.encryptionComponentsFromString002(e.enc_item_key).keyParams;if(!t)return;const n=JSON.parse(this.crypto.base64Decode(t));return Object.assign({},n)}generateEncryptedParametersAsync(e,t){return r(this,void 0,void 0,(function*(){const n=this.crypto.generateRandomKey(2*l.V002Algorithm.EncryptionKeyLength),r=yield this.encryptTextParams(n,t.itemsKey,t.dataAuthenticationKey,e.uuid,t.keyVersion,t instanceof h.SNRootKey?t.keyParams:void 0),i=s.firstHalfOfString(n),o=s.secondHalfOfString(n),a=yield this.encryptTextParams(JSON.stringify(e.content),i,o,e.uuid,t.keyVersion,t instanceof h.SNRootKey?t.keyParams:void 0);return{uuid:e.uuid,items_key_id:(0,u.isItemsKey)(t)?t.uuid:void 0,content:a,enc_item_key:r,version:this.version}}))}generateDecryptedParametersAsync(e,t){return r(this,void 0,void 0,(function*(){if(!e.enc_item_key)return console.error(Error("Missing item encryption key, skipping decryption.")),{uuid:e.uuid,errorDecrypting:!0};const n=e.enc_item_key,r=this.encryptionComponentsFromString002(n,t.itemsKey,t.dataAuthenticationKey),i=yield this.decryptTextParams(r.ciphertextToAuth,r.contentCiphertext,r.encryptionKey,r.iv,r.authHash,r.authKey);if(!i)return console.error("Error decrypting item_key parameters",e),{uuid:e.uuid,errorDecrypting:!0};const o=s.firstHalfOfString(i),a=s.secondHalfOfString(i),c=this.encryptionComponentsFromString002(e.content,o,a),l=yield this.decryptTextParams(c.ciphertextToAuth,c.contentCiphertext,c.encryptionKey,c.iv,c.authHash,c.authKey);return l?{uuid:e.uuid,content:JSON.parse(l)}:{uuid:e.uuid,errorDecrypting:!0}}))}deriveKey(e,t){return r(this,void 0,void 0,(function*(){const n=yield this.crypto.pbkdf2(e,t.content002.pw_salt,t.content002.pw_cost,l.V002Algorithm.PbkdfOutputLength);if(!n)throw Error("Error deriving PBKDF2 key");const r=s.splitString(n,3);return(0,d.CreateNewRootKey)({serverPassword:r[0],masterKey:r[1],dataAuthenticationKey:r[2],version:i.ProtocolVersion.V002,keyParams:t.getPortableValue()})}))}encryptionComponentsFromString002(e,t,n){const r=e.split(":");return{encryptionVersion:r[0],authHash:r[1],uuid:r[2],iv:r[3],contentCiphertext:r[4],keyParams:r[5],ciphertextToAuth:[r[0],r[2],r[3],r[4]].join(":"),encryptionKey:t,authKey:n}}}t.SNProtocolOperator002=f},22405:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SNProtocolOperator003=void 0;const i=n(10256),o=n(16418),a=n(64657),s=n(55665),c=n(28809),l=n(73913),u=n(91938);class d extends u.SNProtocolOperator002{get version(){return i.ProtocolVersion.V003}generateNewItemsKeyContent(){const e=s.V003Algorithm.EncryptionKeyLength,t=this.crypto.generateRandomKey(e),n=this.crypto.generateRandomKey(e);return(0,o.FillItemContent)({itemsKey:t,dataAuthenticationKey:n,version:i.ProtocolVersion.V003})}createItemsKey(){const e=this.generateNewItemsKeyContent(),t=new o.DecryptedPayload(Object.assign({uuid:a.UuidGenerator.GenerateUuid(),content_type:i.ContentType.ItemsKey,content:(0,o.FillItemContent)(e)},(0,o.PayloadTimestampDefaults)()));return(0,o.CreateDecryptedItemFromPayload)(t)}computeRootKey(e,t){return r(this,void 0,void 0,(function*(){return this.deriveKey(e,t)}))}deriveKey(e,t){return r(this,void 0,void 0,(function*(){const n=yield this.generateSalt(t.content003.identifier,i.ProtocolVersion.V003,s.V003Algorithm.PbkdfCost,t.content003.pw_nonce),r=yield this.crypto.pbkdf2(e,n,s.V003Algorithm.PbkdfCost,s.V003Algorithm.PbkdfOutputLength);if(!r)throw Error("Error deriving PBKDF2 key");const o=(0,a.splitString)(r,3);return(0,c.CreateNewRootKey)({serverPassword:o[0],masterKey:o[1],dataAuthenticationKey:o[2],version:i.ProtocolVersion.V003,keyParams:t.getPortableValue()})}))}createRootKey(e,t,n){return r(this,void 0,void 0,(function*(){const r=i.ProtocolVersion.V003,o=this.crypto.generateRandomKey(s.V003Algorithm.SaltSeedLength),a=(0,l.Create003KeyParams)({identifier:e,pw_nonce:o,version:r,origination:n,created:"".concat(Date.now())});return this.deriveKey(t,a)}))}generateSalt(e,t,n,i){return r(this,void 0,void 0,(function*(){return yield this.crypto.sha256([e,"SF",t,n,i].join(":"))}))}}t.SNProtocolOperator003=d},70542:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SNProtocolOperator004=void 0;const i=n(10256),o=n(16418),a=n(16418),s=n(64657),c=n(55665),l=n(20593),u=n(28809),d=n(73913);t.SNProtocolOperator004=class{constructor(e){this.crypto=e}getEncryptionDisplayName(){return"XChaCha20-Poly1305"}get version(){return i.ProtocolVersion.V004}generateNewItemsKeyContent(){const e=this.crypto.generateRandomKey(c.V004Algorithm.EncryptionKeyLength);return(0,a.FillItemContent)({itemsKey:e,version:i.ProtocolVersion.V004})}createItemsKey(){const e=new o.DecryptedPayload(Object.assign({uuid:s.UuidGenerator.GenerateUuid(),content_type:i.ContentType.ItemsKey,content:this.generateNewItemsKeyContent()},(0,a.PayloadTimestampDefaults)()));return(0,a.CreateDecryptedItemFromPayload)(e)}generateSalt004(e,t){return r(this,void 0,void 0,(function*(){const n=yield this.crypto.sha256([e,t].join(":"));return s.truncateHexString(n,c.V004Algorithm.ArgonSaltLength)}))}computeRootKey(e,t){return r(this,void 0,void 0,(function*(){return this.deriveKey(e,t)}))}createRootKey(e,t,n){return r(this,void 0,void 0,(function*(){const r=i.ProtocolVersion.V004,o=this.crypto.generateRandomKey(c.V004Algorithm.ArgonSaltSeedLength),a=(0,d.Create004KeyParams)({identifier:e,pw_nonce:o,version:r,origination:n,created:"".concat(Date.now())});return this.deriveKey(t,a)}))}encryptString004(e,t,n,r){if(!n)throw"encryptString null nonce";if(!t)throw"encryptString null rawKey";return this.crypto.xchacha20Encrypt(e,n,t,this.authenticatedDataToString(r))}decryptString004(e,t,n,r){return this.crypto.xchacha20Decrypt(e,n,t,r)}generateEncryptionNonce(){return this.crypto.generateRandomKey(c.V004Algorithm.EncryptionNonceLength)}generateEncryptedProtocolString(e,t,n){const r=this.generateEncryptionNonce(),o=this.encryptString004(e,t,r,n);return[i.ProtocolVersion.V004,r,o,this.authenticatedDataToString(n)].join(":")}deconstructEncryptedPayloadString(e){const t=e.split(":");return{version:t[0],nonce:t[1],ciphertext:t[2],authenticatedData:t[3]}}getPayloadAuthenticatedData(e){const t=this.deconstructEncryptedPayloadString(e.enc_item_key).authenticatedData;return this.stringToAuthenticatedData(t)}generateAuthenticatedDataForPayload(e,t){const n={u:e.uuid,v:i.ProtocolVersion.V004};if((0,u.ContentTypeUsesRootKeyEncryption)(e.content_type))return Object.assign(Object.assign({},n),{kp:t.keyParams.content});if(!(0,l.isItemsKey)(t))throw Error("Attempting to use non-items key for regular item.");return n}authenticatedDataToString(e){return this.crypto.base64Encode(JSON.stringify(s.sortedCopy(s.omitUndefinedCopy(e))))}stringToAuthenticatedData(e,t){const n=JSON.parse(this.crypto.base64Decode(e));return s.sortedCopy(Object.assign(Object.assign({},n),t))}generateEncryptedParametersSync(e,t){const n=this.crypto.generateRandomKey(c.V004Algorithm.EncryptionKeyLength),r=JSON.stringify(e.content),i=this.generateAuthenticatedDataForPayload(e,t),o=this.generateEncryptedProtocolString(r,n,i),a=this.generateEncryptedProtocolString(n,t.itemsKey,i);return{uuid:e.uuid,items_key_id:(0,l.isItemsKey)(t)?t.uuid:void 0,content:o,enc_item_key:a,version:this.version}}generateDecryptedParametersSync(e,t){const n=this.deconstructEncryptedPayloadString(e.enc_item_key),r=this.stringToAuthenticatedData(n.authenticatedData,{u:e.uuid,v:e.version}),i=this.authenticatedDataToString(r),o=this.decryptString004(n.ciphertext,t.itemsKey,n.nonce,i);if(!o)return console.error("Error decrypting itemKey parameters",e),{uuid:e.uuid,errorDecrypting:!0};const a=this.deconstructEncryptedPayloadString(e.content),s=this.decryptString004(a.ciphertext,o,a.nonce,i);return s?{uuid:e.uuid,content:JSON.parse(s)}:{uuid:e.uuid,errorDecrypting:!0}}deriveKey(e,t){return r(this,void 0,void 0,(function*(){const n=yield this.generateSalt004(t.content004.identifier,t.content004.pw_nonce),r=this.crypto.argon2(e,n,c.V004Algorithm.ArgonIterations,c.V004Algorithm.ArgonMemLimit,c.V004Algorithm.ArgonOutputKeyBytes),o=s.splitString(r,2),a=o[0],l=o[1];return(0,u.CreateNewRootKey)({masterKey:a,serverPassword:l,version:i.ProtocolVersion.V004,keyParams:t.getPortableValue()})}))}}},26455:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolOperator005=void 0;const r=n(55665),i=n(70542),o="005",a="".concat(o,"_KeySym"),s="".concat(o,"_KeyAsym");class c extends i.SNProtocolOperator004{getEncryptionDisplayName(){return"XChaCha20-Poly1305"}get version(){return o}generateKeyPair(){return this.crypto.sodiumCryptoBoxGenerateKeypair()}asymmetricEncryptKey(e,t,n){const i=this.crypto.generateRandomKey(r.V005Algorithm.AsymmetricEncryptionNonceLength),o=this.crypto.sodiumCryptoBoxEasyEncrypt(e,i,t,n);return[s,i,o].join(":")}asymmetricDecryptKey(e,t,n){const r=e.split(":")[1];return this.crypto.sodiumCryptoBoxEasyDecrypt(e,r,t,n)}symmetricEncryptPrivateKey(e,t){if(64!==t.length)throw new Error("Symmetric key length must be 256 bits");const n=this.crypto.generateRandomKey(r.V005Algorithm.SymmetricEncryptionNonceLength),i=this.crypto.xchacha20Encrypt(e,n,t);return[a,n,i].join(":")}symmetricDecryptPrivateKey(e,t){if(64!==t.length)throw new Error("Symmetric key length must be 256 bits");const n=e.split(":")[1];return this.crypto.xchacha20Decrypt(e,n,t)}}t.ProtocolOperator005=c},2163:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isAsyncOperator=t.createOperatorForVersion=void 0;const r=n(10256),i=n(94466),o=n(91938),a=n(22405),s=n(70542);t.createOperatorForVersion=function(e,t){if(e===r.ProtocolVersion.V001)return new i.SNProtocolOperator001(t);if(e===r.ProtocolVersion.V002)return new o.SNProtocolOperator002(t);if(e===r.ProtocolVersion.V003)return new a.SNProtocolOperator003(t);if(e===r.ProtocolVersion.V004)return new s.SNProtocolOperator004(t);throw Error("Unable to find operator for version ".concat(e))},t.isAsyncOperator=function(e){return void 0!==e.generateDecryptedParametersAsync}},89071:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},67913:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperatorManager=void 0;const r=n(10256),i=n(2163);t.OperatorManager=class{constructor(e){this.crypto=e,this.operators={},this.crypto=e}deinit(){this.crypto=void 0,this.operators={}}operatorForVersion(e){const t=e;let n=this.operators[t];return n||(n=(0,i.createOperatorForVersion)(e,this.crypto),this.operators[t]=n),n}defaultOperator(){return this.operatorForVersion(r.ProtocolVersionLatest)}}},8153:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.decryptPayload=t.encryptPayload=void 0;const i=n(47463),o=n(2163);t.encryptPayload=function(e,t,n){return r(this,void 0,void 0,(function*(){const r=n.operatorForVersion(t.keyVersion);let i;if(i=(0,o.isAsyncOperator)(r)?yield r.generateEncryptedParametersAsync(e,t):r.generateEncryptedParametersSync(e,t),!i)throw"Unable to generate encryption parameters";return i}))},t.decryptPayload=function(e,t,n){return r(this,void 0,void 0,(function*(){const r=n.operatorForVersion(e.version);try{return(0,o.isAsyncOperator)(r)?yield r.generateDecryptedParametersAsync((0,i.encryptedParametersFromPayload)(e),t):r.generateDecryptedParametersSync((0,i.encryptedParametersFromPayload)(e),t)}catch(t){return console.error("Error decrypting payload",e,t),{uuid:e.uuid,errorDecrypting:!0}}}))}},20547:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},76379:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findDefaultItemsKey=void 0,t.findDefaultItemsKey=function(e){if(1===e.length)return e[0];const t=e.filter((e=>e.isDefault));if(t.length>1){const e=t.filter((e=>!e.neverSynced));if(e.length>0)return e[0]}return t[0]}},8708:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.KeyMode=void 0,(n=t.KeyMode||(t.KeyMode={}))[n.RootKeyNone=0]="RootKeyNone",n[n.RootKeyOnly=1]="RootKeyOnly",n[n.RootKeyPlusWrapper=2]="RootKeyPlusWrapper",n[n.WrapperOnly=3]="WrapperOnly"},18652:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RootKeyServiceEvent=void 0,(t.RootKeyServiceEvent||(t.RootKeyServiceEvent={})).RootKeyStatusChanged="RootKeyStatusChanged"},79874:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2536:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FindPayloadInDecryptionSplit=t.FindPayloadInEncryptionSplit=t.CreateDecryptionSplitWithKeyLookup=t.CreateEncryptionSplitWithKeyLookup=void 0,t.CreateEncryptionSplitWithKeyLookup=function(e){const t={};return e.rootKeyEncryption&&(t.usesRootKeyWithKeyLookup={items:e.rootKeyEncryption}),e.itemsKeyEncryption&&(t.usesItemsKeyWithKeyLookup={items:e.itemsKeyEncryption}),t},t.CreateDecryptionSplitWithKeyLookup=function(e){const t={};return e.rootKeyEncryption&&(t.usesRootKeyWithKeyLookup={items:e.rootKeyEncryption}),e.itemsKeyEncryption&&(t.usesItemsKeyWithKeyLookup={items:e.itemsKeyEncryption}),t},t.FindPayloadInEncryptionSplit=function(e,t){var n,r,i,o;const a=null===(n=t.usesItemsKey)||void 0===n?void 0:n.items.find((t=>t.uuid===e));if(a)return a;const s=null===(r=t.usesRootKey)||void 0===r?void 0:r.items.find((t=>t.uuid===e));if(s)return s;const c=null===(i=t.usesItemsKeyWithKeyLookup)||void 0===i?void 0:i.items.find((t=>t.uuid===e));if(c)return c;const l=null===(o=t.usesRootKeyWithKeyLookup)||void 0===o?void 0:o.items.find((t=>t.uuid===e));if(l)return l;throw Error("Cannot find payload in encryption split")},t.FindPayloadInDecryptionSplit=function(e,t){var n,r,i,o;const a=null===(n=t.usesItemsKey)||void 0===n?void 0:n.items.find((t=>t.uuid===e));if(a)return a;const s=null===(r=t.usesRootKey)||void 0===r?void 0:r.items.find((t=>t.uuid===e));if(s)return s;const c=null===(i=t.usesItemsKeyWithKeyLookup)||void 0===i?void 0:i.items.find((t=>t.uuid===e));if(c)return c;const l=null===(o=t.usesRootKeyWithKeyLookup)||void 0===o?void 0:o.items.find((t=>t.uuid===e));if(l)return l;throw Error("Cannot find payload in encryption split")}},74258:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},73650:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SplitPayloadsByEncryptionType=void 0;const r=n(28809);t.SplitPayloadsByEncryptionType=function(e){const t=[],n=[];for(const i of e)(0,r.ItemContentTypeUsesRootKeyEncryption)(i.content_type)?t.push(i):n.push(i);return{rootKeyEncryption:t.length>0?t:void 0,itemsKeyEncryption:n.length>0?n:void 0}}},86760:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},85488:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},25072:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StandardException=void 0,t.StandardException=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.message=e,t&&console.error("StandardException raised: ",e)}}},47463:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.encryptedParametersFromPayload=t.isErrorDecryptingParameters=void 0,t.isErrorDecryptingParameters=function(e){return e.errorDecrypting},t.encryptedParametersFromPayload=function(e){return{uuid:e.uuid,content:e.content,items_key_id:e.items_key_id,enc_item_key:e.enc_item_key,version:e.version,auth_hash:e.auth_hash}}},64486:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},74195:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},68053:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},41025:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ComputePrivateUsername=void 0,t.ComputePrivateUsername=function(e,t){return n(this,void 0,void 0,(function*(){const n=yield e.hmac256(yield e.sha256("StandardNotes-PrivateUsername-V1"),yield e.sha256(t.trim().toLowerCase()));if(null!=n)return n}))}},72691:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(55665),t),i(n(11393),t),i(n(20593),t),i(n(73756),t),i(n(11542),t),i(n(28809),t),i(n(73913),t),i(n(41671),t),i(n(80026),t),i(n(2392),t),i(n(29153),t),i(n(83262),t),i(n(94466),t),i(n(91938),t),i(n(22405),t),i(n(70542),t),i(n(26455),t),i(n(2163),t),i(n(89071),t),i(n(67913),t),i(n(8153),t),i(n(20547),t),i(n(76379),t),i(n(8708),t),i(n(18652),t),i(n(79874),t),i(n(2536),t),i(n(74258),t),i(n(73650),t),i(n(86760),t),i(n(85488),t),i(n(25072),t),i(n(47463),t),i(n(64486),t),i(n(74195),t),i(n(68053),t),i(n(41025),t)},75082:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(72691),t)},13187:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentAction=void 0,(n=t.ComponentAction||(t.ComponentAction={})).SetSize="set-size",n.StreamItems="stream-items",n.StreamContextItem="stream-context-item",n.SaveItems="save-items",n.SelectItem="select-item",n.AssociateItem="associate-item",n.DeassociateItem="deassociate-item",n.ClearSelection="clear-selection",n.CreateItem="create-item",n.CreateItems="create-items",n.DeleteItems="delete-items",n.SetComponentData="set-component-data",n.ToggleActivateComponent="toggle-activate-component",n.RequestPermissions="request-permissions",n.PresentConflictResolution="present-conflict-resolution",n.DuplicateItem="duplicate-item",n.ComponentRegistered="component-registered",n.ActivateThemes="themes",n.Reply="reply",n.ThemesActivated="themes-activated",n.KeyDown="key-down",n.KeyUp="key-up",n.Click="click"},6793:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentArea=void 0,(n=t.ComponentArea||(t.ComponentArea={})).Editor="editor-editor",n.Themes="themes",n.EditorStack="editor-stack"},69266:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentFlag=void 0,(n=t.ComponentFlag||(t.ComponentFlag={})).New="New",n.Deprecated="Deprecated"},23444:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},31777:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.NoteType=void 0,(n=t.NoteType||(t.NoteType={})).Authentication="authentication",n.Code="code",n.Markdown="markdown",n.RichText="rich-text",n.Spreadsheet="spreadsheet",n.Task="task",n.Plain="plain-text"},11882:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},89877:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},32772:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentalFeatures=t.LegacyFileSafeIdentifier=t.FeatureIdentifier=void 0,(n=t.FeatureIdentifier||(t.FeatureIdentifier={})).AccountSwitcher="com.standardnotes.account-switcher",n.CloudLink="org.standardnotes.cloudlink",n.DailyDropboxBackup="org.standardnotes.daily-dropbox-backup",n.DailyEmailBackup="org.standardnotes.daily-email-backup",n.DailyGDriveBackup="org.standardnotes.daily-gdrive-backup",n.DailyOneDriveBackup="org.standardnotes.daily-onedrive-backup",n.Files="org.standardnotes.files",n.FilesBeta="org.standardnotes.files-beta",n.FilesLowStorageTier="org.standardnotes.files-low-storage-tier",n.FilesMaximumStorageTier="org.standardnotes.files-max-storage-tier",n.ListedCustomDomain="org.standardnotes.listed-custom-domain",n.NoteHistory30Days="org.standardnotes.note-history-30",n.NoteHistory365Days="org.standardnotes.note-history-365",n.NoteHistoryUnlimited="org.standardnotes.note-history-unlimited",n.SignInAlerts="com.standardnotes.sign-in-alerts",n.SmartFilters="org.standardnotes.smart-filters",n.TagNesting="org.standardnotes.tag-nesting",n.TwoFactorAuth="org.standardnotes.two-factor-auth",n.SubscriptionSharing="org.standardnotes.subscription-sharing",n.AutobiographyTheme="org.standardnotes.theme-autobiography",n.DynamicTheme="org.standardnotes.theme-dynamic",n.DarkTheme="org.standardnotes.theme-focus",n.FocusMode="org.standardnotes.focus-mode",n.FuturaTheme="org.standardnotes.theme-futura",n.MidnightTheme="org.standardnotes.theme-midnight",n.SolarizedDarkTheme="org.standardnotes.theme-solarized-dark",n.TitaniumTheme="org.standardnotes.theme-titanium",n.CodeEditor="org.standardnotes.code-editor",n.MarkdownProEditor="org.standardnotes.advanced-markdown-editor",n.MarkdownVisualEditor="org.standardnotes.markdown-visual-editor",n.PlainTextEditor="org.standardnotes.plain-text-editor",n.PlusEditor="org.standardnotes.plus-editor",n.SheetsEditor="org.standardnotes.standard-sheets",n.TaskEditor="org.standardnotes.simple-task-editor",n.TokenVaultEditor="org.standardnotes.token-vault",n.DeprecatedBoldEditor="org.standardnotes.bold-editor",n.DeprecatedMarkdownBasicEditor="org.standardnotes.simple-markdown-editor",n.DeprecatedMarkdownMathEditor="org.standardnotes.fancy-markdown-editor",n.DeprecatedMarkdownMinimistEditor="org.standardnotes.minimal-markdown-editor",n.DeprecatedFoldersComponent="org.standardnotes.folders",n.DeprecatedFileSafe="org.standardnotes.file-safe",t.LegacyFileSafeIdentifier="org.standardnotes.legacy.file-safe",t.ExperimentalFeatures=[]},63001:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FindNativeFeature=t.GetFeaturesForSubscription=t.GetFeatures=void 0;const r=n(45868),i=n(95143),o=n(83037),a=n(91375),s=n(34533),c=n(23712);function l(){return[...(0,i.themes)(),...(0,r.editors)(),...(0,o.serverFeatures)(),...(0,a.clientFeatures)(),...(0,c.experimentalFeatures)(),...(0,s.GetDeprecatedFeatures)()]}t.GetFeatures=l,t.GetFeaturesForSubscription=function(e){return l().filter((t=>t.availableInSubscriptions.includes(e)))},t.FindNativeFeature=function(e){return l().find((t=>t.identifier===e))}},91375:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clientFeatures=void 0;const r=n(92680),i=n(32772),o=n(10256);t.clientFeatures=function(){return[{availableInSubscriptions:[o.SubscriptionName.PlusPlan,o.SubscriptionName.ProPlan],name:"Tag Nesting",identifier:i.FeatureIdentifier.TagNesting,permission_name:r.PermissionName.TagNesting,description:"Organize your tags into folders."},{availableInSubscriptions:[o.SubscriptionName.PlusPlan,o.SubscriptionName.ProPlan],name:"Smart Filters",identifier:i.FeatureIdentifier.SmartFilters,permission_name:r.PermissionName.SmartFilters,description:"Create smart filters for viewing notes matching specific criteria."},{availableInSubscriptions:[o.SubscriptionName.PlusPlan,o.SubscriptionName.ProPlan],name:"Encrypted files (coming soon)",identifier:i.FeatureIdentifier.Files,permission_name:r.PermissionName.Files,description:""},{availableInSubscriptions:[o.SubscriptionName.PlusPlan,o.SubscriptionName.ProPlan],name:"Encrypted files beta",identifier:i.FeatureIdentifier.FilesBeta,permission_name:r.PermissionName.FilesBeta,description:""},{availableInSubscriptions:[o.SubscriptionName.PlusPlan,o.SubscriptionName.ProPlan],name:"Focus Mode",identifier:i.FeatureIdentifier.FocusMode,permission_name:r.PermissionName.FocusMode,description:""},{availableInSubscriptions:[o.SubscriptionName.PlusPlan,o.SubscriptionName.ProPlan],name:"Listed Custom Domain",identifier:i.FeatureIdentifier.ListedCustomDomain,permission_name:r.PermissionName.ListedCustomDomain,description:""},{availableInSubscriptions:[o.SubscriptionName.PlusPlan,o.SubscriptionName.ProPlan],name:"Multiple accounts",identifier:i.FeatureIdentifier.AccountSwitcher,permission_name:r.PermissionName.AccountSwitcher,description:""}]}},34533:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GetDeprecatedFeatures=void 0;const r=n(10256),i=n(92680),o=n(32772),a=n(31777),s=n(23822),c=n(13187),l=n(6793);t.GetDeprecatedFeatures=function(){return[(0,s.FillEditorComponentDefaults)({availableInSubscriptions:[r.SubscriptionName.PlusPlan,r.SubscriptionName.ProPlan],name:"Alternative Rich Text",identifier:o.FeatureIdentifier.DeprecatedBoldEditor,note_type:a.NoteType.RichText,file_type:"html",component_permissions:[{name:c.ComponentAction.StreamContextItem,content_types:[r.ContentType.Note]},{name:c.ComponentAction.StreamItems,content_types:[r.ContentType.FilesafeCredentials,r.ContentType.FilesafeFileMetadata,r.ContentType.FilesafeIntegration]}],spellcheckControl:!0,deprecated:!0,permission_name:i.PermissionName.BoldEditor,description:"A simple and peaceful rich editor that helps you write and think clearly.",thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/editors/bold.jpg"}),(0,s.FillEditorComponentDefaults)({availableInSubscriptions:[r.SubscriptionName.PlusPlan,r.SubscriptionName.ProPlan],name:"Basic Markdown",identifier:o.FeatureIdentifier.DeprecatedMarkdownBasicEditor,note_type:a.NoteType.Markdown,spellcheckControl:!0,file_type:"md",deprecated:!0,permission_name:i.PermissionName.MarkdownBasicEditor,description:"A Markdown editor with dynamic split-pane preview.",thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/editors/simple-markdown.jpg"}),(0,s.FillEditorComponentDefaults)({availableInSubscriptions:[r.SubscriptionName.PlusPlan,r.SubscriptionName.ProPlan],name:"Minimal Markdown",identifier:o.FeatureIdentifier.DeprecatedMarkdownMinimistEditor,note_type:a.NoteType.Markdown,file_type:"md",index_path:"index.html",permission_name:i.PermissionName.MarkdownMinimistEditor,spellcheckControl:!0,deprecated:!0,description:"A minimal Markdown editor with live rendering and in-text search via Ctrl/Cmd + F",thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/editors/min-markdown.jpg"}),(0,s.FillEditorComponentDefaults)({availableInSubscriptions:[r.SubscriptionName.PlusPlan,r.SubscriptionName.ProPlan],name:"Markdown with Math",identifier:o.FeatureIdentifier.DeprecatedMarkdownMathEditor,spellcheckControl:!0,permission_name:i.PermissionName.MarkdownMathEditor,note_type:a.NoteType.Markdown,file_type:"md",deprecated:!0,index_path:"index.html",description:"A beautiful split-pane Markdown editor with synced-scroll, LaTeX support, and colorful syntax.",thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/editors/fancy-markdown.jpg"}),(0,s.FillEditorComponentDefaults)({availableInSubscriptions:[r.SubscriptionName.PlusPlan,r.SubscriptionName.ProPlan],name:"FileSafe",identifier:o.FeatureIdentifier.DeprecatedFileSafe,component_permissions:[{name:c.ComponentAction.StreamContextItem,content_types:[r.ContentType.Note]},{name:c.ComponentAction.StreamItems,content_types:[r.ContentType.FilesafeCredentials,r.ContentType.FilesafeFileMetadata,r.ContentType.FilesafeIntegration]}],permission_name:i.PermissionName.ComponentFilesafe,area:l.ComponentArea.EditorStack,deprecated:!0,description:"Encrypted attachments for your notes using your Dropbox, Google Drive, or WebDAV server. Limited to 50MB per file.",thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/FileSafe-banner.png"})]}},45868:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editors=void 0;const r=n(10256),i=n(92680),o=n(32772),a=n(31777),s=n(23822);t.editors=function(){return[(0,s.FillEditorComponentDefaults)({availableInSubscriptions:[r.SubscriptionName.PlusPlan,r.SubscriptionName.ProPlan],name:"Code",spellcheckControl:!0,identifier:o.FeatureIdentifier.CodeEditor,permission_name:i.PermissionName.CodeEditor,note_type:a.NoteType.Code,file_type:"txt",interchangeable:!0,index_path:"index.html",description:"Syntax highlighting and convenient keyboard shortcuts for over 120 programming languages. Ideal for code snippets and procedures.",thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/editors/code.jpg"}),(0,s.FillEditorComponentDefaults)({availableInSubscriptions:[r.SubscriptionName.PlusPlan,r.SubscriptionName.ProPlan],name:"Rich Text",note_type:a.NoteType.RichText,file_type:"html",identifier:o.FeatureIdentifier.PlusEditor,permission_name:i.PermissionName.PlusEditor,spellcheckControl:!0,description:"From highlighting to custom font sizes and colors, to tables and lists, this editor is perfect for crafting any document.",thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/editors/plus-editor.jpg"}),(0,s.FillEditorComponentDefaults)({availableInSubscriptions:[r.SubscriptionName.PlusPlan,r.SubscriptionName.ProPlan],name:"Markdown",identifier:o.FeatureIdentifier.MarkdownProEditor,note_type:a.NoteType.Markdown,file_type:"md",permission_name:i.PermissionName.MarkdownProEditor,spellcheckControl:!0,description:"A fully featured Markdown editor that supports live preview, a styling toolbar, and split pane support.",thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/editors/adv-markdown.jpg"}),(0,s.FillEditorComponentDefaults)({availableInSubscriptions:[r.SubscriptionName.PlusPlan,r.SubscriptionName.ProPlan],name:"Markdown Alternative",identifier:o.FeatureIdentifier.MarkdownVisualEditor,note_type:a.NoteType.Markdown,file_type:"md",permission_name:i.PermissionName.MarkdownVisualEditor,spellcheckControl:!0,description:"A WYSIWYG-style Markdown editor that renders Markdown in preview-mode while you type without displaying any syntax.",index_path:"build/index.html"}),(0,s.FillEditorComponentDefaults)({availableInSubscriptions:[r.SubscriptionName.PlusPlan,r.SubscriptionName.ProPlan],name:"Checklist",identifier:o.FeatureIdentifier.TaskEditor,note_type:a.NoteType.Task,spellcheckControl:!0,file_type:"md",interchangeable:!1,permission_name:i.PermissionName.TaskEditor,description:'A great way to manage short-term and long-term to-do"s. You can mark tasks as completed, change their order, and edit the text naturally in place.',thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/editors/task-editor.jpg"}),(0,s.FillEditorComponentDefaults)({availableInSubscriptions:[r.SubscriptionName.PlusPlan,r.SubscriptionName.ProPlan],name:"Authenticator",note_type:a.NoteType.Authentication,file_type:"json",interchangeable:!1,identifier:o.FeatureIdentifier.TokenVaultEditor,permission_name:i.PermissionName.TokenVaultEditor,description:"Encrypt and protect your 2FA secrets for all your internet accounts. Authenticator handles your 2FA secrets so that you never lose them again, or have to start over when you get a new device.",thumbnail_url:"https://standard-notes.s3.amazonaws.com/screenshots/models/editors/token-vault.png"}),(0,s.FillEditorComponentDefaults)({availableInSubscriptions:[r.SubscriptionName.PlusPlan,r.SubscriptionName.ProPlan],name:"Spreadsheet",identifier:o.FeatureIdentifier.SheetsEditor,note_type:a.NoteType.Spreadsheet,file_type:"json",interchangeable:!1,permission_name:i.PermissionName.SheetsEditor,description:"A powerful spreadsheet editor with formatting and formula support. Not recommended for large data sets, as encryption of such data may decrease editor performance.",thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/editors/spreadsheets.png"})]}},23712:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.experimentalFeatures=void 0,t.experimentalFeatures=function(){return[]}},83037:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.serverFeatures=void 0;const r=n(92680),i=n(32772),o=n(10256);t.serverFeatures=function(){return[{availableInSubscriptions:[o.SubscriptionName.PlusPlan,o.SubscriptionName.ProPlan],name:"Two factor authentication",identifier:i.FeatureIdentifier.TwoFactorAuth,permission_name:r.PermissionName.TwoFactorAuth},{availableInSubscriptions:[o.SubscriptionName.ProPlan],name:"Unlimited note history",identifier:i.FeatureIdentifier.NoteHistoryUnlimited,permission_name:r.PermissionName.NoteHistoryUnlimited},{availableInSubscriptions:[o.SubscriptionName.PlusPlan],name:"365 days note history",identifier:i.FeatureIdentifier.NoteHistory365Days,permission_name:r.PermissionName.NoteHistory365Days},{availableInSubscriptions:[o.SubscriptionName.PlusPlan,o.SubscriptionName.ProPlan],name:"Email backups",identifier:i.FeatureIdentifier.DailyEmailBackup,permission_name:r.PermissionName.DailyEmailBackup},{availableInSubscriptions:[o.SubscriptionName.PlusPlan,o.SubscriptionName.ProPlan],name:"Sign-in email alerts",identifier:i.FeatureIdentifier.SignInAlerts,permission_name:r.PermissionName.SignInAlerts},{availableInSubscriptions:[o.SubscriptionName.PlusPlan,o.SubscriptionName.ProPlan],identifier:i.FeatureIdentifier.DailyDropboxBackup,permission_name:r.PermissionName.DailyDropboxBackup},{availableInSubscriptions:[o.SubscriptionName.PlusPlan,o.SubscriptionName.ProPlan],identifier:i.FeatureIdentifier.DailyGDriveBackup,permission_name:r.PermissionName.DailyGDriveBackup},{availableInSubscriptions:[o.SubscriptionName.PlusPlan,o.SubscriptionName.ProPlan],identifier:i.FeatureIdentifier.DailyOneDriveBackup,permission_name:r.PermissionName.DailyOneDriveBackup},{availableInSubscriptions:[o.SubscriptionName.ProPlan],identifier:i.FeatureIdentifier.FilesMaximumStorageTier,permission_name:r.PermissionName.FilesMaximumStorageTier},{availableInSubscriptions:[o.SubscriptionName.PlusPlan],identifier:i.FeatureIdentifier.FilesLowStorageTier,permission_name:r.PermissionName.FilesLowStorageTier},{availableInSubscriptions:[o.SubscriptionName.ProPlan],identifier:i.FeatureIdentifier.SubscriptionSharing,permission_name:r.PermissionName.SubscriptionSharing}]}},95143:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.themes=void 0;const r=n(92680),i=n(32772),o=n(62364),a=n(10256);t.themes=function(){return[(0,o.FillThemeComponentDefaults)({availableInSubscriptions:[a.SubscriptionName.PlusPlan,a.SubscriptionName.ProPlan],name:"Midnight",identifier:i.FeatureIdentifier.MidnightTheme,permission_name:r.PermissionName.MidnightTheme,description:"Elegant utilitarianism.",thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/themes/midnight-with-mobile.jpg",isDark:!0,dock_icon:{type:"circle",background_color:"#086DD6",foreground_color:"#ffffff",border_color:"#086DD6"}}),(0,o.FillThemeComponentDefaults)({availableInSubscriptions:[a.SubscriptionName.PlusPlan,a.SubscriptionName.ProPlan],name:"Futura",identifier:i.FeatureIdentifier.FuturaTheme,permission_name:r.PermissionName.FuturaTheme,description:"Calm and relaxed. Take some time off.",thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/themes/futura-with-mobile.jpg",isDark:!0,dock_icon:{type:"circle",background_color:"#fca429",foreground_color:"#ffffff",border_color:"#fca429"}}),(0,o.FillThemeComponentDefaults)({availableInSubscriptions:[a.SubscriptionName.PlusPlan,a.SubscriptionName.ProPlan],name:"Solarized Dark",identifier:i.FeatureIdentifier.SolarizedDarkTheme,permission_name:r.PermissionName.SolarizedDarkTheme,description:"The perfect theme for any time.",thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/themes/solarized-dark.jpg",isDark:!0,dock_icon:{type:"circle",background_color:"#2AA198",foreground_color:"#ffffff",border_color:"#2AA198"}}),(0,o.FillThemeComponentDefaults)({availableInSubscriptions:[a.SubscriptionName.PlusPlan,a.SubscriptionName.ProPlan],name:"Autobiography",identifier:i.FeatureIdentifier.AutobiographyTheme,permission_name:r.PermissionName.AutobiographyTheme,description:"A theme for writers and readers.",thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/themes/autobiography.jpg",dock_icon:{type:"circle",background_color:"#9D7441",foreground_color:"#ECE4DB",border_color:"#9D7441"}}),(0,o.FillThemeComponentDefaults)({availableInSubscriptions:[a.SubscriptionName.PlusPlan,a.SubscriptionName.ProPlan],name:"Dark",identifier:i.FeatureIdentifier.DarkTheme,permission_name:r.PermissionName.FocusedTheme,description:"For when you need to go in.",thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/themes/focus-with-mobile.jpg",isDark:!0,dock_icon:{type:"circle",background_color:"#a464c2",foreground_color:"#ffffff",border_color:"#a464c2"}}),(0,o.FillThemeComponentDefaults)({availableInSubscriptions:[a.SubscriptionName.PlusPlan,a.SubscriptionName.ProPlan],name:"Titanium",identifier:i.FeatureIdentifier.TitaniumTheme,permission_name:r.PermissionName.TitaniumTheme,description:"Light on the eyes, heavy on the spirit.",thumbnail_url:"https://s3.amazonaws.com/standard-notes/screenshots/models/themes/titanium-with-mobile.jpg",dock_icon:{type:"circle",background_color:"#6e2b9e",foreground_color:"#ffffff",border_color:"#6e2b9e"}}),(0,o.FillThemeComponentDefaults)({availableInSubscriptions:[a.SubscriptionName.PlusPlan,a.SubscriptionName.ProPlan],name:"Dynamic Panels",identifier:i.FeatureIdentifier.DynamicTheme,permission_name:r.PermissionName.ThemeDynamic,layerable:!0,no_mobile:!0,description:"A smart theme that minimizes the tags and notes panels when they are not in use."})]}},23822:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FillEditorComponentDefaults=void 0;const r=n(13187),i=n(10256),o=n(6793);t.FillEditorComponentDefaults=function(e){return e.index_path||(e.index_path="dist/index.html"),e.component_permissions||(e.component_permissions=[{name:r.ComponentAction.StreamContextItem,content_types:[i.ContentType.Note]}]),e.content_type=i.ContentType.Component,e.area||(e.area=o.ComponentArea.Editor),null==e.interchangeable&&(e.interchangeable=!0),e}},62364:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FillThemeComponentDefaults=void 0;const r=n(10256),i=n(6793);t.FillThemeComponentDefaults=function(e){return e.index_path||(e.index_path="dist/dist.css"),e.content_type=r.ContentType.Theme,e.area||(e.area=i.ComponentArea.Themes),e}},3218:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},92680:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PermissionName=void 0,(n=t.PermissionName||(t.PermissionName={})).AccountSwitcher="app:account-switcher",n.AutobiographyTheme="theme:autobiography",n.BoldEditor="editor:bold",n.CloudLink="component:cloud-link",n.CodeEditor="editor:code-editor",n.ComponentFilesafe="component:filesafe",n.ComponentFolders="component:folders",n.DailyDropboxBackup="server:daily-dropbox-backup",n.DailyEmailBackup="server:daily-email-backup",n.DailyGDriveBackup="server:daily-gdrive-backup",n.DailyOneDriveBackup="server:daily-onedrive-backup",n.FilesBeta="app:files-beta",n.Files="app:files",n.FilesMaximumStorageTier="server:files-max-storage-tier",n.FilesLowStorageTier="server:files-low-storage-tier",n.FocusedTheme="theme:focused",n.FocusMode="app:focus-mode",n.FuturaTheme="theme:futura",n.ListedCustomDomain="listed:custom-domain",n.MarkdownBasicEditor="editor:markdown-basic",n.MarkdownMathEditor="editor:markdown-math",n.MarkdownMinimistEditor="editor:markdown-minimist",n.MarkdownProEditor="editor:markdown-pro",n.MarkdownVisualEditor="editor:markdown-visual",n.MidnightTheme="theme:midnight",n.NoteHistory30Days="server:note-history-30-days",n.NoteHistory365Days="server:note-history-365-days",n.NoteHistoryUnlimited="server:note-history-unlimited",n.PlusEditor="editor:plus",n.SheetsEditor="editor:sheets",n.SignInAlerts="server:sign-in-alerts",n.SmartFilters="app:smart-filters",n.SolarizedDarkTheme="theme:solarized-dark",n.TagNesting="app:tag-nesting",n.TaskEditor="editor:task-editor",n.ThemeDynamic="theme:dynamic",n.TitaniumTheme="theme:titanium",n.TokenVaultEditor="editor:token-vault",n.TwoFactorAuth="server:two-factor-auth",n.SubscriptionSharing="server:subscription-sharing"},72346:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(89877),t),i(n(32772),t),i(n(63001),t),i(n(3218),t),i(n(92680),t),i(n(13187),t),i(n(6793),t),i(n(69266),t),i(n(23444),t),i(n(31777),t),i(n(11882),t)},70295:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(72346),t)},64106:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},88601:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},55465:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5761:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},97195:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},21592:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1532:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},35679:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileMemoryCache=void 0;const r=n(64657);t.FileMemoryCache=class{constructor(e){this.maxSize=e,this.cache={},this.orderedQueue=[]}add(e,t){if(t.encryptedBytes.length>this.maxSize)return!1;for(;this.size+t.encryptedBytes.length>this.maxSize;)this.remove(this.orderedQueue[0]);return this.cache[e]=t,this.orderedQueue.push(e),!0}get size(){return Object.values(this.cache).map((e=>e.encryptedBytes.length)).reduce(((e,t)=>e+t),0)}get(e){return this.cache[e]}remove(e){delete this.cache[e],(0,r.removeFromArray)(this.orderedQueue,e)}clear(){this.cache={},this.orderedQueue=[]}}},94043:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ByteChunker=void 0,t.ByteChunker=class{constructor(e,t){this.minimumChunkSize=e,this.onChunk=t,this.loggingEnabled=!1,this.bytes=new Uint8Array,this.index=1}log(){if(this.loggingEnabled){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log(t)}}addBytes(e,t){return n(this,void 0,void 0,(function*(){this.bytes=new Uint8Array([...this.bytes,...e]),this.log("Chunker adding ".concat(e.length,", total size ").concat(this.bytes.length)),(this.bytes.length>=this.minimumChunkSize||t)&&(yield this.popBytes(t))}))}popBytes(e){return n(this,void 0,void 0,(function*(){const t=Math.max(this.minimumChunkSize,this.bytes.length),n=this.bytes.slice(0,t);this.bytes=new Uint8Array([...this.bytes.slice(t)]),this.log("Chunker popping ".concat(n.length,", total size in queue ").concat(this.bytes.length)),yield this.onChunk(n,this.index++,e)}))}}},76545:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},72343:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OrderedByteChunker=void 0,t.OrderedByteChunker=class{constructor(e,t){this.chunkSizes=e,this.onChunk=t,this.bytes=new Uint8Array,this.index=1,this.remainingChunks=[],this.remainingChunks=e.slice()}needsPop(){return this.remainingChunks.length>0&&this.bytes.length>=this.remainingChunks[0]}addBytes(e){return n(this,void 0,void 0,(function*(){this.bytes=new Uint8Array([...this.bytes,...e]),this.needsPop()&&(yield this.popBytes())}))}popBytes(){return n(this,void 0,void 0,(function*(){const e=this.remainingChunks[0],t=this.bytes.slice(0,e);this.bytes=new Uint8Array([...this.bytes.slice(e)]),this.remainingChunks.shift(),yield this.onChunk(t,this.index++,this.index===this.chunkSizes.length-1),this.needsPop()&&(yield this.popBytes())}))}}},1346:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},26579:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileBackupsConstantsV1=void 0,t.FileBackupsConstantsV1={Version:"1.0.0",MetadataFileName:"metadata.sn.json",BinaryFileName:"file.encrypted"}},67378:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},56787:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},28709:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DownloadAndDecryptFileOperation=void 0;const i=n(84945),o=n(40204),a=n(55164);t.DownloadAndDecryptFileOperation=class{constructor(e,t,n){this.file=e,this.crypto=t,this.api=n,this.downloader=new o.FileDownloader(this.file,this.api)}createDecryptor(){return new a.FileDecryptor(this.file,this.crypto)}run(e){return r(this,void 0,void 0,(function*(){const t=this.createDecryptor();let n;const o=yield this.downloader.run(((o,a,s)=>r(this,void 0,void 0,(function*(){const r=t.decryptBytes(o);if(!r||0===r.decryptedBytes.length)return n=new i.ClientDisplayableError("Failed to decrypt chunk"),void s();const c=r.decryptedBytes;yield e({decrypted:{decryptedBytes:c},encrypted:{encryptedBytes:o},progress:a})}))));return{success:!(o instanceof i.ClientDisplayableError),error:"aborted"===o?void 0:o||n,aborted:"aborted"===o}}))}abort(){this.downloader.abort()}}},57495:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EncryptAndUploadFileOperation=void 0;const i=n(19642),o=n(19697);t.EncryptAndUploadFileOperation=class{constructor(e,t,n,r){this.file=e,this.apiToken=t,this.crypto=n,this.api=r,this.encryptedChunkSizes=[],this.totalBytesPushedInDecryptedTerms=0,this.totalBytesUploadedInDecryptedTerms=0,this.encryptor=new o.FileEncryptor(e,this.crypto),this.uploader=new i.FileUploader(this.api),this.encryptionHeader=this.encryptor.initializeHeader()}getApiToken(){return this.apiToken}getProgress(){const e=this.file.decryptedSize;return{decryptedFileSize:e,decryptedBytesUploaded:this.totalBytesUploadedInDecryptedTerms,decryptedBytesRemaining:e-this.totalBytesUploadedInDecryptedTerms,percentComplete:this.totalBytesUploadedInDecryptedTerms/e*100}}getResult(){return{encryptionHeader:this.encryptionHeader,finalDecryptedSize:this.totalBytesPushedInDecryptedTerms,key:this.file.key,remoteIdentifier:this.file.remoteIdentifier}}pushBytes(e,t,n){return r(this,void 0,void 0,(function*(){this.totalBytesPushedInDecryptedTerms+=e.byteLength;const r=this.encryptBytes(e,n);this.encryptedChunkSizes.push(r.length);const i=yield this.uploadBytes(r,t);return i&&(this.totalBytesUploadedInDecryptedTerms+=e.byteLength),i}))}encryptBytes(e,t){return this.encryptor.pushBytes(e,t)}uploadBytes(e,t){return r(this,void 0,void 0,(function*(){return yield this.uploader.uploadBytes(e,t,this.apiToken)}))}}},48266:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},20204:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.readAndDecryptBackupFile=void 0;const i=n(55164),o=n(72343);t.readAndDecryptBackupFile=function(e,t,n,a,s){return r(this,void 0,void 0,(function*(){const c=new i.FileDecryptor(t,a),l=new o.OrderedByteChunker(t.encryptedChunkSizes,(e=>r(this,void 0,void 0,(function*(){const t=c.decryptBytes(e);t&&(yield s(t.decryptedBytes))}))));return yield n.readFile(e,(e=>r(this,void 0,void 0,(function*(){yield l.addBytes(e)}))))}))}},6017:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},69972:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},54810:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},89179:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},78714:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},55164:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileDecryptor=void 0;const r=n(86553);t.FileDecryptor=class{constructor(e,t){this.file=e,this.crypto=t,this.decryptor=this.crypto.xchacha20StreamInitDecryptor(this.file.encryptionHeader,this.file.key)}decryptBytes(e){const t=this.crypto.xchacha20StreamDecryptorPush(this.decryptor,e,this.file.remoteIdentifier);if(!1===t)return;const n=t.tag===r.SodiumConstant.CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_TAG_FINAL;return{decryptedBytes:t.message,isFinalChunk:n}}}},40204:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FileDownloader=void 0;const i=n(84945),o=n(64657);t.FileDownloader=class{constructor(e,t){this.file=e,this.api=t,this.aborted=!1,this.abortDeferred=(0,o.Deferred)(),this.totalBytesDownloaded=0}getProgress(){const e=this.file.encryptedChunkSizes.reduce(((e,t)=>e+t),0);return{encryptedFileSize:e,encryptedBytesDownloaded:this.totalBytesDownloaded,encryptedBytesRemaining:e-this.totalBytesDownloaded,percentComplete:this.totalBytesDownloaded/e*100}}run(e){return r(this,void 0,void 0,(function*(){const t=yield this.getValetToken();return t instanceof i.ClientDisplayableError?t:this.performDownload(t,e)}))}getValetToken(){return r(this,void 0,void 0,(function*(){return yield this.api.createFileValetToken(this.file.remoteIdentifier,"read")}))}performDownload(e,t){return r(this,void 0,void 0,(function*(){const n=this.api.downloadFile(this.file,0,e,0,(e=>r(this,void 0,void 0,(function*(){this.aborted||(this.totalBytesDownloaded+=e.byteLength,yield t(e,this.getProgress(),this.abort))}))));return yield Promise.race([this.abortDeferred.promise,n])}))}abort(){this.aborted=!0,this.abortDeferred.resolve("aborted")}}},19697:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileEncryptor=void 0;const r=n(86553);t.FileEncryptor=class{constructor(e,t){this.file=e,this.crypto=t}initializeHeader(){return this.stream=this.crypto.xchacha20StreamInitEncryptor(this.file.key),this.stream.header}pushBytes(e,t){if(!this.stream)throw new Error("FileEncryptor must call initializeHeader first");const n=t?r.SodiumConstant.CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_TAG_FINAL:void 0;return this.crypto.xchacha20StreamEncryptorPush(this.stream,e,this.file.remoteIdentifier,n)}}},19642:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FileUploader=void 0,t.FileUploader=class{constructor(e){this.apiService=e}uploadBytes(e,t,r){return n(this,void 0,void 0,(function*(){return yield this.apiService.uploadFileBytes(r,t,e)}))}}},11280:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(64106),t),i(n(88601),t),i(n(55465),t),i(n(5761),t),i(n(97195),t),i(n(21592),t),i(n(1532),t),i(n(35679),t),i(n(94043),t),i(n(76545),t),i(n(72343),t),i(n(1346),t),i(n(26579),t),i(n(67378),t),i(n(56787),t),i(n(48266),t),i(n(20204),t),i(n(28709),t),i(n(57495),t),i(n(55164),t),i(n(19642),t),i(n(19697),t),i(n(40204),t),i(n(6017),t),i(n(69972),t),i(n(54810),t),i(n(89179),t),i(n(78714),t)},14581:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(11280),t)},36502:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},67427:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},84577:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},27897:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentViewerEvent=void 0,(t.ComponentViewerEvent||(t.ComponentViewerEvent={})).FeatureStatusUpdated="FeatureStatusUpdated"},44346:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},67463:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardModifier=void 0,(n=t.KeyboardModifier||(t.KeyboardModifier={})).Shift="Shift",n.Ctrl="Control",n.Meta="Meta"},92590:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},52795:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},23767:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FillItemContentSpecialized=t.FillItemContent=void 0;const r=n(96720),i=n(47759);function o(e){return e.references||(e.references=[]),e.appData||(e.appData={[r.DefaultAppDomain]:{}}),e.appData[r.DefaultAppDomain]||(e.appData[r.DefaultAppDomain]={}),e.appData[r.DefaultAppDomain][i.AppDataField.UserModifiedDate]||(e.appData[r.DefaultAppDomain][i.AppDataField.UserModifiedDate]="".concat(new Date)),e}t.FillItemContent=o,t.FillItemContentSpecialized=function(e){return o(e)}},859:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},85206:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},76422:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1341:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createComponentCreatedContextPayload=void 0,t.createComponentCreatedContextPayload=function(e){return{content_type:e.content_type,content:e.content,created_at:e.created_at,deleted:!1,uuid:e.uuid}}},22369:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateComponentRetrievedContextPayload=void 0,t.CreateComponentRetrievedContextPayload=function(e){return{content_type:e.content_type,content:e.content,created_at:e.created_at,deleted:!1,uuid:e.uuid}}},29029:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8656:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isRemotePayloadAllowed=t.FilterDisallowedRemotePayloadsAndMap=t.CreateFilteredServerItem=void 0;const r=n(82818);function i(e){return Object.assign(Object.assign({},e),{__passed_filter__:!0})}function o(e){return!(0,r.isCorruptTransferPayload)(e)&&((0,r.isEncryptedTransferPayload)(e)||null==e.content)}t.CreateFilteredServerItem=i,t.FilterDisallowedRemotePayloadsAndMap=function(e){return e.filter(o).map(i)},t.isRemotePayloadAllowed=o},16462:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateDecryptedBackupFileContextPayload=t.CreateEncryptedBackupFileContextPayload=void 0,t.CreateEncryptedBackupFileContextPayload=function(e){return{auth_hash:e.auth_hash,content_type:e.content_type,content:e.content,created_at_timestamp:e.created_at_timestamp,created_at:e.created_at,deleted:!1,duplicate_of:e.duplicate_of,enc_item_key:e.enc_item_key,items_key_id:e.items_key_id,updated_at_timestamp:e.updated_at_timestamp,updated_at:e.updated_at,uuid:e.uuid}},t.CreateDecryptedBackupFileContextPayload=function(e){return{content_type:e.content_type,content:e.content,created_at_timestamp:e.created_at_timestamp,created_at:e.created_at,deleted:!1,duplicate_of:e.duplicate_of,updated_at_timestamp:e.updated_at_timestamp,updated_at:e.updated_at,uuid:e.uuid}}},49942:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateDeletedLocalStorageContextPayload=t.CreateDecryptedLocalStorageContextPayload=t.CreateEncryptedLocalStorageContextPayload=t.isEncryptedLocalStoragePayload=void 0;const r=n(64657),i=n(82818);t.isEncryptedLocalStoragePayload=function(e){return(0,i.isEncryptedTransferPayload)(e)},t.CreateEncryptedLocalStorageContextPayload=function(e){return{auth_hash:e.auth_hash,content_type:e.content_type,content:e.content,created_at_timestamp:e.created_at_timestamp,created_at:e.created_at,deleted:!1,dirty:null!=e.dirty&&e.dirty,duplicate_of:e.duplicate_of,enc_item_key:e.enc_item_key,errorDecrypting:e.errorDecrypting,items_key_id:e.items_key_id,updated_at_timestamp:e.updated_at_timestamp,updated_at:e.updated_at,uuid:e.uuid,waitingForKey:e.waitingForKey}},t.CreateDecryptedLocalStorageContextPayload=function(e){return{content_type:e.content_type,content:e.content,created_at_timestamp:e.created_at_timestamp,created_at:e.created_at,deleted:!1,duplicate_of:e.duplicate_of,updated_at_timestamp:e.updated_at_timestamp,updated_at:e.updated_at,uuid:e.uuid,dirty:(0,r.useBoolean)(e.dirty,!1)}},t.CreateDeletedLocalStorageContextPayload=function(e){return{content_type:e.content_type,content:void 0,created_at_timestamp:e.created_at_timestamp,created_at:e.created_at,deleted:!0,dirty:!0,duplicate_of:e.duplicate_of,updated_at_timestamp:e.updated_at_timestamp,updated_at:e.updated_at,uuid:e.uuid}}},15559:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateOfflineSyncPushContextPayload=void 0;const r=n(18667);t.CreateOfflineSyncPushContextPayload=function(e){const t={content:void 0,content_type:e.content_type,created_at_timestamp:e.created_at_timestamp,created_at:e.created_at,deleted:!1,duplicate_of:e.duplicate_of,updated_at_timestamp:e.updated_at_timestamp,updated_at:e.updated_at,uuid:e.uuid};return(0,r.isDecryptedPayload)(e)?Object.assign(Object.assign({},t),{content:e.content}):Object.assign(Object.assign({},t),{deleted:e.deleted})}},53186:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateOfflineSyncSavedPayload=void 0;const r=n(18667);t.CreateOfflineSyncSavedPayload=function(e){return{content_type:e.content_type,created_at_timestamp:e.created_at_timestamp,deleted:(0,r.isDeletedPayload)(e),updated_at_timestamp:e.updated_at_timestamp,updated_at:e.updated_at,uuid:e.uuid}}},53771:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateDeletedServerSyncPushPayload=t.CreateEncryptedServerSyncPushPayload=void 0,t.CreateEncryptedServerSyncPushPayload=function(e){return{content_type:e.content_type,created_at_timestamp:e.created_at_timestamp,created_at:e.created_at,deleted:!1,duplicate_of:e.duplicate_of,updated_at_timestamp:e.updated_at_timestamp,updated_at:e.updated_at,uuid:e.uuid,content:e.content,enc_item_key:e.enc_item_key,items_key_id:e.items_key_id,auth_hash:e.auth_hash}},t.CreateDeletedServerSyncPushPayload=function(e){return{content_type:e.content_type,created_at_timestamp:e.created_at_timestamp,created_at:e.created_at,deleted:!0,duplicate_of:e.duplicate_of,updated_at_timestamp:e.updated_at_timestamp,updated_at:e.updated_at,uuid:e.uuid,content:void 0}}},81479:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateServerSyncSavedPayload=void 0;const r=n(64657);t.CreateServerSyncSavedPayload=function(e){return{content_type:e.content_type,created_at_timestamp:e.created_at_timestamp,created_at:e.created_at,deleted:(0,r.useBoolean)(e.deleted,!1),updated_at_timestamp:e.updated_at_timestamp,updated_at:e.updated_at,uuid:e.uuid}}},84656:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},59867:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DecryptedItem=void 0;const r=n(64657),i=n(47759),o=n(96720),a=n(92445),s=n(9600);class c extends a.GenericItem{constructor(e){super(e),this.protected=!1,this.trashed=!1,this.pinned=!1,this.archived=!1,this.locked=!1,this.starred=!1;const t=this.getAppDomainValueWithDefault(i.AppDataField.UserModifiedDate,this.serverUpdatedAt||0);this.userModifiedDate=new Date(t),this.conflictOf=e.content.conflict_of,this.updatedAtString=(0,r.dateToLocalizedString)(this.userModifiedDate),this.protected=(0,r.useBoolean)(this.payload.content.protected,!1),this.trashed=(0,r.useBoolean)(this.payload.content.trashed,!1),this.starred=(0,r.useBoolean)(this.payload.content.starred,!1),this.pinned=this.getAppDomainValueWithDefault(i.AppDataField.Pinned,!1),this.archived=this.getAppDomainValueWithDefault(i.AppDataField.Archived,!1),this.locked=this.getAppDomainValueWithDefault(i.AppDataField.Locked,!1)}static DefaultAppDomain(){return o.DefaultAppDomain}get content(){return this.payload.content}get references(){return this.payload.content.references||[]}isReferencingItem(e){return null!=this.references.find((t=>t.uuid===e.uuid))}getDomainData(e){const t=this.payload.content.appData;if(t)return t[e]}getAppDomainValue(e){const t=this.getDomainData(o.DefaultAppDomain);return null==t?void 0:t[e]}getAppDomainValueWithDefault(e,t){const n=this.getDomainData(o.DefaultAppDomain);return(null==n?void 0:n[e])||t}payloadRepresentation(e){return this.payload.copy(e)}contentKeysToIgnoreWhenCheckingEquality(){return["conflict_of"]}appDataContentKeysToIgnoreWhenCheckingEquality(){return[i.AppDataField.UserModifiedDate]}getContentCopy(){return JSON.parse(JSON.stringify(this.content))}isItemContentEqualWith(e){return(0,s.ItemContentsEqual)(this.payload.content,e.payload.content,this.contentKeysToIgnoreWhenCheckingEquality(),this.appDataContentKeysToIgnoreWhenCheckingEquality())}}t.DecryptedItem=c},89691:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeletedItem=void 0;const r=n(92445);class i extends r.GenericItem{constructor(e){super(e),this.deleted=!0}payloadRepresentation(e){return this.payload.copy(e)}}t.DeletedItem=i},68728:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EncryptedItem=void 0;const r=n(92445);class i extends r.GenericItem{constructor(e){super(e)}get version(){return this.payload.version}payloadRepresentation(e){return this.payload.copy(e)}get errorDecrypting(){return this.payload.errorDecrypting}get waitingForKey(){return this.payload.waitingForKey}get content(){return this.payload.content}get auth_hash(){return this.payload.auth_hash}}t.EncryptedItem=i},92445:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GenericItem=void 0;const r=n(64657),i=n(69002),o=n(50417),a=n(25569),s=n(18472),c=n(99562);t.GenericItem=class{constructor(e){this.payload=e,this.duplicateOf=e.duplicate_of,this.createdAtString=this.created_at&&(0,r.dateToLocalizedString)(this.created_at),this.userModifiedDate=this.serverUpdatedAt||new Date,this.updatedAtString=(0,r.dateToLocalizedString)(this.userModifiedDate),setTimeout((()=>{(0,r.deepFreeze)(this)}),0)}get uuid(){return this.payload.uuid}get content_type(){return this.payload.content_type}get created_at(){return this.payload.created_at}get serverUpdatedAt(){return this.payload.serverUpdatedAt}get serverUpdatedAtTimestamp(){return this.payload.updated_at_timestamp}get updated_at(){return this.serverUpdatedAt}get dirty(){return this.payload.dirty}get lastSyncBegan(){return this.payload.lastSyncBegan}get lastSyncEnd(){return this.payload.lastSyncEnd}get duplicate_of(){return this.payload.duplicate_of}payloadRepresentation(e){return this.payload.copy(e)}get neverSynced(){return!this.serverUpdatedAt||0===this.serverUpdatedAt.getTime()}get isSingleton(){return!1}singletonPredicate(){throw"Must override SNItem.singletonPredicate"}get singletonStrategy(){return s.SingletonStrategy.KeepEarliest}strategyWhenConflictingWithItem(e,t){if((0,c.isEncryptedErroredItem)(this))return a.ConflictStrategy.KeepBaseDuplicateApply;if(this.isSingleton)return a.ConflictStrategy.KeepBase;if((0,c.isDeletedItem)(this))return a.ConflictStrategy.KeepApply;if((0,c.isDeletedItem)(e))return this.payload.source===o.PayloadSource.FileImport?a.ConflictStrategy.KeepBase:a.ConflictStrategy.KeepApply;if(!(0,c.isDecryptedItem)(e)||!(0,c.isDecryptedItem)(this))return a.ConflictStrategy.KeepBaseDuplicateApply;if(!(0,i.ItemContentsDiffer)(this,e))return a.ConflictStrategy.KeepApply;if((0,i.ItemContentsDiffer)(this,e,["references"])){if(t&&!(0,i.ItemContentsDiffer)(t.itemFromPayload(),e))return a.ConflictStrategy.KeepBase;const n=2e4;return e.payload.source===o.PayloadSource.FileImport||Date.now()-this.userModifiedDate.getTime()<n?a.ConflictStrategy.KeepBaseDuplicateApply:a.ConflictStrategy.DuplicateBaseKeepApply}return a.ConflictStrategy.KeepBaseMergeRefs}satisfiesPredicate(e){return e.matchesItem(this)}}},25218:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},83811:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9529:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},89051:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},99562:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isEncryptedErroredItem=t.isDecryptedOrDeletedItem=t.isDeletedItem=t.isNotEncryptedItem=t.isEncryptedItem=t.isDecryptedItem=void 0;const r=n(98890);function i(e){return(0,r.isDecryptedPayload)(e.payload)}function o(e){return(0,r.isEncryptedPayload)(e.payload)}function a(e){return(0,r.isDeletedPayload)(e.payload)}t.isDecryptedItem=i,t.isEncryptedItem=o,t.isNotEncryptedItem=function(e){return!o(e)},t.isDeletedItem=a,t.isDecryptedOrDeletedItem=function(e){return i(e)||a(e)},t.isEncryptedErroredItem=function(e){return o(e)&&!0===e.errorDecrypting}},66276:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DecryptedItemMutator=void 0;const r=n(64657),i=n(65617),o=n(47759),a=n(96720),s=n(14606),c=n(6754);class l extends s.ItemMutator{constructor(e,t){super(e,t);const n=(0,r.Copy)(this.immutablePayload.content);this.mutableContent=n}getResult(){return this.type===i.MutationType.NonDirtying?this.immutablePayload.copy({content:this.mutableContent}):(this.type===i.MutationType.UpdateUserTimestamps?this.userModifiedDate=new Date:this.immutableItem.userModifiedDate||(this.userModifiedDate=new Date(this.immutableItem.serverUpdatedAt)),this.immutablePayload.copy({content:this.mutableContent,dirty:!0,dirtyIndex:(0,c.getIncrementedDirtyIndex)()}))}setBeginSync(e,t){this.immutablePayload=this.immutablePayload.copy({content:this.mutableContent,lastSyncBegan:e,globalDirtyIndexAtLastSync:t})}setCustomContent(e){this.mutableContent=(0,r.Copy)(e)}set userModifiedDate(e){this.setAppDataItem(o.AppDataField.UserModifiedDate,e)}set conflictOf(e){this.mutableContent.conflict_of=e}set protected(e){this.mutableContent.protected=e}set trashed(e){this.mutableContent.trashed=e}set starred(e){this.mutableContent.starred=e}set pinned(e){this.setAppDataItem(o.AppDataField.Pinned,e)}set archived(e){this.setAppDataItem(o.AppDataField.Archived,e)}set locked(e){this.setAppDataItem(o.AppDataField.Locked,e)}setDomainData(e,t){this.mutableContent.appData||(this.mutableContent.appData={[a.DefaultAppDomain]:{}}),this.mutableContent.appData[t]=e}setDomainDataKey(e,t,n){this.mutableContent.appData||(this.mutableContent.appData={[a.DefaultAppDomain]:{}}),this.mutableContent.appData[n]||(this.mutableContent.appData[n]={}),this.mutableContent.appData[n][e]=t}setAppDataItem(e,t){this.setDomainDataKey(e,t,a.DefaultAppDomain)}e2ePendingRefactor_addItemAsRelationship(e){const t=this.mutableContent.references||[];t.find((t=>t.uuid===e.uuid))||t.push({uuid:e.uuid,content_type:e.content_type}),this.mutableContent.references=t}removeItemAsRelationship(e){let t=this.mutableContent.references||[];t=t.filter((t=>t.uuid!==e.uuid)),this.mutableContent.references=t}}t.DecryptedItemMutator=l},5378:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteItemMutator=void 0;const r=n(63188),i=n(14606),o=n(65617),a=n(6754);class s extends i.ItemMutator{getDeletedResult(){const e=this.type!==o.MutationType.NonDirtying;return new r.DeletedPayload(Object.assign(Object.assign({},this.immutablePayload.ejected()),{deleted:!0,content:void 0,dirty:!!e||this.immutablePayload.dirty,dirtyIndex:e?(0,a.getIncrementedDirtyIndex)():this.immutablePayload.dirtyIndex}),this.immutablePayload.source)}getResult(){throw Error("Must use getDeletedResult")}}t.DeleteItemMutator=s},14606:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ItemMutator=void 0;const r=n(65617),i=n(6754);t.ItemMutator=class{constructor(e,t){this.immutableItem=e,this.type=t,this.immutablePayload=e.payload}getUuid(){return this.immutablePayload.uuid}getItem(){return this.immutableItem}getResult(){return this.type===r.MutationType.NonDirtying?this.immutablePayload.copy():this.immutablePayload.copy({dirty:!0,dirtyIndex:(0,i.getIncrementedDirtyIndex)()})}setBeginSync(e,t){this.immutablePayload=this.immutablePayload.copy({lastSyncBegan:e,globalDirtyIndexAtLastSync:t})}set errorDecrypting(e){throw Error("This method is no longer implemented")}set updated_at(e){throw Error("This method is no longer implemented")}set updated_at_timestamp(e){throw Error("This method is no longer implemented")}}},51533:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},47759:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.AppDataField=void 0,(n=t.AppDataField||(t.AppDataField={})).Pinned="pinned",n.Archived="archived",n.Locked="locked",n.UserModifiedDate="client_updated_at",n.DefaultEditor="defaultEditor",n.MobileRules="mobileRules",n.NotAvailableOnMobile="notAvailableOnMobile",n.MobileActive="mobileActive",n.LastSize="lastSize",n.LegacyPrefersPlainEditor="prefersPlainEditor",n.ComponentInstallError="installError"},25569:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ConflictStrategy=void 0,(n=t.ConflictStrategy||(t.ConflictStrategy={}))[n.KeepBase=1]="KeepBase",n[n.KeepApply=2]="KeepApply",n[n.KeepBaseDuplicateApply=3]="KeepBaseDuplicateApply",n[n.DuplicateBaseKeepApply=4]="DuplicateBaseKeepApply",n[n.KeepBaseMergeRefs=5]="KeepBaseMergeRefs"},96720:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentDataDomain=t.DefaultAppDomain=void 0,t.DefaultAppDomain="org.standardnotes.sn",t.ComponentDataDomain="org.standardnotes.sn.components"},25032:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},89015:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},65617:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MutationType=void 0,(n=t.MutationType||(t.MutationType={}))[n.UpdateUserTimestamps=1]="UpdateUserTimestamps",n[n.NoUpdateUserTimestamps=2]="NoUpdateUserTimestamps",n[n.NonDirtying=3]="NonDirtying"},18472:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SingletonStrategy=void 0,(n=t.SingletonStrategy||(t.SingletonStrategy={}))[n.KeepEarliest=1]="KeepEarliest"},12922:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(61335),t),i(n(21984),t),i(n(22386),t),i(n(15744),t),i(n(43239),t),i(n(7893),t),i(n(19755),t),i(n(22104),t),i(n(67189),t),i(n(59867),t),i(n(59867),t),i(n(89691),t),i(n(68728),t),i(n(92445),t),i(n(25218),t),i(n(83811),t),i(n(9529),t),i(n(89051),t),i(n(99562),t),i(n(66276),t),i(n(5378),t),i(n(14606),t),i(n(51533),t),i(n(47759),t),i(n(25569),t),i(n(96720),t),i(n(25032),t),i(n(89015),t),i(n(65617),t),i(n(18472),t)},38111:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DecryptedPayload=void 0;const r=n(64657),i=n(23767),o=n(50417),a=n(19332);class s extends a.PurePayload{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.PayloadSource.Constructor),this.content=(0,r.Copy)((0,i.FillItemContent)(e.content)),this.deleted=!1}get references(){return this.content.references||[]}getReference(e){const t=this.references.find((t=>t.uuid===e));if(!t)throw new Error("Reference not found");return t}ejected(){return Object.assign(Object.assign({},super.ejected()),{content:this.content,deleted:this.deleted})}copy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.source;return new s(Object.assign(Object.assign({},this.ejected()),e),t)}copyAsSyncResolved(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.source;return new s(Object.assign(Object.assign({},this.ejected()),e),t)}}t.DecryptedPayload=s},63188:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeletedPayload=void 0;const r=n(50417),i=n(19332);class o extends i.PurePayload{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.PayloadSource.Constructor),this.deleted=!0,this.content=void 0}get discardable(){return!this.dirty}ejected(){return Object.assign(Object.assign({},super.ejected()),{deleted:this.deleted,content:void 0})}copy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.source;return new o(Object.assign(Object.assign({},this.ejected()),e),t)}copyAsSyncResolved(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.source;return new o(Object.assign(Object.assign({},this.ejected()),e),t)}}t.DeletedPayload=o},50987:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EncryptedPayload=void 0;const r=n(10256),i=n(50417),o=n(19332);class a extends o.PurePayload{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.PayloadSource.Constructor),this.auth_hash=e.auth_hash,this.content=e.content,this.deleted=!1,this.enc_item_key=e.enc_item_key,this.errorDecrypting=e.errorDecrypting,this.items_key_id=e.items_key_id,this.version=(0,r.protocolVersionFromEncryptedString)(this.content),this.waitingForKey=e.waitingForKey}ejected(){return Object.assign(Object.assign({},super.ejected()),{enc_item_key:this.enc_item_key,items_key_id:this.items_key_id,auth_hash:this.auth_hash,errorDecrypting:this.errorDecrypting,waitingForKey:this.waitingForKey,content:this.content,deleted:this.deleted})}copy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.source;return new a(Object.assign(Object.assign({},this.ejected()),e),t)}copyAsSyncResolved(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.source;return new a(Object.assign(Object.assign({},this.ejected()),e),t)}}t.EncryptedPayload=a},19332:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PurePayload=void 0;const r=n(64657),i=n(50417);t.PurePayload=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.PayloadSource.Constructor;if(this.source=t,this.uuid=e.uuid,!this.uuid)throw Error("Attempting to construct payload with null uuid\n        Content type: ".concat(e.content_type));this.content=e.content,this.content_type=e.content_type,this.deleted=(0,r.useBoolean)(e.deleted,!1),this.dirty=e.dirty,this.duplicate_of=e.duplicate_of,this.created_at=new Date(e.created_at||new Date),this.updated_at=new Date(e.updated_at||0),this.created_at_timestamp=e.created_at_timestamp||0,this.updated_at_timestamp=e.updated_at_timestamp||0,this.lastSyncBegan=e.lastSyncBegan?new Date(e.lastSyncBegan):void 0,this.lastSyncEnd=e.lastSyncEnd?new Date(e.lastSyncEnd):void 0,this.dirtyIndex=e.dirtyIndex,this.globalDirtyIndexAtLastSync=e.globalDirtyIndexAtLastSync,setTimeout((()=>{(0,r.deepFreeze)(this)}),0)}ejected(){return{uuid:this.uuid,content:this.content,deleted:this.deleted,content_type:this.content_type,created_at:this.created_at,updated_at:this.updated_at,created_at_timestamp:this.created_at_timestamp,updated_at_timestamp:this.updated_at_timestamp,dirty:this.dirty,duplicate_of:this.duplicate_of,dirtyIndex:this.dirtyIndex,globalDirtyIndexAtLastSync:this.globalDirtyIndexAtLastSync,lastSyncBegan:this.lastSyncBegan,lastSyncEnd:this.lastSyncEnd}}get serverUpdatedAt(){return this.updated_at}get serverUpdatedAtTimestamp(){return this.updated_at_timestamp}}},60196:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},95619:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},81560:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},61481:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},98890:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isErrorDecryptingPayload=t.isDeletedPayload=t.isEncryptedPayload=t.isDecryptedPayload=void 0;const r=n(82818);t.isDecryptedPayload=function(e){return(0,r.isDecryptedTransferPayload)(e)},t.isEncryptedPayload=function(e){return(0,r.isEncryptedTransferPayload)(e)},t.isDeletedPayload=function(e){return(0,r.isDeletedTransferPayload)(e)},t.isErrorDecryptingPayload=function(e){return(0,r.isErrorDecryptingTransferPayload)(e)}},50339:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},26949:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isPayloadSourceRetrieved=t.isPayloadSourceInternalChange=t.PayloadEmitSource=void 0,function(e){e[e.InitialObserverRegistrationPush=1]="InitialObserverRegistrationPush",e[e.LocalChanged=2]="LocalChanged",e[e.LocalInserted=3]="LocalInserted",e[e.LocalDatabaseLoaded=4]="LocalDatabaseLoaded",e[e.OfflineSyncSaved=5]="OfflineSyncSaved",e[e.LocalRetrieved=6]="LocalRetrieved",e[e.FileImport=7]="FileImport",e[e.ComponentRetrieved=8]="ComponentRetrieved",e[e.ComponentCreated=9]="ComponentCreated",e[e.PreSyncSave=10]="PreSyncSave",e[e.RemoteRetrieved=11]="RemoteRetrieved",e[e.RemoteSaved=12]="RemoteSaved"}(n=t.PayloadEmitSource||(t.PayloadEmitSource={})),t.isPayloadSourceInternalChange=function(e){return[n.RemoteSaved,n.PreSyncSave].includes(e)},t.isPayloadSourceRetrieved=function(e){return[n.RemoteRetrieved,n.ComponentRetrieved].includes(e)}},50417:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PayloadSource=void 0,(n=t.PayloadSource||(t.PayloadSource={}))[n.Constructor=1]="Constructor",n[n.RemoteRetrieved=2]="RemoteRetrieved",n[n.RemoteSaved=3]="RemoteSaved",n[n.FileImport=4]="FileImport"},41935:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PayloadTimestampDefaults=void 0,t.PayloadTimestampDefaults=function(){return{updated_at:new Date(0),created_at:new Date,updated_at_timestamp:0,created_at_timestamp:0}}},18667:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(19332),t),i(n(38111),t),i(n(50987),t),i(n(63188),t),i(n(60196),t),i(n(95619),t),i(n(81560),t),i(n(61481),t),i(n(98890),t),i(n(50339),t),i(n(50417),t),i(n(26949),t),i(n(41935),t)},61335:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},22386:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},21984:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ContentReferenceType=void 0,(n=t.ContentReferenceType||(t.ContentReferenceType={})).TagToParentTag="TagToParentTag",n.TagToFile="TagToFile",n.FileToNote="FileToNote",n.FileToFile="FileToFile",n.NoteToNote="NoteToNote"},15744:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},43239:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isTagToParentTagReference=t.isLegacyTagToNoteReference=t.isReference=t.isLegacyAnonymousReference=void 0;const r=n(10256),i=n(21984);t.isLegacyAnonymousReference=e=>void 0===e.reference_type,t.isReference=e=>void 0!==e.reference_type,t.isLegacyTagToNoteReference=(e,t)=>{const n=e.content_type===r.ContentType.Note,i=t.content_type===r.ContentType.Tag;return n&&i},t.isTagToParentTagReference=e=>(0,t.isReference)(e)&&e.reference_type===i.ContentReferenceType.TagToParentTag},7893:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},19755:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},22104:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},67189:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},47073:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},28284:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},63726:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5474:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},57039:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCorruptTransferPayload=t.isDeletedTransferPayload=t.isErrorDecryptingTransferPayload=t.isEncryptedTransferPayload=t.isDecryptedTransferPayload=void 0;const r=n(64657);function i(e){return"content"in e&&(0,r.isString)(e.content)}t.isDecryptedTransferPayload=function(e){return(0,r.isObject)(e.content)},t.isEncryptedTransferPayload=i,t.isErrorDecryptingTransferPayload=function(e){return i(e)&&!0===e.errorDecrypting},t.isDeletedTransferPayload=function(e){return"deleted"in e&&!0===e.deleted},t.isCorruptTransferPayload=function(e){const t=!0===e.deleted&&null!=e.content;return null==e.uuid||t}},82818:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(47073),t),i(n(28284),t),i(n(63726),t),i(n(5474),t),i(n(57039),t)},63835:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},80625:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.InvitationStatus=void 0,(n=t.InvitationStatus||(t.InvitationStatus={})).Sent="sent",n.Canceled="canceled",n.Accepted="accepted",n.Declined="declined"},33132:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.InviteeIdentifierType=void 0,(n=t.InviteeIdentifierType||(t.InviteeIdentifierType={})).Email="email",n.Hash="hash",n.Uuid="uuid"},14668:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.InviterIdentifierType=void 0,(n=t.InviterIdentifierType||(t.InviterIdentifierType={})).Email="email",n.Uuid="uuid"},51252:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},28585:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6689:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Environment=void 0,(n=t.Environment||(t.Environment={}))[n.Web=1]="Web",n[n.Desktop=2]="Desktop",n[n.Mobile=3]="Mobile"},89320:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Platform=void 0,(n=t.Platform||(t.Platform={}))[n.Ios=1]="Ios",n[n.Android=2]="Android",n[n.MacWeb=3]="MacWeb",n[n.MacDesktop=4]="MacDesktop",n[n.WindowsWeb=5]="WindowsWeb",n[n.WindowsDesktop=6]="WindowsDesktop",n[n.LinuxWeb=7]="LinuxWeb",n[n.LinuxDesktop=8]="LinuxDesktop"},88324:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},95099:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},30969:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},28001:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},52659:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Collection=void 0;const r=n(64657),i=n(31773);t.Collection=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;this.map={},this.typedMap={},this.dirtyIndex=new Set,this.nondeletedIndex=new Set,this.invalidsIndex=new Set,this.isDecryptedElement=e=>(0,r.isObject)(e.content),this.isEncryptedElement=e=>"content"in e&&(0,r.isString)(e.content),this.isErrorDecryptingElement=e=>this.isEncryptedElement(e)&&!0===e.errorDecrypting,this.isDeletedElement=e=>"deleted"in e&&!0===e.deleted,this.isNonDeletedElement=e=>!this.isDeletedElement(e),e?(this.map=t,this.typedMap=n,this.referenceMap=i,this.conflictMap=o):(this.referenceMap=new r.UuidMap,this.conflictMap=new r.UuidMap)}uuids(){return Object.keys(this.map)}all(e){var t;if(e){if(Array.isArray(e)){const t=[];for(const n of e)(0,r.extendArray)(t,this.typedMap[n]||[]);return t}return(null===(t=this.typedMap[e])||void 0===t?void 0:t.slice())||[]}return Object.keys(this.map).map((e=>this.map[e]))}nondeletedElements(){const e=Array.from(this.nondeletedIndex);return this.findAll(e).filter(this.isNonDeletedElement)}invalidElements(){const e=Array.from(this.invalidsIndex);return this.findAll(e)}dirtyElements(){const e=Array.from(this.dirtyIndex);return this.findAll(e)}findAll(e){const t=[];for(const n of e){const e=this.map[n];e&&t.push(e)}return t}find(e){return this.map[e]}has(e){return null!=this.find(e)}findAllIncludingBlanks(e){const t=[];for(const n of e){const e=this.map[n];t.push(e)}return t}set(e){if(0!==(e=Array.isArray(e)?e:[e]).length)for(const t of e){if(this.map[t.uuid]=t,this.setToTypedMap(t),this.isErrorDecryptingElement(t)?this.invalidsIndex.add(t.uuid):this.invalidsIndex.delete(t.uuid),this.isDecryptedElement(t)){const e=t.content.conflict_of;e&&this.conflictMap.establishRelationship(e,t.uuid),this.referenceMap.setAllRelationships(t.uuid,t.references.map((e=>e.uuid)))}t.dirty?this.dirtyIndex.add(t.uuid):this.dirtyIndex.delete(t.uuid),t.deleted?this.nondeletedIndex.delete(t.uuid):this.nondeletedIndex.add(t.uuid)}else console.warn("Attempting to set 0 elements onto collection")}discard(e){e=Array.isArray(e)?e:[e];for(const t of e)this.deleteFromTypedMap(t),delete this.map[t.uuid],this.conflictMap.removeFromMap(t.uuid),this.referenceMap.removeFromMap(t.uuid)}uuidReferencesForUuid(e){return this.referenceMap.getDirectRelationships(e)}uuidsThatReferenceUuid(e){return this.referenceMap.getInverseRelationships(e)}referencesForElement(e){const t=this.referenceMap.getDirectRelationships(e.uuid);return this.findAll(t)}conflictsOf(e){const t=this.conflictMap.getDirectRelationships(e);return this.findAll(t)}elementsReferencingElement(e,t){const n=this.uuidsThatReferenceUuid(e.uuid),r=this.findAll(n);return t?r.filter((e=>e.content_type===t)):r}setToTypedMap(e){const t=this.typedMap[e.content_type]||[];(0,i.remove)(t,{uuid:e.uuid}),t.push(e),this.typedMap[e.content_type]=t}deleteFromTypedMap(e){const t=this.typedMap[e.content_type]||[];(0,i.remove)(t,{uuid:e.uuid}),this.typedMap[e.content_type]=t}}},74520:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CollectionSort=void 0,t.CollectionSort={CreatedAt:"created_at",UpdatedAt:"userModifiedDate",Title:"title"}},12714:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ItemCollection=void 0;const r=n(99562),i=n(52659);class o extends i.Collection{onChange(e){const t=e.changed.concat(e.inserted);t.length>0&&this.set(t),this.discard(e.discarded)}findDecrypted(e){const t=this.find(e);if(t)return(0,r.isDecryptedItem)(t)?t:void 0}findAllDecrypted(e){return this.findAll(e).filter(r.isDecryptedItem)}findAllDecryptedWithBlanks(e){return this.findAllIncludingBlanks(e).map((e=>{if(null==e||(0,r.isDecryptedItem)(e))return e}))}allDecrypted(e){return this.all(e).filter(r.isDecryptedItem)}}t.ItemCollection=o},6311:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TagItemsIndex=void 0;const r=n(64657),i=n(10256),o=n(72897),a=n(12922);t.TagItemsIndex=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.collection=e,this.observers=t,this.tagToItemsMap={},this.allCountableItems=new Set,this.isItemCountable=e=>!!(0,a.isDecryptedItem)(e)&&!e.archived&&!e.trashed}addCountChangeObserver(e){this.observers.push(e);const t=this.observers;return()=>{(0,r.removeFromArray)(t,e)}}notifyObservers(e){for(const t of this.observers)t(e)}allCountableItemsCount(){return this.allCountableItems.size}countableItemsForTag(e){var t;return(null===(t=this.tagToItemsMap[e.uuid])||void 0===t?void 0:t.size)||0}onChange(e){const t=[...e.changed,...e.inserted,...e.discarded].filter((e=>e.content_type===i.ContentType.Note||e.content_type===i.ContentType.File)),n=[...e.changed,...e.inserted].filter(a.isDecryptedItem).filter(o.isTag);this.receiveItemChanges(t),this.receiveTagChanges(n)}receiveTagChanges(e){for(const t of e){const e=t.references.filter((e=>e.content_type===i.ContentType.Note||e.content_type===i.ContentType.File)).map((e=>e.uuid)).filter((e=>this.allCountableItems.has(e))),n=this.tagToItemsMap[t.uuid];this.tagToItemsMap[t.uuid]=new Set(e),(null==n?void 0:n.size)!==e.length&&this.notifyObservers(t.uuid)}}receiveItemChanges(e){const t=this.allCountableItems.size;for(const t of e){const e=this.isItemCountable(t);e?this.allCountableItems.add(t.uuid):this.allCountableItems.delete(t.uuid);const n=this.collection.uuidsThatReferenceUuid(t.uuid);for(const r of n){const n=this.setForTag(r),i=n.size;e?n.add(t.uuid):n.delete(t.uuid),i!==n.size&&this.notifyObservers(r)}}t!==this.allCountableItems.size&&this.notifyObservers(void 0)}setForTag(e){let t=this.tagToItemsMap[e];return t||(t=new Set,this.tagToItemsMap[e]=t),t}}},35082:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImmutablePayloadCollection=void 0;const r=n(86785);class i extends r.PayloadCollection{get payloads(){return this.all()}static WithPayloads(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=new i;return e.length>0&&t.set(e),Object.freeze(t),t}static FromCollection(e){const t=Object.freeze(Object.assign({},e.map)),n=Object.freeze(Object.assign({},e.typedMap)),r=Object.freeze(e.referenceMap.makeCopy()),o=Object.freeze(e.conflictMap.makeCopy()),a=new i(!0,t,n,r,o);return Object.freeze(a),a}mutableCopy(){const e=Object.assign({},this.map),t=Object.assign({},this.typedMap),n=this.referenceMap.makeCopy(),i=this.conflictMap.makeCopy();return new r.PayloadCollection(!0,e,t,n,i)}}t.ImmutablePayloadCollection=i},86785:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PayloadCollection=void 0;const r=n(52659);class i extends r.Collection{integrityPayloads(){return this.nondeletedElements().map((e=>({uuid:e.uuid,updated_at_timestamp:e.serverUpdatedAtTimestamp})))}}t.PayloadCollection=i},40346:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.extendSyncDelta=void 0;const r=n(64657);t.extendSyncDelta=function(e,t){(0,r.extendArray)(e.emits,t.emits),t.ignored&&(e.ignored||(e.ignored=[]),(0,r.extendArray)(e.ignored,t.ignored))}},49599:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConflictDelta=void 0;const r=n(64657),i=n(24320),o=n(32405),a=n(25569),s=n(30489),c=n(55687),l=n(98890),u=n(10256),d=n(29998),p=n(6754);t.ConflictDelta=class{constructor(e,t,n,r){this.baseCollection=e,this.basePayload=t,this.applyPayload=n,this.historyMap=r}result(){if(this.applyPayload.content_type===u.ContentType.ItemsKey)return new d.ItemsKeyDelta(this.baseCollection,[this.applyPayload]).result();const e=this.getConflictStrategy();return{emits:this.handleStrategy(e),ignored:[]}}getConflictStrategy(){const e=(0,l.isErrorDecryptingPayload)(this.basePayload),t=(0,l.isErrorDecryptingPayload)(this.applyPayload);if(e||t){if(e&&!t)return a.ConflictStrategy.KeepBaseDuplicateApply;if(!e&&t)return a.ConflictStrategy.DuplicateBaseKeepApply;if(e&&t)return a.ConflictStrategy.KeepApply}else{if((0,l.isDecryptedPayload)(this.basePayload)){const e=this.baseCollection.conflictsOf(this.applyPayload.uuid)[0];if(e&&(0,l.isDecryptedPayload)(e)&&(0,l.isDecryptedPayload)(this.applyPayload)&&(0,c.PayloadContentsEqual)(e,this.applyPayload))return a.ConflictStrategy.KeepBase;{const e=(0,i.CreateDecryptedItemFromPayload)(this.basePayload),t=(0,i.CreateItemFromPayload)(this.applyPayload),n=this.historyMap[this.basePayload.uuid]||[],r=o.historyMapFunctions.getNewestRevision(n);return e.strategyWhenConflictingWithItem(t,r)}}if((0,l.isDeletedPayload)(this.basePayload)||(0,l.isDeletedPayload)(this.applyPayload))return(0,l.isDeletedPayload)(this.basePayload),(0,l.isDeletedPayload)(this.applyPayload),a.ConflictStrategy.KeepApply}throw Error("Unhandled strategy in Conflict Delta getConflictStrategy")}handleStrategy(e){if(e===a.ConflictStrategy.KeepBase)return this.handleKeepBaseStrategy();if(e===a.ConflictStrategy.KeepApply)return this.handleKeepApplyStrategy();if(e===a.ConflictStrategy.KeepBaseDuplicateApply)return this.handleKeepBaseDuplicateApplyStrategy();if(e===a.ConflictStrategy.DuplicateBaseKeepApply)return this.handleDuplicateBaseKeepApply();if(e===a.ConflictStrategy.KeepBaseMergeRefs)return this.handleKeepBaseMergeRefsStrategy();throw Error("Unhandled strategy in conflict delta payloadsByHandlingStrategy")}handleKeepBaseStrategy(){const e=(0,r.greaterOfTwoDates)(this.basePayload.serverUpdatedAt,this.applyPayload.serverUpdatedAt),t=Math.max(this.basePayload.updated_at_timestamp,this.applyPayload.updated_at_timestamp);return[this.basePayload.copyAsSyncResolved({updated_at:e,updated_at_timestamp:t,dirtyIndex:(0,p.getIncrementedDirtyIndex)(),dirty:!0,lastSyncEnd:new Date},this.applyPayload.source)]}handleKeepApplyStrategy(){return[this.applyPayload.copyAsSyncResolved({lastSyncBegan:this.basePayload.lastSyncBegan,lastSyncEnd:new Date,dirty:!1},this.applyPayload.source)]}handleKeepBaseDuplicateApplyStrategy(){const e=(0,r.greaterOfTwoDates)(this.basePayload.serverUpdatedAt,this.applyPayload.serverUpdatedAt),t=Math.max(this.basePayload.updated_at_timestamp,this.applyPayload.updated_at_timestamp),n=this.basePayload.copyAsSyncResolved({updated_at:e,updated_at_timestamp:t,dirty:!0,dirtyIndex:(0,p.getIncrementedDirtyIndex)(),lastSyncEnd:new Date},this.applyPayload.source),i=(0,s.PayloadsByDuplicating)({payload:this.applyPayload,baseCollection:this.baseCollection,isConflict:!0,source:this.applyPayload.source});return[n].concat(i)}handleDuplicateBaseKeepApply(){const e=(0,s.PayloadsByDuplicating)({payload:this.basePayload,baseCollection:this.baseCollection,isConflict:!0,source:this.applyPayload.source}),t=this.applyPayload.copyAsSyncResolved({lastSyncBegan:this.basePayload.lastSyncBegan,dirty:!1,lastSyncEnd:new Date},this.applyPayload.source);return e.concat([t])}handleKeepBaseMergeRefsStrategy(){if(!(0,l.isDecryptedPayload)(this.basePayload)||!(0,l.isDecryptedPayload)(this.applyPayload))return[];const e=(0,r.uniqCombineObjArrays)(this.basePayload.content.references,this.applyPayload.content.references,["uuid","content_type"]),t=(0,r.greaterOfTwoDates)(this.basePayload.serverUpdatedAt,this.applyPayload.serverUpdatedAt),n=Math.max(this.basePayload.updated_at_timestamp,this.applyPayload.updated_at_timestamp);return[this.basePayload.copyAsSyncResolved({updated_at:t,updated_at_timestamp:n,dirty:!0,dirtyIndex:(0,p.getIncrementedDirtyIndex)(),lastSyncEnd:new Date,content:Object.assign(Object.assign({},this.basePayload.content),{references:e})},this.applyPayload.source)]}}},19143:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaFileImport=void 0;const r=n(49599),i=n(18667),o=n(40346),a=n(6754);t.DeltaFileImport=class{constructor(e,t,n){this.baseCollection=e,this.applyPayloads=t,this.historyMap=n}result(){const e={emits:[],ignored:[],source:i.PayloadEmitSource.FileImport};for(const t of this.applyPayloads){const n=this.resolvePayload(t,e);(0,o.extendSyncDelta)(e,n)}return e}resolvePayload(e,t){let n=t.emits.find((t=>(0,i.isDecryptedPayload)(t)&&t.content.conflict_of===e.uuid));if(n||(n=t.emits.find((t=>t.uuid===e.uuid))),!n){const t=this.baseCollection.find(e.uuid);t&&(0,i.isDecryptedPayload)(t)&&(n=t)}return n?new r.ConflictDelta(this.baseCollection,n,e,this.historyMap).result():{emits:[e.copyAsSyncResolved({dirty:!0,dirtyIndex:(0,a.getIncrementedDirtyIndex)(),lastSyncEnd:new Date(0)})],ignored:[]}}}},29998:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ItemsKeyDelta=void 0;const r=n(18667),i=n(14939);t.ItemsKeyDelta=class{constructor(e,t){this.baseCollection=e,this.applyPayloads=t}result(){const e=[],t=[];for(const n of this.applyPayloads){const o=this.baseCollection.find(n.uuid);if(o)if((0,r.isEncryptedPayload)(n)&&(0,r.isDecryptedPayload)(o)){const r=o.copyAsSyncResolved({updated_at_timestamp:n.updated_at_timestamp,updated_at:n.updated_at,dirty:!1,lastSyncEnd:new Date});e.push(r),t.push(n)}else e.push((0,i.payloadByFinalizingSyncState)(n,this.baseCollection));else e.push((0,i.payloadByFinalizingSyncState)(n,this.baseCollection))}return{emits:e,ignored:t}}}},65310:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaOfflineSaved=void 0;const r=n(18667),i=n(14939);t.DeltaOfflineSaved=class{constructor(e,t){this.baseCollection=e,this.applyContextualPayloads=t}result(){const e=[];for(const t of this.applyContextualPayloads){const n=this.baseCollection.find(t.uuid);n&&e.push((0,i.payloadByFinalizingSyncState)(n,this.baseCollection))}return{emits:e,source:r.PayloadEmitSource.OfflineSyncSaved}}}},79873:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaOutOfSync=void 0;const r=n(18667),i=n(98890),o=n(55687),a=n(49599),s=n(10256),c=n(29998),l=n(14939),u=n(40346);t.DeltaOutOfSync=class{constructor(e,t,n){this.baseCollection=e,this.applyCollection=t,this.historyMap=n}result(){const e={emits:[],ignored:[],source:r.PayloadEmitSource.RemoteRetrieved};for(const t of this.applyCollection.all()){if(t.content_type===s.ContentType.ItemsKey){const n=new c.ItemsKeyDelta(this.baseCollection,[t]).result();(0,u.extendSyncDelta)(e,n);continue}const n=this.baseCollection.find(t.uuid);if(!n){e.emits.push((0,l.payloadByFinalizingSyncState)(t,this.baseCollection));continue}const r=(0,i.isDecryptedPayload)(n),d=(0,i.isDecryptedPayload)(t);if(d!==r||d&&r&&!(0,o.PayloadContentsEqual)(t,n)){const r=new a.ConflictDelta(this.baseCollection,n,t,this.historyMap);(0,u.extendSyncDelta)(e,r.result())}else e.emits.push((0,l.payloadByFinalizingSyncState)(t,this.baseCollection))}return e}}},89191:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaRemoteDataConflicts=void 0;const r=n(49599),i=n(18667),o=n(40346),a=n(14939);t.DeltaRemoteDataConflicts=class{constructor(e,t,n){this.baseCollection=e,this.applyCollection=t,this.historyMap=n}result(){const e={emits:[],ignored:[],source:i.PayloadEmitSource.RemoteRetrieved};for(const t of this.applyCollection.all()){const n=this.baseCollection.find(t.uuid);if(null==n){e.emits.push((0,a.payloadByFinalizingSyncState)(t,this.baseCollection));continue}const i=new r.ConflictDelta(this.baseCollection,n,t,this.historyMap);(0,o.extendSyncDelta)(e,i.result())}return e}}},79341:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaRemoteRejected=void 0;const r=n(50417),i=n(18667);t.DeltaRemoteRejected=class{constructor(e,t){this.baseCollection=e,this.applyCollection=t}result(){const e=[];for(const t of this.applyCollection.all()){const n=this.baseCollection.find(t.uuid);if(!n)continue;const i=n.copyAsSyncResolved({dirty:!1,lastSyncEnd:new Date},r.PayloadSource.RemoteSaved);e.push(i)}return{emits:e,source:i.PayloadEmitSource.RemoteSaved}}}},66862:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaRemoteRetrieved=void 0;const r=n(49599),i=n(98890),o=n(18667),a=n(10256),s=n(14939),c=n(29998),l=n(40346);t.DeltaRemoteRetrieved=class{constructor(e,t,n,r){this.baseCollection=e,this.applyCollection=t,this.itemsSavedOrSaving=n,this.historyMap=r}isUuidOfPayloadCurrentlySavingOrSaved(e){return null!=this.itemsSavedOrSaving.find((t=>t.uuid===e))}result(){const e={emits:[],ignored:[],source:o.PayloadEmitSource.RemoteRetrieved},t=[];for(const n of this.applyCollection.all()){if(n.content_type===a.ContentType.ItemsKey){const t=new c.ItemsKeyDelta(this.baseCollection,[n]).result();(0,l.extendSyncDelta)(e,t);continue}if(this.isUuidOfPayloadCurrentlySavingOrSaved(n.uuid)){t.push(n);continue}const r=this.baseCollection.find(n.uuid);!(null==r?void 0:r.dirty)||(0,i.isErrorDecryptingPayload)(r)?e.emits.push((0,s.payloadByFinalizingSyncState)(n,this.baseCollection)):t.push(n)}for(const n of t){if(!(0,i.isDecryptedPayload)(n))continue;const t=this.baseCollection.find(n.uuid);if(!t)continue;const o=new r.ConflictDelta(this.baseCollection,t,n,this.historyMap);(0,l.extendSyncDelta)(e,o.result())}return e}}},17759:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaRemoteSaved=void 0;const r=n(63188),i=n(50417),o=n(98890),a=n(18667),s=n(14939),c=n(57650),l=n(6754);t.DeltaRemoteSaved=class{constructor(e,t){this.baseCollection=e,this.applyContextualPayloads=t}result(){const e=[];for(const t of this.applyContextualPayloads){const n=this.baseCollection.find(t.uuid);if(n)if((0,o.isDeletedPayload)(n)){const o=!t.deleted,a=t.deleted;if(o){const n=new r.DeletedPayload(Object.assign(Object.assign(Object.assign({},t),{deleted:!0,content:void 0,dirtyIndex:(0,l.getIncrementedDirtyIndex)()}),(0,c.BuildSyncResolvedParams)({dirty:!0,lastSyncEnd:new Date})),i.PayloadSource.RemoteSaved);e.push(n)}else if(a){const r=n.copy(Object.assign(Object.assign(Object.assign({},t),{deleted:!0}),(0,c.BuildSyncResolvedParams)({dirty:!1,lastSyncEnd:new Date})),i.PayloadSource.RemoteSaved);e.push(r)}}else{const r=(0,s.payloadByFinalizingSyncState)(n.copy(Object.assign(Object.assign({},t),{deleted:!1}),i.PayloadSource.RemoteSaved),this.baseCollection);e.push(r)}else{const n=new r.DeletedPayload(Object.assign(Object.assign(Object.assign({},t),{deleted:!0,content:void 0}),(0,c.BuildSyncResolvedParams)({dirty:!1,lastSyncEnd:new Date})),i.PayloadSource.RemoteSaved);e.push(n)}}return{emits:e,source:a.PayloadEmitSource.RemoteSaved}}}},28637:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaRemoteUuidConflicts=void 0;const r=n(64657),i=n(35082),o=n(24439),a=n(98890),s=n(18667);t.DeltaRemoteUuidConflicts=class{constructor(e,t){this.baseCollection=e,this.applyCollection=t}result(){const e=[],t=this.baseCollection.mutableCopy();for(const n of this.applyCollection.all()){const s=e.find((e=>e.uuid===n.uuid))||n;if(!(0,a.isDecryptedPayload)(s))continue;const c=(0,o.PayloadsByAlternatingUuid)(s,i.ImmutablePayloadCollection.FromCollection(t));t.set(c),(0,r.filterFromArray)(e,(e=>(0,r.Uuids)(c).includes(e.uuid))),(0,r.extendArray)(e,c)}return{emits:e,source:s.PayloadEmitSource.RemoteRetrieved}}}},14939:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.payloadsByFinalizingSyncState=t.payloadByFinalizingSyncState=void 0;const r=n(6754);function i(e,t){const n=t.find(e.uuid);if(!n)return e.copyAsSyncResolved({dirty:!1,lastSyncEnd:new Date});const i=!(!n.dirtyIndex||!n.globalDirtyIndexAtLastSync)&&n.dirtyIndex>n.globalDirtyIndexAtLastSync;return e.copyAsSyncResolved({dirty:i,dirtyIndex:i?(0,r.getIncrementedDirtyIndex)():void 0,lastSyncEnd:new Date})}t.payloadByFinalizingSyncState=i,t.payloadsByFinalizingSyncState=function(e,t){return e.map((e=>i(e,t)))}},57650:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BuildSyncResolvedParams=void 0,t.BuildSyncResolvedParams=function(e){return e}},1750:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(49599),t),i(n(19143),t),i(n(79873),t),i(n(89191),t),i(n(66862),t),i(n(17759),t),i(n(65310),t),i(n(28637),t),i(n(79341),t),i(n(40346),t)},6754:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentDirtyIndex=t.getIncrementedDirtyIndex=void 0;let n=0;t.getIncrementedDirtyIndex=function(){return n++,n},t.getCurrentDirtyIndex=function(){return n}},23072:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},23075:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.computeFiltersForDisplayOptions=t.computeUnifiedFilterForDisplayOptions=void 0;const r=n(10256),i=n(4103),o=n(1265),a=n(52252);function s(e,t){const n=[];let s;if(e.views&&e.views.length>0){const a=new i.CompoundPredicate("and",e.views.map((e=>e.predicate)));s=a,n.push((e=>{if(a.keypathIncludesString("tags")){const n=o.ItemWithTags.Create(e.payload,e,t.elementsReferencingElement(e,r.ContentType.Tag));return a.matchesItem(n)}return a.matchesItem(e)}))}if(e.tags&&e.tags.length>0)for(const t of e.tags)n.push((e=>t.isReferencingItem(e)));if(!1!==e.includePinned||(null==s?void 0:s.keypathIncludesString("pinned"))||n.push((e=>!e.pinned)),!1!==e.includeProtected||(null==s?void 0:s.keypathIncludesString("protected"))||n.push((e=>!e.protected)),!1!==e.includeTrashed||(null==s?void 0:s.keypathIncludesString("trashed"))||n.push((e=>!e.trashed)),!1!==e.includeArchived||(null==s?void 0:s.keypathIncludesString("archived"))||n.push((e=>!e.archived)),e.searchQuery){const r=e.searchQuery;n.push((e=>(0,a.itemMatchesQuery)(e,r,t)))}return n}t.computeUnifiedFilterForDisplayOptions=function(e,t){const n=s(e,t);return e=>(0,a.itemPassesFilters)(e,n)},t.computeFiltersForDisplayOptions=s},69089:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ItemDisplayController=void 0;const r=n(64657),i=n(12922),o=n(97713);t.ItemDisplayController=class{constructor(e,t,n){this.collection=e,this.contentTypes=t,this.options=n,this.sortMap={},this.sortedItems=[],this.needsSort=!0,this.filterThenSortElements(this.collection.all(this.contentTypes))}items(){return this.sortedItems}setDisplayOptions(e){this.options=Object.assign(Object.assign({},this.options),e),this.needsSort=!0,this.filterThenSortElements(this.collection.all(this.contentTypes))}onCollectionChange(e){const t=[...e.changed,...e.inserted,...e.discarded].filter((e=>this.contentTypes.includes(e.content_type)));this.filterThenSortElements(t)}filterThenSortElements(e){var t;for(const n of e){const e=this.sortMap[n.uuid],o=null!=e?this.sortedItems[e]:void 0,a=()=>{null!=e&&(delete this.sortMap[n.uuid],this.sortedItems[e]=void 0,this.needsSort=!0)};if((0,i.isDeletedItem)(n)||(0,i.isEncryptedItem)(n))a();else if(!this.collection.has(n.uuid)||(null===(t=this.options.hiddenContentTypes)||void 0===t?void 0:t.includes(n.content_type))||this.options.customFilter&&!this.options.customFilter(n))a();else if(null!=o){const t=o[this.options.sortBy],i=n[this.options.sortBy];this.sortedItems[e]=n;const a=o.pinned!==n.pinned;(0,r.compareValues)(t,i)&&!a||(this.needsSort=!0)}else this.sortedItems.push(n),this.needsSort=!0}this.needsSort&&(this.needsSort=!1,this.resortItems())}resortItems(){const e=this.sortedItems.sort(((e,t)=>(0,o.sortTwoItems)(e,t,this.options.sortBy,this.options.sortDirection))),t=[];let n=0;for(const r of e)r&&(t.push(r),this.sortMap[r.uuid]=n,n++);this.sortedItems=t}}},1265:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ItemWithTags=void 0;const r=n(12922);class i extends r.DecryptedItem{constructor(e,t,n){super(e),this.item=t,this.tags=n,this.tags=n||e.content.tags}static Create(e,t,n){return new i(e,t,n)}get tagsCount(){var e;return(null===(e=this.tags)||void 0===e?void 0:e.length)||0}get title(){return this.item.title}get text(){return this.item.text}}t.ItemWithTags=i},52252:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.itemMatchesQuery=t.itemPassesFilters=t.itemsMatchingOptions=void 0;const r=n(10256),i=n(23075);var o;function a(e,t){for(const n of t)if(!n(e))return!1;return!0}function s(e,t){var n,r;if(0===t.length)return o.TitleAndText;const i=null===(n=e.title)||void 0===n?void 0:n.toLowerCase(),a=null===(r=e.text)||void 0===r?void 0:r.toLowerCase(),s=t.toLowerCase(),c=s.split(" "),l=function(e){const t=e.match(/"(.*?)"/);return t?t[1]:null}(s);if(l)return((null==i?void 0:i.includes(l))?o.Title:o.None)+((null==a?void 0:a.includes(l))?o.Text:o.None);if(function(e){return!!e.match(/\b[0-9a-f]{8}\b-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-\b[0-9a-f]{12}\b/)}(s))return e.uuid===s?o.Uuid:o.None;const u=i&&c.every((e=>i.indexOf(e)>=0)),d=a&&c.every((e=>a.indexOf(e)>=0));return(u?o.Title:0)+(d?o.Text:0)}!function(e){e[e.None=0]="None",e[e.Title=1]="Title",e[e.Text=2]="Text",e[e.TitleAndText=3]="TitleAndText",e[e.Uuid=5]="Uuid"}(o||(o={})),t.itemsMatchingOptions=function(e,t,n){const r=(0,i.computeFiltersForDisplayOptions)(e,n);return t.filter((e=>a(e,r)))},t.itemPassesFilters=a,t.itemMatchesQuery=function(e,t,n){const i=n.elementsReferencingElement(e,r.ContentType.Tag).some((e=>s(e,t.query)!==o.None));if(e.protected&&!t.includeProtectedNoteText){const n=s(e,t.query);return n===o.Title||n===o.TitleAndText||i}return s(e,t.query)!==o.None||i}},26159:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},43142:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},97713:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sortTwoItems=t.KeepSameOrder=t.SortRightFirst=t.SortLeftFirst=void 0;const r=n(64657),i=n(74520);t.SortLeftFirst=-1,t.SortRightFirst=1,t.KeepSameOrder=0,t.sortTwoItems=function e(n,o,a,s){let c=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!n)return t.SortLeftFirst;if(!o)return t.SortRightFirst;if(!c){if(n.pinned&&o.pinned)return e(n,o,a,s,!0);if(n.pinned)return t.SortLeftFirst;if(o.pinned)return t.SortRightFirst}const l=n[a]||"",u=o[a]||"",d="asc"===s;let p=t.KeepSameOrder;p=a===i.CollectionSort.Title&&(0,r.isString)(l)&&(0,r.isString)(u)&&l.length>0&&u.length>0?l.localeCompare(u,"en",{numeric:!0}):l>u?t.SortRightFirst:l<u?t.SortLeftFirst:t.KeepSameOrder;const h=p===t.SortLeftFirst,y=p===t.SortRightFirst;return h?d?t.SortLeftFirst:t.SortRightFirst:y?d?t.SortRightFirst:t.SortLeftFirst:t.KeepSameOrder}},87425:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},98295:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(23072),t),i(n(23075),t),i(n(69089),t),i(n(1265),t),i(n(26159),t),i(n(52252),t),i(n(43142),t),i(n(87425),t)},22558:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateHistoryEntryForPayload=void 0;const r=n(10256),i=n(57792),o=n(99438);t.CreateHistoryEntryForPayload=function(e,t){return new(e.content_type===r.ContentType.Note?o.NoteHistoryEntry:i.HistoryEntry)(e,t)}},57792:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HistoryEntry=void 0;const r=n(64657),i=n(24320);t.HistoryEntry=class{constructor(e,t){var n;this.defaultContentKeyToDiffOn="text",this.payload=e.copy(),this.previousEntry=t,this.hasPreviousEntry=!(0,r.isNullOrUndefined)(t);const i=this.payload.content[this.defaultContentKeyToDiffOn];if(i)if(t){const e=(null===(n=t.payload.content[this.defaultContentKeyToDiffOn])||void 0===n?void 0:n.length)||0;this.textCharDiffLength=i.length-e}else this.textCharDiffLength=i.length;else this.textCharDiffLength=0}itemFromPayload(){return(0,i.CreateDecryptedItemFromPayload)(this.payload)}isSameAsEntry(e){if(!e)return!1;const t=this.itemFromPayload(),n=e.itemFromPayload();return!(t.userModifiedDate.getTime()!==n.userModifiedDate.getTime())&&t.isItemContentEqualWith(n)}isDiscardable(){return!1}operationVector(){return void 0!==this.textCharDiffLength?this.hasPreviousEntry&&0!==this.textCharDiffLength?this.textCharDiffLength<0?-1:1:0:1}deltaSize(){return void 0!==this.textCharDiffLength?Math.abs(this.textCharDiffLength):1}}},6777:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},32405:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.historyMapFunctions=void 0,t.historyMapFunctions={getNewestRevision:e=>e[0]}},99438:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoteHistoryEntry=void 0;const r=n(64657),i=n(57792);class o extends i.HistoryEntry{previewTitle(){return this.payload.updated_at.getTime()>0?this.payload.updated_at.toLocaleString():this.payload.created_at.toLocaleString()}previewSubTitle(){return this.hasPreviousEntry?this.textCharDiffLength<0?"".concat(-1*this.textCharDiffLength," characters removed"):this.textCharDiffLength>0?"".concat(this.textCharDiffLength," characters added"):"Title or metadata changed":"".concat(this.textCharDiffLength," characters loaded")}isDiscardable(){return(0,r.isEmpty)(this.payload.content.text)}}t.NoteHistoryEntry=o},63874:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(22558),t),i(n(57792),t),i(n(32405),t),i(n(99438),t),i(n(6777),t)},66658:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateItemDelta=void 0,t.CreateItemDelta=function(e){return{changed:e.changed||[],inserted:e.inserted||[],discarded:e.discarded||[],ignored:e.ignored||[],unerrored:e.unerrored||[]}}},83883:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},4103:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CompoundPredicate=void 0,t.CompoundPredicate=class{constructor(e,t){this.operator=e,this.predicates=t}matchesItem(e){if("and"===this.operator){for(const t of this.predicates)if(!t.matchesItem(e))return!1;return!0}if("or"===this.operator){for(const t of this.predicates)if(t.matchesItem(e))return!0;return!1}return!1}keypathIncludesString(e){for(const t of this.predicates)if(t.keypathIncludesString(e))return!0;return!1}toJson(){return{operator:this.operator,value:this.predicates.map((e=>e.toJson()))}}}},41291:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.predicateFromDSLString=t.predicateFromJson=t.includesPredicateFromArguments=t.notPredicateFromArguments=t.compoundPredicateFromArguments=t.predicateFromArguments=void 0;const r=n(4103),i=n(37436),o=n(72650),a=n(54981),s=n(95536);function c(e,t,n){if(o.AllPredicateCompoundOperators.includes(t))return l(t,n);if("not"===t)return new a.NotPredicate(u(n));if("includes"===t&&e)return function(e){return!!o.SureValueNonObjectTypesAsStrings.includes(typeof e)||!!Array.isArray(e)&&!d(e)}(n)?new s.Predicate(e,t,n):new i.IncludesPredicate(e,u(n));if(e)return new s.Predicate(e,t,n);throw Error("Invalid predicate arguments")}function l(e,t){const n=t.map((e=>u(e)));return new r.CompoundPredicate(e,n)}function u(e){if(Array.isArray(e))throw Error("Invalid predicateFromJson value");return c(e.keypath,e.operator,d(e.value)?p(e.value):e.value)}function d(e){return Array.isArray(e)&&o.AllPredicateOperators.includes(e[1])}function p(e){const t=e[2];let n;if(Array.isArray(t)){const e=t;n=Array.isArray(e[0])?e.map((e=>p(e))):d(t[1])?p(e):t}else n=t;return{keypath:e[0],operator:e[1],value:n}}t.predicateFromArguments=c,t.compoundPredicateFromArguments=l,t.notPredicateFromArguments=function(e){const t=u(e);return new a.NotPredicate(t)},t.includesPredicateFromArguments=function(e,t){const n=u(t);return new i.IncludesPredicate(e,n)},t.predicateFromJson=u,t.predicateFromDSLString=function(e){try{const t=JSON.parse(e.substring(1,e.length));return t.shift(),u(p(t))}catch(e){throw Error("Invalid smart view syntax ".concat(e))}}},37436:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IncludesPredicate=void 0,t.IncludesPredicate=class{constructor(e,t){this.keypath=e,this.predicate=t}matchesItem(e){const t=this.keypath.split(".").reduce(((e,t)=>e&&e[t]),e);return!!Array.isArray(t)&&t.some((e=>this.predicate.matchesItem(e)))}keypathIncludesString(e){return this.keypath.includes(e)}toJson(){return{keypath:this.keypath,operator:"includes",value:this.predicate.toJson()}}}},72650:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SureValueNonObjectTypesAsStrings=t.AllPredicateOperators=t.AllPredicateCompoundOperators=void 0,t.AllPredicateCompoundOperators=["and","or"],t.AllPredicateOperators=[...t.AllPredicateCompoundOperators,"!=","=","<",">","<=",">=","startsWith","in","matches","not","includes"],t.SureValueNonObjectTypesAsStrings=["number","string","boolean"]},54981:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NotPredicate=void 0,t.NotPredicate=class{constructor(e){this.predicate=e}matchesItem(e){return!this.predicate.matchesItem(e)}keypathIncludesString(e){return this.predicate.keypathIncludesString(e)}toJson(){return{operator:"not",value:this.predicate.toJson()}}}},36640:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.valueMatchesTargetValue=void 0;const r=n(64657),i=n(25929);t.valueMatchesTargetValue=function e(t,n,o){if(null==o)return!1;if("string"==typeof o&&o.includes(".ago")&&(o=(0,i.dateFromDSLDateString)(o)),"string"==typeof o&&(o=o.toLowerCase()),"string"==typeof t&&(t=t.toLowerCase()),"not"===n)return!e(t,"=",o);if(null==t){const e=[!1,"",null,void 0,NaN].includes(o);return"!="===n?!e:e}if("="===n)return Array.isArray(t)?JSON.stringify(t)===JSON.stringify(o):t===o;if("!="===n)return Array.isArray(t)?JSON.stringify(t)!==JSON.stringify(o):t!==o;if("<"===n)return t<o;if(">"===n)return t>o;if("<="===n)return t<=o;if(">="===n)return t>=o;if("startsWith"===n)return t.startsWith(o);if("in"===n&&Array.isArray(o))return o.includes(t);if("includes"===n){if((0,r.isString)(t))return t.includes(o);if((0,r.isString)(o)&&((0,r.isString)(t)||Array.isArray(t)))return t.includes(o)}return"matches"===n&&new RegExp(o).test(t)}},95536:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate=void 0;const r=n(36640);t.Predicate=class{constructor(e,t,n){this.keypath=e,this.operator=t,this.targetValue=n,"true"!==this.targetValue&&"false"!==this.targetValue||(this.targetValue=JSON.parse(this.targetValue))}keypathIncludesString(e){return this.keypath.includes(e)}matchesItem(e){const t=this.keypath.split(".").reduce(((e,t)=>e&&e[t]),e);return(0,r.valueMatchesTargetValue)(t,this.operator,this.targetValue)}toJson(){return{keypath:this.keypath,operator:this.operator,value:this.targetValue}}}},25929:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dateFromDSLDateString=void 0,t.dateFromDSLDateString=function(e){const t=e.split("."),n=t[1],r=new Date,i=parseInt(t[0]);return"days"===n?r.setDate(r.getDate()-i):"hours"===n&&r.setHours(r.getHours()-i),r}},61079:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SNActionsExtension=void 0;const r=n(59867),i=n(25569);class o extends r.DecryptedItem{constructor(e){super(e),this.actions=[],this.name=e.content.name||"",this.description=e.content.description||"",this.url=e.content.hosted_url||e.content.url,this.supported_types=e.content.supported_types,this.package_info=this.payload.content.package_info||{},this.deprecation=e.content.deprecation,this.actions=e.content.actions}get displayName(){return this.name}get thirdPartyPackageInfo(){return this.package_info}get isListedExtension(){return"org.standardnotes.listed"===this.package_info.identifier}actionsWithContextForItem(e){return this.actions.filter((t=>t.context===e.content_type||"Item"===t.context))}strategyWhenConflictingWithItem(e,t){return i.ConflictStrategy.KeepBase}}t.SNActionsExtension=o},83062:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ActionsExtensionMutator=void 0;const r=n(66276);class i extends r.DecryptedItemMutator{set description(e){this.mutableContent.description=e}set supported_types(e){this.mutableContent.supported_types=e}set actions(e){this.mutableContent.actions=e}set deprecation(e){this.mutableContent.deprecation=e}}t.ActionsExtensionMutator=i},87966:(e,t)=>{var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.ActionVerb=t.ActionAccessType=void 0,(r=t.ActionAccessType||(t.ActionAccessType={})).Encrypted="encrypted",r.Decrypted="decrypted",(n=t.ActionVerb||(t.ActionVerb={})).Get="get",n.Render="render",n.Show="show",n.Post="post",n.Nested="nested"},93261:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(61079),t),i(n(83062),t),i(n(87966),t)},58892:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SNComponent=t.isComponentOrTheme=t.isComponent=void 0;const r=n(64657),i=n(10256),o=n(70295),a=n(47759),s=n(25569),c=n(59867),l=n(95536);t.isComponent=e=>e.content_type===i.ContentType.Component,t.isComponentOrTheme=e=>e.content_type===i.ContentType.Component||e.content_type===i.ContentType.Theme;class u extends c.DecryptedItem{constructor(e){super(e),this.permissions=[],this.componentData=this.payload.content.componentData||{},e.content.hosted_url&&(0,r.isValidUrl)(e.content.hosted_url)?this.hosted_url=e.content.hosted_url:e.content.url&&(0,r.isValidUrl)(e.content.url)?this.hosted_url=e.content.url:e.content.legacy_url&&(0,r.isValidUrl)(e.content.legacy_url)&&(this.hosted_url=e.content.legacy_url),this.local_url=e.content.local_url,this.valid_until=new Date(e.content.valid_until||0),this.offlineOnly=e.content.offlineOnly,this.name=e.content.name,this.area=e.content.area,this.package_info=e.content.package_info||{},this.permissions=e.content.permissions||[],this.active=e.content.active,this.autoupdateDisabled=e.content.autoupdateDisabled,this.disassociatedItemIds=e.content.disassociatedItemIds||[],this.associatedItemIds=e.content.associatedItemIds||[],this.isMobileDefault=e.content.isMobileDefault,this.legacy_url=e.content.hosted_url?void 0:e.content.url}strategyWhenConflictingWithItem(e,t){return s.ConflictStrategy.KeepBase}get isSingleton(){return!0}get displayName(){var e;return(null===(e=(0,o.FindNativeFeature)(this.identifier))||void 0===e?void 0:e.name)||this.name}singletonPredicate(){return new l.Predicate("identifier","=",this.identifier)}isEditor(){return this.area===o.ComponentArea.Editor}isTheme(){return this.content_type===i.ContentType.Theme||this.area===o.ComponentArea.Themes}isDefaultEditor(){return!0===this.getAppDomainValue(a.AppDataField.DefaultEditor)}getLastSize(){return this.getAppDomainValue(a.AppDataField.LastSize)}getClientDataKey(){return this.legacy_url?this.legacy_url:this.uuid}hasValidHostedUrl(){return null!=(this.hosted_url||this.legacy_url)}contentKeysToIgnoreWhenCheckingEquality(){return["active","disassociatedItemIds","associatedItemIds",...super.contentKeysToIgnoreWhenCheckingEquality()]}static associativeAreas(){return[o.ComponentArea.Editor]}isAssociative(){return u.associativeAreas().includes(this.area)}isExplicitlyEnabledForItem(e){return-1!==this.associatedItemIds.indexOf(e)}isExplicitlyDisabledForItem(e){return-1!==this.disassociatedItemIds.indexOf(e)}get isExpired(){return this.valid_until.getTime()>0&&this.valid_until<=new Date}get identifier(){return this.package_info.identifier}get thirdPartyPackageInfo(){return this.package_info}get noteType(){return this.package_info.note_type||o.NoteType.Plain}get isDeprecated(){var e;let t=null!==(e=this.package_info.flags)&&void 0!==e?e:[];return t=t.map((e=>e.toLowerCase())),t.includes(o.ComponentFlag.Deprecated)}get deprecationMessage(){return this.package_info.deprecation_message}}t.SNComponent=u},48072:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},54712:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentMutator=void 0;const r=n(64657),i=n(47759),o=n(66276);class a extends o.DecryptedItemMutator{set active(e){this.mutableContent.active=e}set isMobileDefault(e){this.mutableContent.isMobileDefault=e}set defaultEditor(e){this.setAppDataItem(i.AppDataField.DefaultEditor,e)}set componentData(e){this.mutableContent.componentData=e}set package_info(e){this.mutableContent.package_info=e}set local_url(e){this.mutableContent.local_url=e}set hosted_url(e){this.mutableContent.hosted_url=e}set valid_until(e){this.mutableContent.valid_until=e}set permissions(e){this.mutableContent.permissions=e}set name(e){this.mutableContent.name=e}set offlineOnly(e){this.mutableContent.offlineOnly=e}associateWithItem(e){const t=this.mutableContent.associatedItemIds||[];(0,r.addIfUnique)(t,e),this.mutableContent.associatedItemIds=t}disassociateWithItem(e){const t=this.mutableContent.disassociatedItemIds||[];(0,r.addIfUnique)(t,e),this.mutableContent.disassociatedItemIds=t}removeAssociatedItemId(e){(0,r.removeFromArray)(this.mutableContent.associatedItemIds||[],e)}removeDisassociatedItemId(e){(0,r.removeFromArray)(this.mutableContent.disassociatedItemIds||[],e)}setLastSize(e){this.setAppDataItem(i.AppDataField.LastSize,e)}}t.ComponentMutator=a},15834:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(58892),t),i(n(54712),t),i(n(48072),t)},3322:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SNEditor=void 0;const r=n(59867);class i extends r.DecryptedItem{constructor(e){super(e),this.notes=[],this.data={},this.url=e.content.url,this.name=e.content.name,this.data=e.content.data||{},this.isDefault=e.content.default,this.systemEditor=e.content.systemEditor}}t.SNEditor=i},69109:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(3322),t)},54246:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SNFeatureRepo=void 0;const r=n(64657),i=n(59867);class o extends i.DecryptedItem{get migratedToUserSetting(){return(0,r.useBoolean)(this.payload.content.migratedToUserSetting,!1)}get migratedToOfflineEntitlements(){return(0,r.useBoolean)(this.payload.content.migratedToOfflineEntitlements,!1)}get onlineUrl(){return this.payload.content.url}get offlineFeaturesUrl(){return this.payload.content.offlineFeaturesUrl}get offlineKey(){return this.payload.content.offlineKey}}t.SNFeatureRepo=o},39231:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureRepoMutator=void 0;const r=n(66276);class i extends r.DecryptedItemMutator{set migratedToUserSetting(e){this.mutableContent.migratedToUserSetting=e}set migratedToOfflineEntitlements(e){this.mutableContent.migratedToOfflineEntitlements=e}set offlineFeaturesUrl(e){this.mutableContent.offlineFeaturesUrl=e}set offlineKey(e){this.mutableContent.offlineKey=e}}t.FeatureRepoMutator=i},28346:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(54246),t),i(n(39231),t)},23899:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileItem=t.isFile=void 0;const r=n(59867),i=n(12922),o=n(10256);t.isFile=e=>e.content_type===o.ContentType.File;class a extends r.DecryptedItem{constructor(e){super(e),this.remoteIdentifier=this.content.remoteIdentifier,this.name=this.content.name,this.key=this.content.key,this.content.size&&this.content.chunkSizes?(this.decryptedSize=this.content.size,this.encryptedChunkSizes=this.content.chunkSizes):(this.decryptedSize=this.content.decryptedSize,this.encryptedChunkSizes=this.content.encryptedChunkSizes),this.encryptionHeader=this.content.encryptionHeader,this.mimeType=this.content.mimeType}strategyWhenConflictingWithItem(e){return e.key!==this.key||e.encryptionHeader!==this.encryptionHeader||e.remoteIdentifier!==this.remoteIdentifier||JSON.stringify(e.encryptedChunkSizes)!==JSON.stringify(this.encryptedChunkSizes)?i.ConflictStrategy.KeepBaseDuplicateApply:i.ConflictStrategy.KeepBase}get encryptedSize(){return this.encryptedChunkSizes.reduce(((e,t)=>e+t),0)}get title(){return this.name}}t.FileItem=a},50324:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},71554:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileMutator=void 0;const r=n(10256),i=n(21984),o=n(66276);class a extends o.DecryptedItemMutator{set name(e){this.mutableContent.name=e}set encryptionHeader(e){this.mutableContent.encryptionHeader=e}addNote(e){const t={reference_type:i.ContentReferenceType.FileToNote,content_type:r.ContentType.Note,uuid:e.uuid},n=this.mutableContent.references||[];n.push(t),this.mutableContent.references=n}removeNote(e){const t=this.immutableItem.references.filter((t=>t.uuid!==e.uuid));this.mutableContent.references=t}addFile(e){if(this.immutableItem.isReferencingItem(e))return;const t={uuid:e.uuid,content_type:r.ContentType.File,reference_type:i.ContentReferenceType.FileToFile};this.mutableContent.references.push(t)}removeFile(e){this.mutableContent.references=this.mutableContent.references.filter((t=>t.uuid!==e.uuid))}}t.FileMutator=a},75006:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.FileProtocolV1Constants=void 0,(n=t.FileProtocolV1Constants||(t.FileProtocolV1Constants={}))[n.KeySize=256]="KeySize"},49740:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(23899),t),i(n(71554),t),i(n(50324),t),i(n(75006),t)},59536:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3338:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},55998:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SNNote=t.isNote=void 0;const r=n(47759),i=n(10256),o=n(70295),a=n(59867);t.isNote=e=>e.content_type===i.ContentType.Note;class s extends a.DecryptedItem{constructor(e){super(e),this.hidePreview=!1,this.title=String(this.payload.content.title||""),this.text=String(this.payload.content.text||""),this.preview_plain=String(this.payload.content.preview_plain||""),this.preview_html=String(this.payload.content.preview_html||""),this.hidePreview=Boolean(this.payload.content.hidePreview),this.spellcheck=this.payload.content.spellcheck,this.noteType=this.payload.content.noteType,this.editorIdentifier=this.payload.content.editorIdentifier,this.authorizedForListed=this.payload.content.authorizedForListed||!1,this.noteType||this.getAppDomainValueWithDefault(r.AppDataField.LegacyPrefersPlainEditor,!1)&&(this.noteType=o.NoteType.Plain)}}t.SNNote=s},29833:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},50943:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoteMutator=void 0;const r=n(66276),i=n(10256),o=n(12922);class a extends r.DecryptedItemMutator{set title(e){this.mutableContent.title=e}set text(e){this.mutableContent.text=e}set hidePreview(e){this.mutableContent.hidePreview=e}set preview_plain(e){this.mutableContent.preview_plain=e}set preview_html(e){this.mutableContent.preview_html=e}set spellcheck(e){this.mutableContent.spellcheck=e}set noteType(e){this.mutableContent.noteType=e}set editorIdentifier(e){this.mutableContent.editorIdentifier=e}set authorizedForListed(e){this.mutableContent.authorizedForListed=e}toggleSpellcheck(){null==this.mutableContent.spellcheck?this.mutableContent.spellcheck=!1:this.mutableContent.spellcheck=!this.mutableContent.spellcheck}addNote(e){if(this.immutableItem.isReferencingItem(e))return;const t={uuid:e.uuid,content_type:i.ContentType.Note,reference_type:o.ContentReferenceType.NoteToNote};this.mutableContent.references.push(t)}removeNote(e){this.mutableContent.references=this.mutableContent.references.filter((t=>t.uuid!==e.uuid))}}t.NoteMutator=a},23251:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(55998),t),i(n(50943),t),i(n(29833),t)},33652:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SmartView=t.isSmartView=t.isSystemView=t.SMART_TAG_DSL_PREFIX=void 0;const r=n(59867),i=n(41291),o=n(86865),a=n(36176),s=n(10256);function c(e){return Object.values(o.SystemViewId).includes(e.uuid)}t.SMART_TAG_DSL_PREFIX="![",t.isSystemView=c,t.isSmartView=e=>e.content_type===s.ContentType.SmartView;class l extends r.DecryptedItem{constructor(e){super(e),this.title=String(this.content.title||""),c(this)?this.iconString=(0,a.systemViewIcon)(this.uuid):this.iconString=this.payload.content.iconString||a.SmartViewDefaultIconName,this.preferences=this.payload.content.preferences;try{this.predicate=this.content.predicate&&(0,i.predicateFromJson)(this.content.predicate)}catch(e){console.error(e)}}}t.SmartView=l},55874:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BuildSmartViews=void 0;const r=n(38111),i=n(33652),o=n(86865),a=n(10256),s=n(23767),c=n(95536),l=n(4103),u=n(18667);function d(e){const t=[new c.Predicate("content_type","=",a.ContentType.Note)];return!1===e.includeTrashed&&t.push(new c.Predicate("trashed","=",!1)),!1===e.includeArchived&&t.push(new c.Predicate("archived","=",!1)),!1===e.includeProtected&&t.push(new c.Predicate("protected","=",!1)),!1===e.includePinned&&t.push(new c.Predicate("pinned","=",!1)),new l.CompoundPredicate("and",t)}function p(e){const t=[new c.Predicate("content_type","=",a.ContentType.File)];return!1===e.includeTrashed&&t.push(new c.Predicate("trashed","=",!1)),!1===e.includeArchived&&t.push(new c.Predicate("archived","=",!1)),!1===e.includeProtected&&t.push(new c.Predicate("protected","=",!1)),!1===e.includePinned&&t.push(new c.Predicate("pinned","=",!1)),new l.CompoundPredicate("and",t)}function h(e){const t=[new c.Predicate("archived","=",!0),new c.Predicate("content_type","=",a.ContentType.Note)];return!1===e.includeTrashed&&t.push(new c.Predicate("trashed","=",!1)),!1===e.includeProtected&&t.push(new c.Predicate("protected","=",!1)),!1===e.includePinned&&t.push(new c.Predicate("pinned","=",!1)),new l.CompoundPredicate("and",t)}function y(e){const t=[new c.Predicate("trashed","=",!0),new c.Predicate("content_type","=",a.ContentType.Note)];return!1===e.includeArchived&&t.push(new c.Predicate("archived","=",!1)),!1===e.includeProtected&&t.push(new c.Predicate("protected","=",!1)),!1===e.includePinned&&t.push(new c.Predicate("pinned","=",!1)),new l.CompoundPredicate("and",t)}function f(e){const t=[new c.Predicate("content_type","=",a.ContentType.Note),new c.Predicate("tagsCount","=",0)];return!1===e.includeArchived&&t.push(new c.Predicate("archived","=",!1)),!1===e.includeProtected&&t.push(new c.Predicate("protected","=",!1)),!1===e.includePinned&&t.push(new c.Predicate("pinned","=",!1)),new l.CompoundPredicate("and",t)}function v(e){const t=[new c.Predicate("starred","=",!0),new c.Predicate("content_type","=",a.ContentType.Note)];return!1===e.includeTrashed&&t.push(new c.Predicate("trashed","=",!1)),!1===e.includeProtected&&t.push(new c.Predicate("protected","=",!1)),!1===e.includePinned&&t.push(new c.Predicate("pinned","=",!1)),new l.CompoundPredicate("and",t)}t.BuildSmartViews=function(e,t){let{supportsFileNavigation:n=!1}=t;const c=new i.SmartView(new r.DecryptedPayload(Object.assign(Object.assign({uuid:o.SystemViewId.AllNotes,content_type:a.ContentType.SmartView},(0,u.PayloadTimestampDefaults)()),{content:(0,s.FillItemContent)({title:"Notes",predicate:d(e).toJson()})}))),l=new i.SmartView(new r.DecryptedPayload(Object.assign(Object.assign({uuid:o.SystemViewId.Files,content_type:a.ContentType.SmartView},(0,u.PayloadTimestampDefaults)()),{content:(0,s.FillItemContent)({title:"Files",predicate:p(e).toJson()})}))),m=new i.SmartView(new r.DecryptedPayload(Object.assign(Object.assign({uuid:o.SystemViewId.ArchivedNotes,content_type:a.ContentType.SmartView},(0,u.PayloadTimestampDefaults)()),{content:(0,s.FillItemContent)({title:"Archived",predicate:h(e).toJson()})}))),g=new i.SmartView(new r.DecryptedPayload(Object.assign(Object.assign({uuid:o.SystemViewId.TrashedNotes,content_type:a.ContentType.SmartView},(0,u.PayloadTimestampDefaults)()),{content:(0,s.FillItemContent)({title:"Trash",predicate:y(e).toJson()})}))),S=new i.SmartView(new r.DecryptedPayload(Object.assign(Object.assign({uuid:o.SystemViewId.UntaggedNotes,content_type:a.ContentType.SmartView},(0,u.PayloadTimestampDefaults)()),{content:(0,s.FillItemContent)({title:"Untagged",predicate:f(e).toJson()})}))),b=new i.SmartView(new r.DecryptedPayload(Object.assign(Object.assign({uuid:o.SystemViewId.StarredNotes,content_type:a.ContentType.SmartView},(0,u.PayloadTimestampDefaults)()),{content:(0,s.FillItemContent)({title:"Starred",predicate:v(e).toJson()})})));return n?[c,b,l,m,g,S]:[c,b,m,g,S]}},31511:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},36176:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SmartViewDefaultIconName=t.systemViewIcon=t.SmartViewIcons=void 0;const r=n(86865);t.SmartViewIcons={[r.SystemViewId.AllNotes]:"notes",[r.SystemViewId.Files]:"folder",[r.SystemViewId.ArchivedNotes]:"archive",[r.SystemViewId.TrashedNotes]:"trash",[r.SystemViewId.UntaggedNotes]:"hashtag-off",[r.SystemViewId.StarredNotes]:"star-filled"},t.systemViewIcon=function(e){return t.SmartViewIcons[e]},t.SmartViewDefaultIconName="restore"},86865:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SystemViewId=void 0,(n=t.SystemViewId||(t.SystemViewId={})).AllNotes="all-notes",n.Files="files",n.ArchivedNotes="archived-notes",n.TrashedNotes="trashed-notes",n.UntaggedNotes="untagged-notes",n.StarredNotes="starred-notes"},53209:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(33652),t),i(n(55874),t),i(n(86865),t),i(n(31511),t)},72897:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SNTag=t.isTag=t.DefaultTagIconName=t.TagFolderDelimitter=void 0;const r=n(10256),i=n(59867),o=n(43239);t.TagFolderDelimitter=".",t.DefaultTagIconName="hashtag",t.isTag=e=>e.content_type===r.ContentType.Tag;class a extends i.DecryptedItem{constructor(e){super(e),this.title=this.payload.content.title||"",this.expanded=null==this.payload.content.expanded||this.payload.content.expanded,this.iconString=this.payload.content.iconString||t.DefaultTagIconName,this.preferences=this.payload.content.preferences}get isDailyEntry(){var e;return"daily"===(null===(e=this.preferences)||void 0===e?void 0:e.entryMode)}get noteReferences(){return this.payload.references.filter((e=>e.content_type===r.ContentType.Note))}get noteCount(){return this.noteReferences.length}get parentId(){const e=this.references.find(o.isTagToParentTagReference);return null==e?void 0:e.uuid}static arrayToDisplayString(e){return e.sort(((e,t)=>e.title>t.title?1:-1)).map((e=>"#"+e.title)).join(" ")}}t.SNTag=a},91357:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},57010:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TagMutator=void 0;const r=n(10256),i=n(43239),o=n(21984),a=n(66276);class s extends a.DecryptedItemMutator{constructor(e,t){super(e,t),this.mutablePreferences=this.mutableContent.preferences}set title(e){this.mutableContent.title=e}set expanded(e){this.mutableContent.expanded=e}set iconString(e){this.mutableContent.iconString=e}get preferences(){return this.mutablePreferences||(this.mutableContent.preferences={},this.mutablePreferences=this.mutableContent.preferences),this.mutablePreferences}set preferences(e){this.mutablePreferences=e,this.mutableContent.preferences=this.mutablePreferences}makeChildOf(e){const t=this.immutableItem.references.filter((e=>!(0,i.isTagToParentTagReference)(e))),n={reference_type:o.ContentReferenceType.TagToParentTag,content_type:r.ContentType.Tag,uuid:e.uuid};t.push(n),this.mutableContent.references=t}unsetParent(){this.mutableContent.references=this.immutableItem.references.filter((e=>!(0,i.isTagToParentTagReference)(e)))}addFile(e){if(this.immutableItem.isReferencingItem(e))return;const t={reference_type:o.ContentReferenceType.TagToFile,content_type:r.ContentType.File,uuid:e.uuid};this.mutableContent.references.push(t)}removeFile(e){this.mutableContent.references=this.mutableContent.references.filter((t=>t.uuid!==e.uuid))}addNote(e){this.immutableItem.isReferencingItem(e)||this.mutableContent.references.push({uuid:e.uuid,content_type:e.content_type})}removeNote(e){this.mutableContent.references=this.mutableContent.references.filter((t=>t.uuid!==e.uuid))}}t.TagMutator=s},66136:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9665:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(72897),t),i(n(57010),t),i(n(91357),t),i(n(66136),t)},74008:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SNTheme=t.isTheme=void 0;const r=n(70295),i=n(58892),o=n(25569),a=n(47759),s=n(10256),c=n(64657);t.isTheme=e=>e.content_type===s.ContentType.Theme;class l extends i.SNComponent{constructor(){super(...arguments),this.area=r.ComponentArea.Themes}isLayerable(){return(0,c.useBoolean)(this.package_info&&this.package_info.layerable,!1)}strategyWhenConflictingWithItem(e,t){return o.ConflictStrategy.KeepBase}getMobileRules(){return this.getAppDomainValue(a.AppDataField.MobileRules)||{constants:{},rules:{}}}hasMobileRules(){return this.getAppDomainValue(a.AppDataField.MobileRules)}getNotAvailOnMobile(){return this.getAppDomainValue(a.AppDataField.NotAvailableOnMobile)}isMobileActive(){return this.getAppDomainValue(a.AppDataField.MobileActive)}}t.SNTheme=l},10043:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeMutator=void 0;const r=n(47759),i=n(66276);class o extends i.DecryptedItemMutator{setMobileRules(e){this.setAppDataItem(r.AppDataField.MobileRules,e)}setNotAvailOnMobile(e){this.setAppDataItem(r.AppDataField.NotAvailableOnMobile,e)}set local_url(e){this.mutableContent.local_url=e}setMobileActive(e){this.setAppDataItem(r.AppDataField.MobileActive,e)}}t.ThemeMutator=o},31924:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(74008),t),i(n(10043),t)},37461:(e,t)=>{var n,r,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.EditorFontSize=t.EditorLineHeight=t.NewNoteTitleFormat=t.PrefKey=void 0,(o=t.PrefKey||(t.PrefKey={})).TagsPanelWidth="tagsPanelWidth",o.NotesPanelWidth="notesPanelWidth",o.EditorWidth="editorWidth",o.EditorLeft="editorLeft",o.EditorMonospaceEnabled="monospaceFont",o.EditorSpellcheck="spellcheck",o.EditorResizersEnabled="marginResizersEnabled",o.EditorLineHeight="editorLineHeight",o.EditorFontSize="editorFontSize",o.SortNotesBy="sortBy",o.SortNotesReverse="sortReverse",o.NotesShowArchived="showArchived",o.NotesShowTrashed="showTrashed",o.NotesHideProtected="hideProtected",o.NotesHidePinned="hidePinned",o.NotesHideNotePreview="hideNotePreview",o.NotesHideDate="hideDate",o.NotesHideTags="hideTags",o.NotesHideEditorIcon="hideEditorIcon",o.UseSystemColorScheme="useSystemColorScheme",o.AutoLightThemeIdentifier="autoLightThemeIdentifier",o.AutoDarkThemeIdentifier="autoDarkThemeIdentifier",o.NoteAddToParentFolders="noteAddToParentFolders",o.MobileSortNotesBy="mobileSortBy",o.MobileSortNotesReverse="mobileSortReverse",o.MobileNotesHideNotePreview="mobileHideNotePreview",o.MobileNotesHideDate="mobileHideDate",o.MobileNotesHideTags="mobileHideTags",o.MobileLastExportDate="mobileLastExportDate",o.MobileDoNotShowAgainUnsupportedEditors="mobileDoNotShowAgainUnsupportedEditors",o.MobileSelectedTagUuid="mobileSelectedTagUuid",o.MobileNotesHideEditorIcon="mobileHideEditorIcon",o.NewNoteTitleFormat="newNoteTitleFormat",o.CustomNoteTitleFormat="customNoteTitleFormat",o.UpdateSavingStatusIndicator="updateSavingStatusIndicator",o.DarkMode="darkMode",(i=t.NewNoteTitleFormat||(t.NewNoteTitleFormat={})).CurrentDateAndTime="CurrentDateAndTime",i.CurrentNoteCount="CurrentNoteCount",i.CustomFormat="CustomFormat",i.Empty="Empty",(r=t.EditorLineHeight||(t.EditorLineHeight={})).None="None",r.Tight="Tight",r.Snug="Snug",r.Normal="Normal",r.Relaxed="Relaxed",r.Loose="Loose",(n=t.EditorFontSize||(t.EditorFontSize={})).ExtraSmall="ExtraSmall",n.Small="Small",n.Normal="Normal",n.Medium="Medium",n.Large="Large"},1657:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SNUserPrefs=void 0;const r=n(59867),i=n(10256),o=n(95536);class a extends r.DecryptedItem{get isSingleton(){return!0}singletonPredicate(){return a.singletonPredicate}getPref(e){return this.getAppDomainValue(e)}}t.SNUserPrefs=a,a.singletonPredicate=new o.Predicate("content_type","=",i.ContentType.UserPrefs)},38222:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UserPrefsMutator=void 0;const r=n(66276);class i extends r.DecryptedItemMutator{setPref(e,t){this.setAppDataItem(e,t)}}t.UserPrefsMutator=i},61109:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(1657),t),i(n(38222),t),i(n(37461),t)},68990:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},72655:(e,t)=>{function n(e,t){return e.find((e=>e.uuid===t))}Object.defineProperty(t,"__esModule",{value:!0}),t.SureFindItem=t.FindItem=void 0,t.FindItem=n,t.SureFindItem=function(e,t){return n(e,t)}},69002:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ItemContentsDiffer=void 0;const r=n(9600);t.ItemContentsDiffer=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return!(0,r.ItemContentsEqual)(e.content,t.content,[...e.contentKeysToIgnoreWhenCheckingEquality(),...n],e.appDataContentKeysToIgnoreWhenCheckingEquality())}},9600:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ItemContentsEqual=void 0;const r=n(64657),i=n(96720);t.ItemContentsEqual=function(e,t,n,o){const a=(0,r.sortedCopy)(e);if(a.appData){const e=a.appData[i.DefaultAppDomain];(0,r.omitInPlace)(e,o),e?0===Object.keys(e).length&&delete a.appData:delete a.appData}(0,r.omitInPlace)(a,n);const s=(0,r.sortedCopy)(t);if(s.appData){const e=s.appData[i.DefaultAppDomain];(0,r.omitInPlace)(e,o),e?0===Object.keys(e).length&&delete s.appData:delete s.appData}return(0,r.omitInPlace)(s,n),JSON.stringify(a)===JSON.stringify(s)}},24320:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateItemFromPayload=t.CreateDecryptedItemFromPayload=t.RegisterItemClass=t.CreateDecryptedMutatorForItem=void 0;const r=n(10256),i=n(68728),o=n(23899),a=n(54246),s=n(61079),c=n(58892),l=n(3322),u=n(59867),d=n(55998),p=n(33652),h=n(72897),y=n(74008),f=n(1657),v=n(71554),m=n(10043),g=n(38222),S=n(83062),b=n(54712),P=n(57010),_=n(50943),w=n(66276),E=n(18667),C=n(89691),O={[r.ContentType.ActionsExtension]:{itemClass:s.SNActionsExtension,mutatorClass:S.ActionsExtensionMutator},[r.ContentType.Component]:{itemClass:c.SNComponent,mutatorClass:b.ComponentMutator},[r.ContentType.Editor]:{itemClass:l.SNEditor},[r.ContentType.ExtensionRepo]:{itemClass:a.SNFeatureRepo},[r.ContentType.File]:{itemClass:o.FileItem,mutatorClass:v.FileMutator},[r.ContentType.Note]:{itemClass:d.SNNote,mutatorClass:_.NoteMutator},[r.ContentType.SmartView]:{itemClass:p.SmartView,mutatorClass:P.TagMutator},[r.ContentType.Tag]:{itemClass:h.SNTag,mutatorClass:P.TagMutator},[r.ContentType.Theme]:{itemClass:y.SNTheme,mutatorClass:m.ThemeMutator},[r.ContentType.UserPrefs]:{itemClass:f.SNUserPrefs,mutatorClass:g.UserPrefsMutator}};function I(e){const t=O[e.content_type];return new(t?t.itemClass:u.DecryptedItem)(e)}t.CreateDecryptedMutatorForItem=function(e,t){var n;const r=null===(n=O[e.content_type])||void 0===n?void 0:n.mutatorClass;return r?new r(e,t):new w.DecryptedItemMutator(e,t)},t.RegisterItemClass=function(e,t,n){const r={itemClass:t,mutatorClass:n};O[e]=r},t.CreateDecryptedItemFromPayload=I,t.CreateItemFromPayload=function(e){if((0,E.isDecryptedPayload)(e))return I(e);if((0,E.isEncryptedPayload)(e))return new i.EncryptedItem(e);if((0,E.isDeletedPayload)(e))return new C.DeletedItem(e);throw Error("Unhandled case in CreateItemFromPayload")}},45349:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CopyPayloadWithContentOverride=void 0;const r=n(70999);t.CopyPayloadWithContentOverride=function(e,t){const n=Object.assign(Object.assign({},e.ejected()),{content:Object.assign(Object.assign({},e.content),t)});return(0,r.CreatePayload)(n,e.source)}},70999:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreatePayload=void 0;const r=n(50987),i=n(63188),o=n(38111),a=n(82818);t.CreatePayload=function(e,t){if((0,a.isDecryptedTransferPayload)(e))return new o.DecryptedPayload(e,t);if((0,a.isEncryptedTransferPayload)(e))return new r.EncryptedPayload(e,t);if((0,a.isDeletedTransferPayload)(e))return new i.DeletedPayload(e,t);throw Error("Unhandled case in CreatePayload")}},57330:(e,t)=>{function n(e,t){return e.find((e=>e.uuid===t))}Object.defineProperty(t,"__esModule",{value:!0}),t.SureFindPayload=t.FindPayload=void 0,t.FindPayload=n,t.SureFindPayload=function(e,t){return n(e,t)}},55687:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PayloadContentsEqual=void 0;const r=n(24320);t.PayloadContentsEqual=function(e,t){const n=(0,r.CreateDecryptedItemFromPayload)(e),i=(0,r.CreateDecryptedItemFromPayload)(t);return n.isItemContentEqualWith(i)}},97202:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateNonDecryptedPayloadSplit=t.CreatePayloadSplitWithDiscardables=t.CreatePayloadSplit=void 0;const r=n(98890);t.CreatePayloadSplit=function(e){const t={encrypted:[],decrypted:[],deleted:[]};for(const n of e)if((0,r.isDecryptedPayload)(n))t.decrypted.push(n);else if((0,r.isEncryptedPayload)(n))t.encrypted.push(n);else{if(!(0,r.isDeletedPayload)(n))throw Error("Unhandled case in CreatePayloadSplit");t.deleted.push(n)}return t},t.CreatePayloadSplitWithDiscardables=function(e){const t={encrypted:[],decrypted:[],deleted:[],discardable:[]};for(const n of e)if((0,r.isDecryptedPayload)(n))t.decrypted.push(n);else if((0,r.isEncryptedPayload)(n))t.encrypted.push(n);else{if(!(0,r.isDeletedPayload)(n))throw Error("Unhandled case in CreatePayloadSplitWithDiscardables");n.discardable?t.discardable.push(n):t.deleted.push(n)}return t},t.CreateNonDecryptedPayloadSplit=function(e){const t={encrypted:[],deleted:[]};for(const n of e)if((0,r.isEncryptedPayload)(n))t.encrypted.push(n);else{if(!(0,r.isDeletedPayload)(n))throw Error("Unhandled case in CreateNonDecryptedPayloadSplit");t.deleted.push(n)}return t}},24439:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PayloadsByAlternatingUuid=void 0;const r=n(63188),i=n(10256),o=n(64657),a=n(98890),s=n(43446),c=n(6754);t.PayloadsByAlternatingUuid=function(e,t){const n=[],l=e.copyAsSyncResolved({uuid:o.UuidGenerator.GenerateUuid(),dirty:!0,dirtyIndex:(0,c.getIncrementedDirtyIndex)(),lastSyncBegan:void 0,lastSyncEnd:new Date,duplicate_of:e.uuid});n.push(l);const u=(0,s.PayloadsByUpdatingReferencingPayloadReferences)(e,t,[l],[e.uuid]);if((0,o.extendArray)(n,u),e.content_type===i.ContentType.ItemsKey){const r=t.all().filter((t=>(0,a.isEncryptedPayload)(t)&&t.items_key_id===e.uuid)).map((e=>e.copyAsSyncResolved({items_key_id:l.uuid,dirty:!0,dirtyIndex:(0,c.getIncrementedDirtyIndex)(),lastSyncEnd:new Date})));r.length>0&&(0,o.extendArray)(n,r)}const d=new r.DeletedPayload({created_at:e.created_at,updated_at:e.updated_at,created_at_timestamp:e.created_at_timestamp,updated_at_timestamp:e.updated_at_timestamp,dirty:!1,content:void 0,uuid:e.uuid,content_type:e.content_type,deleted:!0},e.source);return n.push(d),n}},30489:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PayloadsByDuplicating=void 0;const r=n(64657),i=n(43446),o=n(98890),a=n(6754);t.PayloadsByDuplicating=function(e){const{payload:t,baseCollection:n,isConflict:s,additionalContent:c,source:l}=e,u=[],d={uuid:r.UuidGenerator.GenerateUuid(),dirty:!0,dirtyIndex:(0,a.getIncrementedDirtyIndex)(),lastSyncBegan:void 0,lastSyncEnd:new Date,duplicate_of:t.uuid};let p;if((0,o.isDecryptedPayload)(t)){const e=Object.assign(Object.assign({},t.content),c);s&&(e.conflict_of=t.uuid),p=t.copyAsSyncResolved(Object.assign(Object.assign({},d),{content:e,deleted:!1}))}else p=t.copyAsSyncResolved(Object.assign({},d),l||t.source);if(u.push(p),(0,o.isDecryptedPayload)(t)&&(0,o.isDecryptedPayload)(p)){const e=(0,i.PayloadsByUpdatingReferencingPayloadReferences)(t,n,[p]);(0,r.extendArray)(u,e)}return u}},43446:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PayloadsByUpdatingReferencingPayloadReferences=void 0;const r=n(31773),i=n(18667),o=n(6754);t.PayloadsByUpdatingReferencingPayloadReferences=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const s=t.elementsReferencingElement(e).filter(i.isDecryptedPayload),c=[];for(const t of s){const i=t.content.references.slice(),s=t.getReference(e.uuid);for(const e of n){const t=Object.assign(Object.assign({},s),{uuid:e.uuid,content_type:e.content_type});i.push(t)}for(const e of a)(0,r.remove)(i,{uuid:e});const l=t.copyAsSyncResolved({dirty:!0,dirtyIndex:(0,o.getIncrementedDirtyIndex)(),lastSyncEnd:new Date,content:Object.assign(Object.assign({},t.content),{references:i})});c.push(l)}return c}},44225:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(36502),t),i(n(67427),t),i(n(84577),t),i(n(27897),t),i(n(44346),t),i(n(67463),t),i(n(92590),t),i(n(52795),t),i(n(23767),t),i(n(859),t),i(n(85206),t),i(n(76422),t),i(n(1341),t),i(n(22369),t),i(n(29029),t),i(n(8656),t),i(n(16462),t),i(n(49942),t),i(n(15559),t),i(n(53186),t),i(n(53771),t),i(n(81479),t),i(n(84656),t),i(n(12922),t),i(n(18667),t),i(n(82818),t),i(n(63835),t),i(n(80625),t),i(n(33132),t),i(n(14668),t),i(n(51252),t),i(n(28585),t),i(n(6689),t),i(n(89320),t),i(n(88324),t),i(n(95099),t),i(n(30969),t),i(n(28001),t),i(n(74520),t),i(n(12714),t),i(n(6311),t),i(n(35082),t),i(n(86785),t),i(n(1750),t),i(n(6754),t),i(n(98295),t),i(n(69089),t),i(n(87425),t),i(n(63874),t),i(n(66658),t),i(n(83883),t),i(n(4103),t),i(n(41291),t),i(n(37436),t),i(n(72650),t),i(n(72650),t),i(n(54981),t),i(n(36640),t),i(n(95536),t),i(n(25929),t),i(n(93261),t),i(n(15834),t),i(n(69109),t),i(n(28346),t),i(n(49740),t),i(n(59536),t),i(n(3338),t),i(n(23251),t),i(n(53209),t),i(n(9665),t),i(n(31924),t),i(n(61109),t),i(n(68990),t),i(n(72655),t),i(n(69002),t),i(n(9600),t),i(n(24320),t),i(n(45349),t),i(n(70999),t),i(n(57330),t),i(n(55687),t),i(n(24439),t),i(n(30489),t),i(n(97202),t)},16418:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(44225),t)},14017:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},90200:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},14499:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},92233:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},50916:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},79482:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},15960:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},64952:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},75958:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},35634:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},88887:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},33755:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},19050:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},50776:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},19999:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9399:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ClientDisplayableError=void 0;class n{constructor(e,t,n){this.text=e,this.title=t,this.tag=n,console.error("Client Displayable Error:",e,t||"",n||"")}static FromError(e){return new n(e.message,void 0,e.tag)}}t.ClientDisplayableError=n},62989:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},55152:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},86848:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},250:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},98913:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},92306:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},83483:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},87282:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},68090:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isErrorResponseExpiredToken=void 0;const r=n(83964);t.isErrorResponseExpiredToken=function(e){return e.status===r.StatusCode.HttpStatusExpiredAccessToken}},24621:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},62990:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},48540:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},83964:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.StatusCode=void 0,(n=t.StatusCode||(t.StatusCode={}))[n.LocalValidationError=10]="LocalValidationError",n[n.CanceledMfa=11]="CanceledMfa",n[n.UnknownError=12]="UnknownError",n[n.HttpStatusMinSuccess=200]="HttpStatusMinSuccess",n[n.HttpStatusNoContent=204]="HttpStatusNoContent",n[n.HttpStatusMaxSuccess=299]="HttpStatusMaxSuccess",n[n.HttpStatusExpiredAccessToken=498]="HttpStatusExpiredAccessToken",n[n.HttpStatusInvalidSession=401]="HttpStatusInvalidSession",n[n.HttpStatusForbidden=403]="HttpStatusForbidden",n[n.HttpBadRequest=400]="HttpBadRequest"},29359:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ApiEndpointParam=void 0,(n=t.ApiEndpointParam||(t.ApiEndpointParam={})).LastSyncToken="sync_token",n.PaginationToken="cursor_token",n.SyncDlLimit="limit",n.SyncPayloads="items",n.ApiVersion="api"},71491:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},83088:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},25869:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ConflictType=void 0,(n=t.ConflictType||(t.ConflictType={})).ConflictingData="sync_conflict",n.UuidConflict="uuid_conflict",n.ContentTypeError="content_type_error",n.ContentError="content_error",n.ReadOnlyError="readonly_error",n.UuidError="uuid_error",n.SyncError="sync_error"},1126:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6841:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},98529:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),n(29359)},68994:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},72469:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},43801:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},27619:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},30777:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},79858:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},83162:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},79588:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},12022:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},32444:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},23793:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},52735:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},52217:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2291:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},88791:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},94647:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},77483:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},47451:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},34648:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},56833:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},84078:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6893:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},96850:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(14017),t),i(n(90200),t),i(n(14499),t),i(n(92233),t),i(n(50916),t),i(n(79482),t),i(n(15960),t),i(n(64952),t),i(n(75958),t),i(n(35634),t),i(n(88887),t),i(n(33755),t),i(n(19050),t),i(n(50776),t),i(n(19999),t),i(n(9399),t),i(n(62989),t),i(n(55152),t),i(n(86848),t),i(n(250),t),i(n(98913),t),i(n(92306),t),i(n(83483),t),i(n(87282),t),i(n(68090),t),i(n(24621),t),i(n(62990),t),i(n(48540),t),i(n(83964),t),i(n(29359),t),i(n(71491),t),i(n(83088),t),i(n(25869),t),i(n(1126),t),i(n(98529),t),i(n(68994),t),i(n(72469),t),i(n(43801),t),i(n(7),t),i(n(27619),t),i(n(30777),t),i(n(6841),t),i(n(79858),t),i(n(83162),t),i(n(79588),t),i(n(12022),t),i(n(32444),t),i(n(23793),t),i(n(52735),t),i(n(52217),t),i(n(2291),t),i(n(88791),t),i(n(94647),t),i(n(77483),t),i(n(47451),t),i(n(34648),t),i(n(56833),t),i(n(84078),t),i(n(6893),t)},84945:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(96850),t)},17656:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.AlertService=t.ButtonType=void 0,(n=t.ButtonType||(t.ButtonType={}))[n.Info=0]="Info",n[n.Danger=1]="Danger",t.AlertService=class{showErrorAlert(e){return this.alert(e.text,e.title)}}},69207:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ApiServiceEvent=void 0,(t.ApiServiceEvent||(t.ApiServiceEvent={})).MetaReceived="MetaReceived"},58864:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},54943:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},80091:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ApplicationStage=void 0,(n=t.ApplicationStage||(t.ApplicationStage={}))[n.PreparingForLaunch_0=0]="PreparingForLaunch_0",n[n.ReadyForLaunch_05=.5]="ReadyForLaunch_05",n[n.StorageDecrypted_09=.9]="StorageDecrypted_09",n[n.Launched_10=1]="Launched_10",n[n.LoadingDatabase_11=1.1]="LoadingDatabase_11",n[n.LoadedDatabase_12=1.2]="LoadedDatabase_12",n[n.FullSyncCompleted_13=1.3]="FullSyncCompleted_13",n[n.SignedIn_30=3]="SignedIn_30"},87941:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},27555:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DeinitMode=void 0,(n=t.DeinitMode||(t.DeinitMode={})).Soft="Soft",n.Hard="Hard"},63840:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DeinitSource=void 0,(n=t.DeinitSource||(t.DeinitSource={}))[n.SignOut=1]="SignOut",n[n.Lock=2]="Lock",n[n.SwitchWorkspace=3]="SwitchWorkspace",n[n.SignOutAll=4]="SignOutAll"},85788:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},30935:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FilesBackupService=void 0;const i=n(10256),o=n(16418),a=n(84945),s=n(10687);class c extends s.AbstractService{constructor(e,t,n,r,a,s){super(s),this.items=e,this.api=t,this.encryptor=n,this.device=r,this.status=a,this.internalEventBus=s,this.pendingFiles=new Set,this.itemsObserverDisposer=e.addObserver(i.ContentType.File,(e=>{let{changed:t,inserted:n,source:r}=e;[o.PayloadEmitSource.LocalDatabaseLoaded,o.PayloadEmitSource.RemoteSaved,o.PayloadEmitSource.RemoteRetrieved].includes(r)&&this.handleChangedFiles([...t,...n])}))}deinit(){this.itemsObserverDisposer()}isFilesBackupsEnabled(){return this.device.isFilesBackupsEnabled()}enableFilesBackups(){return r(this,void 0,void 0,(function*(){yield this.device.enableFilesBackups(),(yield this.isFilesBackupsEnabled())&&this.backupAllFiles()}))}backupAllFiles(){const e=this.items.getItems(i.ContentType.File);this.handleChangedFiles(e)}disableFilesBackups(){return this.device.disableFilesBackups()}changeFilesBackupsLocation(){return this.device.changeFilesBackupsLocation()}getFilesBackupsLocation(){return this.device.getFilesBackupsLocation()}openFilesBackupsLocation(){return this.device.openFilesBackupsLocation()}getBackupsMapping(){return r(this,void 0,void 0,(function*(){return(yield this.device.getFilesBackupsMappingFile()).files}))}handleChangedFiles(e){return r(this,void 0,void 0,(function*(){if(0===e.length)return;if(!(yield this.isFilesBackupsEnabled()))return;const t=yield this.getBackupsMapping();for(const n of e)this.pendingFiles.has(n.uuid)||null==t[n.uuid]&&(this.pendingFiles.add(n.uuid),yield this.performBackupOperation(n),this.pendingFiles.delete(n.uuid))}))}performBackupOperation(e){return r(this,void 0,void 0,(function*(){const t=this.status.addMessage("Backing up file ".concat(e.name,"...")),n=yield this.encryptor.encryptSplitSingle({usesItemsKeyWithKeyLookup:{items:[e.payload]}}),r=this.items.getDisplayableItemsKeys().find((e=>e.uuid===n.items_key_id));if(!r)return"failed";const i=yield this.encryptor.encryptSplitSingle({usesRootKeyWithKeyLookup:{items:[r.payload]}}),s=yield this.api.createFileValetToken(e.remoteIdentifier,"read");if(s instanceof a.ClientDisplayableError)return"failed";const c={info:{warning:"Do not edit this file.",information:"The file and key data below is encrypted with your account password.",instructions:"Drag and drop this metadata file into the File Backups preferences pane in the Standard Notes desktop or web application interface."},file:(0,o.CreateEncryptedBackupFileContextPayload)(n.ejected()),itemsKey:(0,o.CreateEncryptedBackupFileContextPayload)(i.ejected()),version:"1.0.0"},l=JSON.stringify(c,null,2),u=yield this.device.saveFilesBackupsFile(e.uuid,l,{chunkSizes:e.encryptedChunkSizes,url:this.api.getFilesDownloadUrl(),valetToken:s});if(this.status.removeMessage(t),"failed"===u){const t=this.status.addMessage("Failed to back up ".concat(e.name,"..."));setTimeout((()=>{this.status.removeMessage(t)}),2e3)}return u}))}}t.FilesBackupService=c},74858:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Challenge=void 0;const r=n(64657),i=n(58325),o=n(34210);t.Challenge=class{constructor(e,t,n,r,i){this.prompts=e,this.reason=t,this.cancelable=n,this._heading=r,this._subheading=i,this.id=Math.random(),Object.freeze(this)}get modalTitle(){return this.reason===o.ChallengeReason.Migration?i.ChallengeModalTitle.Migration:i.ChallengeModalTitle.Generic}get heading(){if(this._heading)return this._heading;switch(this.reason){case o.ChallengeReason.ApplicationUnlock:return i.ChallengeStrings.UnlockApplication;case o.ChallengeReason.Migration:return i.ChallengeStrings.EnterLocalPasscode;case o.ChallengeReason.ResaveRootKey:return i.ChallengeStrings.EnterPasscodeForRootResave;case o.ChallengeReason.ProtocolUpgrade:return i.ChallengeStrings.EnterCredentialsForProtocolUpgrade;case o.ChallengeReason.AccessProtectedNote:return i.ChallengeStrings.NoteAccess;case o.ChallengeReason.AccessProtectedFile:return i.ChallengeStrings.FileAccess;case o.ChallengeReason.ImportFile:return i.ChallengeStrings.ImportFile;case o.ChallengeReason.AddPasscode:return i.ChallengeStrings.AddPasscode;case o.ChallengeReason.RemovePasscode:return i.ChallengeStrings.RemovePasscode;case o.ChallengeReason.ChangePasscode:return i.ChallengeStrings.ChangePasscode;case o.ChallengeReason.ChangeAutolockInterval:return i.ChallengeStrings.ChangeAutolockInterval;case o.ChallengeReason.CreateDecryptedBackupWithProtectedItems:return i.ChallengeStrings.EnterCredentialsForDecryptedBackupDownload;case o.ChallengeReason.RevokeSession:return i.ChallengeStrings.RevokeSession;case o.ChallengeReason.DecryptEncryptedFile:return i.ChallengeStrings.DecryptEncryptedFile;case o.ChallengeReason.ExportBackup:return i.ChallengeStrings.ExportBackup;case o.ChallengeReason.DisableBiometrics:return i.ChallengeStrings.DisableBiometrics;case o.ChallengeReason.UnprotectNote:return i.ChallengeStrings.UnprotectNote;case o.ChallengeReason.UnprotectFile:return i.ChallengeStrings.UnprotectFile;case o.ChallengeReason.SearchProtectedNotesText:return i.ChallengeStrings.SearchProtectedNotesText;case o.ChallengeReason.SelectProtectedNote:return i.ChallengeStrings.SelectProtectedNote;case o.ChallengeReason.DisableMfa:return i.ChallengeStrings.DisableMfa;case o.ChallengeReason.DeleteAccount:return i.ChallengeStrings.DeleteAccount;case o.ChallengeReason.AuthorizeNoteForListed:return i.ChallengeStrings.ListedAuthorization;case o.ChallengeReason.Custom:return"";default:return(0,r.assertUnreachable)(this.reason)}}get subheading(){return this._subheading?this._subheading:this.reason===o.ChallengeReason.Migration?i.ChallengeStrings.EnterPasscodeForMigration:void 0}hasPromptForValidationType(e){for(const t of this.prompts)if(t.validation===e)return!0;return!1}}},62016:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2854:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},49001:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},94224:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChallengePrompt=void 0;const r=n(64657),i=n(10162),o=n(51013);t.ChallengePrompt=class{constructor(e,t,n){let a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4?arguments[4]:void 0,c=arguments.length>5?arguments[5]:void 0;switch(this.validation=e,this.secureTextEntry=a,this.keyboardType=s,this.initialValue=c,this.id=Math.random(),this.validation){case i.ChallengeValidation.AccountPassword:this.title=null!=t?t:o.ChallengePromptTitle.AccountPassword,this.placeholder=null!=n?n:o.ChallengePromptTitle.AccountPassword,this.validates=!0;break;case i.ChallengeValidation.LocalPasscode:this.title=null!=t?t:o.ChallengePromptTitle.LocalPasscode,this.placeholder=null!=n?n:o.ChallengePromptTitle.LocalPasscode,this.validates=!0;break;case i.ChallengeValidation.Biometric:this.title=null!=t?t:o.ChallengePromptTitle.Biometrics,this.placeholder=null!=n?n:"",this.validates=!0;break;case i.ChallengeValidation.ProtectionSessionDuration:this.title=null!=t?t:o.ChallengePromptTitle.RememberFor,this.placeholder=null!=n?n:"",this.validates=!0;break;case i.ChallengeValidation.None:this.title=null!=t?t:"",this.placeholder=null!=n?n:"",this.validates=!1;break;default:(0,r.assertUnreachable)(this.validation)}Object.freeze(this)}}},24840:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},51013:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChallengePromptTitle=void 0,t.ChallengePromptTitle={AccountPassword:"Account Password",LocalPasscode:"Application Passcode",Biometrics:"Biometrics",RememberFor:"Remember For",Mfa:"Two-factor Authentication Code"}},99777:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},12712:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ChallengeKeyboardType=void 0,(n=t.ChallengeKeyboardType||(t.ChallengeKeyboardType={})).Alphanumeric="default",n.Numeric="numeric"},11817:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},34210:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ChallengeReason=void 0,(n=t.ChallengeReason||(t.ChallengeReason={}))[n.AccessProtectedFile=0]="AccessProtectedFile",n[n.AccessProtectedNote=1]="AccessProtectedNote",n[n.AddPasscode=2]="AddPasscode",n[n.ApplicationUnlock=3]="ApplicationUnlock",n[n.ChangeAutolockInterval=4]="ChangeAutolockInterval",n[n.ChangePasscode=5]="ChangePasscode",n[n.CreateDecryptedBackupWithProtectedItems=6]="CreateDecryptedBackupWithProtectedItems",n[n.Custom=7]="Custom",n[n.DecryptEncryptedFile=8]="DecryptEncryptedFile",n[n.DisableBiometrics=9]="DisableBiometrics",n[n.DisableMfa=10]="DisableMfa",n[n.ExportBackup=11]="ExportBackup",n[n.ImportFile=12]="ImportFile",n[n.Migration=13]="Migration",n[n.ProtocolUpgrade=14]="ProtocolUpgrade",n[n.RemovePasscode=15]="RemovePasscode",n[n.ResaveRootKey=16]="ResaveRootKey",n[n.RevokeSession=17]="RevokeSession",n[n.SearchProtectedNotesText=18]="SearchProtectedNotesText",n[n.SelectProtectedNote=19]="SelectProtectedNote",n[n.UnprotectFile=20]="UnprotectFile",n[n.UnprotectNote=21]="UnprotectNote",n[n.DeleteAccount=22]="DeleteAccount",n[n.AuthorizeNoteForListed=23]="AuthorizeNoteForListed"},10162:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ChallengeValidation=void 0,(n=t.ChallengeValidation||(t.ChallengeValidation={}))[n.None=0]="None",n[n.LocalPasscode=1]="LocalPasscode",n[n.AccountPassword=2]="AccountPassword",n[n.Biometric=3]="Biometric",n[n.ProtectionSessionDuration=4]="ProtectionSessionDuration"},75967:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateChallengeValue=void 0,t.CreateChallengeValue=function(e,t){return{prompt:e,value:t}}},30306:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(74858),t),i(n(62016),t),i(n(2854),t),i(n(49001),t),i(n(94224),t),i(n(24840),t),i(n(51013),t),i(n(99777),t),i(n(12712),t),i(n(11817),t),i(n(34210),t),i(n(10162),t),i(n(75967),t)},47205:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},38796:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentViewerError=void 0,(n=t.ComponentViewerError||(t.ComponentViewerError={})).OfflineRestricted="OfflineRestricted",n.MissingUrl="MissingUrl"},96040:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},18908:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isDesktopDevice=void 0;const r=n(16418);t.isDesktopDevice=function(e){return e.environment===r.Environment.Desktop}},48531:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},61235:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},42101:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},92820:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},84136:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isMobileDevice=void 0;const r=n(16418);t.isMobileDevice=function(e){return e.environment===r.Environment.Mobile}},6113:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},76081:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},47084:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DecryptBackupFile=void 0;const i=n(10256),o=n(75082),a=n(16418),s=n(84945),c=n(64657);function l(e,t){return r(this,void 0,void 0,(function*(){const n=[],r=[];e.forEach((e=>{e.content_type===i.ContentType.ItemsKey&&(0,a.isDecryptedPayload)(e)?n.push(e):(0,a.isEncryptedPayload)(e)&&r.push(e)}));const o=n.map((e=>(0,a.CreateDecryptedItemFromPayload)(e)));return d(r,o,t)}))}function u(e,t,n,r,o){let a;if(e.items_key_id&&(a=n.itemsKeyForPayload(e),a))return a;if(a=t.find((t=>e.items_key_id===t.uuid)),a)return a;if(!r)return;const s=e.version;return(0,i.leftVersionGreaterThanOrEqualToRight)(r.version,i.ProtocolVersion.V004)?a=n.defaultItemsKeyForItemVersion(s,t):(0,i.compareVersions)(s,i.ProtocolVersion.V003)<=0&&(a=o),a}function d(e,t,n,i,a){return r(this,void 0,void 0,(function*(){const r=[];for(const s of e)if(!(0,o.ContentTypeUsesRootKeyEncryption)(s.content_type))try{const e=u(s,t,n,i,a);if(!e){r.push(s.copy({errorDecrypting:!0}));continue}if((0,o.isItemsKey)(e)){const t=yield n.decryptSplitSingle({usesItemsKey:{items:[s],key:e}});r.push(t)}else{const t=yield n.decryptSplitSingle({usesRootKey:{items:[s],key:e}});r.push(t)}}catch(e){r.push(s.copy({errorDecrypting:!0})),console.error("Error decrypting payload",s,e)}return r}))}function p(e,t,n,o){return r(this,void 0,void 0,(function*(){const r=[],s=yield o.computeRootKey(e,t),l=n.filter((e=>e.content_type===i.ContentType.ItemsKey)),u=yield o.decryptSplit({usesRootKey:{items:l,key:s}});(0,c.extendArray)(r,u);const p=yield d(n,u.filter(a.isDecryptedPayload).map((e=>(0,a.CreateDecryptedItemFromPayload)(e))),o,t,s);return(0,c.extendArray)(r,p),r}))}t.DecryptBackupFile=function(e,t,n){return r(this,void 0,void 0,(function*(){const r=e.items.map((e=>{if((0,a.isEncryptedTransferPayload)(e))return new a.EncryptedPayload(e);if((0,a.isDecryptedTransferPayload)(e))return new a.DecryptedPayload(e);throw Error("Unhandled case in decryptBackupFile")})),{encrypted:c,decrypted:u}=(0,a.CreatePayloadSplit)(r),d=function(e,t){if(e.keyParams||e.auth_params)return o.BackupFileType.Encrypted;{const e=t.find(a.isEncryptedPayload),n=t.find((e=>e.content_type===i.ContentType.ItemsKey&&(0,a.isDecryptedPayload)(e)));return e&&n?o.BackupFileType.EncryptedWithNonEncryptedItemsKey:e?o.BackupFileType.Corrupt:o.BackupFileType.FullyDecrypted}}(e,r);switch(d){case o.BackupFileType.Corrupt:return new s.ClientDisplayableError("Invalid backup file.");case o.BackupFileType.Encrypted:{if(!n)throw Error("Attempting to decrypt encrypted file with no password");const r=e.keyParams||e.auth_params;return[...u,...yield p(n,(0,o.CreateAnyKeyParams)(r),c,t)]}case o.BackupFileType.EncryptedWithNonEncryptedItemsKey:return[...u,...yield l(r,t)];case o.BackupFileType.FullyDecrypted:return[...u,...c]}}))}},52567:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EncryptionService=void 0;const i=n(75082),o=n(16418),a=n(64657),s=n(10256),c=n(10687),l=n(41479),u=n(63706),d=n(49184),p=n(47084),h=n(13744);class y extends c.AbstractService{constructor(e,t,n,r,o,s,c){super(c),this.itemManager=e,this.payloadManager=t,this.deviceInterface=n,this.storageService=r,this.identifier=o,this.crypto=s,this.internalEventBus=c,this.crypto=s,this.operatorManager=new i.OperatorManager(s),this.itemsEncryption=new l.ItemsEncryptionService(e,t,r,this.operatorManager,c),this.rootKeyEncryption=new d.RootKeyEncryptionService(this.itemManager,this.operatorManager,this.deviceInterface,this.storageService,this.identifier,this.internalEventBus),this.rootKeyObserverDisposer=this.rootKeyEncryption.addEventObserver((e=>{this.itemsEncryption.userVersion=this.getUserVersion(),e===i.RootKeyServiceEvent.RootKeyStatusChanged&&this.notifyEvent(h.EncryptionServiceEvent.RootKeyStatusChanged)})),a.UuidGenerator.SetGenerator(this.crypto.generateUUID)}deinit(){this.itemManager=void 0,this.payloadManager=void 0,this.deviceInterface=void 0,this.storageService=void 0,this.crypto=void 0,this.operatorManager=void 0,this.rootKeyObserverDisposer(),this.rootKeyObserverDisposer=void 0,this.itemsEncryption.deinit(),this.itemsEncryption=void 0,this.rootKeyEncryption.deinit(),this.rootKeyEncryption=void 0,super.deinit()}initialize(){return r(this,void 0,void 0,(function*(){yield this.rootKeyEncryption.initialize()}))}getEncryptionDisplayName(){return r(this,void 0,void 0,(function*(){const e=yield this.rootKeyEncryption.getEncryptionSourceVersion();if(e)return this.operatorManager.operatorForVersion(e).getEncryptionDisplayName();throw Error("Attempting to access encryption display name wtihout source")}))}getLatestVersion(){return s.ProtocolVersionLatest}hasAccount(){return this.rootKeyEncryption.hasAccount()}hasRootKeyEncryptionSource(){return this.rootKeyEncryption.hasRootKeyEncryptionSource()}getUserVersion(){return this.rootKeyEncryption.getUserVersion()}upgradeAvailable(){return r(this,void 0,void 0,(function*(){const e=this.accountUpgradeAvailable(),t=yield this.passcodeUpgradeAvailable();return e||t}))}getSureDefaultItemsKey(){return this.itemsEncryption.getDefaultItemsKey()}repersistAllItems(){return r(this,void 0,void 0,(function*(){return this.itemsEncryption.repersistAllItems()}))}reencryptItemsKeys(){return r(this,void 0,void 0,(function*(){yield this.rootKeyEncryption.reencryptItemsKeys()}))}createNewItemsKeyWithRollback(){return r(this,void 0,void 0,(function*(){return this.rootKeyEncryption.createNewItemsKeyWithRollback()}))}decryptErroredPayloads(){return r(this,void 0,void 0,(function*(){yield this.itemsEncryption.decryptErroredPayloads()}))}itemsKeyForPayload(e){return this.itemsEncryption.itemsKeyForPayload(e)}defaultItemsKeyForItemVersion(e,t){return this.itemsEncryption.defaultItemsKeyForItemVersion(e,t)}encryptSplitSingle(e){return r(this,void 0,void 0,(function*(){return(yield this.encryptSplit(e))[0]}))}encryptSplit(e){return r(this,void 0,void 0,(function*(){const t=[];if(e.usesRootKey){const n=yield this.rootKeyEncryption.encryptPayloads(e.usesRootKey.items,e.usesRootKey.key);(0,a.extendArray)(t,n)}if(e.usesItemsKey){const n=yield this.itemsEncryption.encryptPayloads(e.usesItemsKey.items,e.usesItemsKey.key);(0,a.extendArray)(t,n)}if(e.usesRootKeyWithKeyLookup){const n=yield this.rootKeyEncryption.encryptPayloadsWithKeyLookup(e.usesRootKeyWithKeyLookup.items);(0,a.extendArray)(t,n)}if(e.usesItemsKeyWithKeyLookup){const n=yield this.itemsEncryption.encryptPayloadsWithKeyLookup(e.usesItemsKeyWithKeyLookup.items);(0,a.extendArray)(t,n)}return t.map((t=>{const n=(0,i.FindPayloadInEncryptionSplit)(t.uuid,e);return new o.EncryptedPayload(Object.assign(Object.assign(Object.assign({},n),t),{waitingForKey:!1,errorDecrypting:!1}))}))}))}decryptSplitSingle(e){return r(this,void 0,void 0,(function*(){return(yield this.decryptSplit(e))[0]}))}decryptSplit(e){return r(this,void 0,void 0,(function*(){const t=[];if(e.usesRootKey){const n=yield this.rootKeyEncryption.decryptPayloads(e.usesRootKey.items,e.usesRootKey.key);(0,a.extendArray)(t,n)}if(e.usesRootKeyWithKeyLookup){const n=yield this.rootKeyEncryption.decryptPayloadsWithKeyLookup(e.usesRootKeyWithKeyLookup.items);(0,a.extendArray)(t,n)}if(e.usesItemsKey){const n=yield this.itemsEncryption.decryptPayloads(e.usesItemsKey.items,e.usesItemsKey.key);(0,a.extendArray)(t,n)}if(e.usesItemsKeyWithKeyLookup){const n=yield this.itemsEncryption.decryptPayloadsWithKeyLookup(e.usesItemsKeyWithKeyLookup.items);(0,a.extendArray)(t,n)}return t.map((t=>{const n=(0,i.FindPayloadInDecryptionSplit)(t.uuid,e);return(0,i.isErrorDecryptingParameters)(t)?new o.EncryptedPayload(Object.assign(Object.assign({},n.ejected()),t)):new o.DecryptedPayload(Object.assign(Object.assign({},n.ejected()),t))}))}))}accountUpgradeAvailable(){const e=this.getUserVersion();return!!e&&e!==s.ProtocolVersionLatest}passcodeUpgradeAvailable(){return r(this,void 0,void 0,(function*(){return this.rootKeyEncryption.passcodeUpgradeAvailable()}))}platformSupportsKeyDerivation(e){return(0,s.compareVersions)(e.version,s.ProtocolVersion.V004)>=0||!!(0,a.isWebCryptoAvailable)()||(0,a.isReactNativeEnvironment)()}supportedVersions(){return[s.ProtocolVersion.V001,s.ProtocolVersion.V002,s.ProtocolVersion.V003,s.ProtocolVersion.V004]}isVersionNewerThanLibraryVersion(e){const t=s.ProtocolVersionLatest;return 1===(0,s.compareVersions)(e,t)}costMinimumForVersion(e){if((0,s.compareVersions)(e,s.ProtocolVersion.V003)>=0)throw"Cost minimums only apply to versions <= 002";if(e===s.ProtocolVersion.V001)return i.V001Algorithm.PbkdfMinCost;if(e===s.ProtocolVersion.V002)return i.V002Algorithm.PbkdfMinCost;throw"Invalid version for cost minimum: ".concat(e)}computeRootKey(e,t){return r(this,void 0,void 0,(function*(){return this.rootKeyEncryption.computeRootKey(e,t)}))}createRootKey(e,t,n,i){return r(this,void 0,void 0,(function*(){return this.rootKeyEncryption.createRootKey(e,t,n,i)}))}decryptBackupFile(e,t){return r(this,void 0,void 0,(function*(){return yield(0,p.DecryptBackupFile)(e,this,t)}))}createKeyParams(e){return(0,i.CreateAnyKeyParams)(e)}createEncryptedBackupFile(){return r(this,void 0,void 0,(function*(){const e=this.itemManager.items.map((e=>e.payload)),t=(0,i.SplitPayloadsByEncryptionType)(e),n=(0,i.CreateEncryptionSplitWithKeyLookup)(t),r=(yield this.encryptSplit(n)).map((e=>(0,o.CreateEncryptedBackupFileContextPayload)(e))),a={version:s.ProtocolVersionLatest,items:r},c=yield this.getRootKeyParams();return a.keyParams=null==c?void 0:c.getPortableValue(),a}))}createDecryptedBackupFile(){const e=this.payloadManager.nonDeletedItems.filter((e=>e.content_type!==s.ContentType.ItemsKey));return{version:s.ProtocolVersionLatest,items:e.map((e=>(0,o.isDecryptedPayload)(e)?(0,o.CreateDecryptedBackupFileContextPayload)(e):(0,o.isEncryptedPayload)(e)?(0,o.CreateEncryptedBackupFileContextPayload)(e):void 0)).filter(a.isNotUndefined)}}hasPasscode(){return this.rootKeyEncryption.hasPasscode()}isPasscodeLocked(){return r(this,void 0,void 0,(function*(){return(yield this.rootKeyEncryption.hasRootKeyWrapper())&&null==this.rootKeyEncryption.getRootKey()}))}getRootKeyParams(){return r(this,void 0,void 0,(function*(){return this.rootKeyEncryption.getRootKeyParams()}))}getAccountKeyParams(){return this.rootKeyEncryption.memoizedRootKeyParams}computeWrappingKey(e){return r(this,void 0,void 0,(function*(){const t=yield this.rootKeyEncryption.getSureRootKeyWrapperKeyParams();return yield this.computeRootKey(e,t)}))}unwrapRootKey(e){return r(this,void 0,void 0,(function*(){return this.rootKeyEncryption.unwrapRootKey(e)}))}setNewRootKeyWrapper(e){return r(this,void 0,void 0,(function*(){return this.rootKeyEncryption.setNewRootKeyWrapper(e)}))}removePasscode(){return r(this,void 0,void 0,(function*(){yield this.rootKeyEncryption.removeRootKeyWrapper()}))}setRootKey(e,t){return r(this,void 0,void 0,(function*(){yield this.rootKeyEncryption.setRootKey(e,t)}))}getRootKey(){return this.rootKeyEncryption.getRootKey()}deleteWorkspaceSpecificKeyStateFromDevice(){return r(this,void 0,void 0,(function*(){yield this.rootKeyEncryption.deleteWorkspaceSpecificKeyStateFromDevice()}))}validateAccountPassword(e){return r(this,void 0,void 0,(function*(){return this.rootKeyEncryption.validateAccountPassword(e)}))}validatePasscode(e){return r(this,void 0,void 0,(function*(){return this.rootKeyEncryption.validatePasscode(e)}))}getEmbeddedPayloadAuthenticatedData(e){const t=e.version;if(t)return this.operatorManager.operatorForVersion(t).getPayloadAuthenticatedData((0,i.encryptedParametersFromPayload)(e))}getKeyEmbeddedKeyParams(e){const t=this.getEmbeddedPayloadAuthenticatedData(e);if(t){if((0,s.isVersionLessThanOrEqualTo)(e.version,s.ProtocolVersion.V003)){const e=t;return this.createKeyParams(e)}{const e=t.kp;return this.createKeyParams(e)}}}needsNewRootKeyBasedItemsKey(){if(!this.hasAccount())return!1;const e=this.rootKeyEncryption.getRootKey();if(!e)return!1;if((0,s.compareVersions)(e.keyVersion,s.ProtocolVersionLastNonrootItemsKey)>0)return!1;const t=(0,i.findDefaultItemsKey)(this.itemsEncryption.getItemsKeys());return!t||t.itemsKey!==e.itemsKey}createNewDefaultItemsKey(){return r(this,void 0,void 0,(function*(){return this.rootKeyEncryption.createNewDefaultItemsKey()}))}getPasswordCreatedDate(){const e=this.getRootKey();return e?e.keyParams.createdDate:void 0}onSyncEvent(e){return r(this,void 0,void 0,(function*(){e===u.SyncEvent.SyncCompletedWithAllItemsUploaded&&(yield this.handleFullSyncCompletion()),e===u.SyncEvent.DownloadFirstSyncCompleted&&(yield this.handleDownloadFirstSyncCompletion())}))}handleDownloadFirstSyncCompletion(){return r(this,void 0,void 0,(function*(){if(!this.hasAccount())return;const e=this.itemsEncryption.getItemsKeys(),t=e.filter((e=>e.neverSynced)),n=e.filter((e=>!e.neverSynced)).find((e=>e.isDefault));if((0,a.isNullOrUndefined)(n)){const e=yield this.getRootKeyParams();if(e){const n=t.filter((t=>t.keyVersion!==e.version));n.length>0&&(yield this.itemManager.setItemsToBeDeleted(n)),0===this.itemsEncryption.getItemsKeys().length&&(yield this.rootKeyEncryption.createNewDefaultItemsKey())}}else yield this.itemManager.setItemsToBeDeleted(t);const r=this.getUserVersion(),i=this.itemsEncryption.getItemsKeys().find((e=>e.keyVersion===r));(0,a.isNullOrUndefined)(i)&&(yield this.rootKeyEncryption.createNewDefaultItemsKey()),this.syncUnsyncedItemsKeys()}))}handleFullSyncCompletion(){return r(this,void 0,void 0,(function*(){if(!(0,i.findDefaultItemsKey)(this.itemsEncryption.getItemsKeys())&&(yield this.rootKeyEncryption.createNewDefaultItemsKey(),this.rootKeyEncryption.keyMode===i.KeyMode.WrapperOnly))return this.itemsEncryption.repersistAllItems()}))}syncUnsyncedItemsKeys(){if(!this.hasAccount())return;const e=this.itemsEncryption.getItemsKeys().filter((e=>e.neverSynced&&!e.dirty));e.length>0&&this.itemManager.setItemsDirty(e)}getDiagnostics(){return r(this,void 0,void 0,(function*(){return{encryption:Object.assign(Object.assign({getLatestVersion:this.getLatestVersion(),hasAccount:this.hasAccount(),hasRootKeyEncryptionSource:this.hasRootKeyEncryptionSource(),getUserVersion:this.getUserVersion(),upgradeAvailable:yield this.upgradeAvailable(),accountUpgradeAvailable:this.accountUpgradeAvailable(),passcodeUpgradeAvailable:yield this.passcodeUpgradeAvailable(),hasPasscode:this.hasPasscode(),isPasscodeLocked:yield this.isPasscodeLocked(),needsNewRootKeyBasedItemsKey:this.needsNewRootKeyBasedItemsKey()},yield this.itemsEncryption.getDiagnostics()),yield this.rootKeyEncryption.getDiagnostics())}}))}}t.EncryptionService=y},13744:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EncryptionServiceEvent=void 0,(t.EncryptionServiceEvent||(t.EncryptionServiceEvent={})).RootKeyStatusChanged="RootKeyStatusChanged"},12121:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DecryptItemsKeyByPromptingUser=t.DecryptItemsKeyWithUserFallback=void 0;const i=n(16418),o=n(75082),a=n(94224),s=n(34210),c=n(10162);function l(e,t,n,l){return r(this,void 0,void 0,(function*(){if(l||(l=t.getKeyEmbeddedKeyParams(e)),!l)return"failed";const r=n.createChallenge([new a.ChallengePrompt(c.ChallengeValidation.None,void 0,void 0,!0)],s.ChallengeReason.Custom,!0,o.KeyRecoveryStrings.KeyRecoveryLoginFlowPrompt(l),o.KeyRecoveryStrings.KeyRecoveryPasswordRequired),u=yield n.promptForChallengeResponse(r);if(!u)return"aborted";const d=u.values[0].value,p=yield t.computeRootKey(d,l),h=yield t.decryptSplitSingle({usesRootKey:{items:[e],key:p}});return n.completeChallenge(r),(0,i.isDecryptedPayload)(h)?{decryptedKey:h,rootKey:p}:"failed"}))}t.DecryptItemsKeyWithUserFallback=function(e,t,n){return r(this,void 0,void 0,(function*(){const r=yield t.decryptSplitSingle({usesRootKeyWithKeyLookup:{items:[e]}});if((0,i.isDecryptedPayload)(r))return r;const o=yield l(e,t,n);return"aborted"===o||"failed"===o?o:o.decryptedKey}))},t.DecryptItemsKeyByPromptingUser=l},41479:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ItemsEncryptionService=void 0;const i=n(10256),o=n(75082),a=n(16418),s=n(64657),c=n(10687);class l extends c.AbstractService{constructor(e,t,n,r,o){super(o),this.itemManager=e,this.payloadManager=t,this.storageService=n,this.operatorManager=r,this.internalEventBus=o,this.removeItemsObserver=this.itemManager.addObserver([i.ContentType.ItemsKey],(e=>{let{changed:t,inserted:n}=e;t.concat(n).length>0&&this.decryptErroredPayloads()}))}deinit(){this.itemManager=void 0,this.payloadManager=void 0,this.storageService=void 0,this.removeItemsObserver(),this.removeItemsObserver=void 0,super.deinit()}repersistAllItems(){return r(this,void 0,void 0,(function*(){const e=this.itemManager.items.map((e=>e.payload));return this.storageService.savePayloads(e)}))}getItemsKeys(){return this.itemManager.getDisplayableItemsKeys()}itemsKeyForPayload(e){return this.getItemsKeys().find((t=>t.uuid===e.items_key_id||t.duplicateOf===e.items_key_id))}getDefaultItemsKey(){return(0,o.findDefaultItemsKey)(this.getItemsKeys())}keyToUseForItemEncryption(){const e=this.getDefaultItemsKey();let t;return t=this.userVersion&&this.userVersion!==(null==e?void 0:e.keyVersion)?this.getItemsKeys().find((e=>e.keyVersion===this.userVersion)):e,t||new o.StandardException("Cannot find items key to use for encryption")}keyToUseForDecryptionOfPayload(e){return e.items_key_id?this.itemsKeyForPayload(e):this.defaultItemsKeyForItemVersion(e.version)}encryptPayloadWithKeyLookup(e){return r(this,void 0,void 0,(function*(){const t=this.keyToUseForItemEncryption();if(t instanceof o.StandardException)throw Error(t.message);return this.encryptPayload(e,t)}))}encryptPayload(e,t){return r(this,void 0,void 0,(function*(){if((0,a.isEncryptedPayload)(e))throw Error("Attempting to encrypt already encrypted payload.");if(!e.content)throw Error("Attempting to encrypt payload with no content.");if(!e.uuid)throw Error("Attempting to encrypt payload with no UuidGenerator.");return(0,o.encryptPayload)(e,t,this.operatorManager)}))}encryptPayloads(e,t){return r(this,void 0,void 0,(function*(){return Promise.all(e.map((e=>this.encryptPayload(e,t))))}))}encryptPayloadsWithKeyLookup(e){return r(this,void 0,void 0,(function*(){return Promise.all(e.map((e=>this.encryptPayloadWithKeyLookup(e))))}))}decryptPayloadWithKeyLookup(e){return r(this,void 0,void 0,(function*(){const t=this.keyToUseForDecryptionOfPayload(e);return null==t?{uuid:e.uuid,errorDecrypting:!0,waitingForKey:!0}:this.decryptPayload(e,t)}))}decryptPayload(e,t){return r(this,void 0,void 0,(function*(){return e.content?(0,o.decryptPayload)(e,t,this.operatorManager):{uuid:e.uuid,errorDecrypting:!0}}))}decryptPayloadsWithKeyLookup(e){return r(this,void 0,void 0,(function*(){return Promise.all(e.map((e=>this.decryptPayloadWithKeyLookup(e))))}))}decryptPayloads(e,t){return r(this,void 0,void 0,(function*(){return Promise.all(e.map((e=>this.decryptPayload(e,t))))}))}decryptErroredPayloads(){return r(this,void 0,void 0,(function*(){const e=this.payloadManager.invalidPayloads.filter((e=>e.content_type!==i.ContentType.ItemsKey));if(0===e.length)return;const t=(yield this.decryptPayloadsWithKeyLookup(e)).map((t=>{const n=(0,a.SureFindPayload)(e,t.uuid);return(0,o.isErrorDecryptingParameters)(t)?new a.EncryptedPayload(Object.assign(Object.assign({},n.ejected()),t)):new a.DecryptedPayload(Object.assign(Object.assign({},n.ejected()),t))}));yield this.payloadManager.emitPayloads(t,a.PayloadEmitSource.LocalChanged)}))}defaultItemsKeyForItemVersion(e,t){const n=t||this.getItemsKeys();return n.find((t=>t.isDefault&&t.keyVersion===e))||n.find((t=>t.keyVersion===e))}getDiagnostics(){var e;return r(this,void 0,void 0,(function*(){const t=this.keyToUseForItemEncryption();return{itemsEncryption:{itemsKeysIds:(0,s.Uuids)(this.getItemsKeys()),defaultItemsKeyId:null===(e=this.getDefaultItemsKey())||void 0===e?void 0:e.uuid,keyToUseForItemEncryptionId:t instanceof o.StandardException?void 0:t.uuid}}}))}}t.ItemsEncryptionService=l},49184:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RootKeyEncryptionService=void 0;const i=n(10256),o=n(75082),a=n(16418),s=n(64657),c=n(10687),l=n(96640),u=n(19288);class d extends c.AbstractService{constructor(e,t,n,r,i,a){super(a),this.itemManager=e,this.operatorManager=t,this.deviceInterface=n,this.storageService=r,this.identifier=i,this.internalEventBus=a,this.keyMode=o.KeyMode.RootKeyNone}deinit(){this.itemManager=void 0,this.rootKey=void 0,this.memoizedRootKeyParams=void 0,super.deinit()}initialize(){return r(this,void 0,void 0,(function*(){const e=this.getWrappedRootKey(),t=yield this.recomputeAccountKeyParams(),n=yield this.hasRootKeyWrapper(),r=null!=e||null!=t;if(n&&r)this.keyMode=o.KeyMode.RootKeyPlusWrapper;else if(n&&!r)this.keyMode=o.KeyMode.WrapperOnly;else if(!n&&r)this.keyMode=o.KeyMode.RootKeyOnly;else{if(n||r)throw"Invalid key mode condition";this.keyMode=o.KeyMode.RootKeyNone}this.keyMode===o.KeyMode.RootKeyOnly&&(this.setRootKeyInstance(yield this.getRootKeyFromKeychain()),yield this.handleKeyStatusChange())}))}handleKeyStatusChange(){return r(this,void 0,void 0,(function*(){yield this.recomputeAccountKeyParams(),this.notifyEvent(o.RootKeyServiceEvent.RootKeyStatusChanged)}))}passcodeUpgradeAvailable(){return r(this,void 0,void 0,(function*(){const e=yield this.getRootKeyWrapperKeyParams();return!!e&&e.version!==i.ProtocolVersionLatest}))}hasRootKeyWrapper(){return r(this,void 0,void 0,(function*(){return null!=(yield this.getRootKeyWrapperKeyParams())}))}hasAccount(){switch(this.keyMode){case o.KeyMode.RootKeyNone:case o.KeyMode.WrapperOnly:return!1;case o.KeyMode.RootKeyOnly:case o.KeyMode.RootKeyPlusWrapper:return!0;default:throw Error("Unhandled keyMode value '".concat(this.keyMode,"'."))}}hasRootKeyEncryptionSource(){return this.hasAccount()||this.hasPasscode()}hasPasscode(){return this.keyMode===o.KeyMode.WrapperOnly||this.keyMode===o.KeyMode.RootKeyPlusWrapper}getEncryptionSourceVersion(){return r(this,void 0,void 0,(function*(){if(this.hasAccount())return this.getSureUserVersion();if(this.hasPasscode())return(yield this.getSureRootKeyWrapperKeyParams()).version;throw Error("Attempting to access encryption source version without source")}))}getUserVersion(){const e=this.memoizedRootKeyParams;return null==e?void 0:e.version}getSureUserVersion(){return this.memoizedRootKeyParams.version}getRootKeyFromKeychain(){return r(this,void 0,void 0,(function*(){const e=yield this.deviceInterface.getNamespacedKeychainValue(this.identifier);if(null==e)return;const t=yield this.getSureRootKeyParams();return(0,o.CreateNewRootKey)(Object.assign(Object.assign({},e),{keyParams:t.getPortableValue()}))}))}saveRootKeyToKeychain(){return r(this,void 0,void 0,(function*(){if(null==this.getRootKey())throw"Attempting to non-existent root key to the keychain.";if(this.keyMode!==o.KeyMode.RootKeyOnly)throw"Should not be persisting wrapped key to keychain.";const e=this.getSureRootKey().getKeychainValue();return this.executeCriticalFunction((()=>this.deviceInterface.setNamespacedKeychainValue(e,this.identifier)))}))}getRootKeyWrapperKeyParams(){return r(this,void 0,void 0,(function*(){const e=yield this.storageService.getValue(l.StorageKey.RootKeyWrapperKeyParams,u.StorageValueModes.Nonwrapped);if(e)return(0,o.CreateAnyKeyParams)(e)}))}getSureRootKeyWrapperKeyParams(){return r(this,void 0,void 0,(function*(){return this.getRootKeyWrapperKeyParams()}))}getRootKeyParams(){return r(this,void 0,void 0,(function*(){if(this.keyMode===o.KeyMode.WrapperOnly)return this.getRootKeyWrapperKeyParams();if(this.keyMode===o.KeyMode.RootKeyOnly||this.keyMode===o.KeyMode.RootKeyPlusWrapper)return this.recomputeAccountKeyParams();if(this.keyMode!==o.KeyMode.RootKeyNone)throw"Unhandled key mode for getRootKeyParams ".concat(this.keyMode)}))}getSureRootKeyParams(){return r(this,void 0,void 0,(function*(){return this.getRootKeyParams()}))}computeRootKey(e,t){return r(this,void 0,void 0,(function*(){const n=t.version;return this.operatorManager.operatorForVersion(n).computeRootKey(e,t)}))}createRootKey(e,t,n,i){return r(this,void 0,void 0,(function*(){return(i?this.operatorManager.operatorForVersion(i):this.operatorManager.defaultOperator()).createRootKey(e,t,n)}))}getSureMemoizedRootKeyParams(){return this.memoizedRootKeyParams}validateAccountPassword(e){return r(this,void 0,void 0,(function*(){const t=yield this.computeRootKey(e,this.getSureMemoizedRootKeyParams()),n=this.getSureRootKey().compare(t);return n?{valid:n,artifacts:{rootKey:t}}:{valid:!1}}))}validatePasscode(e){return r(this,void 0,void 0,(function*(){const t=yield this.getSureRootKeyWrapperKeyParams(),n=yield this.computeRootKey(e,t),r=yield this.validateWrappingKey(n);return r?{valid:r,artifacts:{wrappingKey:n}}:{valid:!1}}))}validateWrappingKey(e){return r(this,void 0,void 0,(function*(){const t=this.getWrappedRootKey();if(this.keyMode===o.KeyMode.WrapperOnly)return this.storageService.canDecryptWithKey(e);if(this.keyMode===o.KeyMode.RootKeyOnly||this.keyMode===o.KeyMode.RootKeyPlusWrapper){const n=new a.EncryptedPayload(t),r=yield this.decryptPayload(n,e);return!(0,o.isErrorDecryptingParameters)(r)}throw"Unhandled case in validateWrappingKey"}))}recomputeAccountKeyParams(){return r(this,void 0,void 0,(function*(){const e=yield this.storageService.getValue(l.StorageKey.RootKeyParams,u.StorageValueModes.Nonwrapped);if(e)return this.memoizedRootKeyParams=(0,o.CreateAnyKeyParams)(e),this.memoizedRootKeyParams}))}wrapAndPersistRootKey(e){return r(this,void 0,void 0,(function*(){const t=this.getSureRootKey(),n=Object.assign(Object.assign({},t.payload.ejected()),{content:(0,a.FillItemContentSpecialized)(t.persistableValueWhenWrapping())}),r=new a.DecryptedPayload(n),i=yield this.encryptPayload(r,e),o=new a.EncryptedPayload(Object.assign(Object.assign(Object.assign({},r.ejected()),i),{errorDecrypting:!1,waitingForKey:!1}));this.storageService.setValue(l.StorageKey.WrappedRootKey,o.ejected(),u.StorageValueModes.Nonwrapped)}))}unwrapRootKey(e){return r(this,void 0,void 0,(function*(){if(this.keyMode===o.KeyMode.WrapperOnly)return void this.setRootKeyInstance(e);if(this.keyMode!==o.KeyMode.RootKeyPlusWrapper)throw"Invalid key mode condition for unwrapping.";const t=this.getWrappedRootKey(),n=new a.EncryptedPayload(t),r=yield this.decryptPayload(n,e);if((0,o.isErrorDecryptingParameters)(r))throw Error("Unable to decrypt root key with provided wrapping key.");{const e=new a.DecryptedPayload(Object.assign(Object.assign({},n.ejected()),r));this.setRootKeyInstance(new o.SNRootKey(e)),yield this.handleKeyStatusChange()}}))}setNewRootKeyWrapper(e){return r(this,void 0,void 0,(function*(){if(this.keyMode===o.KeyMode.RootKeyNone)this.keyMode=o.KeyMode.WrapperOnly;else{if(this.keyMode!==o.KeyMode.RootKeyOnly)throw Error("Attempting to set wrapper on already wrapped key.");this.keyMode=o.KeyMode.RootKeyPlusWrapper}if(yield this.deviceInterface.clearNamespacedKeychainValue(this.identifier),this.keyMode!==o.KeyMode.WrapperOnly&&this.keyMode!==o.KeyMode.RootKeyPlusWrapper)throw Error("Invalid keyMode on setNewRootKeyWrapper");this.keyMode===o.KeyMode.WrapperOnly?(this.setRootKeyInstance(e),yield this.reencryptItemsKeys()):yield this.wrapAndPersistRootKey(e),this.storageService.setValue(l.StorageKey.RootKeyWrapperKeyParams,e.keyParams.getPortableValue(),u.StorageValueModes.Nonwrapped),yield this.handleKeyStatusChange()}))}removeRootKeyWrapper(){return r(this,void 0,void 0,(function*(){if(this.keyMode!==o.KeyMode.WrapperOnly&&this.keyMode!==o.KeyMode.RootKeyPlusWrapper)throw Error("Attempting to remove root key wrapper on unwrapped key.");this.keyMode===o.KeyMode.WrapperOnly?(this.keyMode=o.KeyMode.RootKeyNone,this.setRootKeyInstance(void 0)):this.keyMode===o.KeyMode.RootKeyPlusWrapper&&(this.keyMode=o.KeyMode.RootKeyOnly),yield this.storageService.removeValue(l.StorageKey.WrappedRootKey,u.StorageValueModes.Nonwrapped),yield this.storageService.removeValue(l.StorageKey.RootKeyWrapperKeyParams,u.StorageValueModes.Nonwrapped),this.keyMode===o.KeyMode.RootKeyOnly&&(yield this.saveRootKeyToKeychain()),yield this.handleKeyStatusChange()}))}setRootKey(e,t){return r(this,void 0,void 0,(function*(){if(!e.keyParams)throw Error("keyParams must be supplied if setting root key.");if(this.getRootKey()===e)throw Error("Attempting to set root key as same current value.");if(this.keyMode===o.KeyMode.WrapperOnly)this.keyMode=o.KeyMode.RootKeyPlusWrapper;else if(this.keyMode===o.KeyMode.RootKeyNone)this.keyMode=o.KeyMode.RootKeyOnly;else if(this.keyMode!==o.KeyMode.RootKeyOnly&&this.keyMode!==o.KeyMode.RootKeyPlusWrapper)throw Error("Unhandled key mode for setNewRootKey ".concat(this.keyMode));if(this.setRootKeyInstance(e),this.storageService.setValue(l.StorageKey.RootKeyParams,e.keyParams.getPortableValue(),u.StorageValueModes.Nonwrapped),this.keyMode===o.KeyMode.RootKeyOnly)yield this.saveRootKeyToKeychain();else if(this.keyMode===o.KeyMode.RootKeyPlusWrapper){if(!t)throw Error("wrappingKey must be supplied");yield this.wrapAndPersistRootKey(t)}yield this.handleKeyStatusChange()}))}deleteWorkspaceSpecificKeyStateFromDevice(){return r(this,void 0,void 0,(function*(){yield this.deviceInterface.clearNamespacedKeychainValue(this.identifier),yield this.storageService.removeValue(l.StorageKey.WrappedRootKey,u.StorageValueModes.Nonwrapped),yield this.storageService.removeValue(l.StorageKey.RootKeyWrapperKeyParams,u.StorageValueModes.Nonwrapped),yield this.storageService.removeValue(l.StorageKey.RootKeyParams,u.StorageValueModes.Nonwrapped),this.keyMode=o.KeyMode.RootKeyNone,this.setRootKeyInstance(void 0),yield this.handleKeyStatusChange()}))}getWrappedRootKey(){return this.storageService.getValue(l.StorageKey.WrappedRootKey,u.StorageValueModes.Nonwrapped)}setRootKeyInstance(e){this.rootKey=e}getRootKey(){return this.rootKey}getSureRootKey(){return this.rootKey}getItemsKeys(){return this.itemManager.getDisplayableItemsKeys()}encrypPayloadWithKeyLookup(e){return r(this,void 0,void 0,(function*(){const t=this.getRootKey();if(null==t)throw Error("Attempting root key encryption with no root key");return this.encryptPayload(e,t)}))}encryptPayloadsWithKeyLookup(e){return r(this,void 0,void 0,(function*(){return Promise.all(e.map((e=>this.encrypPayloadWithKeyLookup(e))))}))}encryptPayload(e,t){return r(this,void 0,void 0,(function*(){return(0,o.encryptPayload)(e,t,this.operatorManager)}))}encryptPayloads(e,t){return r(this,void 0,void 0,(function*(){return Promise.all(e.map((e=>this.encryptPayload(e,t))))}))}decryptPayloadWithKeyLookup(e){return r(this,void 0,void 0,(function*(){const t=this.getRootKey();return null==t?{uuid:e.uuid,errorDecrypting:!0,waitingForKey:!0}:this.decryptPayload(e,t)}))}decryptPayload(e,t){return r(this,void 0,void 0,(function*(){return(0,o.decryptPayload)(e,t,this.operatorManager)}))}decryptPayloadsWithKeyLookup(e){return r(this,void 0,void 0,(function*(){return Promise.all(e.map((e=>this.decryptPayloadWithKeyLookup(e))))}))}decryptPayloads(e,t){return r(this,void 0,void 0,(function*(){return Promise.all(e.map((e=>this.decryptPayload(e,t))))}))}reencryptItemsKeys(){return r(this,void 0,void 0,(function*(){const e=this.getItemsKeys();e.length>0&&(yield this.itemManager.setItemsDirty(e))}))}createNewDefaultItemsKey(){return r(this,void 0,void 0,(function*(){const e=this.getSureRootKey(),t=e?e.keyVersion:i.ProtocolVersionLatest;let n;if((0,i.compareVersions)(t,i.ProtocolVersionLastNonrootItemsKey)<=0){const r=new a.DecryptedPayload(Object.assign({uuid:s.UuidGenerator.GenerateUuid(),content_type:i.ContentType.ItemsKey,content:(0,a.FillItemContentSpecialized)({itemsKey:e.masterKey,dataAuthenticationKey:e.dataAuthenticationKey,version:t})},(0,a.PayloadTimestampDefaults)()));n=(0,a.CreateDecryptedItemFromPayload)(r)}else n=this.operatorManager.operatorForVersion(t).createItemsKey();const r=this.getItemsKeys().filter((e=>e.isDefault));for(const e of r)yield this.itemManager.changeItemsKey(e,(e=>{e.isDefault=!1}));const o=yield this.itemManager.insertItem(n);return yield this.itemManager.changeItemsKey(o,(e=>{e.isDefault=!0})),o}))}createNewItemsKeyWithRollback(){return r(this,void 0,void 0,(function*(){const e=(0,o.findDefaultItemsKey)(this.getItemsKeys()),t=yield this.createNewDefaultItemsKey();return()=>r(this,void 0,void 0,(function*(){yield this.itemManager.setItemToBeDeleted(t),e&&(yield this.itemManager.changeItem(e,(e=>{e.isDefault=!0})))}))}))}getDiagnostics(){return r(this,void 0,void 0,(function*(){return{rootKeyEncryption:{hasRootKey:null!=this.rootKey,keyMode:o.KeyMode[this.keyMode],hasRootKeyWrapper:yield this.hasRootKeyWrapper(),hasAccount:this.hasAccount(),hasRootKeyEncryptionSource:this.hasRootKeyEncryptionSource(),hasPasscode:this.hasPasscode(),getEncryptionSourceVersion:this.hasRootKeyEncryptionSource()&&(yield this.getEncryptionSourceVersion()),getUserVersion:this.getUserVersion()}}}))}}t.RootKeyEncryptionService=d},52335:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ApplicationEvent=void 0,(n=t.ApplicationEvent||(t.ApplicationEvent={}))[n.SignedIn=2]="SignedIn",n[n.SignedOut=3]="SignedOut",n[n.CompletedFullSync=5]="CompletedFullSync",n[n.FailedSync=6]="FailedSync",n[n.HighLatencySync=7]="HighLatencySync",n[n.EnteredOutOfSync=8]="EnteredOutOfSync",n[n.ExitedOutOfSync=9]="ExitedOutOfSync",n[n.Started=10]="Started",n[n.Launched=11]="Launched",n[n.LocalDataLoaded=12]="LocalDataLoaded",n[n.KeyStatusChanged=13]="KeyStatusChanged",n[n.MajorDataChange=14]="MajorDataChange",n[n.CompletedRestart=15]="CompletedRestart",n[n.LocalDataIncrementalLoad=16]="LocalDataIncrementalLoad",n[n.SyncStatusChanged=17]="SyncStatusChanged",n[n.WillSync=18]="WillSync",n[n.InvalidSyncSession=19]="InvalidSyncSession",n[n.LocalDatabaseReadError=20]="LocalDatabaseReadError",n[n.LocalDatabaseWriteError=21]="LocalDatabaseWriteError",n[n.CompletedIncrementalSync=22]="CompletedIncrementalSync",n[n.MigrationsLoaded=23]="MigrationsLoaded",n[n.StorageReady=24]="StorageReady",n[n.PreferencesChanged=25]="PreferencesChanged",n[n.UnprotectedSessionBegan=26]="UnprotectedSessionBegan",n[n.UserRolesChanged=27]="UserRolesChanged",n[n.FeaturesUpdated=28]="FeaturesUpdated",n[n.UnprotectedSessionExpired=29]="UnprotectedSessionExpired",n[n.CompletedInitialSync=30]="CompletedInitialSync",n[n.BiometricsSoftLockEngaged=31]="BiometricsSoftLockEngaged",n[n.BiometricsSoftLockDisengaged=32]="BiometricsSoftLockDisengaged"},31714:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},88050:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},63706:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SyncEvent=void 0,(n=t.SyncEvent||(t.SyncEvent={})).SyncCompletedWithAllItemsUploaded="SyncCompletedWithAllItemsUploaded",n.SyncCompletedWithAllItemsUploadedAndDownloaded="SyncCompletedWithAllItemsUploadedAndDownloaded",n.SingleRoundTripSyncCompleted="SingleRoundTripSyncCompleted",n.SyncWillBegin="sync:will-begin",n.DownloadFirstSyncCompleted="sync:download-first-completed",n.SyncTakingTooLong="sync:taking-too-long",n.SyncError="sync:error",n.InvalidSession="sync:invalid-session",n.MajorDataChange="major-data-change",n.LocalDataIncrementalLoad="local-data-incremental-load",n.LocalDataLoaded="local-data-loaded",n.EnterOutOfSync="enter-out-of-sync",n.ExitOutOfSync="exit-out-of-sync",n.StatusChanged="status-changed",n.DatabaseWriteError="database-write-error",n.DatabaseReadError="database-read-error",n.SyncRequestsIntegrityCheck="sync:requests-integrity-check"},354:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},43934:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.WebAppEvent=void 0,(n=t.WebAppEvent||(t.WebAppEvent={})).NewUpdateAvailable="NewUpdateAvailable",n.EditorFocused="EditorFocused",n.BeganBackupDownload="BeganBackupDownload",n.EndedBackupDownload="EndedBackupDownload",n.PanelResized="PanelResized",n.WindowDidFocus="WindowDidFocus",n.WindowDidBlur="WindowDidBlur",n.MobileKeyboardDidChangeFrame="MobileKeyboardDidChangeFrame",n.MobileKeyboardWillChangeFrame="MobileKeyboardWillChangeFrame"},24382:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureStatus=void 0,(n=t.FeatureStatus||(t.FeatureStatus={})).NoUserSubscription="NoUserSubscription",n.NotInCurrentPlan="NotInCurrentPlan",n.InCurrentPlanButExpired="InCurrentPlanButExpired",n.Entitled="Entitled"},21400:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},35067:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.FeaturesEvent=void 0,(n=t.FeaturesEvent||(t.FeaturesEvent={})).UserRolesChanged="UserRolesChanged",n.FeaturesUpdated="FeaturesUpdated"},54613:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},42176:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},39143:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FileService=void 0;const i=n(84945),o=n(10256),a=n(16418),s=n(64657),c=n(75082),l=n(14581),u=n(10687),d=n(12121);class p extends u.AbstractService{constructor(e,t,n,r,i,o,a,s){super(s),this.api=e,this.itemManager=t,this.syncService=n,this.encryptor=r,this.challengor=i,this.alertService=o,this.crypto=a,this.internalEventBus=s,this.encryptedCache=new l.FileMemoryCache(1e8)}deinit(){super.deinit(),this.encryptedCache.clear(),this.encryptedCache=void 0,this.api=void 0,this.itemManager=void 0,this.encryptor=void 0,this.syncService=void 0,this.alertService=void 0,this.challengor=void 0,this.crypto=void 0}minimumChunkSize(){return 5e6}beginNewFileUpload(e){return r(this,void 0,void 0,(function*(){const t=s.UuidGenerator.GenerateUuid(),n=yield this.api.createFileValetToken(t,"write",e);if(n instanceof i.ClientDisplayableError)return n;const r={key:this.crypto.generateRandomKey(a.FileProtocolV1Constants.KeySize),remoteIdentifier:t,decryptedSize:e},o=new l.EncryptAndUploadFileOperation(r,n,this.crypto,this.api);return(yield this.api.startUploadSession(n)).uploadId?o:new i.ClientDisplayableError("Could not start upload session")}))}pushBytesForUpload(e,t,n,o){return r(this,void 0,void 0,(function*(){if(!(yield e.pushBytes(t,n,o)))return new i.ClientDisplayableError("Failed to push file bytes to server")}))}finishUpload(e,t){return r(this,void 0,void 0,(function*(){if(!(yield this.api.closeUploadSession(e.getApiToken())))return new i.ClientDisplayableError("Could not close upload session");const n=e.getResult(),r={decryptedSize:n.finalDecryptedSize,encryptedChunkSizes:e.encryptedChunkSizes,encryptionHeader:n.encryptionHeader,key:n.key,mimeType:t.mimeType,name:t.name,remoteIdentifier:n.remoteIdentifier},s=yield this.itemManager.createItem(o.ContentType.File,(0,a.FillItemContentSpecialized)(r),!0);return yield this.syncService.sync(),s}))}decryptCachedEntry(e,t){return r(this,void 0,void 0,(function*(){const n=new l.FileDecryptor(e,this.crypto);let i=new Uint8Array;const o=new l.OrderedByteChunker(e.encryptedChunkSizes,(e=>r(this,void 0,void 0,(function*(){const t=n.decryptBytes(e);t&&(i=new Uint8Array([...i,...t.decryptedBytes]))}))));return yield o.addBytes(t.encryptedBytes),{decryptedBytes:i}}))}downloadFile(e,t){return r(this,void 0,void 0,(function*(){const n=this.encryptedCache.get(e.uuid);if(n){const r=yield this.decryptCachedEntry(e,n);return void(yield t(r.decryptedBytes,void 0))}const i=e.encryptedSize<this.encryptedCache.maxSize;let o=new Uint8Array;const a=new l.DownloadAndDecryptFileOperation(e,this.crypto,this.api),s=yield a.run((e=>{let{decrypted:n,encrypted:a,progress:s}=e;return r(this,void 0,void 0,(function*(){return i&&(o=new Uint8Array([...o,...a.encryptedBytes])),t(n.decryptedBytes,s)}))}));return i&&this.encryptedCache.add(e.uuid,{encryptedBytes:o}),s.error}))}deleteFile(e){return r(this,void 0,void 0,(function*(){this.encryptedCache.remove(e.uuid);const t=yield this.api.createFileValetToken(e.remoteIdentifier,"delete");if(t instanceof i.ClientDisplayableError)return t;const n=yield this.api.deleteFile(t);if(n.error)return i.ClientDisplayableError.FromError(n.error);yield this.itemManager.setItemToBeDeleted(e),yield this.syncService.sync()}))}isFileNameFileBackupRelated(e){return e===l.FileBackupsConstantsV1.MetadataFileName?"metadata":e===l.FileBackupsConstantsV1.BinaryFileName&&"binary"}decryptBackupMetadataFile(e){return r(this,void 0,void 0,(function*(){const t=new a.EncryptedPayload(Object.assign(Object.assign({},e.itemsKey),{waitingForKey:!1,errorDecrypting:!1})),n=yield(0,d.DecryptItemsKeyWithUserFallback)(t,this.encryptor,this.challengor);if("failed"===n||"aborted"===n)return;const r=new a.EncryptedPayload(Object.assign(Object.assign({},e.file),{waitingForKey:!1,errorDecrypting:!1})),i=new c.SNItemsKey(n),o=yield this.encryptor.decryptSplitSingle({usesItemsKey:{items:[r],key:i}});return(0,a.isEncryptedPayload)(o)?void 0:new a.FileItem(o)}))}selectFile(e){return r(this,void 0,void 0,(function*(){return yield e.selectFile()}))}readBackupFileAndSaveDecrypted(e,t,n){return r(this,void 0,void 0,(function*(){const i=yield n.selectDirectory();if("aborted"===i||"failed"===i)return i;const o=yield n.createFile(i,t.name);if("aborted"===o||"failed"===o)return o;const a=yield(0,l.readAndDecryptBackupFile)(e,t,n,this.crypto,(e=>r(this,void 0,void 0,(function*(){yield n.saveBytes(o,e)}))));return yield n.closeFileWriteStream(o),a}))}readBackupFileBytesDecrypted(e,t,n){return r(this,void 0,void 0,(function*(){let i=new Uint8Array;return yield(0,l.readAndDecryptBackupFile)(e,t,n,this.crypto,(e=>r(this,void 0,void 0,(function*(){i=new Uint8Array([...i,...e])})))),i}))}}t.FileService=p},81052:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},40829:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IntegrityEvent=void 0,(t.IntegrityEvent||(t.IntegrityEvent={})).IntegrityCheckCompleted="IntegrityCheckCompleted"},2901:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},40330:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.IntegrityService=void 0;const i=n(40829),o=n(10687),a=n(63706);class s extends o.AbstractService{constructor(e,t,n,r){super(r),this.integrityApi=e,this.itemApi=t,this.payloadManager=n,this.internalEventBus=r}handleEvent(e){return r(this,void 0,void 0,(function*(){if(e.type!==a.SyncEvent.SyncRequestsIntegrityCheck)return;const t=yield this.integrityApi.checkIntegrity(this.payloadManager.integrityPayloads);if(void 0!==t.error)return void this.log("Could not obtain integrity check: ".concat(t.error));const n=[];for(const e of t.data.mismatches)n.push(this.itemApi.getSingleItem(e.uuid));const r=yield Promise.all(n),o=[];for(const e of r)void 0!==e.data&&!e.error&&"item"in e.data?o.push(e.data.item):this.log("Could not obtain item for integrity adjustments: ".concat(e.error));yield this.notifyEventSync(i.IntegrityEvent.IntegrityCheckCompleted,{rawPayloads:o,source:e.payload.source})}))}}t.IntegrityService=s},15689:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InternalEventBus=void 0;const i=n(61325);t.InternalEventBus=class{constructor(){this.eventHandlers=new Map}deinit(){this.eventHandlers=void 0}addEventHandler(e,t){let n=this.eventHandlers.get(t);void 0===n&&(n=[]),n.push(e),this.eventHandlers.set(t,n)}publish(e){const t=this.eventHandlers.get(e.type);if(void 0!==t)for(const n of t)n.handleEvent(e)}publishSync(e,t){return r(this,void 0,void 0,(function*(){const n=this.eventHandlers.get(e.type);if(void 0!==n){if(t===i.InternalEventPublishStrategy.SEQUENCE)for(const t of n)yield t.handleEvent(e);if(t===i.InternalEventPublishStrategy.ASYNC){const t=[];for(const r of n)t.push(r.handleEvent(e));yield Promise.all(t)}}}))}}},87143:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},14027:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},39239:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},61325:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.InternalEventPublishStrategy=void 0,(n=t.InternalEventPublishStrategy||(t.InternalEventPublishStrategy={})).ASYNC="ASYNC",n.SEQUENCE="SEQUENCE"},13211:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},37830:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ItemCounter=void 0;const r=n(10256);t.ItemCounter=class{countNotesAndTags(e){const t={notes:0,archived:0,deleted:0,tags:0};for(const n of e)n.trashed?t.deleted++:n.archived?t.archived++:n.content_type!==r.ContentType.Note?n.content_type!==r.ContentType.Tag||t.tags++:t.notes++;return t}}},94250:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},99463:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},23479:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ItemRelationshipDirection=void 0,(n=t.ItemRelationshipDirection||(t.ItemRelationshipDirection={}))[n.AReferencesB=0]="AReferencesB",n[n.BReferencesA=1]="BReferencesA",n[n.NoRelationship=2]="NoRelationship"},83990:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},81098:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},69991:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},83387:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},76473:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PreferencesServiceEvent=void 0,(t.PreferencesServiceEvent||(t.PreferencesServiceEvent={})).PreferencesChanged="PreferencesChanged"},10147:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MobileUnlockTiming=void 0,(n=t.MobileUnlockTiming||(t.MobileUnlockTiming={})).Immediately="immediately",n.OnQuit="on-quit"},26353:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},71835:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},10687:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractService=void 0;const i=n(64657),o=n(61325);t.AbstractService=class{constructor(e){this.internalEventBus=e,this.eventObservers=[],this.loggingEnabled=!1,this.criticalPromises=[]}addEventObserver(e){this.eventObservers.push(e);const t=this.eventObservers;return()=>{(0,i.removeFromArray)(t,e)}}notifyEvent(e,t){var n;return r(this,void 0,void 0,(function*(){for(const n of this.eventObservers)yield n(e,t);null===(n=this.internalEventBus)||void 0===n||n.publish({type:e,payload:t})}))}notifyEventSync(e,t){var n;return r(this,void 0,void 0,(function*(){for(const n of this.eventObservers)yield n(e,t);yield null===(n=this.internalEventBus)||void 0===n?void 0:n.publishSync({type:e,payload:t},o.InternalEventPublishStrategy.SEQUENCE)}))}getDiagnostics(){return Promise.resolve(void 0)}blockDeinit(){return r(this,void 0,void 0,(function*(){yield Promise.all(this.criticalPromises)}))}deinit(){this.eventObservers.length=0,this.internalEventBus=void 0,this.criticalPromises=void 0}executeCriticalFunction(e){return r(this,void 0,void 0,(function*(){const t=e();return this.criticalPromises.push(t),t}))}handleApplicationStage(e){return r(this,void 0,void 0,(function*(){}))}getServiceName(){return this.constructor.name}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.loggingEnabled&&(0,i.log)(this.getServiceName(),...arguments)}}},19032:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},15328:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},4194:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},60106:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StatusService=void 0;const r=n(64657),i=n(10687),o=n(24825);class a extends i.AbstractService{constructor(){super(...arguments),this._message="",this.dynamicMessages=[]}get message(){return this._message}setMessage(e){this.directSetMessage=e,this.recomputeMessage()}addMessage(e){return this.dynamicMessages.push(e),this.recomputeMessage(),e}removeMessage(e){(0,r.removeFromArray)(this.dynamicMessages,e),this.recomputeMessage()}recomputeMessage(){const e=[...this.dynamicMessages];this.directSetMessage&&e.unshift(this.directSetMessage),this._message=this.messageFromArray(e),this.notifyEvent(o.StatusServiceEvent.MessageChanged,this._message)}messageFromArray(e){let t="";return e.forEach(((n,r)=>{const i=r===e.length-1;t+=n,i||(t+=", ")})),t}}t.StatusService=a},24825:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StatusServiceEvent=void 0,(t.StatusServiceEvent||(t.StatusServiceEvent={})).MessageChanged="MessageChanged"},14753:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryStore=void 0,t.InMemoryStore=class{constructor(){this.values=new Map}setValue(e,t){this.values.set(e,t)}getValue(e){return this.values.get(e)}removeValue(e){this.values.delete(e)}}},13066:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},96640:(e,t)=>{var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyKeys1_0_0=t.namespacedKey=t.NonwrappedStorageKey=t.StorageKey=t.RawStorageKey=void 0,(r=t.RawStorageKey||(t.RawStorageKey={})).StorageObject="storage",r.DescriptorRecord="descriptors",r.SnjsVersion="snjs_version",(n=t.StorageKey||(t.StorageKey={})).RootKeyParams="ROOT_KEY_PARAMS",n.WrappedRootKey="WRAPPED_ROOT_KEY",n.RootKeyWrapperKeyParams="ROOT_KEY_WRAPPER_KEY_PARAMS",n.Session="session",n.User="user",n.ServerHost="server",n.LegacyUuid="uuid",n.LastSyncToken="syncToken",n.PaginationToken="cursorToken",n.BiometricsState="biometrics_state",n.MobilePasscodeTiming="passcode_timing",n.MobileBiometricsTiming="biometrics_timing",n.MobilePasscodeKeyboardType="passcodeKeyboardType",n.MobilePreferences="preferences",n.MobileScreenshotPrivacyEnabled="screenshotPrivacy_enabled",n.ProtectionExpirey="SessionExpiresAtKey",n.ProtectionSessionLength="SessionLengthKey",n.KeyRecoveryUndecryptableItems="key_recovery_undecryptable",n.StorageEncryptionPolicy="storage_policy",n.WebSocketUrl="webSocket_url",n.UserRoles="user_roles",n.UserFeatures="user_features",n.ExperimentalFeatures="experimental_features",n.DeinitMode="deinit_mode",n.CodeVerifier="code_verifier",n.LaunchPriorityUuids="launch_priority_uuids",(t.NonwrappedStorageKey||(t.NonwrappedStorageKey={})).MobileFirstRun="first_run",t.namespacedKey=function(e,t){return"".concat(e,"-").concat(t)},t.LegacyKeys1_0_0={WebPasscodeParamsKey:"offlineParams",MobilePasscodeParamsKey:"pc_params",AllAccountKeyParamsKey:"auth_params",WebEncryptedStorageKey:"encryptedStorage",MobileWrappedRootKeyKey:"encrypted_account_keys",MobileBiometricsPrefs:"biometrics_prefs",AllMigrations:"migrations",MobileThemesCache:"ThemePreferencesKey",MobileLightTheme:"lightTheme",MobileDarkTheme:"darkTheme",MobileLastExportDate:"LastExportDateKey",MobileDoNotWarnUnsupportedEditors:"DoNotShowAgainUnsupportedEditorsKey",MobileOptionsState:"options",MobilePasscodeKeyboardType:"passcodeKeyboardType"}},89057:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},19288:(e,t)=>{var n,r,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.ValueModesKeys=t.StorageValueModes=t.StorageEncryptionPolicy=t.StoragePersistencePolicies=void 0,(o=t.StoragePersistencePolicies||(t.StoragePersistencePolicies={}))[o.Default=1]="Default",o[o.Ephemeral=2]="Ephemeral",(i=t.StorageEncryptionPolicy||(t.StorageEncryptionPolicy={}))[i.Default=1]="Default",i[i.Disabled=2]="Disabled",(r=t.StorageValueModes||(t.StorageValueModes={}))[r.Default=1]="Default",r[r.Nonwrapped=2]="Nonwrapped",(n=t.ValueModesKeys||(t.ValueModesKeys={})).Wrapped="wrapped",n.Unwrapped="unwrapped",n.Nonwrapped="nonwrapped"},45272:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InfoStrings=void 0,t.InfoStrings={AccountDeleted:"Your account has been successfully deleted.",UnsupportedBackupFileVersion:"This backup file was created using a newer version of the application and cannot be imported here. Please update your application and try again.",BackupFileMoreRecentThanAccount:"This backup file was created using a newer encryption version than your account's. Please run the available encryption upgrade and try again.",SavingWhileDocumentHidden:"Attempting to save an item while the application is hidden. To protect data integrity, please refresh the application window and try again.",InvalidNote:"The note you are attempting to save can not be found or has been deleted. Changes you make will not be synced. Please copy this note's text and start a new note."}},58325:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KeychainRecoveryStrings=t.ErrorAlertStrings=t.ChallengeStrings=t.SessionStrings=t.ChallengeModalTitle=t.ProtocolUpgradeStrings=t.SignInStrings=t.RegisterStrings=t.CredentialsChangeStrings=t.StrictSignInFailed=t.InsufficientPasswordMessage=t.UNKNOWN_ERROR=t.DO_NOT_CLOSE_APPLICATION=t.REMOVING_PASSCODE=t.CHANGING_PASSCODE=t.SETTING_PASSCODE=t.UPGRADING_ENCRYPTION=t.OUTDATED_PROTOCOL_ALERT_IGNORE=t.INVALID_PASSWORD=t.INVALID_PASSWORD_COST=t.UNSUPPORTED_KEY_DERIVATION=t.EXPIRED_PROTOCOL_VERSION=t.UNSUPPORTED_PROTOCOL_VERSION=t.INVALID_EXTENSION_URL=t.API_MESSAGE_FAILED_OFFLINE_ACTIVATION=t.API_MESSAGE_FAILED_DOWNLOADING_EXTENSION=t.API_MESSAGE_UNTRUSTED_EXTENSIONS_WARNING=t.API_MESSAGE_FAILED_OFFLINE_FEATURES=t.API_MESSAGE_FAILED_DELETE_REVISION=t.API_MESSAGE_FAILED_ACCESS_PURCHASE=t.API_MESSAGE_FAILED_SUBSCRIPTION_INFO=t.API_MESSAGE_FAILED_CREATE_FILE_TOKEN=t.API_MESSAGE_FAILED_LISTED_REGISTRATION=t.API_MESSAGE_FAILED_UPDATE_SETTINGS=t.API_MESSAGE_FAILED_GET_SETTINGS=t.API_MESSAGE_INVALID_SESSION=t.API_MESSAGE_RATE_LIMITED=t.API_MESSAGE_TOKEN_REFRESH_IN_PROGRESS=t.API_MESSAGE_GENERIC_TOKEN_REFRESH_FAIL=t.API_MESSAGE_FALLBACK_LOGIN_FAIL=t.API_MESSAGE_CHANGE_CREDENTIALS_IN_PROGRESS=t.API_MESSAGE_LOGIN_IN_PROGRESS=t.API_MESSAGE_REGISTRATION_IN_PROGRESS=t.API_MESSAGE_GENERIC_SINGLE_ITEM_SYNC_FAIL=t.API_MESSAGE_GENERIC_INTEGRITY_CHECK_FAIL=t.ServerErrorStrings=t.API_MESSAGE_GENERIC_SYNC_FAIL=t.API_MESSAGE_GENERIC_CHANGE_CREDENTIALS_FAIL=t.API_MESSAGE_GENERIC_REGISTRATION_FAIL=t.API_MESSAGE_GENERIC_INVALID_LOGIN=void 0,t.API_MESSAGE_GENERIC_INVALID_LOGIN="A server error occurred while trying to sign in. Please try again.",t.API_MESSAGE_GENERIC_REGISTRATION_FAIL="A server error occurred while trying to register. Please try again.",t.API_MESSAGE_GENERIC_CHANGE_CREDENTIALS_FAIL="Something went wrong while changing your credentials. Your credentials were not changed. Please try again.",t.API_MESSAGE_GENERIC_SYNC_FAIL="Could not connect to server.",t.ServerErrorStrings={DeleteAccountError:"Your account was unable to be deleted due to an error. Please try your request again."},t.API_MESSAGE_GENERIC_INTEGRITY_CHECK_FAIL="Could not check your data integrity with the server.",t.API_MESSAGE_GENERIC_SINGLE_ITEM_SYNC_FAIL="Could not retrieve item.",t.API_MESSAGE_REGISTRATION_IN_PROGRESS="An existing registration request is already in progress.",t.API_MESSAGE_LOGIN_IN_PROGRESS="An existing sign in request is already in progress.",t.API_MESSAGE_CHANGE_CREDENTIALS_IN_PROGRESS="An existing change credentials request is already in progress.",t.API_MESSAGE_FALLBACK_LOGIN_FAIL="Invalid email or password.",t.API_MESSAGE_GENERIC_TOKEN_REFRESH_FAIL="A server error occurred while trying to refresh your session. Please try again.",t.API_MESSAGE_TOKEN_REFRESH_IN_PROGRESS="Your account session is being renewed with the server. Please try your request again.",t.API_MESSAGE_RATE_LIMITED="Too many successive server requests. Please wait a few minutes and try again.",t.API_MESSAGE_INVALID_SESSION="Please sign in to an account in order to continue with your request.",t.API_MESSAGE_FAILED_GET_SETTINGS="Failed to get settings.",t.API_MESSAGE_FAILED_UPDATE_SETTINGS="Failed to update settings.",t.API_MESSAGE_FAILED_LISTED_REGISTRATION="Unable to register for Listed. Please try again later.",t.API_MESSAGE_FAILED_CREATE_FILE_TOKEN="Failed to create file token.",t.API_MESSAGE_FAILED_SUBSCRIPTION_INFO="Failed to get subscription's information.",t.API_MESSAGE_FAILED_ACCESS_PURCHASE="Failed to access purchase flow.",t.API_MESSAGE_FAILED_DELETE_REVISION="Failed to delete revision.",t.API_MESSAGE_FAILED_OFFLINE_FEATURES="Failed to get offline features.",t.API_MESSAGE_UNTRUSTED_EXTENSIONS_WARNING="The extension you are attempting to install comes from an\n  untrusted source. Untrusted extensions may lower the security of your data. Do you want to continue?",t.API_MESSAGE_FAILED_DOWNLOADING_EXTENSION="Error downloading package details. Please check the\n  extension link and try again.",t.API_MESSAGE_FAILED_OFFLINE_ACTIVATION="An unknown issue occurred during offline activation. Please try again.",t.INVALID_EXTENSION_URL="Invalid extension URL.",t.UNSUPPORTED_PROTOCOL_VERSION="This version of the application does not support your newer account type. Please upgrade to the latest version of Standard Notes to sign in.",t.EXPIRED_PROTOCOL_VERSION="The protocol version associated with your account is outdated and no longer supported by this application. Please visit standardnotes.com/help/security for more information.",t.UNSUPPORTED_KEY_DERIVATION="Your account was created on a platform with higher security capabilities than this browser supports. If we attempted to generate your login keys here, it would take hours. Please use a browser with more up to date security capabilities, like Google Chrome or Firefox, to log in.",t.INVALID_PASSWORD_COST="Unable to sign in due to insecure password parameters. Please visit standardnotes.com/help/security for more information.",t.INVALID_PASSWORD="Invalid password.",t.OUTDATED_PROTOCOL_ALERT_IGNORE="Sign In",t.UPGRADING_ENCRYPTION="Upgrading your account's encryption version…",t.SETTING_PASSCODE="Setting passcode…",t.CHANGING_PASSCODE="Changing passcode…",t.REMOVING_PASSCODE="Removing passcode…",t.DO_NOT_CLOSE_APPLICATION="Do not close the application until this process completes.",t.UNKNOWN_ERROR="Unknown error.",t.InsufficientPasswordMessage=function(e){return"Your password must be at least ".concat(e," characters in length. For your security, please choose a longer password or, ideally, a passphrase, and try again.")},t.StrictSignInFailed=function(e,t){return"Strict Sign In has refused the server's sign-in parameters. The latest account version is ".concat(t,", but the server is reporting a version of ").concat(e," for your account. If you'd like to proceed with sign in anyway, please disable Strict Sign In and try again.")},t.CredentialsChangeStrings={PasscodeRequired:"Your passcode is required to process your credentials change.",Failed:"Unable to change your credentials due to a sync error. Please try again."},t.RegisterStrings={PasscodeRequired:"Your passcode is required in order to register for an account."},t.SignInStrings={PasscodeRequired:"Your passcode is required in order to sign in to your account.",IncorrectMfa:"Incorrect two-factor authentication code. Please try again.",SignInCanceledMissingMfa:"Your sign in request has been canceled."},t.ProtocolUpgradeStrings={SuccessAccount:"Your encryption version has been successfully upgraded. You may be asked to enter your credentials again on other devices you're signed into.",SuccessPasscodeOnly:"Your encryption version has been successfully upgraded.",Fail:"Unable to upgrade encryption version. Please try again.",UpgradingPasscode:"Upgrading local encryption..."},t.ChallengeModalTitle={Generic:"Authentication Required",Migration:"Storage Update"},t.SessionStrings={EnterEmailAndPassword:"Please enter your account email and password.",RecoverSession:e=>e?"Your credentials are needed for ".concat(e," to refresh your session with the server."):"Your credentials are needed to refresh your session with the server.",SessionRestored:"Your session has been successfully restored.",EnterMfa:"Please enter your two-factor authentication code.",MfaInputPlaceholder:"Two-factor authentication code",EmailInputPlaceholder:"Email",PasswordInputPlaceholder:"Password",KeychainRecoveryErrorTitle:"Invalid Credentials",KeychainRecoveryError:"The email or password you entered is incorrect.\n\nPlease note that this sign-in request is made against the default server. If you are using a custom server, you must uninstall the app then reinstall, and sign back into your account.",RevokeTitle:"Revoke this session?",RevokeConfirmButton:"Revoke",RevokeCancelButton:"Cancel",RevokeText:"The associated app will be signed out and all data removed from the device when it is next launched. You can sign back in on that device at any time.",CurrentSessionRevoked:"Your session has been revoked and all local data has been removed from this device."},t.ChallengeStrings={UnlockApplication:"Authentication is required to unlock the application",NoteAccess:"Authentication is required to view this note",FileAccess:"Authentication is required to access this file",ImportFile:"Authentication is required to import a backup file",AddPasscode:"Authentication is required to add a passcode",RemovePasscode:"Authentication is required to remove your passcode",ChangePasscode:"Authentication is required to change your passcode",ChangeAutolockInterval:"Authentication is required to change autolock timer duration",RevokeSession:"Authentication is required to revoke a session",EnterAccountPassword:"Enter your account password",EnterLocalPasscode:"Enter your application passcode",EnterPasscodeForMigration:"Your application passcode is required to perform an upgrade of your local data storage structure.",EnterPasscodeForRootResave:"Enter your application passcode to continue",EnterCredentialsForProtocolUpgrade:"Enter your credentials to perform encryption upgrade",EnterCredentialsForDecryptedBackupDownload:"Enter your credentials to download a decrypted backup",AccountPasswordPlaceholder:"Account Password",LocalPasscodePlaceholder:"Application Passcode",DecryptEncryptedFile:"Enter the account password associated with the import file",ExportBackup:"Authentication is required to export a backup",DisableBiometrics:"Authentication is required to disable biometrics",UnprotectNote:"Authentication is required to unprotect a note",UnprotectFile:"Authentication is required to unprotect a file",SearchProtectedNotesText:"Authentication is required to search protected contents",SelectProtectedNote:"Authentication is required to select a protected note",DisableMfa:"Authentication is required to disable two-factor authentication",DeleteAccount:"Authentication is required to delete your account",ListedAuthorization:"Authentication is required to approve this note for Listed"},t.ErrorAlertStrings={MissingSessionTitle:"Missing Session",MissingSessionBody:"We were unable to load your server session. This represents an inconsistency with your application state. Please take an opportunity to backup your data, then sign out and sign back in to resolve this issue.",StorageDecryptErrorTitle:"Storage Error",StorageDecryptErrorBody:"We were unable to decrypt your local storage. Please restart the app and try again. If you're unable to resolve this issue, and you have an account, you may try uninstalling the app then reinstalling, then signing back into your account. Otherwise, please contact help@standardnotes.org for support."},t.KeychainRecoveryStrings={Title:"Restore Keychain",Text:"We've detected that your keychain has been wiped. This can happen when restoring your device from a backup. Please enter your account password to restore your account keys."}},85835:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},76727:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptionManager=void 0;const i=n(10687);class o extends i.AbstractService{constructor(e,t){super(t),this.subscriptionApiService=e,this.internalEventBus=t}acceptInvitation(e){return r(this,void 0,void 0,(function*(){try{const t=yield this.subscriptionApiService.acceptInvite(e);return t.data.error?{success:!1,message:t.data.error.message}:t.data}catch(e){return{success:!1,message:"Could not accept invitation."}}}))}listSubscriptionInvitations(){var e;return r(this,void 0,void 0,(function*(){try{const t=yield this.subscriptionApiService.listInvites();return null!==(e=t.data.invitations)&&void 0!==e?e:[]}catch(e){return[]}}))}inviteToSubscription(e){return r(this,void 0,void 0,(function*(){try{return!0===(yield this.subscriptionApiService.invite(e)).data.success}catch(e){return!1}}))}cancelInvitation(e){return r(this,void 0,void 0,(function*(){try{return!0===(yield this.subscriptionApiService.cancelInvite(e)).data.success}catch(e){return!1}}))}}t.SubscriptionManager=o},34089:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SyncMode=void 0,(n=t.SyncMode||(t.SyncMode={}))[n.Default=1]="Default",n[n.DownloadFirst=2]="DownloadFirst"},35255:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},31883:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SyncQueueStrategy=void 0,(n=t.SyncQueueStrategy||(t.SyncQueueStrategy={}))[n.ResolveOnNext=1]="ResolveOnNext",n[n.ForceSpawnNew=2]="ForceSpawnNew"},21027:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8762:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SyncSource=void 0,(n=t.SyncSource||(t.SyncSource={}))[n.External=1]="External",n[n.SpawnQueue=2]="SpawnQueue",n[n.ResolveQueue=3]="ResolveQueue",n[n.MoreDirtyItems=4]="MoreDirtyItems",n[n.AfterDownloadFirst=5]="AfterDownloadFirst",n[n.IntegrityCheck=6]="IntegrityCheck",n[n.ResolveOutOfSync=7]="ResolveOutOfSync"},4394:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},15922:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UserService=t.AccountEvent=void 0;const i=n(10256),o=n(64657),a=n(58325),s=n(45272),c=n(30306),l=n(10687),u=n(63840),d=n(19288);var p;!function(e){e.SignedInOrRegistered="SignedInOrRegistered",e.SignedOut="SignedOut"}(p=t.AccountEvent||(t.AccountEvent={}));class h extends l.AbstractService{constructor(e,t,n,r,i,o,a,s,c,l){super(l),this.sessionManager=e,this.syncService=t,this.storageService=n,this.itemManager=r,this.protocolService=i,this.alertService=o,this.challengeService=a,this.protectionService=s,this.userApiService=c,this.internalEventBus=l,this.signingIn=!1,this.registering=!1,this.MINIMUM_PASSCODE_LENGTH=1,this.MINIMUM_PASSWORD_LENGTH=8}deinit(){super.deinit(),this.sessionManager=void 0,this.syncService=void 0,this.storageService=void 0,this.itemManager=void 0,this.protocolService=void 0,this.alertService=void 0,this.challengeService=void 0,this.protectionService=void 0,this.userApiService=void 0}register(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return r(this,void 0,void 0,(function*(){if(this.protocolService.hasAccount())throw Error("Tried to register when an account already exists.");if(this.registering)throw Error("Already registering.");this.registering=!0;try{this.lockSyncing();const r=yield this.sessionManager.register(e,t,n);return this.syncService.resetSyncState(),yield this.storageService.setPersistencePolicy(n?d.StoragePersistencePolicies.Ephemeral:d.StoragePersistencePolicies.Default),i?yield this.syncService.markAllItemsAsNeedingSyncAndPersist():(yield this.itemManager.removeAllItemsFromMemory(),yield this.clearDatabase()),yield this.notifyEvent(p.SignedInOrRegistered),this.unlockSyncing(),this.registering=!1,yield this.syncService.downloadFirstSync(300),this.protocolService.decryptErroredPayloads(),r}catch(e){throw this.unlockSyncing(),this.registering=!1,e}}))}signIn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return r(this,void 0,void 0,(function*(){if(this.protocolService.hasAccount())throw Error("Tried to sign in when an account already exists.");if(this.signingIn)throw Error("Already signing in.");this.signingIn=!0;try{this.lockSyncing();const r=yield this.sessionManager.signIn(e,t,n,i);if(r.response.error)this.unlockSyncing();else{this.syncService.resetSyncState(),yield this.storageService.setPersistencePolicy(i?d.StoragePersistencePolicies.Ephemeral:d.StoragePersistencePolicies.Default),o?yield this.syncService.markAllItemsAsNeedingSyncAndPersist():(this.itemManager.removeAllItemsFromMemory(),yield this.clearDatabase()),yield this.notifyEvent(p.SignedInOrRegistered),this.unlockSyncing();const e=this.syncService.downloadFirstSync(1e3,{checkIntegrity:!0,awaitAll:a}).then((()=>{a||this.protocolService.decryptErroredPayloads()}));a&&(yield e,yield this.protocolService.decryptErroredPayloads())}return r.response}finally{this.signingIn=!1}}))}deleteAccount(){return r(this,void 0,void 0,(function*(){if(!(yield this.protectionService.authorizeAction(c.ChallengeReason.DeleteAccount,{fallBackToAccountPassword:!0,requireAccountPassword:!0,forcePrompt:!1})))return{error:!0,message:a.INVALID_PASSWORD};const e=this.sessionManager.getSureUser().uuid,t=yield this.userApiService.deleteAccount(e);return t.data.error?{error:!0,message:t.data.error.message}:(yield this.signOut(!0),this.alertService.alert(s.InfoStrings.AccountDeleted),{error:!1})}))}submitUserRequest(e){return r(this,void 0,void 0,(function*(){const t=this.sessionManager.getSureUser().uuid;try{const n=yield this.userApiService.submitUserRequest({userUuid:t,requestType:e});return!n.data.error&&n.data.success}catch(e){return!1}}))}correctiveSignIn(e){return r(this,void 0,void 0,(function*(){this.lockSyncing();const t=yield this.sessionManager.bypassChecksAndSignInWithRootKey(e.keyParams.identifier,e,!1);return t.error||(yield this.notifyEvent(p.SignedInOrRegistered),this.unlockSyncing(),this.syncService.downloadFirstSync(1e3,{checkIntegrity:!0}),this.protocolService.decryptErroredPayloads()),this.unlockSyncing(),t}))}changeCredentials(e){return r(this,void 0,void 0,(function*(){const t=yield this.performCredentialsChange(e);return t.error&&this.alertService.alert(t.error.message),t}))}signOut(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.DeinitSource.SignOut;return r(this,void 0,void 0,(function*(){const n=()=>r(this,void 0,void 0,(function*(){yield this.sessionManager.signOut(),yield this.protocolService.deleteWorkspaceSpecificKeyStateFromDevice(),yield this.storageService.clearAllData(),yield this.notifyEvent(p.SignedOut,{source:t})}));if(e)return void(yield n());const i=this.itemManager.getDirtyItems();if(i.length>0){const e=1===i.length;(yield this.alertService.confirm("There ".concat(e?"is":"are"," ").concat(i.length," ").concat(e?"item":"items"," with unsynced changes. If you sign out, these changes will be lost forever. Are you sure you want to sign out?")))&&(yield n())}else yield n()}))}performProtocolUpgrade(){return r(this,void 0,void 0,(function*(){const e=this.protocolService.hasPasscode(),t=this.protocolService.hasAccount(),n=[];e&&n.push(new c.ChallengePrompt(c.ChallengeValidation.LocalPasscode,void 0,a.ChallengeStrings.LocalPasscodePlaceholder)),t&&n.push(new c.ChallengePrompt(c.ChallengeValidation.AccountPassword,void 0,a.ChallengeStrings.AccountPasswordPlaceholder));const r=new c.Challenge(n,c.ChallengeReason.ProtocolUpgrade,!0),o=yield this.challengeService.promptForChallengeResponse(r);if(!o)return{canceled:!0};const s=yield this.alertService.blockingDialog(a.DO_NOT_CLOSE_APPLICATION,a.UPGRADING_ENCRYPTION);try{let n;if(e&&(n=o.getValueForType(c.ChallengeValidation.LocalPasscode).value),t){const e=o.getValueForType(c.ChallengeValidation.AccountPassword).value,t=yield this.changeCredentials({currentPassword:e,newPassword:e,passcode:n,origination:i.KeyParamsOrigination.ProtocolUpgrade,validateNewPasswordStrength:!1});if(null==t?void 0:t.error)return{error:t.error}}return e&&(yield this.removePasscodeWithoutWarning(),yield this.setPasscodeWithoutWarning(n,i.KeyParamsOrigination.ProtocolUpgrade)),{success:!0}}catch(e){return{error:e}}finally{s()}}))}addPasscode(e){return r(this,void 0,void 0,(function*(){if(e.length<this.MINIMUM_PASSCODE_LENGTH)return!1;if(!(yield this.protectionService.authorizeAddingPasscode()))return!1;const t=yield this.alertService.blockingDialog(a.DO_NOT_CLOSE_APPLICATION,a.SETTING_PASSCODE);try{return yield this.setPasscodeWithoutWarning(e,i.KeyParamsOrigination.PasscodeCreate),!0}finally{t()}}))}removePasscode(){return r(this,void 0,void 0,(function*(){if(!(yield this.protectionService.authorizeRemovingPasscode()))return!1;const e=yield this.alertService.blockingDialog(a.DO_NOT_CLOSE_APPLICATION,a.REMOVING_PASSCODE);try{return yield this.removePasscodeWithoutWarning(),!0}finally{e()}}))}changePasscode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.KeyParamsOrigination.PasscodeChange;return r(this,void 0,void 0,(function*(){if(e.length<this.MINIMUM_PASSCODE_LENGTH)return!1;if(!(yield this.protectionService.authorizeChangingPasscode()))return!1;const n=yield this.alertService.blockingDialog(a.DO_NOT_CLOSE_APPLICATION,t===i.KeyParamsOrigination.ProtocolUpgrade?a.ProtocolUpgradeStrings.UpgradingPasscode:a.CHANGING_PASSCODE);try{return yield this.removePasscodeWithoutWarning(),yield this.setPasscodeWithoutWarning(e,t),!0}finally{n()}}))}setPasscodeWithoutWarning(e,t){return r(this,void 0,void 0,(function*(){const n=o.UuidGenerator.GenerateUuid(),r=yield this.protocolService.createRootKey(n,e,t);yield this.protocolService.setNewRootKeyWrapper(r),yield this.rewriteItemsKeys(),yield this.syncService.sync()}))}removePasscodeWithoutWarning(){return r(this,void 0,void 0,(function*(){yield this.protocolService.removePasscode(),yield this.rewriteItemsKeys()}))}rewriteItemsKeys(){return r(this,void 0,void 0,(function*(){const e=this.itemManager.getDisplayableItemsKeys().map((e=>e.payloadRepresentation()));yield this.storageService.forceDeletePayloads(e),yield this.syncService.persistPayloads(e)}))}lockSyncing(){this.syncService.lockSyncing()}unlockSyncing(){this.syncService.unlockSyncing()}clearDatabase(){return this.storageService.clearAllPayloads()}performCredentialsChange(e){return r(this,void 0,void 0,(function*(){const{wrappingKey:t,canceled:n}=yield this.challengeService.getWrappingKeyIfApplicable(e.passcode);if(n)return{error:Error(a.CredentialsChangeStrings.PasscodeRequired)};if(void 0!==e.newPassword&&e.validateNewPasswordStrength&&e.newPassword.length<this.MINIMUM_PASSWORD_LENGTH)return{error:Error(a.InsufficientPasswordMessage(this.MINIMUM_PASSWORD_LENGTH))};if(!(yield this.protocolService.validateAccountPassword(e.currentPassword)).valid)return{error:Error(a.INVALID_PASSWORD)};const r=this.sessionManager.getUser().email,i=yield this.recomputeRootKeysForCredentialChange({currentPassword:e.currentPassword,currentEmail:r,origination:e.origination,newEmail:e.newEmail,newPassword:e.newPassword});this.lockSyncing();const o=yield this.sessionManager.changeCredentials({currentServerPassword:i.currentRootKey.serverPassword,newRootKey:i.newRootKey,wrappingKey:t,newEmail:e.newEmail});if(this.unlockSyncing(),!o.response.error){const e=yield this.protocolService.createNewItemsKeyWithRollback();if(yield this.protocolService.reencryptItemsKeys(),yield this.syncService.sync({awaitAll:!0}),this.protocolService.getSureDefaultItemsKey().neverSynced)return yield this.sessionManager.changeCredentials({currentServerPassword:i.newRootKey.serverPassword,newRootKey:i.currentRootKey,wrappingKey:t}),yield this.protocolService.reencryptItemsKeys(),yield e(),yield this.syncService.sync({awaitAll:!0}),{error:Error(a.CredentialsChangeStrings.Failed)}}return o.response}))}recomputeRootKeysForCredentialChange(e){var t,n;return r(this,void 0,void 0,(function*(){return{currentRootKey:yield this.protocolService.computeRootKey(e.currentPassword,yield this.protocolService.getRootKeyParams()),newRootKey:yield this.protocolService.createRootKey(null!==(t=e.newEmail)&&void 0!==t?t:e.currentEmail,null!==(n=e.newPassword)&&void 0!==n?n:e.currentPassword,e.origination)}}))}}t.UserService=h},84333:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},18165:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceManager=void 0;const i=n(10687);class o extends i.AbstractService{constructor(e,t){super(t),this.workspaceApiService=e,this.internalEventBus=t}initiateKeyshare(e){return r(this,void 0,void 0,(function*(){try{const t=yield this.workspaceApiService.initiateKeyshare(e);return void 0!==t.data.error?{success:!1}:t.data}catch(e){return{success:!1}}}))}listWorkspaceUsers(e){return r(this,void 0,void 0,(function*(){try{const t=yield this.workspaceApiService.listWorkspaceUsers(e);return void 0!==t.data.error?{users:[]}:t.data}catch(e){return{users:[]}}}))}listWorkspaces(){return r(this,void 0,void 0,(function*(){try{const e=yield this.workspaceApiService.listWorkspaces();return void 0!==e.data.error?{ownedWorkspaces:[],joinedWorkspaces:[]}:e.data}catch(e){return{ownedWorkspaces:[],joinedWorkspaces:[]}}}))}acceptInvite(e){return r(this,void 0,void 0,(function*(){try{const t=yield this.workspaceApiService.acceptInvite(e);return void 0!==t.data.error?{success:!1}:t.data}catch(e){return{success:!1}}}))}inviteToWorkspace(e){return r(this,void 0,void 0,(function*(){try{const t=yield this.workspaceApiService.inviteToWorkspace(e);return void 0!==t.data.error?null:t.data}catch(e){return null}}))}createWorkspace(e){return r(this,void 0,void 0,(function*(){try{const t=yield this.workspaceApiService.createWorkspace(e);return void 0!==t.data.error?null:t.data}catch(e){return null}}))}}t.WorkspaceManager=o},29966:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(17656),t),i(n(69207),t),i(n(58864),t),i(n(54943),t),i(n(80091),t),i(n(87941),t),i(n(63840),t),i(n(27555),t),i(n(4394),t),i(n(85788),t),i(n(30935),t),i(n(30306),t),i(n(47205),t),i(n(38796),t),i(n(96040),t),i(n(18908),t),i(n(48531),t),i(n(61235),t),i(n(42101),t),i(n(92820),t),i(n(84136),t),i(n(6113),t),i(n(76081),t),i(n(47084),t),i(n(52567),t),i(n(13744),t),i(n(12121),t),i(n(41479),t),i(n(49184),t),i(n(52335),t),i(n(31714),t),i(n(88050),t),i(n(63706),t),i(n(354),t),i(n(43934),t),i(n(24382),t),i(n(21400),t),i(n(35067),t),i(n(54613),t),i(n(42176),t),i(n(39143),t),i(n(81052),t),i(n(40829),t),i(n(2901),t),i(n(40330),t),i(n(15689),t),i(n(87143),t),i(n(14027),t),i(n(39239),t),i(n(61325),t),i(n(13211),t),i(n(37830),t),i(n(94250),t),i(n(99463),t),i(n(83990),t),i(n(81098),t),i(n(23479),t),i(n(69991),t),i(n(83387),t),i(n(76473),t),i(n(10147),t),i(n(26353),t),i(n(71835),t),i(n(10687),t),i(n(19032),t),i(n(15328),t),i(n(4194),t),i(n(60106),t),i(n(24825),t),i(n(96640),t),i(n(14753),t),i(n(13066),t),i(n(89057),t),i(n(19288),t),i(n(45272),t),i(n(58325),t),i(n(85835),t),i(n(76727),t),i(n(34089),t),i(n(35255),t),i(n(31883),t),i(n(21027),t),i(n(8762),t),i(n(4394),t),i(n(15922),t),i(n(84333),t),i(n(18165),t)},20819:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(29966),t)},29686:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},91606:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},38331:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7624:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(29686),t),i(n(91606),t),i(n(38331),t)},23111:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},38644:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(23111),t)},20876:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},67790:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.timingSafeEqual=void 0,t.timingSafeEqual=function(e,t){const n=String(e);let r=String(t);const i=n.length;let o=0;i!==r.length&&(r=n,o=1);for(let e=0;e<i;e++)o|=n.charCodeAt(e)^r.charCodeAt(e);return 0===o}},70097:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(20876),t),i(n(67790),t)},20830:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},43438:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(20830),t)},64025:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},57756:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},84948:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7747:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},13795:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SodiumConstant=void 0,(n=t.SodiumConstant||(t.SodiumConstant={}))[n.CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_STATEBYTES=52]="CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_STATEBYTES",n[n.CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_ABYTES=17]="CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_ABYTES",n[n.CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_HEADERBYTES=24]="CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_HEADERBYTES",n[n.CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_KEYBYTES=32]="CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_KEYBYTES",n[n.CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_TAG_PUSH=0]="CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_TAG_PUSH",n[n.CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_TAG_PULL=1]="CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_TAG_PULL",n[n.CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_TAG_REKEY=2]="CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_TAG_REKEY",n[n.CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_TAG_FINAL=3]="CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_TAG_FINAL",n[n.CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_MESSAGEBYTES_MAX=274877906816]="CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_MESSAGEBYTES_MAX"},74078:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},4044:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},25786:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},54373:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},47349:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},91921:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},86976:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(64025),t),i(n(57756),t),i(n(84948),t),i(n(13795),t),i(n(74078),t),i(n(4044),t),i(n(25786),t),i(n(54373),t),i(n(47349),t),i(n(91921),t),i(n(7747),t)},86553:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(7624),t),i(n(38644),t),i(n(70097),t),i(n(43438),t),i(n(86976),t)},49148:(e,t,n)=>{n.d(t,{Ak:()=>s,FB:()=>i,Im:()=>c,_e:()=>o,g:()=>a});var r=n(16418);function i(e){return{"mac-web":r.Platform.MacWeb,"mac-desktop":r.Platform.MacDesktop,"linux-web":r.Platform.LinuxWeb,"linux-desktop":r.Platform.LinuxDesktop,"windows-web":r.Platform.WindowsWeb,"windows-desktop":r.Platform.WindowsDesktop,ios:r.Platform.Ios,android:r.Platform.Android}[e]}function o(e){return{[r.Platform.MacWeb]:"mac-web",[r.Platform.MacDesktop]:"mac-desktop",[r.Platform.LinuxWeb]:"linux-web",[r.Platform.LinuxDesktop]:"linux-desktop",[r.Platform.WindowsWeb]:"windows-web",[r.Platform.WindowsDesktop]:"windows-desktop",[r.Platform.Ios]:"ios",[r.Platform.Android]:"android"}[e]}function a(e){return{[r.Environment.Web]:"web",[r.Environment.Desktop]:"desktop",[r.Environment.Mobile]:"native-mobile-web"}[e]}function s(e){return e===r.Environment.Web||e===r.Environment.Desktop}function c(e){return e===r.Environment.Mobile}},58364:(e,t,n)=>{n.d(t,{J5:()=>S,UC:()=>m,wM:()=>o.SyncEvent,ie:()=>l,g:()=>b.g,Im:()=>b.Im,Ak:()=>b.Ak,FB:()=>b.FB,_e:()=>b._e});var r=n(70297),i=n(10256),o=n(20819),a=n(16418),s=n(65432),c=n(64657);function l(e){return{[o.SyncEvent.SyncCompletedWithAllItemsUploaded]:o.ApplicationEvent.CompletedFullSync,[o.SyncEvent.SingleRoundTripSyncCompleted]:o.ApplicationEvent.CompletedIncrementalSync,[o.SyncEvent.SyncError]:o.ApplicationEvent.FailedSync,[o.SyncEvent.SyncTakingTooLong]:o.ApplicationEvent.HighLatencySync,[o.SyncEvent.EnterOutOfSync]:o.ApplicationEvent.EnteredOutOfSync,[o.SyncEvent.ExitOutOfSync]:o.ApplicationEvent.ExitedOutOfSync,[o.SyncEvent.LocalDataLoaded]:o.ApplicationEvent.LocalDataLoaded,[o.SyncEvent.MajorDataChange]:o.ApplicationEvent.MajorDataChange,[o.SyncEvent.LocalDataIncrementalLoad]:o.ApplicationEvent.LocalDataIncrementalLoad,[o.SyncEvent.StatusChanged]:o.ApplicationEvent.SyncStatusChanged,[o.SyncEvent.SyncWillBegin]:o.ApplicationEvent.WillSync,[o.SyncEvent.InvalidSession]:o.ApplicationEvent.InvalidSyncSession,[o.SyncEvent.DatabaseReadError]:o.ApplicationEvent.LocalDatabaseReadError,[o.SyncEvent.DatabaseWriteError]:o.ApplicationEvent.LocalDatabaseWriteError,[o.SyncEvent.DownloadFirstSyncCompleted]:o.ApplicationEvent.CompletedInitialSync}[e]}var u=n(75082),d=n(10715),p=n(44412);const h={loadBatchSize:700,supportsFileNavigation:!1};function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class m{constructor(e){v(this,"onDeinit",void 0),v(this,"ephemeralIdentifier",c.nonSecureRandomIdentifier()),v(this,"migrationService",void 0),v(this,"deprecatedHttpService",void 0),v(this,"payloadManager",void 0),v(this,"protocolService",void 0),v(this,"diskStorageService",void 0),v(this,"inMemoryStore",void 0),v(this,"apiService",void 0),v(this,"sessionManager",void 0),v(this,"syncService",void 0),v(this,"challengeService",void 0),v(this,"singletonManager",void 0),v(this,"componentManagerService",void 0),v(this,"protectionService",void 0),v(this,"actionsManager",void 0),v(this,"historyManager",void 0),v(this,"itemManager",void 0),v(this,"keyRecoveryService",void 0),v(this,"preferencesService",void 0),v(this,"featuresService",void 0),v(this,"userService",void 0),v(this,"webSocketsService",void 0),v(this,"settingsService",void 0),v(this,"mfaService",void 0),v(this,"listedService",void 0),v(this,"fileService",void 0),v(this,"mutatorService",void 0),v(this,"integrityService",void 0),v(this,"statusService",void 0),v(this,"filesBackupService",void 0),v(this,"internalEventBus",void 0),v(this,"eventHandlers",[]),v(this,"services",[]),v(this,"streamRemovers",[]),v(this,"serviceObservers",[]),v(this,"managedSubscribers",[]),v(this,"autoSyncInterval",void 0),v(this,"createdNewDatabase",!1),v(this,"started",!1),v(this,"launched",!1),v(this,"dealloced",!1),v(this,"revokingSession",!1),v(this,"handledFullSyncStage",!1),v(this,"environment",void 0),v(this,"platform",void 0),v(this,"deviceInterface",void 0),v(this,"alertService",void 0),v(this,"identifier",void 0),v(this,"options",void 0);const t=f(f({},h),e);if(!p.W.onLog)throw Error("SNLog.onLog must be set.");if(!p.W.onError)throw Error("SNLog.onError must be set.");const n=["deviceInterface","environment","platform","crypto","alertService","identifier","defaultHost","appVersion"];for(const e of n)if(!t[e])throw Error("".concat(e," must be supplied when creating an application."));this.environment=e.environment,this.platform=e.platform,this.deviceInterface=e.deviceInterface,this.alertService=e.alertService,this.identifier=e.identifier,this.options=Object.freeze(t),this.constructInternalEventBus(),this.constructServices(),this.defineInternalEventHandlers()}get subscriptions(){return this.subscriptionManager}get workspaces(){return this.workspaceManager}get files(){return this.fileService}get features(){return this.featuresService}get items(){return this.itemManager}get protections(){return this.protectionService}get sync(){return this.syncService}get user(){return this.userService}get settings(){return this.settingsService}get mutator(){return this.mutatorService}get sessions(){return this.sessionManager}get status(){return this.statusService}get fileBackups(){return this.filesBackupService}get componentManager(){return this.componentManagerService}get listed(){return this.listedService}computePrivateUsername(e){return(0,u.ComputePrivateUsername)(this.options.crypto,e)}async prepareForLaunch(e){if(this.launched)throw new Error("Attempting to prelaunch already launched application");await this.options.crypto.initialize(),this.setLaunchCallback(e);const t=await this.deviceInterface.openDatabase(this.identifier).catch((e=>{this.notifyEvent(o.ApplicationEvent.LocalDatabaseReadError,e)}));this.createdNewDatabase=(0,c.useBoolean)(null==t?void 0:t.isNewDatabase,!1),await this.migrationService.initialize(),await this.notifyEvent(o.ApplicationEvent.MigrationsLoaded),await this.handleStage(o.ApplicationStage.PreparingForLaunch_0),await this.diskStorageService.initializeFromDisk(),await this.notifyEvent(o.ApplicationEvent.StorageReady),await this.protocolService.initialize(),await this.handleStage(o.ApplicationStage.ReadyForLaunch_05),this.started=!0,await this.notifyEvent(o.ApplicationEvent.Started)}setLaunchCallback(e){this.challengeService.sendChallenge=e.receiveChallenge}async launch(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.launched)throw new Error("Attempting to launch already launched application");this.launched=!1;const t=this.getLaunchChallenge();if(t){const e=await this.challengeService.promptForChallengeResponse(t);if(!e)throw Error("Launch challenge was cancelled.");await this.handleLaunchChallengeResponse(e)}if(this.diskStorageService.isStorageWrapped())try{await this.diskStorageService.decryptStorage()}catch(e){this.alertService.alert(o.ErrorAlertStrings.StorageDecryptErrorBody,o.ErrorAlertStrings.StorageDecryptErrorTitle)}await this.handleStage(o.ApplicationStage.StorageDecrypted_09),this.apiService.loadHost(),this.webSocketsService.loadWebSocketUrl(),await this.sessionManager.initializeFromDisk(),this.settingsService.initializeFromDisk(),this.featuresService.initializeFromDisk(),this.launched=!0,await this.notifyEvent(o.ApplicationEvent.Launched),await this.handleStage(o.ApplicationStage.Launched_10);const n=await this.syncService.getDatabasePayloads();await this.handleStage(o.ApplicationStage.LoadingDatabase_11),this.createdNewDatabase&&await this.syncService.onNewDatabaseCreated();const r=this.syncService.loadDatabasePayloads(n).then((async()=>{if(this.dealloced)throw"Application has been destroyed.";await this.handleStage(o.ApplicationStage.LoadedDatabase_12),this.beginAutoSyncTimer(),await this.syncService.sync({mode:o.SyncMode.DownloadFirst,source:o.SyncSource.External})}));e&&await r}onStart(){}onLaunch(){}getLaunchChallenge(){return this.protectionService.createLaunchChallenge()}async handleLaunchChallengeResponse(e){if(e.challenge.hasPromptForValidationType(o.ChallengeValidation.LocalPasscode)){var t;let n=null===(t=e.artifacts)||void 0===t?void 0:t.wrappingKey;if(!n){const t=e.getValueForType(o.ChallengeValidation.LocalPasscode);n=await this.protocolService.computeWrappingKey(t.value)}await this.protocolService.unwrapRootKey(n)}}beginAutoSyncTimer(){this.autoSyncInterval=setInterval((()=>{this.syncService.log("Syncing from autosync"),this.sync.sync()}),3e4)}async handleStage(e){for(const t of this.services)await t.handleApplicationStage(e)}addEventObserver(e,t){const n={callback:e,singleEvent:t};return this.eventHandlers.push(n),()=>{c.removeFromArray(this.eventHandlers,n)}}addSingleEventObserver(e,t){return this.addEventObserver((async n=>{n===e&&t(e)}),e)}async getDiagnostics(){let e={application:{snjsVersion:d.in,appVersion:this.options.appVersion,environment:this.options.environment,platform:this.options.platform}};for(const t of this.services){const n=await t.getDiagnostics();n&&(e=f(f({},e),n))}return e}async notifyEvent(e,t){e===o.ApplicationEvent.Started?this.onStart():e===o.ApplicationEvent.Launched&&this.onLaunch();for(const n of this.eventHandlers.slice())(n.singleEvent&&n.singleEvent===e||!n.singleEvent)&&await n.callback(e,t||{});this.migrationService.handleApplicationEvent(e)}isDatabaseLoaded(){return this.syncService.isDatabaseLoaded()}getSessions(){return this.sessionManager.getSessionsList()}async revokeSession(e){if(await this.protectionService.authorizeSessionRevoking())return this.sessionManager.revokeSession(e)}async revokeAllOtherSessions(){return this.sessionManager.revokeAllOtherSessions()}userCanManageSessions(){const e=this.getUserVersion();return!c.isNullOrUndefined(e)&&i.compareVersions(e,i.ProtocolVersion.V004)>=0}async getUserSubscription(){return this.sessionManager.getSubscription()}async getAvailableSubscriptions(){return this.sessionManager.getAvailableSubscriptions()}streamItems(e,t){const n=this.itemManager.addObserver(e,(e=>{let{changed:n,inserted:r,removed:i,source:o}=e;t({changed:n,inserted:r,removed:i,source:o})})),r=this.itemManager.getItems(e);return t({inserted:r,changed:[],removed:[],source:a.PayloadEmitSource.InitialObserverRegistrationPush}),this.streamRemovers.push(n),()=>{n(),c.removeFromArray(this.streamRemovers,n)}}async setHost(e){this.httpService.setHost(e),await this.apiService.setHost(e)}getHost(){return this.apiService.getHost()}async setCustomHost(e){await this.setHost(e),this.webSocketsService.setWebSocketUrl(void 0)}getUser(){if(!this.launched)throw Error("Attempting to access user before application unlocked");return this.sessionManager.getUser()}getUserPasswordCreationDate(){return this.protocolService.getPasswordCreatedDate()}getProtocolEncryptionDisplayName(){return this.protocolService.getEncryptionDisplayName()}getUserVersion(){return this.protocolService.getUserVersion()}protocolUpgradeAvailable(){return this.protocolService.upgradeAvailable()}isEncryptionAvailable(){return this.hasAccount()||this.hasPasscode()}async upgradeProtocolVersion(){const e=await this.userService.performProtocolUpgrade();return e.success?this.hasAccount()?this.alertService.alert(o.ProtocolUpgradeStrings.SuccessAccount):this.alertService.alert(o.ProtocolUpgradeStrings.SuccessPasscodeOnly):e.error&&this.alertService.alert(o.ProtocolUpgradeStrings.Fail),e}noAccount(){return!this.hasAccount()}hasAccount(){return this.protocolService.hasAccount()}hasProtectionSources(){return this.protectionService.hasProtectionSources()}hasUnprotectedAccessSession(){return this.protectionService.hasUnprotectedAccessSession()}getProtectionSessionExpiryDate(){return this.protectionService.getSessionExpiryDate()}clearProtectionSession(){return this.protectionService.clearSession()}async authorizeProtectedActionForNotes(e,t){return await this.protectionService.authorizeProtectedActionForItems(e,t)}authorizeNoteAccess(e){return this.protectionService.authorizeItemAccess(e)}authorizeAutolockIntervalChange(){return this.protectionService.authorizeAutolockIntervalChange()}authorizeSearchingProtectedNotesText(){return this.protectionService.authorizeSearchingProtectedNotesText()}async createEncryptedBackupFileForAutomatedDesktopBackups(){return this.protocolService.createEncryptedBackupFile()}async createEncryptedBackupFile(){if(await this.protectionService.authorizeBackupCreation())return this.protocolService.createEncryptedBackupFile()}async createDecryptedBackupFile(){if(await this.protectionService.authorizeBackupCreation())return this.protocolService.createDecryptedBackupFile()}isEphemeralSession(){return this.diskStorageService.isEphemeralSession()}setValue(e,t,n){return this.diskStorageService.setValue(e,t,n)}getValue(e,t){return this.diskStorageService.getValue(e,t)}async removeValue(e,t){return this.diskStorageService.removeValue(e,t)}getPreference(e,t){return this.preferencesService.getValue(e,t)}async setPreference(e,t){return this.preferencesService.setValue(e,t)}async prepareForDeinit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=Promise.all(this.services.map((e=>e.blockDeinit())));0===e?await t:await Promise.race([t,c.sleep(e)])}promptForCustomChallenge(e){var t;return null===(t=this.challengeService)||void 0===t?void 0:t.promptForChallengeResponse(e)}addChallengeObserver(e,t){return this.challengeService.addChallengeObserver(e,t)}submitValuesForChallenge(e,t){return this.challengeService.submitValuesForChallenge(e,t)}cancelChallenge(e){this.challengeService.cancelChallenge(e)}setOnDeinit(e){this.onDeinit=e}deinit(e,t){var n;this.dealloced=!0,clearInterval(this.autoSyncInterval),this.autoSyncInterval=void 0;for(const e of this.serviceObservers)e();for(const e of this.managedSubscribers)e();for(const e of this.services)e.deinit();this.options.crypto.deinit(),this.options=void 0,this.createdNewDatabase=!1,this.services.length=0,this.serviceObservers.length=0,this.managedSubscribers.length=0,this.streamRemovers.length=0,this.clearInternalEventBus(),this.clearServices(),this.started=!1,null===(n=this.onDeinit)||void 0===n||n.call(this,this,e,t),this.onDeinit=void 0}async register(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return this.userService.register(e,t,n,r)}async signIn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return this.userService.signIn(e,t,n,r,i,o)}async changeEmail(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.KeyParamsOrigination.EmailChange;return this.userService.changeCredentials({currentPassword:t,newEmail:e,passcode:n,origination:r,validateNewPasswordStrength:!1})}async changePassword(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.KeyParamsOrigination.PasswordChange,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return this.userService.changeCredentials({currentPassword:e,newPassword:t,passcode:n,origination:r,validateNewPasswordStrength:o})}async handleRevokedSession(){if(this.revokingSession)return;this.revokingSession=!0;const e=this.alertService;await this.user.signOut(!0),e.alert(o.SessionStrings.CurrentSessionRevoked)}async validateAccountPassword(e){const{valid:t}=await this.protocolService.validateAccountPassword(e);return t}isStarted(){return this.started}isLaunched(){return this.launched}hasPasscode(){return this.protocolService.hasPasscode()}isLocked(){return this.started?this.challengeService.isPasscodeLocked():Promise.resolve(!0)}async lock(){return await this.prepareForDeinit(500),this.deinit(this.getDeinitMode(),o.DeinitSource.Lock)}softLockBiometrics(){const e=new o.Challenge([new o.ChallengePrompt(o.ChallengeValidation.Biometric)],o.ChallengeReason.ApplicationUnlock,!1);this.promptForCustomChallenge(e),this.notifyEvent(o.ApplicationEvent.BiometricsSoftLockEngaged),this.addChallengeObserver(e,{onComplete:()=>{this.notifyEvent(o.ApplicationEvent.BiometricsSoftLockDisengaged)}})}isNativeMobileWeb(){return this.environment===a.Environment.Mobile}getDeinitMode(){return"hard"===this.getValue(o.StorageKey.DeinitMode)?o.DeinitMode.Hard:o.DeinitMode.Soft}addPasscode(e){return this.userService.addPasscode(e)}async removePasscode(){return this.userService.removePasscode()}async changePasscode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.KeyParamsOrigination.PasscodeChange;return this.userService.changePasscode(e,t)}getStorageEncryptionPolicy(){return this.diskStorageService.getStorageEncryptionPolicy()}setStorageEncryptionPolicy(e){return this.diskStorageService.setEncryptionPolicy(e),this.protocolService.repersistAllItems()}enableEphemeralPersistencePolicy(){return this.diskStorageService.setPersistencePolicy(o.StoragePersistencePolicies.Ephemeral)}hasPendingMigrations(){return this.migrationService.hasPendingMigrations()}generateUuid(){return c.UuidGenerator.GenerateUuid()}presentKeyRecoveryWizard(){return this.keyRecoveryService.presentKeyRecoveryWizard()}canAttemptDecryptionOfItem(e){return this.keyRecoveryService.canAttemptDecryptionOfItem(e)}changeDeviceInterface(e){this.deviceInterface=e;for(const t of this.services)"deviceInterface"in t&&(t.deviceInterface=e)}isMfaFeatureAvailable(){return this.mfaService.isMfaFeatureAvailable()}async isMfaActivated(){return this.mfaService.isMfaActivated()}async generateMfaSecret(){return this.mfaService.generateMfaSecret()}async getOtpToken(e){return this.mfaService.getOtpToken(e)}async enableMfa(e,t){return this.mfaService.enableMfa(e,t)}async disableMfa(){if(await this.protectionService.authorizeMfaDisable())return this.mfaService.disableMfa()}getNewSubscriptionToken(){return this.apiService.getNewSubscriptionToken()}isThirdPartyHostUsed(){return this.apiService.isThirdPartyHostUsed()}getCloudProviderIntegrationUrl(e,t){return this.settingsService.getCloudProviderIntegrationUrl(e,t)}constructServices(){this.createPayloadManager(),this.createItemManager(),this.createDiskStorageManager(),this.createInMemoryStorageManager(),this.createProtocolService(),this.diskStorageService.provideEncryptionProvider(this.protocolService),this.createChallengeService(),this.createHttpManager(),this.createApiService(),this.createHttpService(),this.createUserServer(),this.createUserRequestServer(),this.createUserApiService(),this.createSubscriptionServer(),this.createSubscriptionApiService(),this.createWebSocketServer(),this.createWebSocketApiService(),this.createSubscriptionManager(),this.createWorkspaceServer(),this.createWorkspaceApiService(),this.createWorkspaceManager(),this.createWebSocketsService(),this.createSessionManager(),this.createHistoryManager(),this.createSyncManager(),this.createProtectionService(),this.createUserService(),this.createKeyRecoveryService(),this.createSingletonManager(),this.createPreferencesService(),this.createSettingsService(),this.createFeaturesService(),this.createComponentManager(),this.createMigrationService(),this.createMfaService(),this.createFileService(),this.createIntegrityService(),this.createMutatorService(),this.createListedService(),this.createActionsManager(),this.createStatusService(),(0,o.isDesktopDevice)(this.deviceInterface)&&this.createFilesBackupService(this.deviceInterface)}clearServices(){this.migrationService=void 0,this.alertService=void 0,this.deprecatedHttpService=void 0,this.httpService=void 0,this.payloadManager=void 0,this.protocolService=void 0,this.diskStorageService=void 0,this.inMemoryStore=void 0,this.apiService=void 0,this.userApiService=void 0,this.userServer=void 0,this.userRequestServer=void 0,this.subscriptionApiService=void 0,this.subscriptionServer=void 0,this.subscriptionManager=void 0,this.workspaceApiService=void 0,this.workspaceServer=void 0,this.workspaceManager=void 0,this.webSocketApiService=void 0,this.webSocketServer=void 0,this.sessionManager=void 0,this.syncService=void 0,this.challengeService=void 0,this.singletonManager=void 0,this.componentManagerService=void 0,this.protectionService=void 0,this.actionsManager=void 0,this.historyManager=void 0,this.itemManager=void 0,this.keyRecoveryService=void 0,this.preferencesService=void 0,this.featuresService=void 0,this.userService=void 0,this.webSocketsService=void 0,this.settingsService=void 0,this.mfaService=void 0,this.listedService=void 0,this.fileService=void 0,this.integrityService=void 0,this.mutatorService=void 0,this.filesBackupService=void 0,this.statusService=void 0,this.services=[]}constructInternalEventBus(){this.internalEventBus=new o.InternalEventBus}defineInternalEventHandlers(){this.internalEventBus.addEventHandler(this.featuresService,o.ApiServiceEvent.MetaReceived),this.internalEventBus.addEventHandler(this.integrityService,o.SyncEvent.SyncRequestsIntegrityCheck),this.internalEventBus.addEventHandler(this.syncService,o.IntegrityEvent.IntegrityCheckCompleted)}clearInternalEventBus(){this.internalEventBus.deinit(),this.internalEventBus=void 0}createListedService(){this.listedService=new s.o8(this.apiService,this.itemManager,this.settingsService,this.deprecatedHttpService,this.protectionService,this.mutator,this.internalEventBus),this.services.push(this.listedService)}createFileService(){this.fileService=new o.FileService(this.apiService,this.itemManager,this.syncService,this.protocolService,this.challengeService,this.alertService,this.options.crypto,this.internalEventBus),this.services.push(this.fileService)}createIntegrityService(){this.integrityService=new o.IntegrityService(this.apiService,this.apiService,this.payloadManager,this.internalEventBus),this.services.push(this.integrityService)}createFeaturesService(){this.featuresService=new s.sX(this.diskStorageService,this.apiService,this.itemManager,this.webSocketsService,this.settingsService,this.userService,this.syncService,this.alertService,this.sessionManager,this.options.crypto,this.internalEventBus),this.serviceObservers.push(this.featuresService.addEventObserver((e=>{switch(e){case o.FeaturesEvent.UserRolesChanged:this.notifyEvent(o.ApplicationEvent.UserRolesChanged);break;case o.FeaturesEvent.FeaturesUpdated:this.notifyEvent(o.ApplicationEvent.FeaturesUpdated);break;default:c.assertUnreachable(e)}}))),this.services.push(this.featuresService)}createWebSocketsService(){this.webSocketsService=new s.g7(this.diskStorageService,this.options.webSocketUrl,this.webSocketApiService,this.internalEventBus),this.services.push(this.webSocketsService)}createMigrationService(){this.migrationService=new s.FR({protocolService:this.protocolService,deviceInterface:this.deviceInterface,storageService:this.diskStorageService,sessionManager:this.sessionManager,challengeService:this.challengeService,itemManager:this.itemManager,singletonManager:this.singletonManager,featuresService:this.featuresService,environment:this.environment,identifier:this.identifier,internalEventBus:this.internalEventBus}),this.services.push(this.migrationService)}createUserService(){this.userService=new o.UserService(this.sessionManager,this.syncService,this.diskStorageService,this.itemManager,this.protocolService,this.alertService,this.challengeService,this.protectionService,this.userApiService,this.internalEventBus),this.serviceObservers.push(this.userService.addEventObserver((async(e,t)=>{switch(e){case o.AccountEvent.SignedInOrRegistered:this.notifyEvent(o.ApplicationEvent.SignedIn);break;case o.AccountEvent.SignedOut:await this.notifyEvent(o.ApplicationEvent.SignedOut),await this.prepareForDeinit(),this.deinit(this.getDeinitMode(),(null==t?void 0:t.source)||o.DeinitSource.SignOut);break;default:c.assertUnreachable(e)}}))),this.services.push(this.userService)}createApiService(){this.apiService=new s.QL(this.deprecatedHttpService,this.diskStorageService,this.options.defaultHost,this.inMemoryStore,this.options.crypto,this.internalEventBus),this.services.push(this.apiService)}createUserApiService(){this.userApiService=new r.UserApiService(this.userServer,this.userRequestServer)}createUserServer(){this.userServer=new r.UserServer(this.httpService)}createUserRequestServer(){this.userRequestServer=new r.UserRequestServer(this.httpService)}createSubscriptionApiService(){this.subscriptionApiService=new r.SubscriptionApiService(this.subscriptionServer)}createSubscriptionServer(){this.subscriptionServer=new r.SubscriptionServer(this.httpService)}createWebSocketApiService(){this.webSocketApiService=new r.WebSocketApiService(this.webSocketServer)}createWebSocketServer(){this.webSocketServer=new r.WebSocketServer(this.httpService)}createSubscriptionManager(){this.subscriptionManager=new o.SubscriptionManager(this.subscriptionApiService,this.internalEventBus)}createWorkspaceServer(){this.workspaceServer=new r.WorkspaceServer(this.httpService)}createWorkspaceApiService(){this.workspaceApiService=new r.WorkspaceApiService(this.workspaceServer)}createWorkspaceManager(){this.workspaceManager=new o.WorkspaceManager(this.workspaceApiService,this.internalEventBus)}createItemManager(){this.itemManager=new s.A(this.payloadManager,this.options,this.internalEventBus),this.services.push(this.itemManager)}createComponentManager(){this.componentManagerService=new s.bJ(this.itemManager,this.syncService,this.featuresService,this.preferencesService,this.alertService,this.environment,this.platform,this.internalEventBus,this.deviceInterface),this.services.push(this.componentManagerService)}createHttpManager(){this.deprecatedHttpService=new s.aJ(this.environment,this.options.appVersion,this.internalEventBus),this.services.push(this.deprecatedHttpService)}createHttpService(){this.httpService=new r.HttpService(this.environment,this.options.appVersion,d.in,this.options.defaultHost,this.apiService.processMetaObject.bind(this.apiService))}createPayloadManager(){this.payloadManager=new s.Ot(this.internalEventBus),this.services.push(this.payloadManager)}createSingletonManager(){this.singletonManager=new s.c5(this.itemManager,this.payloadManager,this.syncService,this.internalEventBus),this.services.push(this.singletonManager)}createDiskStorageManager(){this.diskStorageService=new s.e5(this.deviceInterface,this.identifier,this.environment,this.internalEventBus),this.services.push(this.diskStorageService)}createInMemoryStorageManager(){this.inMemoryStore=new o.InMemoryStore}createProtocolService(){this.protocolService=new o.EncryptionService(this.itemManager,this.payloadManager,this.deviceInterface,this.diskStorageService,this.identifier,this.options.crypto,this.internalEventBus),this.serviceObservers.push(this.protocolService.addEventObserver((async e=>{e===o.EncryptionServiceEvent.RootKeyStatusChanged&&await this.notifyEvent(o.ApplicationEvent.KeyStatusChanged)}))),this.services.push(this.protocolService)}createKeyRecoveryService(){this.keyRecoveryService=new s.Mj(this.itemManager,this.payloadManager,this.apiService,this.protocolService,this.challengeService,this.alertService,this.diskStorageService,this.syncService,this.userService,this.internalEventBus),this.services.push(this.keyRecoveryService)}createSessionManager(){this.sessionManager=new s.Lb(this.diskStorageService,this.apiService,this.userApiService,this.alertService,this.protocolService,this.challengeService,this.webSocketsService,this.httpService,this.internalEventBus),this.serviceObservers.push(this.sessionManager.addEventObserver((async e=>{switch(e){case s.Px.Restored:(async()=>{await this.sync.sync(),this.protocolService.needsNewRootKeyBasedItemsKey()&&this.protocolService.createNewDefaultItemsKey().then((()=>{this.sync.sync()}))})();break;case s.Px.Revoked:await this.handleRevokedSession();break;default:c.assertUnreachable(e)}}))),this.services.push(this.sessionManager)}createSyncManager(){this.syncService=new s.xu(this.itemManager,this.sessionManager,this.protocolService,this.diskStorageService,this.payloadManager,this.apiService,this.historyManager,{loadBatchSize:this.options.loadBatchSize},this.internalEventBus);const e=this.syncService.addEventObserver((async e=>{const t=l(e);t&&(await this.protocolService.onSyncEvent(e),await this.notifyEvent(t),t===o.ApplicationEvent.CompletedFullSync&&(this.handledFullSyncStage||(this.handledFullSyncStage=!0,await this.handleStage(o.ApplicationStage.FullSyncCompleted_13))))}));this.serviceObservers.push(e),this.services.push(this.syncService)}createChallengeService(){this.challengeService=new s.PJ(this.diskStorageService,this.protocolService,this.internalEventBus),this.services.push(this.challengeService)}createProtectionService(){this.protectionService=new s.Xr(this.protocolService,this.challengeService,this.diskStorageService,this.internalEventBus),this.serviceObservers.push(this.protectionService.addEventObserver((e=>{e===s.Hh.UnprotectedSessionBegan?this.notifyEvent(o.ApplicationEvent.UnprotectedSessionBegan):e===s.Hh.UnprotectedSessionExpired&&this.notifyEvent(o.ApplicationEvent.UnprotectedSessionExpired)}))),this.services.push(this.protectionService)}createHistoryManager(){this.historyManager=new s.Cv(this.itemManager,this.diskStorageService,this.apiService,this.protocolService,this.deviceInterface,this.internalEventBus),this.services.push(this.historyManager)}createActionsManager(){this.actionsManager=new s.UP(this.itemManager,this.alertService,this.deviceInterface,this.deprecatedHttpService,this.payloadManager,this.protocolService,this.syncService,this.challengeService,this.listedService,this.internalEventBus),this.services.push(this.actionsManager)}createPreferencesService(){this.preferencesService=new s.J_(this.singletonManager,this.itemManager,this.syncService,this.internalEventBus),this.serviceObservers.push(this.preferencesService.addEventObserver((()=>{this.notifyEvent(o.ApplicationEvent.PreferencesChanged)}))),this.services.push(this.preferencesService)}createSettingsService(){this.settingsService=new s.kf(this.sessionManager,this.apiService,this.internalEventBus),this.services.push(this.settingsService)}createMfaService(){this.mfaService=new s.P$(this.settingsService,this.options.crypto,this.featuresService,this.internalEventBus),this.services.push(this.mfaService)}createMutatorService(){this.mutatorService=new s.Vu(this.itemManager,this.syncService,this.protectionService,this.protocolService,this.payloadManager,this.challengeService,this.componentManagerService,this.historyManager,this.internalEventBus),this.services.push(this.mutatorService)}createFilesBackupService(e){this.filesBackupService=new o.FilesBackupService(this.itemManager,this.apiService,this.protocolService,e,this.statusService,this.internalEventBus),this.services.push(this.filesBackupService)}createStatusService(){this.statusService=new o.StatusService(this.internalEventBus),this.services.push(this.statusService)}}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class S{constructor(e,t,n){g(this,"item",void 0),g(this,"removeObserver",void 0),this.item=t.items.findSureItem(e),n&&n(this.item),this.removeObserver=t.streamItems(this.item.content_type,(t=>{let{changed:r,inserted:i}=t;const o=[...r,...i].find((t=>t.uuid===e));o&&(this.item=o,n&&n(this.item))}))}deinit(){this.removeObserver?(this.removeObserver(),this.removeObserver=void 0):console.error("A LiveItem is attempting to be deinited more than once.")}}var b=n(49148)},82698:(e,t,n)=>{n.d(t,{$:()=>r,R:()=>s});var r,i=n(20819),o=n(64657);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.PrimaryApplicationSet="PrimaryApplicationSet",e.DescriptorsDataChanged="DescriptorsDataChanged",e.DeviceWillRestart="DeviceWillRestart"}(r||(r={}));class s extends i.AbstractService{constructor(e,t){void 0===t&&(t=new i.InternalEventBus),super(t),a(this,"device",void 0),a(this,"primaryApplication",void 0),a(this,"descriptorRecord",void 0),a(this,"callback",void 0),a(this,"onApplicationDeinit",((e,t,n)=>{this.primaryApplication===e&&(this.primaryApplication=void 0),(async()=>{n===i.DeinitSource.SignOut&&this.removeDescriptor(this.descriptorForApplication(e));const o=this.getDescriptors();if(0===o.length||n===i.DeinitSource.SignOutAll){const e=o.map((e=>e.identifier));this.descriptorRecord={};const{killsApplication:t}=await this.device.clearAllDataFromDevice(e);if(t)return}const a=this.device;this.notifyEvent(r.DeviceWillRestart,{source:n,mode:t}),this.deinit(),t===i.DeinitMode.Hard?a.performHardReset():a.performSoftReset()})()})),this.device=e}deinit(){super.deinit(),this.device.deinit(),this.device=void 0,this.callback=void 0,this.primaryApplication=void 0,this.onApplicationDeinit=void 0}async initialize(e){if(this.device.isDeviceDestroyed())throw"Attempting to initialize new application while device is destroyed.";this.callback=e,this.descriptorRecord=await this.device.getJsonParsedRawStorageValue(i.RawStorageKey.DescriptorRecord),this.descriptorRecord||await this.createNewDescriptorRecord();let t=this.findPrimaryDescriptor();t||(console.error("No primary application descriptor found. Ensure migrations have been run."),t=this.getDescriptors()[0],this.setDescriptorAsPrimary(t),await this.persistDescriptors());const n=await this.buildApplication(t);this.primaryApplication=n,await this.notifyEvent(r.PrimaryApplicationSet,{application:n})}async createNewDescriptorRecord(){const e="standardnotes",t={[e]:{identifier:e,label:"Main Workspace",primary:!0}};this.device.setRawStorageValue(i.RawStorageKey.DescriptorRecord,JSON.stringify(t)),this.descriptorRecord=t,await this.persistDescriptors()}getDescriptors(){return Object.values(this.descriptorRecord)}findPrimaryDescriptor(){for(const e of this.getDescriptors())if(e.primary)return e}async signOutAllWorkspaces(){await this.primaryApplication.user.signOut(!1,i.DeinitSource.SignOutAll)}setDescriptorAsPrimary(e){for(const t of this.getDescriptors())t.primary=t===e}async persistDescriptors(){await this.device.setRawStorageValue(i.RawStorageKey.DescriptorRecord,JSON.stringify(this.descriptorRecord)),this.notifyEvent(r.DescriptorsDataChanged,{descriptors:this.descriptorRecord})}renameDescriptor(e,t){e.label=t,this.persistDescriptors()}removeDescriptor(e){delete this.descriptorRecord[e.identifier];const t=this.getDescriptors();return e.primary&&t.length>0&&this.setDescriptorAsPrimary(t[0]),this.persistDescriptors()}removeAllDescriptors(){return this.descriptorRecord={},this.persistDescriptors()}descriptorForApplication(e){return this.descriptorRecord[e.identifier]}createNewApplicationDescriptor(e){const t=o.UuidGenerator.GenerateUuid(),n=this.getDescriptors().length+1;return{identifier:t,label:e||"Workspace ".concat(n),primary:!1}}async createNewPrimaryDescriptor(e){const t=this.createNewApplicationDescriptor(e);this.descriptorRecord[t.identifier]=t,this.setDescriptorAsPrimary(t),await this.persistDescriptors()}async unloadCurrentAndCreateNewDescriptor(e){await this.createNewPrimaryDescriptor(e),this.primaryApplication&&this.primaryApplication.deinit(this.primaryApplication.getDeinitMode(),i.DeinitSource.SwitchWorkspace)}async unloadCurrentAndActivateDescriptor(e){this.setDescriptorAsPrimary(e),await this.persistDescriptors(),this.primaryApplication&&this.primaryApplication.deinit(this.primaryApplication.getDeinitMode(),i.DeinitSource.SwitchWorkspace)}async buildApplication(e){const t=await this.callback.applicationCreator(e,this.device);return t.setOnDeinit(this.onApplicationDeinit),t}}},78338:(e,t,n)=>{n.d(t,{rp:()=>h,iB:()=>i,Jj:()=>f,_p:()=>d,Zw:()=>o});var r=n(70295);class i{getIconForFileType(e){let t="file-other";return"application/pdf"===e&&(t="file-pdf"),/word/.test(e)&&(t="file-doc"),/powerpoint|presentation/.test(e)&&(t="file-ppt"),/excel|spreadsheet/.test(e)&&(t="file-xls"),/^image\//.test(e)&&(t="file-image"),/^video\//.test(e)&&(t="file-mov"),/^audio\//.test(e)&&(t="file-music"),/(zip)|([tr]ar)|(7z)/.test(e)&&(t="file-zip"),t}getIconAndTintForNoteType(e){switch(e){case r.NoteType.RichText:return["rich-text",1];case r.NoteType.Markdown:return["markdown",2];case r.NoteType.Authentication:return["authenticator",6];case r.NoteType.Spreadsheet:return["spreadsheets",5];case r.NoteType.Task:return["tasks",3];case r.NoteType.Code:return["code",4];default:return["plain-text",1]}}}var o,a=n(20819),s=n(16418),c=n(64657),l=n(10256);function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class d{constructor(e,t,n){u(this,"application",void 0),u(this,"templateNoteOptions",void 0),u(this,"item",void 0),u(this,"dealloced",!1),u(this,"innerValueChangeObservers",[]),u(this,"removeStreamObserver",void 0),u(this,"isTemplateNote",!1),u(this,"saveTimeout",void 0),u(this,"defaultTagUuid",void 0),u(this,"defaultTag",void 0),u(this,"runtimeId","".concat(Math.random())),this.application=e,this.templateNoteOptions=n,t&&(this.item=t),n&&(this.defaultTagUuid=n.tag),this.defaultTagUuid&&(this.defaultTag=this.application.items.findItem(this.defaultTagUuid))}deinit(){var e;this.dealloced=!0,null===(e=this.removeStreamObserver)||void 0===e||e.call(this),this.removeStreamObserver=void 0,this.application=void 0,this.item=void 0,this.innerValueChangeObservers.length=0,this.saveTimeout=void 0}async initialize(e){if(!this.item){var t,n,i,o,a;const c=(null===(t=this.defaultTag)||void 0===t||null===(n=t.preferences)||void 0===n?void 0:n.editorIdentifier)||(null===(i=this.application.componentManager.getDefaultEditor())||void 0===i?void 0:i.identifier),u=c?this.application.componentManager.componentWithIdentifier(c):void 0,d=this.application.mutator.createTemplateItem(l.ContentType.Note,{text:"",title:(null===(o=this.templateNoteOptions)||void 0===o?void 0:o.title)||"",noteType:(null==u?void 0:u.noteType)||r.NoteType.Plain,editorIdentifier:c,references:[]},{created_at:(null===(a=this.templateNoteOptions)||void 0===a?void 0:a.createdAt)||new Date});if(this.isTemplateNote=!0,this.item=d,this.defaultTagUuid){const t=this.application.items.findItem(this.defaultTagUuid);await this.application.items.addTagToNote(d,t,e)}this.notifyObservers(this.item,s.PayloadEmitSource.InitialObserverRegistrationPush)}this.streamItems()}notifyObservers(e,t){for(const n of this.innerValueChangeObservers)n(e,t)}streamItems(){this.dealloced||(this.removeStreamObserver=this.application.streamItems(l.ContentType.Note,(e=>{let{changed:t,inserted:n,source:r}=e;if(this.dealloced)return;const i=t.concat(n).find((e=>e.uuid===this.item.uuid));i&&(this.isTemplateNote=!1,this.item=i,this.notifyObservers(i,r))})))}insertTemplatedNote(){return this.isTemplateNote=!1,this.application.mutator.insertItem(this.item)}addNoteInnerValueChangeObserver(e){this.innerValueChangeObservers.push(e),this.item&&e(this.item,s.PayloadEmitSource.InitialObserverRegistrationPush);const t=this.innerValueChangeObservers;return()=>{(0,c.removeFromArray)(t,e)}}async save(e){const t=e.editorValues.title,n=e.editorValues.text,r=this.isTemplateNote;if("undefined"!=typeof document&&document.hidden)return void this.application.alertService.alert(a.InfoStrings.SavingWhileDocumentHidden);if(r&&await this.insertTemplatedNote(),!this.application.items.findItem(this.item.uuid))return void this.application.alertService.alert(a.InfoStrings.InvalidNote);await this.application.mutator.changeItem(this.item,(r=>{const i=r;if(e.customMutate&&e.customMutate(i),i.title=t,i.text=n,!e.dontUpdatePreviews){const e=n||"",t=e.length>160,r=e.substring(0,160)+(t?"...":"");i.preview_plain=r,i.preview_html=void 0}}),e.isUserModified),this.saveTimeout&&clearTimeout(this.saveTimeout);const i=e.bypassDebouncer||this.application.noAccount()?100:this.application.isNativeMobileWeb()?700:350;this.saveTimeout=setTimeout((()=>{this.application.sync.sync()}),i)}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class h{constructor(e,t){p(this,"application",void 0),p(this,"item",void 0),p(this,"dealloced",!1),p(this,"removeStreamObserver",void 0),p(this,"runtimeId","".concat(Math.random())),this.application=e,this.item=t}deinit(){var e;this.dealloced=!0,null===(e=this.removeStreamObserver)||void 0===e||e.call(this),this.removeStreamObserver=void 0,this.application=void 0,this.item=void 0}async initialize(){this.streamItems()}streamItems(){this.removeStreamObserver=this.application.streamItems(l.ContentType.File,(e=>{let{changed:t,inserted:n}=e;if(this.dealloced)return;const r=t.concat(n).find((e=>e.uuid===this.item.uuid));r&&(this.item=r)}))}}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class f{constructor(e){y(this,"application",void 0),y(this,"itemControllers",[]),y(this,"addTagHierarchy",void 0),y(this,"changeObservers",[]),y(this,"eventObservers",[]),this.application=e,this.addTagHierarchy=e.getPreference(s.PrefKey.NoteAddToParentFolders,!0),this.eventObservers.push(e.addSingleEventObserver(a.ApplicationEvent.PreferencesChanged,(async()=>{this.addTagHierarchy=e.getPreference(s.PrefKey.NoteAddToParentFolders,!0)})))}deinit(){this.application=void 0,this.eventObservers.forEach((e=>{e()})),this.changeObservers.length=0;for(const e of this.itemControllers)this.closeItemController(e,{notify:!1});this.itemControllers.length=0}async createItemController(e){let t;if(this.activeItemViewController&&this.closeItemController(this.activeItemViewController,{notify:!1}),e instanceof s.FileItem){const n=e;t=new h(this.application,n)}else if(e instanceof s.SNNote){const n=e;t=new d(this.application,n)}else t=new d(this.application,void 0,e);return this.itemControllers.push(t),await t.initialize(this.addTagHierarchy),this.notifyObservers(),t}closeItemController(e){let{notify:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{notify:!0};e.deinit(),(0,c.removeFromArray)(this.itemControllers,e),t&&this.notifyObservers()}closeActiveItemController(){const e=this.activeItemViewController;e&&this.closeItemController(e,{notify:!0})}closeAllItemControllers(){for(const e of this.itemControllers)this.closeItemController(e,{notify:!1});this.notifyObservers()}get activeItemViewController(){return this.itemControllers[0]}addActiveControllerChangeObserver(e){this.changeObservers.push(e),this.activeItemViewController&&e(this.activeItemViewController);const t=this.changeObservers;return()=>{(0,c.removeFromArray)(t,e)}}notifyObservers(){for(const e of this.changeObservers)e(this.activeItemViewController)}}!function(e){e.EnteringBackground="EnteringBackground",e.ResumingFromBackground="ResumingFromBackground",e.GainingFocus="GainingFocus",e.LosingFocus="LosingFocus",e.AndroidBackButtonPressed="AndroidBackButtonPressed",e.ColorSchemeChanged="ColorSchemeChanged",e.KeyboardFrameWillChange="KeyboardFrameWillChange",e.KeyboardFrameDidChange="KeyboardFrameDidChange"}(o||(o={}))},44412:(e,t,n)=>{function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{W:()=>i});class i{static log(){this.onLog(...arguments)}static error(e){return this.onError(e),e}}r(i,"onLog",void 0),r(i,"onError",void 0)},72186:(e,t,n)=>{n.d(t,{_:()=>v});var r={};n.r(r),n.d(r,{StorageReader1_0_0:()=>p.a,StorageReader2_0_0:()=>d});var i=n(44412),o=n(16418),a=n(10715),s=n(9907),c=n(20819),l=n(64657),u=n(34988);class d extends u.V{static version(){return a.Oq}async getStorage(){const e=(0,c.namespacedKey)(this.identifier,c.RawStorageKey.StorageObject),t=await this.deviceInterface.getRawStorageValue(e);return t?JSON.parse(t):void 0}async getNonWrappedValue(e){var t;const n=await this.getStorage();if(n)return null===(t=n[c.ValueModesKeys.Nonwrapped])||void 0===t?void 0:t[e]}async getAccountKeyParams(){return this.getNonWrappedValue(c.StorageKey.RootKeyParams)}async hasNonWrappedAccountKeys(){const e=await this.deviceInterface.getNamespacedKeychainValue(this.identifier);return!(0,l.isNullOrUndefined)(e)}async hasPasscode(){const e=await this.getNonWrappedValue(c.StorageKey.WrappedRootKey);return!(0,l.isNullOrUndefined)(e)}usesKeychain(){return!0}}var p=n(61733),h=n(75082);function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const f="last_migration_timestamp";class v extends s.U{constructor(){super(...arguments),y(this,"reader",void 0),y(this,"didPreRun",!1),y(this,"memoizedNeedsKeychainRepair",void 0)}async preRun(){await this.storeVersionNumber(),this.didPreRun=!0}registerStageHandlers(){this.registerStageHandler(c.ApplicationStage.PreparingForLaunch_0,(async()=>{await this.needsKeychainRepair()&&await this.repairMissingKeychain(),this.markDone()}))}getStoredVersion(){const e=(0,c.namespacedKey)(this.services.identifier,c.RawStorageKey.SnjsVersion);return this.services.deviceInterface.getRawStorageValue(e)}async storeVersionNumber(){const e=(0,c.namespacedKey)(this.services.identifier,c.RawStorageKey.SnjsVersion);if(!await this.getStoredVersion()){const t=["migrations","ephemeral","user","cachedThemes","syncToken","encryptedStorage"];let n=!1;for(const e of t)if(await this.services.deviceInterface.getRawStorageValue(e)){n=!0;break}if(n)await this.services.deviceInterface.setRawStorageValue(e,a.DU);else{const t=(0,c.namespacedKey)(this.services.identifier,f),n=await this.services.deviceInterface.getRawStorageValue(t);(0,l.isNullOrUndefined)(n)?await this.services.deviceInterface.setRawStorageValue(e,a.in):(await this.services.deviceInterface.setRawStorageValue(e,a.Oq),await this.services.deviceInterface.removeRawStorageValue(f))}}}async loadReader(){if(this.reader)return;const e=await this.getStoredVersion();this.reader=function(e,t,n,i){const o=function(e){const t=Object.values(r).sort(((e,t)=>-1*(0,a.D8)(e.version(),t.version())));for(const n of t){if(n.version()===e)return n;if((0,a.jV)(n.version(),e))return n}throw Error("Cannot find reader for version ".concat(e))}(e);return new o(t,n,i)}(e,this.services.deviceInterface,this.services.identifier,this.services.environment)}async needsKeychainRepair(){if(null!=this.memoizedNeedsKeychainRepair)return this.memoizedNeedsKeychainRepair;if(!this.didPreRun)throw Error("Attempting to access specialized function before prerun");if(this.reader||await this.loadReader(),!this.reader.usesKeychain)return this.memoizedNeedsKeychainRepair=!1,this.memoizedNeedsKeychainRepair;const e=await this.reader.getAccountKeyParams();return(0,l.isNullOrUndefined)(e)||await this.reader.hasPasscode()||await this.reader.hasNonWrappedAccountKeys()?(this.memoizedNeedsKeychainRepair=!1,this.memoizedNeedsKeychainRepair):(this.memoizedNeedsKeychainRepair=!0,this.memoizedNeedsKeychainRepair)}async repairMissingKeychain(){const e=await this.getStoredVersion(),t=await this.reader.getAccountKeyParams(),n=new c.Challenge([new c.ChallengePrompt(c.ChallengeValidation.None,void 0,c.SessionStrings.PasswordInputPlaceholder,!0)],c.ChallengeReason.Custom,!1,c.KeychainRecoveryStrings.Title,c.KeychainRecoveryStrings.Text);return new Promise((r=>{this.services.challengeService.addChallengeObserver(n,{onNonvalidatedSubmit:async s=>{const c=s.values[0].value,l=this.services.protocolService.createKeyParams(t),u=await this.services.protocolService.computeRootKey(c,l),d=(await this.services.deviceInterface.getAllRawDatabasePayloads(this.services.identifier)).map((e=>new o.EncryptedPayload(e)));let p=d.find((e=>(0,h.ContentTypeUsesRootKeyEncryption)(e.content_type)));if(p||(p=d[0]),!p)throw i.W.error(Error("Attempting keychain recovery validation but no items present."));const y=await this.services.protocolService.decryptSplitSingle({usesRootKey:{items:[p],key:u}});if((0,o.isErrorDecryptingPayload)(y))this.services.challengeService.setValidationStatusForChallenge(n,s.values[0],!1);else{if(e===a.DU)await this.services.deviceInterface.setLegacyRawKeychainValue({mk:u.masterKey,ak:u.dataAuthenticationKey,version:l.version});else{const e=u.getKeychainValue();await this.services.deviceInterface.setNamespacedKeychainValue(e,this.services.identifier)}r(!0),this.services.challengeService.completeChallenge(n)}}}),this.services.challengeService.promptForChallengeResponse(n)}))}}},9907:(e,t,n)=>{n.d(t,{U:()=>o});var r=n(20819);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class o{constructor(e){i(this,"services",void 0),i(this,"stageHandlers",{}),i(this,"onDoneHandler",void 0),this.services=e,this.registerStageHandlers()}static version(){throw"Must override migration version"}registerStageHandler(e,t){this.stageHandlers[e]=t}markDone(){var e;null===(e=this.onDoneHandler)||void 0===e||e.call(this),this.onDoneHandler=void 0}async promptForPasscodeUntilCorrect(e){const t=new r.Challenge([new r.ChallengePrompt(r.ChallengeValidation.None)],r.ChallengeReason.Migration,!1);return new Promise((n=>{this.services.challengeService.addChallengeObserver(t,{onNonvalidatedSubmit:async r=>{const i=r.values[0],o=i.value;await e(o)?(this.services.challengeService.completeChallenge(t),n(o)):this.services.challengeService.setValidationStatusForChallenge(t,i,!1)}}),this.services.challengeService.promptForChallengeResponse(t)}))}onDone(e){this.onDoneHandler=e}async handleStage(e){const t=this.stageHandlers[e];t&&await t()}}},34988:(e,t,n)=>{function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{V:()=>i});class i{constructor(e,t,n){r(this,"deviceInterface",void 0),r(this,"identifier",void 0),r(this,"environment",void 0),this.deviceInterface=e,this.identifier=t,this.environment=n}static version(){throw Error("Must override")}}},61733:(e,t,n)=>{n.d(t,{a:()=>c});var r=n(64657),i=n(49148),o=n(10715),a=n(20819),s=n(34988);class c extends s.V{static version(){return o.DU}async getAccountKeyParams(){return this.deviceInterface.getJsonParsedRawStorageValue(a.LegacyKeys1_0_0.AllAccountKeyParamsKey)}async hasNonWrappedAccountKeys(){if((0,a.isMobileDevice)(this.deviceInterface)){const e=await this.deviceInterface.getRawKeychainValue();return!(0,r.isNullOrUndefined)(e)}{const e=await this.deviceInterface.getRawStorageValue("mk");return!(0,r.isNullOrUndefined)(e)}}async hasPasscode(){if((0,i.Im)(this.environment)){const e=await this.deviceInterface.getJsonParsedRawStorageValue(a.LegacyKeys1_0_0.MobilePasscodeParamsKey);return!(0,r.isNullOrUndefined)(e)}{const e=await this.deviceInterface.getJsonParsedRawStorageValue(a.LegacyKeys1_0_0.WebEncryptedStorageKey);return!(0,r.isNullOrUndefined)(e)}}usesKeychain(){return!!(0,i.Im)(this.environment)}}},79437:(e,t,n)=>{n.d(t,{ce:()=>g,ly:()=>S,kK:()=>P,qW:()=>_,Ni:()=>w,pI:()=>b,R_:()=>E});var r=n(10256),i=n(91260),o=n(9907),a=n(10715),s=n(75082),c=n(70008),l=n(61733),u=n(16418),d=n(20819),p=n(64657),h=n(49148);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const m="jwt";class g extends o.U{constructor(e){super(e),v(this,"legacyReader",void 0),this.legacyReader=new l.a(this.services.deviceInterface,this.services.identifier,this.services.environment)}static version(){return a.Oq}registerStageHandlers(){this.registerStageHandler(d.ApplicationStage.PreparingForLaunch_0,(async()=>{(0,h.Ak)(this.services.environment)?await this.migrateStorageStructureForWebDesktop():(0,h.Im)(this.services.environment)&&await this.migrateStorageStructureForMobile()})),this.registerStageHandler(d.ApplicationStage.StorageDecrypted_09,(async()=>{await this.migrateArbitraryRawStorageToManagedStorageAllPlatforms(),(0,h.Im)(this.services.environment)&&await this.migrateMobilePreferences(),await this.migrateSessionStorage(),await this.deleteLegacyStorageValues()})),this.registerStageHandler(d.ApplicationStage.LoadingDatabase_11,(async()=>{await this.createDefaultItemsKeyForAllPlatforms(),this.markDone()}))}async migrateStorageStructureForWebDesktop(){const e=this.services.deviceInterface,t={[d.ValueModesKeys.Wrapped]:{},[d.ValueModesKeys.Unwrapped]:{},[d.ValueModesKeys.Nonwrapped]:{}},n=await this.legacyReader.getAccountKeyParams();n&&(t.nonwrapped[d.StorageKey.RootKeyParams]=n);const r=await e.getJsonParsedRawStorageValue(d.LegacyKeys1_0_0.WebEncryptedStorageKey);if(r){const e=new u.EncryptedPayload(r),n=await this.webDesktopHelperGetPasscodeKeyAndDecryptEncryptedStorage(e),i=n.key,o=n.decryptedStoragePayload,a=n.keyParams;t.nonwrapped[d.StorageKey.RootKeyWrapperKeyParams]=a.getPortableValue();const s=p.Copy(o.content.storage),c=p.jsonParseEmbeddedKeys(s),l=c[d.LegacyKeys1_0_0.AllAccountKeyParamsKey];t.nonwrapped[d.StorageKey.RootKeyParams]=l;let h=i;if(!p.isNullOrUndefined(c.mk)){const{accountKey:e,wrappedKey:n}=await this.webDesktopHelperExtractAndWrapAccountKeysFromValueStore(i,l,c);h=e,t.nonwrapped[d.StorageKey.WrappedRootKey]=n}t.wrapped=await this.webDesktopHelperEncryptStorage(h,o,c)}else{const e=await this.services.deviceInterface.getRawStorageValue("ak"),t=await this.services.deviceInterface.getRawStorageValue("mk");if(e||t){const r=n.version||await this.getFallbackRootKeyVersion(),i=(0,s.CreateNewRootKey)({masterKey:t,dataAuthenticationKey:e,version:r,keyParams:n});await this.services.deviceInterface.setNamespacedKeychainValue(i.getKeychainValue(),this.services.identifier)}}await this.allPlatformHelperSetStorageStructure(t)}async allPlatformHelperSetStorageStructure(e){const t=c.e.DefaultValuesObject(e.wrapped,e.unwrapped,e.nonwrapped);t[d.ValueModesKeys.Unwrapped]=void 0,await this.services.deviceInterface.setRawStorageValue(d.namespacedKey(this.services.identifier,d.RawStorageKey.StorageObject),JSON.stringify(t))}async webDesktopHelperGetPasscodeKeyAndDecryptEncryptedStorage(e){const t=await this.services.deviceInterface.getJsonParsedRawStorageValue(d.LegacyKeys1_0_0.WebPasscodeParamsKey),n=this.services.protocolService.createKeyParams(t);let r,i=e;return await this.promptForPasscodeUntilCorrect((async t=>(r=await this.services.protocolService.computeRootKey(t,n),i=await this.services.protocolService.decryptSplitSingle({usesRootKey:{items:[e],key:r}}),!u.isErrorDecryptingPayload(i)))),{decryptedStoragePayload:i,key:r,keyParams:n}}async webDesktopHelperExtractAndWrapAccountKeysFromValueStore(e,t,n){const r=(null==t?void 0:t.version)||await this.getFallbackRootKeyVersion(),i=(0,s.CreateNewRootKey)({masterKey:n.mk,dataAuthenticationKey:n.ak,version:r,keyParams:t});delete n.mk,delete n.pw,delete n.ak;const o=i.payload,a=await this.services.protocolService.encryptSplitSingle({usesRootKey:{items:[o],key:e}});return{accountKey:i,wrappedKey:u.CreateEncryptedLocalStorageContextPayload(a)}}async webDesktopHelperEncryptStorage(e,t,n){const i=await this.services.protocolService.encryptSplitSingle({usesRootKey:{items:[t.copy({content_type:r.ContentType.EncryptedStorage,content:n})],key:e}});return u.CreateEncryptedLocalStorageContextPayload(i)}async migrateStorageStructureForMobile(){p.assert((0,d.isMobileDevice)(this.services.deviceInterface));const e=await this.services.deviceInterface.getRawKeychainValue(),t=await this.services.deviceInterface.getJsonParsedRawStorageValue(d.LegacyKeys1_0_0.MobileWrappedRootKeyKey)||(null==e?void 0:e.encryptedAccountKeys),n=await this.legacyReader.getAccountKeyParams(),i=await this.services.deviceInterface.getJsonParsedRawStorageValue(d.LegacyKeys1_0_0.MobilePasscodeParamsKey),o=await this.services.deviceInterface.getJsonParsedRawStorageValue(d.NonwrappedStorageKey.MobileFirstRun),a={[d.ValueModesKeys.Nonwrapped]:{[d.StorageKey.WrappedRootKey]:t,[d.StorageKey.RootKeyWrapperKeyParams]:p.omitByCopy(i,["hash"]),[d.StorageKey.RootKeyParams]:n,[d.NonwrappedStorageKey.MobileFirstRun]:o},[d.ValueModesKeys.Unwrapped]:{},[d.ValueModesKeys.Wrapped]:{}},c=await this.services.deviceInterface.getJsonParsedRawStorageValue(d.LegacyKeys1_0_0.MobileBiometricsPrefs);c&&(a.nonwrapped[d.StorageKey.BiometricsState]=c.enabled,a.nonwrapped[d.StorageKey.MobileBiometricsTiming]=c.timing);const l=await this.services.deviceInterface.getRawStorageValue(d.LegacyKeys1_0_0.MobilePasscodeKeyboardType);if(l&&(a.nonwrapped[d.StorageKey.MobilePasscodeKeyboardType]=l),i){var h;const o=this.services.protocolService.createKeyParams(i),s=async()=>{let n;return await this.promptForPasscodeUntilCorrect((async r=>{var i;n=await this.services.protocolService.computeRootKey(r,o);const a=null==e||null===(i=e.offline)||void 0===i?void 0:i.pw;if(a)return n.serverPassword===a;if(t){const e=await this.services.protocolService.decryptSplitSingle({usesRootKey:{items:[new u.EncryptedPayload(t)],key:n}});return!u.isErrorDecryptingPayload(e)}{const e=(await this.services.deviceInterface.getAllRawDatabasePayloads(this.services.identifier))[0];if(!e)throw Error("Passcode only migration aborting due to missing keychain.offline.pw");const t=await this.services.protocolService.decryptSplitSingle({usesRootKey:{items:[new u.EncryptedPayload(e)],key:n}});return!u.isErrorDecryptingPayload(t)}})),n};if(a.nonwrapped[d.StorageKey.MobilePasscodeTiming]=null==e||null===(h=e.offline)||void 0===h?void 0:h.timing,t){const e=await s(),r=new u.EncryptedPayload(t),i=await this.services.protocolService.decryptSplitSingle({usesRootKey:{items:[r],key:e}});if(u.isErrorDecryptingPayload(i))return;const o=i.content.accountKeys,c=o.version||(null==n?void 0:n.version)||await this.getFallbackRootKeyVersion(),l=i.copy({content:u.FillItemContent({masterKey:o.mk,dataAuthenticationKey:o.ak,version:c,keyParams:n,accountKeys:void 0})}),p=await this.services.protocolService.encryptSplitSingle({usesRootKey:{items:[l],key:e}});a.nonwrapped[d.StorageKey.WrappedRootKey]=u.CreateEncryptedLocalStorageContextPayload(p),o.jwt&&this.services.deviceInterface.setRawStorageValue(m,o.jwt),await this.services.deviceInterface.clearRawKeychainValue()}else if(!t){const e=await s(),t=new u.DecryptedPayload(f({uuid:p.UuidGenerator.GenerateUuid(),content:u.FillItemContent(a.unwrapped),content_type:r.ContentType.EncryptedStorage},(0,u.PayloadTimestampDefaults)())),n=await this.services.protocolService.encryptSplitSingle({usesRootKey:{items:[t],key:e}});a.wrapped=u.CreateEncryptedLocalStorageContextPayload(n),await this.services.deviceInterface.clearRawKeychainValue()}}else if(!p.isNullOrUndefined(null==e?void 0:e.mk)){const t=e.version||(null==n?void 0:n.version)||await this.getFallbackRootKeyVersion(),r=(0,s.CreateNewRootKey)({masterKey:e.mk,dataAuthenticationKey:e.ak,version:t,keyParams:n});await this.services.deviceInterface.setNamespacedKeychainValue(r.getKeychainValue(),this.services.identifier),e.jwt&&this.services.deviceInterface.setRawStorageValue(m,e.jwt)}await this.allPlatformHelperSetStorageStructure(a)}async getFallbackRootKeyVersion(){const e=(await this.services.deviceInterface.getAllRawDatabasePayloads(this.services.identifier))[0];return e&&new u.EncryptedPayload(e).version||r.ProtocolVersion.V002}async migrateArbitraryRawStorageToManagedStorageAllPlatforms(){const e=await this.services.deviceInterface.getAllRawStorageKeyValues(),t=p.objectToValueArray(d.LegacyKeys1_0_0),n=e=>{try{return JSON.parse(e)}catch(t){return e}},r=this.services.identifier;for(const i of e){const e=i.key,o=i.value,a=r&&r.length>0&&e.startsWith(r);if(!t.includes(e)&&!a&&!p.isNullOrUndefined(o)){const t=n(o);this.services.storageService.setValue(e,t)}}}async deleteLegacyStorageValues(){const e=[...p.objectToValueArray(d.StorageKey),...p.objectToValueArray(d.LegacyKeys1_0_0),"mk","ak","pw","encryptionKey","authKey","jwt","ephemeral","cachedThemes"];for(const t of e)await this.services.deviceInterface.removeRawStorageValue(t)}async migrateMobilePreferences(){const e=await this.services.deviceInterface.getJsonParsedRawStorageValue(d.LegacyKeys1_0_0.MobileLastExportDate),t=await this.services.deviceInterface.getJsonParsedRawStorageValue(d.LegacyKeys1_0_0.MobileDoNotWarnUnsupportedEditors),n=await this.services.deviceInterface.getJsonParsedRawStorageValue(d.LegacyKeys1_0_0.MobileOptionsState);let r={};if(n){var i,o,a,s;const e=n.sortBy;r={sortBy:"updated_at"===e||"client_updated_at"===e?u.CollectionSort.UpdatedAt:e,sortReverse:null!==(i=n.sortReverse)&&void 0!==i&&i,hideNotePreview:null!==(o=n.hidePreviews)&&void 0!==o&&o,hideDate:null!==(a=n.hideDates)&&void 0!==a&&a,hideTags:null!==(s=n.hideTags)&&void 0!==s&&s}}const c=f(f({},r),{},{lastExportDate:null!=e?e:void 0,doNotShowAgainUnsupportedEditors:null!=t&&t});await this.services.storageService.setValue(d.StorageKey.MobilePreferences,c)}migrateSessionStorage(){let e=this.services.storageService.getValue(m);const t=this.services.storageService.getValue("user");if(e||t&&(e=t.jwt),!e){if(p.isNullOrUndefined(t))return;e="junk-value"}const n=new i.j(e);this.services.storageService.setValue(d.StorageKey.Session,n),(0,h.Im)(this.services.environment)&&t&&t.server&&this.services.storageService.setValue(d.StorageKey.ServerHost,t.server)}async createDefaultItemsKeyForAllPlatforms(){const e=this.services.protocolService.getRootKey();if(e){const t=await this.services.protocolService.getRootKeyParams(),n=r.ProtocolVersion.V001,i=new u.DecryptedPayload(f({uuid:p.UuidGenerator.GenerateUuid(),content_type:r.ContentType.ItemsKey,content:u.FillItemContentSpecialized({itemsKey:e.masterKey,dataAuthenticationKey:e.dataAuthenticationKey,version:(null==t?void 0:t.version)||n}),dirty:!0,dirtyIndex:(0,u.getIncrementedDirtyIndex)()},(0,u.PayloadTimestampDefaults)())),o=u.CreateDecryptedItemFromPayload(i);await this.services.itemManager.emitItemFromPayload(o.payloadRepresentation(),u.PayloadEmitSource.LocalChanged)}}}class S extends o.U{static version(){return"2.0.15"}registerStageHandlers(){this.registerStageHandler(d.ApplicationStage.LoadedDatabase_12,(async()=>{await this.createNewDefaultItemsKeyIfNecessary(),this.markDone()}))}async createNewDefaultItemsKeyIfNecessary(){this.services.protocolService.needsNewRootKeyBasedItemsKey()&&await this.services.protocolService.createNewDefaultItemsKey()}}class b extends o.U{static version(){return"2.7.0"}registerStageHandlers(){this.registerStageHandler(d.ApplicationStage.FullSyncCompleted_13,(async()=>{await this.deleteBatchManagerSingleton(),this.markDone()}))}async deleteBatchManagerSingleton(){const e=new u.CompoundPredicate("and",[new u.Predicate("content_type","=",r.ContentType.Component),new u.Predicate("identifier","=","org.standardnotes.batch-manager")]),t=this.services.singletonManager.findSingleton(r.ContentType.Component,e);t&&await this.services.itemManager.setItemToBeDeleted(t)}}class P extends o.U{static version(){return"2.20.0"}registerStageHandlers(){this.registerStageHandler(d.ApplicationStage.LoadedDatabase_12,(async()=>{await this.deleteMfaItems(),this.markDone()}))}async deleteMfaItems(){const e=this.services.itemManager.getItems("SF|MFA");for(const t of e)this.services.itemManager.removeItemLocally(t),await this.services.storageService.deletePayloadWithId(t.uuid)}}class _ extends o.U{static version(){return"2.36.0"}registerStageHandlers(){this.registerStageHandler(d.ApplicationStage.LoadedDatabase_12,(async()=>{await this.removeServerExtensionsLocally(),this.markDone()}))}async removeServerExtensionsLocally(){const e=this.services.itemManager.getItems("SF|Extension");for(const t of e)this.services.itemManager.removeItemLocally(t),await this.services.storageService.deletePayloadWithId(t.uuid)}}class w extends o.U{static version(){return"2.42.0"}registerStageHandlers(){this.registerStageHandler(d.ApplicationStage.FullSyncCompleted_13,(async()=>{await this.deleteNoDistraction(),this.markDone()}))}async deleteNoDistraction(){const e=this.services.itemManager.getItems(r.ContentType.Theme).filter((e=>"org.standardnotes.theme-no-distraction"===e.identifier));for(const t of e)await this.services.itemManager.setItemToBeDeleted(t)}}const E=[g,S,b,P,_,w]},24431:(e,t,n)=>{n.d(t,{Ni:()=>i.Ni,R_:()=>i.R_,_r:()=>r._,ce:()=>i.ce,kK:()=>i.kK,ly:()=>i.ly,pI:()=>i.pI,qW:()=>i.qW});var r=n(72186),i=n(79437)},91260:(e,t,n)=>{n.d(t,{j:()=>i});var r=n(24630);class i extends r.z{constructor(e){var t;super(),t=void 0,"jwt"in this?Object.defineProperty(this,"jwt",{value:t,enumerable:!0,configurable:!0,writable:!0}):this.jwt=t,this.jwt=e}get authorizationValue(){return this.jwt}canExpire(){return!1}}},24630:(e,t,n)=>{n.d(t,{z:()=>r});class r{}},70008:(e,t,n)=>{n.d(t,{e:()=>p});var r=n(10256),i=n(64657),o=n(44412),a=n(75082),s=n(20819),c=n(16418);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class p extends s.AbstractService{constructor(e,t,n,r){super(r),d(this,"deviceInterface",void 0),d(this,"identifier",void 0),d(this,"environment",void 0),d(this,"internalEventBus",void 0),d(this,"encryptionProvider",void 0),d(this,"storagePersistable",!1),d(this,"persistencePolicy",void 0),d(this,"encryptionPolicy",void 0),d(this,"needsPersist",!1),d(this,"currentPersistPromise",void 0),d(this,"values",void 0),this.deviceInterface=e,this.identifier=t,this.environment=n,this.internalEventBus=r,this.setPersistencePolicy(s.StoragePersistencePolicies.Default),this.setEncryptionPolicy(s.StorageEncryptionPolicy.Default,!1)}provideEncryptionProvider(e){this.encryptionProvider=e}deinit(){this.deviceInterface=void 0,this.encryptionProvider=void 0,this.storagePersistable=!1,super.deinit()}async handleApplicationStage(e){if(await super.handleApplicationStage(e),e===s.ApplicationStage.Launched_10)this.storagePersistable=!0,this.needsPersist&&this.persistValuesToDisk();else if(e===s.ApplicationStage.StorageDecrypted_09){const e=await this.getValue(s.StorageKey.StorageEncryptionPolicy);e&&this.setEncryptionPolicy(e,!1)}}async setPersistencePolicy(e){this.persistencePolicy=e,this.persistencePolicy===s.StoragePersistencePolicies.Ephemeral&&(await this.deviceInterface.removeAllRawStorageValues(),await this.clearAllPayloads())}setEncryptionPolicy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e===s.StorageEncryptionPolicy.Disabled&&![c.Environment.Mobile].includes(this.environment))throw Error("Disabling storage encryption is only available on mobile.");this.encryptionPolicy=e,t&&this.setValue(s.StorageKey.StorageEncryptionPolicy,e)}isEphemeralSession(){return this.persistencePolicy===s.StoragePersistencePolicies.Ephemeral}async initializeFromDisk(){const e=await this.deviceInterface.getRawStorageValue(this.getPersistenceKey()),t=e?JSON.parse(e):void 0;await this.setInitialValues(t)}async setInitialValues(e){const t=e||this.defaultValuesObject();t[s.ValueModesKeys.Unwrapped]||(t[s.ValueModesKeys.Unwrapped]={}),this.values=t,this.isStorageWrapped()||(this.values[s.ValueModesKeys.Unwrapped]=u(u({},this.values[s.ValueModesKeys.Wrapped].content),this.values[s.ValueModesKeys.Unwrapped]))}isStorageWrapped(){const e=this.values[s.ValueModesKeys.Wrapped];return null!=e&&(0,c.isEncryptedLocalStoragePayload)(e)}async canDecryptWithKey(e){const t=this.values[s.ValueModesKeys.Wrapped];if(!(0,c.isEncryptedLocalStoragePayload)(t))throw Error("Attempting to decrypt non decrypted storage value");const n=await this.decryptWrappedValue(t,e);return!(0,a.isErrorDecryptingParameters)(n)}async decryptWrappedValue(e,t){if(null==e||!e.content_type)throw Error("Attempting to decrypt nonexistent wrapped value");const n=new c.EncryptedPayload(u(u(u({},e),(0,c.PayloadTimestampDefaults)()),{},{content_type:r.ContentType.EncryptedStorage})),i=t?{usesRootKey:{items:[n],key:t}}:{usesRootKeyWithKeyLookup:{items:[n]}};return await this.encryptionProvider.decryptSplitSingle(i)}async decryptStorage(){const e=this.values[s.ValueModesKeys.Wrapped];if(!(0,c.isEncryptedLocalStoragePayload)(e))throw Error("Attempting to decrypt already decrypted storage");const t=await this.decryptWrappedValue(e);if((0,a.isErrorDecryptingParameters)(t))throw o.W.error(Error("Unable to decrypt storage."));this.values[s.ValueModesKeys.Unwrapped]=(0,i.Copy)(t.content)}async persistValuesToDisk(){if(!this.storagePersistable)return void(this.needsPersist=!0);if(this.persistencePolicy===s.StoragePersistencePolicies.Ephemeral)return;await this.currentPersistPromise,this.needsPersist=!1;const e=await this.immediatelyPersistValuesToDisk();this.values[s.ValueModesKeys.Wrapped]=e[s.ValueModesKeys.Wrapped]}async awaitPersist(){await this.currentPersistPromise}async immediatelyPersistValuesToDisk(){return this.currentPersistPromise=this.executeCriticalFunction((async()=>{var e;const t=await this.generatePersistableValues();return this.persistencePolicy===s.StoragePersistencePolicies.Ephemeral||await(null===(e=this.deviceInterface)||void 0===e?void 0:e.setRawStorageValue(this.getPersistenceKey(),JSON.stringify(t))),t})),this.currentPersistPromise}async generatePersistableValues(){const e=(0,i.Copy)(this.values),t=e[s.ValueModesKeys.Unwrapped];e[s.ValueModesKeys.Unwrapped]=void 0;const n=new c.DecryptedPayload(u({uuid:i.UuidGenerator.GenerateUuid(),content:t,content_type:r.ContentType.EncryptedStorage},(0,c.PayloadTimestampDefaults)()));if(this.encryptionProvider.hasRootKeyEncryptionSource()){const t={usesRootKeyWithKeyLookup:{items:[n]}},r=await this.encryptionProvider.encryptSplitSingle(t);e[s.ValueModesKeys.Wrapped]=(0,c.CreateEncryptedLocalStorageContextPayload)(r)}else e[s.ValueModesKeys.Wrapped]=(0,c.CreateDecryptedLocalStorageContextPayload)(n);return e}setValue(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.StorageValueModes.Default;this.setValueWithNoPersist(e,t,n),this.persistValuesToDisk()}async setValueAndAwaitPersist(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.StorageValueModes.Default;this.setValueWithNoPersist(e,t,n),await this.persistValuesToDisk()}setValueWithNoPersist(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.StorageValueModes.Default;if(!this.values)throw Error("Attempting to set storage key ".concat(e," before loading local storage."));const r=this.domainKeyForMode(n);this.values[r][e]=t}getValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.StorageValueModes.Default,n=arguments.length>2?arguments[2]:void 0;if(!this.values)throw Error("Attempting to get storage key ".concat(e," before loading local storage."));if(!this.values[this.domainKeyForMode(t)])throw Error("Storage domain mode not available ".concat(t," for key ").concat(e));const r=this.values[this.domainKeyForMode(t)][e];return null!=r?r:n}async removeValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.StorageValueModes.Default;if(!this.values)throw Error("Attempting to remove storage key ".concat(e," before loading local storage."));const n=this.values[this.domainKeyForMode(t)];if(null!=n&&n[e])return delete n[e],this.persistValuesToDisk()}getStorageEncryptionPolicy(){return this.encryptionPolicy}getPersistenceKey(){return s.namespacedKey(this.identifier,s.RawStorageKey.StorageObject)}defaultValuesObject(e,t,n){return p.DefaultValuesObject(e,t,n)}static DefaultValuesObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{[s.ValueModesKeys.Wrapped]:e,[s.ValueModesKeys.Unwrapped]:t,[s.ValueModesKeys.Nonwrapped]:n}}domainKeyForMode(e){if(e===s.StorageValueModes.Default)return s.ValueModesKeys.Unwrapped;if(e===s.StorageValueModes.Nonwrapped)return s.ValueModesKeys.Nonwrapped;throw Error("Invalid mode")}async clearValues(){await this.setInitialValues(),await this.immediatelyPersistValuesToDisk()}async getAllRawPayloads(){return this.deviceInterface.getAllRawDatabasePayloads(this.identifier)}async savePayload(e){return this.savePayloads([e])}async savePayloads(e){if(this.persistencePolicy===s.StoragePersistencePolicies.Ephemeral)return;const{encrypted:t,decrypted:n,deleted:r,discardable:o}=(0,c.CreatePayloadSplitWithDiscardables)(e),l=this.encryptionPolicy===s.StorageEncryptionPolicy.Default,u=this.encryptionProvider.hasRootKeyEncryptionSource(),d=[],p=[];if(l){const e=a.SplitPayloadsByEncryptionType(n);e.itemsKeyEncryption&&(0,i.extendArray)(d,e.itemsKeyEncryption),e.rootKeyEncryption&&(u?(0,i.extendArray)(d,e.rootKeyEncryption):(0,i.extendArray)(p,e.rootKeyEncryption))}else(0,i.extendArray)(p,d),(0,i.extendArray)(p,n);await this.deletePayloads(o);const h=a.SplitPayloadsByEncryptionType(d),y=a.CreateEncryptionSplitWithKeyLookup(h),f=[...t,...await this.encryptionProvider.encryptSplit(y)].map(c.CreateEncryptedLocalStorageContextPayload),v=p.map(c.CreateDecryptedLocalStorageContextPayload),m=r.map(c.CreateDeletedLocalStorageContextPayload);return this.executeCriticalFunction((async()=>{var e;return null===(e=this.deviceInterface)||void 0===e?void 0:e.saveRawDatabasePayloads([...f,...v,...m],this.identifier)}))}async deletePayloads(e){await Promise.all(e.map((e=>this.deletePayloadWithId(e.uuid))))}async forceDeletePayloads(e){await Promise.all(e.map((e=>this.deletePayloadWithId(e.uuid))))}async deletePayloadWithId(e){return this.executeCriticalFunction((async()=>this.deviceInterface.removeRawDatabasePayloadWithId(e,this.identifier)))}async clearAllPayloads(){return this.executeCriticalFunction((async()=>this.deviceInterface.removeAllRawDatabasePayloads(this.identifier)))}clearAllData(){return this.executeCriticalFunction((async()=>{await this.clearValues(),await this.clearAllPayloads(),await this.deviceInterface.removeRawStorageValue(s.namespacedKey(this.identifier,s.RawStorageKey.SnjsVersion)),await this.deviceInterface.removeRawStorageValue(this.getPersistenceKey())}))}async getDiagnostics(){return{storage:{storagePersistable:this.storagePersistable,persistencePolicy:s.StoragePersistencePolicies[this.persistencePolicy],encryptionPolicy:s.StorageEncryptionPolicy[this.encryptionPolicy],needsPersist:this.needsPersist,currentPersistPromise:null!=this.currentPersistPromise,isStorageWrapped:this.isStorageWrapped(),allRawPayloadsCount:(await this.getAllRawPayloads()).length,databaseKeys:await this.deviceInterface.getDatabaseKeys()}}}}},65432:(e,t,n)=>{n.d(t,{U8:()=>It,Jg:()=>fe,h6:()=>ye,IX:()=>J,ne:()=>te,ap:()=>Z,PJ:()=>pe,VG:()=>Te,SV:()=>Ie,e5:()=>_t.e,xO:()=>Rt,FH:()=>u,A:()=>ze,jW:()=>F.j,o8:()=>Xe,aM:()=>B,Sn:()=>W,Vu:()=>at,Bi:()=>Tt,nB:()=>E,Ot:()=>ut,Ps:()=>oe,Hh:()=>ne,jg:()=>ce,UP:()=>l,QL:()=>N,bJ:()=>ke,sX:()=>Fe,Cv:()=>Le,aJ:()=>f,Mj:()=>$e,P$:()=>et,FR:()=>it,J_:()=>pt,Xr:()=>le,Lb:()=>q,kf:()=>mt,c5:()=>bt,xu:()=>Ht,g7:()=>Y,Fi:()=>Et,y0:()=>jt,z_:()=>C.z,Px:()=>H,d6:()=>j,BU:()=>Ft,jH:()=>Ot,NA:()=>I,Fr:()=>ae,fA:()=>G,z4:()=>se});var r=n(10256),i=n(16418),o=n(20819);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class l extends o.AbstractService{constructor(e,t,n,r,i,o,a,s,l,u){super(u),c(this,"itemManager",void 0),c(this,"alertService",void 0),c(this,"deviceInterface",void 0),c(this,"httpService",void 0),c(this,"payloadManager",void 0),c(this,"protocolService",void 0),c(this,"syncService",void 0),c(this,"challengeService",void 0),c(this,"listedService",void 0),c(this,"internalEventBus",void 0),c(this,"previousPasswords",[]),this.itemManager=e,this.alertService=t,this.deviceInterface=n,this.httpService=r,this.payloadManager=i,this.protocolService=o,this.syncService=a,this.challengeService=s,this.listedService=l,this.internalEventBus=u,this.previousPasswords=[]}deinit(){this.itemManager=void 0,this.alertService=void 0,this.deviceInterface=void 0,this.httpService=void 0,this.payloadManager=void 0,this.listedService=void 0,this.challengeService=void 0,this.protocolService=void 0,this.syncService=void 0,this.previousPasswords.length=0,super.deinit()}getExtensions(){return this.itemManager.getItems(r.ContentType.ActionsExtension).filter((e=>!e.isListedExtension))}extensionsInContextOfItem(e){return this.getExtensions().filter((t=>t.supported_types.includes(e.content_type)||t.actionsWithContextForItem(e).length>0))}async loadExtensionInContextOfItem(e,t){const n={content_type:t.content_type,item_uuid:t.uuid},r=await this.httpService.getAbsolute(e.url,n).catch((e=>{console.error("Error loading extension",e)}));if(!r)return;const o=r.description||e.description,a=r.supported_types||e.supported_types,s=r.actions||[],c=new i.ActionsExtensionMutator(e,i.MutationType.UpdateUserTimestamps);c.deprecation=r.deprecation,c.description=o,c.supported_types=a,c.actions=s;const l=c.getResult();return(0,i.CreateDecryptedItemFromPayload)(l)}async runAction(e,t){let n;switch(e.verb){case"render":n=await this.handleRenderAction(e);break;case"show":n=this.handleShowAction(e);break;case"post":n=await this.handlePostAction(e,t)}return n}async handleRenderAction(e){return await this.httpService.getAbsolute(e.url).then((async e=>{const t=await this.payloadByDecryptingResponse(e);if(t){const n=(0,i.CreateDecryptedItemFromPayload)(t);return s(s({},e),{},{item:n})}})).catch((e=>{const t=e&&e.error||{message:"An issue occurred while processing this action. Please try again."};return this.alertService.alert(t.message),{error:t}}))}async payloadByDecryptingResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!e.item||e.item.deleted||null==e.item.content)return;const r=new i.EncryptedPayload(e.item);if(!r.enc_item_key)return void this.alertService.alert("This revision is missing its key and cannot be recovered.");let o=await this.protocolService.decryptSplitSingle({usesItemsKeyWithKeyLookup:{items:[r]}});if(!(0,i.isErrorDecryptingPayload)(o))return o;if(t&&(o=await this.protocolService.decryptSplitSingle({usesRootKey:{items:[r],key:t}}),!(0,i.isErrorDecryptingPayload)(o)))return o;for(const e of this.itemManager.getDisplayableItemsKeys()){const t=await this.protocolService.decryptSplitSingle({usesItemsKey:{items:[r],key:e}});if(!(0,i.isErrorDecryptingPayload)(t))return t}const a=e.keyParams||e.auth_params;if(!a)return void this.alertService.alert("We were unable to decrypt this revision using your current keys, and this revision is missing metadata that would allow us to try different keys to decrypt it. This can likely be fixed with some manual intervention. Please email help@standardnotes.com for assistance.");const s=this.protocolService.createKeyParams(a);for(const t of this.previousPasswords){if(n.includes(t))continue;n.push(t);const r=await this.protocolService.computeRootKey(t,s);if(!r)continue;const i=await this.payloadByDecryptingResponse(e,r,n);if(i)return i}const c=await this.promptForLegacyPassword();return c&&!this.previousPasswords.includes(c)?(this.previousPasswords.push(c),this.payloadByDecryptingResponse(e,t)):void 0}async promptForLegacyPassword(){const e=new o.Challenge([new o.ChallengePrompt(o.ChallengeValidation.None,"Previous Password",void 0,!0)],o.ChallengeReason.Custom,!0,"Unable to find key for revision. Please enter the account password you may have used at the time of the revision."),t=await this.challengeService.promptForChallengeResponse(e);return null==t?void 0:t.getDefaultValue().value}async handlePostAction(e,t){const n=e.access_type===i.ActionAccessType.Decrypted,r={items:[await this.outgoingPayloadForItem(t,n)]};return this.httpService.postAbsolute(e.url,r).then((e=>e)).catch((e=>(console.error("Action error response:",e),this.alertService.alert("An issue occurred while processing this action. Please try again."),e)))}handleShowAction(e){return this.deviceInterface.openUrl(e.url),{}}async outgoingPayloadForItem(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return e.payload.ejected();const t=await this.protocolService.encryptSplitSingle({usesItemsKeyWithKeyLookup:{items:[e.payload]}});return(0,i.CreateEncryptedBackupFileContextPayload)(t)}}var u,d=n(64657),p=n(84945),h=n(10715);function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.Get="GET",e.Post="POST",e.Put="PUT",e.Patch="PATCH",e.Delete="DELETE"}(u||(u={}));class f extends o.AbstractService{constructor(e,t,n){super(n),y(this,"environment",void 0),y(this,"appVersion",void 0),y(this,"internalEventBus",void 0),this.environment=e,this.appVersion=t,this.internalEventBus=n}async getAbsolute(e,t,n){return this.runHttp({url:e,params:t,verb:u.Get,authentication:n})}async postAbsolute(e,t,n){return this.runHttp({url:e,params:t,verb:u.Post,authentication:n})}async putAbsolute(e,t,n){return this.runHttp({url:e,params:t,verb:u.Put,authentication:n})}async patchAbsolute(e,t,n){return this.runHttp({url:e,params:t,verb:u.Patch,authentication:n})}async deleteAbsolute(e,t,n){return this.runHttp({url:e,params:t,verb:u.Delete,authentication:n})}async runHttp(e){const t=this.createXmlRequest(e);return this.runRequest(t,this.createRequestBody(e))}createRequestBody(e){return void 0!==e.params&&[u.Post,u.Put,u.Patch,u.Delete].includes(e.verb)?JSON.stringify(e.params):e.rawBytes}createXmlRequest(e){var t;const n=new XMLHttpRequest;if(e.params&&e.verb===u.Get&&Object.keys(e.params).length>0&&(e.url=this.urlForUrlAndParams(e.url,e.params)),n.open(e.verb,e.url,!0),n.responseType=null!==(t=e.responseType)&&void 0!==t?t:"",!e.external){n.setRequestHeader("X-SNJS-Version",h.in);const t="".concat(i.Environment[this.environment],"-").concat(this.appVersion);n.setRequestHeader("X-Application-Version",t),e.authentication&&n.setRequestHeader("Authorization","Bearer "+e.authentication)}let r=!1;return e.customHeaders&&e.customHeaders.length>0&&e.customHeaders.forEach((e=>{let{key:t,value:i}=e;n.setRequestHeader(t,i),"Content-Type"===t&&(r=!0)})),r||e.external||n.setRequestHeader("Content-Type","application/json"),n}async runRequest(e,t){return new Promise(((n,r)=>{e.onreadystatechange=()=>{this.stateChangeHandlerForRequest(e,n,r)},e.send(t)}))}stateChangeHandlerForRequest(e,t,n){var r;if(4!==e.readyState)return;const i=e.status,a={status:i,headers:new Map},s=null===(r=e.getAllResponseHeaders())||void 0===r?void 0:r.trim().split(/[\r\n]+/);null==s||s.forEach((e=>{const t=e.split(": "),n=t.shift(),r=t.join(": ");a.headers.set(n,r)}));try{if(i!==p.StatusCode.HttpStatusNoContent){var c,l;let t;const n=(null===(c=a.headers)||void 0===c?void 0:c.get("content-type"))||(null===(l=a.headers)||void 0===l?void 0:l.get("Content-Type"));t=null!=n&&n.includes("application/json")?JSON.parse(e.responseText):e.response,t.data||(a.data=t),(0,d.isString)(t)||Object.assign(a,t)}}catch(e){console.error(e)}if(i>=p.StatusCode.HttpStatusMinSuccess&&i<=p.StatusCode.HttpStatusMaxSuccess)t(a);else{if(i===p.StatusCode.HttpStatusForbidden)a.error={message:o.API_MESSAGE_RATE_LIMITED,status:i};else if(null==a.error)if(null==a.data||null==a.data.error)try{a.error={message:e.responseText||o.UNKNOWN_ERROR,status:i}}catch(e){a.error={message:o.UNKNOWN_ERROR,status:i}}else a.error=a.data.error;n(a)}}urlForUrlAndParams(e,t){const n=Object.keys(t).map((e=>e+"="+encodeURIComponent(t[e]))).join("&");return e.includes("?")?e+"&"+n:e+"?"+n}}const v=["api.standardnotes.com","api-dev.standardnotes.com","sync.standardnotes.org","syncing-server-demo.standardnotes.com"],m=["files.standardnotes.com","files-dev.standardnotes.com"],g=["api-dev.standardnotes.com","api.standardnotes.com","extensions.standardnotes.com","extensions.standardnotes.org","extensions-server-dev.standardnotes.org","extensions-server-dev.standardnotes.com","features.standardnotes.com"];var S;!function(e){e.Dev="https://extensions-server-dev.standardnotes.org",e.Prod="https://extensions.standardnotes.org"}(S||(S={}));const b=["listed.to"];function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const E={v1:_(_(_(_(_(_({},{closeUploadSession:"/v1/files/upload/close-session",createFileValetToken:"/v1/files/valet-tokens",deleteFile:"/v1/files",downloadFileChunk:"/v1/files",startUploadSession:"/v1/files/upload/create-session",uploadFileChunk:"/v1/files/upload/chunk"}),{checkIntegrity:"/v1/items/check-integrity",getSingleItem:e=>"/v1/items/".concat(e),itemRevisions:e=>"/v1/items/".concat(e,"/revisions"),itemRevision:(e,t)=>"/v1/items/".concat(e,"/revisions/").concat(t),sync:"/v1/items"}),{listedRegistration:e=>"/v1/users/".concat(e,"/integrations/listed")}),{settings:e=>"/v1/users/".concat(e,"/settings"),setting:(e,t)=>"/v1/users/".concat(e,"/settings/").concat(t),subscriptionSetting:(e,t)=>"/v1/users/".concat(e,"/subscription-settings/").concat(t)}),{offlineFeatures:"/v1/offline/features",purchase:"/v1/purchase",subscription:e=>"/v1/users/".concat(e,"/subscription"),subscriptionTokens:"/v1/subscription-tokens",userFeatures:e=>"/v1/users/".concat(e,"/features")}),{changeCredentials:e=>"/v1/users/".concat(e,"/attributes/credentials"),deleteAccount:e=>"/v1/users/".concat(e),keyParams:"/v1/login-params",refreshSession:"/v1/sessions/refresh",register:"/v1/users",session:e=>"/v1/sessions/".concat(e),sessions:"/v1/sessions",signIn:"/v1/login",signOut:"/v1/logout"}),v2:_(_({},{subscriptions:"/v2/subscriptions"}),{keyParams:"/v2/login-params",signIn:"/v2/login"})};var C=n(24630);function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class I extends C.z{static FromApiResponse(e){const t=e.data.session,n=t.access_token,r=t.refresh_token,i=t.access_expiration,o=t.refresh_expiration,a=t.readonly_access;return new I(n,i,r,o,a)}constructor(e,t,n,r,i){super(),O(this,"accessToken",void 0),O(this,"accessExpiration",void 0),O(this,"refreshToken",void 0),O(this,"refreshExpiration",void 0),O(this,"readonlyAccess",void 0),this.accessToken=e,this.accessExpiration=t,this.refreshToken=n,this.refreshExpiration=r,this.readonlyAccess=i}isReadOnly(){return this.readonlyAccess}getExpireAt(){return this.accessExpiration||0}get authorizationValue(){return this.accessToken}canExpire(){return!0}isExpired(){return this.getExpireAt()<Date.now()}}var M=n(3363),A=n.n(M);const T={Network:{Files:{FailedStartUploadSession:"Failed to start an upload session.",FailedCloseUploadSession:"Failed to close an upload session.",FailedUploadFileChunk:"Failed to upload file chunk.",FailedDownloadFileChunk:"Failed to download file chunk.",FailedDeleteFile:"Failed to delete file."}},Confirm:{ProtocolVersionExpired(e){var t;return{Message:"The encryption version for your account is outdated and requires upgrade. You may proceed with login, but are advised to perform a security update using the web or desktop application.\n\n"+"If your account was created after ".concat(null===(t=r.ProtocolExpirationDates[e])||void 0===t?void 0:t.toLocaleString(),", it may not be safe to continue signing in. ")+"In that case, please discontinue your sign in request and contact support.\n\nFor more information, visit standardnotes.com/help/security.",Title:"Update Recommended",ConfirmButton:"Sign In"}}},Input:{FileAccountPassword:"File account password"}};function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){R(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class N extends o.AbstractService{constructor(e,t,n,r,i,o){super(o),R(this,"httpService",void 0),R(this,"storageService",void 0),R(this,"host",void 0),R(this,"inMemoryStore",void 0),R(this,"crypto",void 0),R(this,"internalEventBus",void 0),R(this,"session",void 0),R(this,"user",void 0),R(this,"registering",!1),R(this,"authenticating",!1),R(this,"changing",!1),R(this,"refreshingSession",!1),R(this,"invalidSessionObserver",void 0),R(this,"filesHost",void 0),this.httpService=e,this.storageService=t,this.host=n,this.inMemoryStore=r,this.crypto=i,this.internalEventBus=o}deinit(){this.httpService=void 0,this.storageService=void 0,this.invalidSessionObserver=void 0,this.session=void 0,super.deinit()}setUser(e){this.user=e}setInvalidSessionObserver(e){this.invalidSessionObserver=e}loadHost(){const e=this.storageService.getValue(o.StorageKey.ServerHost);this.host=e||this.host||window._default_sync_server}async setHost(e){this.host=e,this.storageService.setValue(o.StorageKey.ServerHost,e)}getHost(){return this.host}isThirdPartyHostUsed(){return!function(e){try{const{host:t}=new URL(e);return t.startsWith("localhost")||v.includes(t)||m.includes(t)}catch(e){return!1}}(this.getHost()||"")}getFilesHost(){if(!this.filesHost)throw Error("Attempting to access undefined filesHost");return this.filesHost}setSession(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.session=e,t&&this.storageService.setValue(o.StorageKey.Session,e)}getSession(){return this.session}get apiVersion(){return"20200115"}params(e){return A()(e,{[p.ApiEndpointParam.ApiVersion]:this.apiVersion})}createErrorResponse(e,t){return{error:{message:e,status:t}}}errorResponseWithFallbackMessage(e,t){var n,r,i;return null!==(n=e.error)&&void 0!==n&&n.message||(e.error=D(D({},e.error),{},{status:null!==(r=null===(i=e.error)||void 0===i?void 0:i.status)&&void 0!==r?r:p.StatusCode.UnknownError,message:t})),e}processMetaObject(e){var t,n;e.auth&&e.auth.userUuid&&e.auth.roles&&this.notifyEvent(o.ApiServiceEvent.MetaReceived,{userUuid:e.auth.userUuid,userRoles:e.auth.roles}),null!==(t=e.server)&&void 0!==t&&t.filesServerUrl&&(this.filesHost=null===(n=e.server)||void 0===n?void 0:n.filesServerUrl)}processResponse(e){e.meta&&this.processMetaObject(e.meta)}async request(e){try{const t=await this.httpService.runHttp(e);return this.processResponse(t),t}catch(t){return this.errorResponseWithFallbackMessage(t,e.fallbackErrorMessage)}}async getAccountKeyParams(e){var t;const n=this.crypto.generateRandomKey(256);this.inMemoryStore.setValue(o.StorageKey.CodeVerifier,n);const r=this.crypto.base64URLEncode(await this.crypto.sha256(n)),i=this.params({email:e.email,code_challenge:r});return void 0!==e.mfaKeyPath&&void 0!==e.mfaCode&&(i[e.mfaKeyPath]=e.mfaCode),this.request({verb:u.Post,url:(0,d.joinPaths)(this.host,E.v2.keyParams),fallbackErrorMessage:o.API_MESSAGE_GENERIC_INVALID_LOGIN,params:i,authentication:null===(t=this.session)||void 0===t?void 0:t.authorizationValue})}async signIn(e){if(this.authenticating)return this.createErrorResponse(o.API_MESSAGE_LOGIN_IN_PROGRESS);this.authenticating=!0;const t=(0,d.joinPaths)(this.host,E.v2.signIn),n=this.params({email:e.email,password:e.serverPassword,ephemeral:e.ephemeral,code_verifier:this.inMemoryStore.getValue(o.StorageKey.CodeVerifier)}),r=await this.request({verb:u.Post,url:t,params:n,fallbackErrorMessage:o.API_MESSAGE_GENERIC_INVALID_LOGIN});return this.authenticating=!1,this.inMemoryStore.removeValue(o.StorageKey.CodeVerifier),r}signOut(){var e;const t=(0,d.joinPaths)(this.host,E.v1.signOut);return this.httpService.postAbsolute(t,void 0,null===(e=this.session)||void 0===e?void 0:e.authorizationValue).catch((e=>e))}async changeCredentials(e){var t;if(this.changing)return this.createErrorResponse(o.API_MESSAGE_CHANGE_CREDENTIALS_IN_PROGRESS);const n=this.preprocessingError();if(n)return n;this.changing=!0;const r=(0,d.joinPaths)(this.host,E.v1.changeCredentials(e.userUuid)),i=this.params(D({current_password:e.currentServerPassword,new_password:e.newServerPassword,new_email:e.newEmail},e.newKeyParams.getPortableValue())),a=await this.httpService.putAbsolute(r,i,null===(t=this.session)||void 0===t?void 0:t.authorizationValue).catch((async e=>p.isErrorResponseExpiredToken(e)?this.refreshSessionThenRetryRequest({verb:u.Put,url:r,params:i}):this.errorResponseWithFallbackMessage(e,o.API_MESSAGE_GENERIC_CHANGE_CREDENTIALS_FAIL)));return this.processResponse(a),this.changing=!1,a}async sync(e,t,n,r){var i;const a=this.preprocessingError();if(a)return a;const s=(0,d.joinPaths)(this.host,E.v1.sync),c=this.params({[p.ApiEndpointParam.SyncPayloads]:e,[p.ApiEndpointParam.LastSyncToken]:t,[p.ApiEndpointParam.PaginationToken]:n,[p.ApiEndpointParam.SyncDlLimit]:r}),l=await this.httpService.postAbsolute(s,c,null===(i=this.session)||void 0===i?void 0:i.authorizationValue).catch((async e=>(this.preprocessAuthenticatedErrorResponse(e),p.isErrorResponseExpiredToken(e)?this.refreshSessionThenRetryRequest({verb:u.Post,url:s,params:c}):this.errorResponseWithFallbackMessage(e,o.API_MESSAGE_GENERIC_SYNC_FAIL))));return this.processResponse(l),l}async refreshSessionThenRetryRequest(e){const t=await this.refreshSession();return t.error||(0,d.isNullOrUndefined)(t.data)?t:this.httpService.runHttp(D(D({},e),{},{authentication:null===(n=this.session)||void 0===n?void 0:n.authorizationValue})).catch((e=>e));var n}async refreshSession(){const e=this.preprocessingError();if(e)return e;this.refreshingSession=!0;const t=(0,d.joinPaths)(this.host,E.v1.refreshSession),n=this.session,r=this.params({access_token:n.accessToken,refresh_token:n.refreshToken}),i=await this.httpService.postAbsolute(t,r).then((async e=>{const t=I.FromApiResponse(e);return await this.setSession(t),this.processResponse(e),e})).catch((e=>(this.preprocessAuthenticatedErrorResponse(e),this.errorResponseWithFallbackMessage(e,o.API_MESSAGE_GENERIC_TOKEN_REFRESH_FAIL))));return this.refreshingSession=!1,i}async getSessionsList(){var e;const t=this.preprocessingError();if(t)return t;const n=(0,d.joinPaths)(this.host,E.v1.sessions),r=await this.httpService.getAbsolute(n,{},null===(e=this.session)||void 0===e?void 0:e.authorizationValue).catch((async e=>(this.preprocessAuthenticatedErrorResponse(e),p.isErrorResponseExpiredToken(e)?this.refreshSessionThenRetryRequest({verb:u.Get,url:n}):this.errorResponseWithFallbackMessage(e,o.API_MESSAGE_GENERIC_SYNC_FAIL))));return this.processResponse(r),r}async deleteSession(e){var t;const n=this.preprocessingError();if(n)return n;const r=(0,d.joinPaths)(this.host,E.v1.session(e)),i=await this.httpService.deleteAbsolute(r,{uuid:e},null===(t=this.session)||void 0===t?void 0:t.authorizationValue).catch((e=>{const t=e;return this.preprocessAuthenticatedErrorResponse(t),p.isErrorResponseExpiredToken(t)?this.refreshSessionThenRetryRequest({verb:u.Delete,url:r}):this.errorResponseWithFallbackMessage(t,o.API_MESSAGE_GENERIC_SYNC_FAIL)}));return this.processResponse(i),i}async getItemRevisions(e){var t;const n=this.preprocessingError();if(n)return n;const r=(0,d.joinPaths)(this.host,E.v1.itemRevisions(e)),i=await this.httpService.getAbsolute(r,void 0,null===(t=this.session)||void 0===t?void 0:t.authorizationValue).catch((e=>(this.preprocessAuthenticatedErrorResponse(e),p.isErrorResponseExpiredToken(e)?this.refreshSessionThenRetryRequest({verb:u.Get,url:r}):this.errorResponseWithFallbackMessage(e,o.API_MESSAGE_GENERIC_SYNC_FAIL))));return this.processResponse(i),i}async getRevision(e,t){var n;const r=this.preprocessingError();if(r)return r;const i=(0,d.joinPaths)(this.host,E.v1.itemRevision(t,e.uuid)),a=await this.httpService.getAbsolute(i,void 0,null===(n=this.session)||void 0===n?void 0:n.authorizationValue).catch((e=>(this.preprocessAuthenticatedErrorResponse(e),p.isErrorResponseExpiredToken(e)?this.refreshSessionThenRetryRequest({verb:u.Get,url:i}):this.errorResponseWithFallbackMessage(e,o.API_MESSAGE_GENERIC_SYNC_FAIL))));return this.processResponse(a),a}async getUserFeatures(e){var t;const n=(0,d.joinPaths)(this.host,E.v1.userFeatures(e)),r=await this.httpService.getAbsolute(n,void 0,null===(t=this.session)||void 0===t?void 0:t.authorizationValue).catch((e=>(this.preprocessAuthenticatedErrorResponse(e),p.isErrorResponseExpiredToken(e)?this.refreshSessionThenRetryRequest({verb:u.Get,url:n}):this.errorResponseWithFallbackMessage(e,o.API_MESSAGE_GENERIC_SYNC_FAIL))));return this.processResponse(r),r}async tokenRefreshableRequest(e){const t=this.preprocessingError();if(t)return t;const n=await this.httpService.runHttp(e).catch((t=>(this.preprocessAuthenticatedErrorResponse(t),p.isErrorResponseExpiredToken(t)?this.refreshSessionThenRetryRequest(e):this.errorResponseWithFallbackMessage(t,e.fallbackErrorMessage))));return this.processResponse(n),n}async listSettings(e){var t;return await this.tokenRefreshableRequest({verb:u.Get,url:(0,d.joinPaths)(this.host,E.v1.settings(e)),fallbackErrorMessage:o.API_MESSAGE_FAILED_GET_SETTINGS,authentication:null===(t=this.session)||void 0===t?void 0:t.authorizationValue})}async updateSetting(e,t,n,r){var i;const a={name:t,value:n,sensitive:r};return this.tokenRefreshableRequest({verb:u.Put,url:(0,d.joinPaths)(this.host,E.v1.settings(e)),authentication:null===(i=this.session)||void 0===i?void 0:i.authorizationValue,fallbackErrorMessage:o.API_MESSAGE_FAILED_UPDATE_SETTINGS,params:a})}async getSetting(e,t){var n;return await this.tokenRefreshableRequest({verb:u.Get,url:(0,d.joinPaths)(this.host,E.v1.setting(e,t.toLowerCase())),authentication:null===(n=this.session)||void 0===n?void 0:n.authorizationValue,fallbackErrorMessage:o.API_MESSAGE_FAILED_GET_SETTINGS})}async getSubscriptionSetting(e,t){var n;return await this.tokenRefreshableRequest({verb:u.Get,url:(0,d.joinPaths)(this.host,E.v1.subscriptionSetting(e,t.toLowerCase())),authentication:null===(n=this.session)||void 0===n?void 0:n.authorizationValue,fallbackErrorMessage:o.API_MESSAGE_FAILED_GET_SETTINGS})}async deleteSetting(e,t){var n;return this.tokenRefreshableRequest({verb:u.Delete,url:(0,d.joinPaths)(this.host,E.v1.setting(e,t)),authentication:null===(n=this.session)||void 0===n?void 0:n.authorizationValue,fallbackErrorMessage:o.API_MESSAGE_FAILED_UPDATE_SETTINGS})}async deleteRevision(e,t){var n;const r=(0,d.joinPaths)(this.host,E.v1.itemRevision(e,t.uuid));return await this.tokenRefreshableRequest({verb:u.Delete,url:r,fallbackErrorMessage:o.API_MESSAGE_FAILED_DELETE_REVISION,authentication:null===(n=this.session)||void 0===n?void 0:n.authorizationValue})}downloadFeatureUrl(e){return this.request({verb:u.Get,url:e,external:!0,fallbackErrorMessage:o.API_MESSAGE_GENERIC_INVALID_LOGIN})}async getSubscription(e){var t;const n=(0,d.joinPaths)(this.host,E.v1.subscription(e));return await this.tokenRefreshableRequest({verb:u.Get,url:n,authentication:null===(t=this.session)||void 0===t?void 0:t.authorizationValue,fallbackErrorMessage:o.API_MESSAGE_FAILED_SUBSCRIPTION_INFO})}async getAvailableSubscriptions(){const e=(0,d.joinPaths)(this.host,E.v2.subscriptions);return await this.request({verb:u.Get,url:e,fallbackErrorMessage:o.API_MESSAGE_FAILED_SUBSCRIPTION_INFO})}async getNewSubscriptionToken(){var e,t;const n=(0,d.joinPaths)(this.host,E.v1.subscriptionTokens);return null===(t=(await this.request({verb:u.Post,url:n,authentication:null===(e=this.session)||void 0===e?void 0:e.authorizationValue,fallbackErrorMessage:o.API_MESSAGE_FAILED_ACCESS_PURCHASE})).data)||void 0===t?void 0:t.token}async downloadOfflineFeaturesFromRepo(e){try{var t;const n=e.offlineFeaturesUrl,r=e.offlineKey;if(!n||!r)throw Error("Cannot download offline repo without url and offlineKEy");const{host:i}=new URL(n);if(!g.includes(i))return new p.ClientDisplayableError("This offline features host is not in the trusted allowlist.");const a=await this.request({verb:u.Get,url:n,fallbackErrorMessage:o.API_MESSAGE_FAILED_OFFLINE_FEATURES,customHeaders:[{key:"x-offline-token",value:r}]});return a.error?p.ClientDisplayableError.FromError(a.error):{features:(null===(t=a.data)||void 0===t?void 0:t.features)||[]}}catch(e){return new p.ClientDisplayableError(o.API_MESSAGE_FAILED_OFFLINE_ACTIVATION)}}async registerForListedAccount(){var e;if(!this.user)throw Error("Cannot register for Listed without user account.");return await this.tokenRefreshableRequest({verb:u.Post,url:(0,d.joinPaths)(this.host,E.v1.listedRegistration(this.user.uuid)),fallbackErrorMessage:o.API_MESSAGE_FAILED_LISTED_REGISTRATION,authentication:null===(e=this.session)||void 0===e?void 0:e.authorizationValue})}async createFileValetToken(e,t,n){var r,i,a;const s=(0,d.joinPaths)(this.host,E.v1.createFileValetToken),c={operation:t,resources:[{remoteIdentifier:e,unencryptedFileSize:n||0}]},l=await this.tokenRefreshableRequest({verb:u.Post,url:s,authentication:null===(r=this.session)||void 0===r?void 0:r.authorizationValue,fallbackErrorMessage:o.API_MESSAGE_FAILED_CREATE_FILE_TOKEN,params:c});var h,y;return null!==(i=l.data)&&void 0!==i&&i.success?null===(a=l.data)||void 0===a?void 0:a.valetToken:new p.ClientDisplayableError(null===(h=l.data)||void 0===h?void 0:h.reason,void 0,null===(y=l.data)||void 0===y?void 0:y.reason)}async startUploadSession(e){const t=(0,d.joinPaths)(this.getFilesHost(),E.v1.startUploadSession);return await this.tokenRefreshableRequest({verb:u.Post,url:t,customHeaders:[{key:"x-valet-token",value:e}],fallbackErrorMessage:T.Network.Files.FailedStartUploadSession})}async deleteFile(e){const t=(0,d.joinPaths)(this.getFilesHost(),E.v1.deleteFile);return await this.tokenRefreshableRequest({verb:u.Delete,url:t,customHeaders:[{key:"x-valet-token",value:e}],fallbackErrorMessage:T.Network.Files.FailedDeleteFile})}async uploadFileBytes(e,t,n){if(0===t)throw Error("chunkId must start with 1");const r=(0,d.joinPaths)(this.getFilesHost(),E.v1.uploadFileChunk);return(await this.tokenRefreshableRequest({verb:u.Post,url:r,rawBytes:n,customHeaders:[{key:"x-valet-token",value:e},{key:"x-chunk-id",value:t.toString()},{key:"Content-Type",value:"application/octet-stream"}],fallbackErrorMessage:T.Network.Files.FailedUploadFileChunk})).success}async closeUploadSession(e){const t=(0,d.joinPaths)(this.getFilesHost(),E.v1.closeUploadSession);return(await this.tokenRefreshableRequest({verb:u.Post,url:t,customHeaders:[{key:"x-valet-token",value:e}],fallbackErrorMessage:T.Network.Files.FailedCloseUploadSession})).success}getFilesDownloadUrl(){return(0,d.joinPaths)(this.getFilesHost(),E.v1.downloadFileChunk)}async downloadFile(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;const o=this.getFilesDownloadUrl(),a=e.encryptedChunkSizes[t],s=await this.tokenRefreshableRequest({verb:u.Get,url:o,customHeaders:[{key:"x-valet-token",value:n},{key:"x-chunk-size",value:a.toString()},{key:"range",value:"bytes=".concat(r,"-")}],fallbackErrorMessage:T.Network.Files.FailedDownloadFileChunk,responseType:"arraybuffer"}),c=s.headers.get("content-range");if(!c)return new p.ClientDisplayableError("Could not obtain content-range header while downloading file chunk");const l=c.match(/(^[a-zA-Z][\w]*)\s+(\d+)\s?-\s?(\d+)?\s?\/?\s?(\d+|\*)?/);if(!l||5!==l.length)return new p.ClientDisplayableError("Malformed content-range header in response when downloading file chunk");const d=+l[2],h=+l[3],y=+l[4],f=new Uint8Array(s.data);return await i(f),h<y-1?this.downloadFile(e,++t,n,d+a,i):void 0}async checkIntegrity(e){var t;return await this.tokenRefreshableRequest({verb:u.Post,url:(0,d.joinPaths)(this.host,E.v1.checkIntegrity),params:{integrityPayloads:e},fallbackErrorMessage:o.API_MESSAGE_GENERIC_INTEGRITY_CHECK_FAIL,authentication:null===(t=this.session)||void 0===t?void 0:t.authorizationValue})}async getSingleItem(e){var t;return await this.tokenRefreshableRequest({verb:u.Get,url:(0,d.joinPaths)(this.host,E.v1.getSingleItem(e)),fallbackErrorMessage:o.API_MESSAGE_GENERIC_SINGLE_ITEM_SYNC_FAIL,authentication:null===(t=this.session)||void 0===t?void 0:t.authorizationValue})}preprocessingError(){return this.refreshingSession?this.createErrorResponse(o.API_MESSAGE_TOKEN_REFRESH_IN_PROGRESS):this.session?void 0:this.createErrorResponse(o.API_MESSAGE_INVALID_SESSION)}preprocessAuthenticatedErrorResponse(e){var t,n;e.status===p.StatusCode.HttpStatusInvalidSession&&this.session&&(null===(t=this.invalidSessionObserver)||void 0===t||t.call(this,(null===(n=e.error)||void 0===n?void 0:n.tag)===r.ErrorTag.RevokedSession))}getDiagnostics(){return Promise.resolve({api:{hasSession:null!=this.session,user:this.user,registering:this.registering,authenticating:this.authenticating,changing:this.changing,refreshingSession:this.refreshingSession,filesHost:this.filesHost,host:this.host}})}}var F=n(91260),x=n(75082);function j(e){if("jwt"in e)return new F.j(e.jwt);{const t=e;return new I(t.accessToken,t.accessExpiration,t.refreshToken,t.refreshExpiration,t.readonlyAccess)}}var K=n(70297);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){V(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const B=8,W="missing-params",z=e=>e.trim().toLowerCase();var H,G;!function(e){e.Restored="SessionRestored",e.Revoked="SessionRevoked"}(H||(H={}));class q extends o.AbstractService{constructor(e,t,n,r,i,o,a,s,c){super(c),V(this,"diskStorageService",void 0),V(this,"apiService",void 0),V(this,"userApiService",void 0),V(this,"alertService",void 0),V(this,"protocolService",void 0),V(this,"challengeService",void 0),V(this,"webSocketsService",void 0),V(this,"httpService",void 0),V(this,"internalEventBus",void 0),V(this,"user",void 0),V(this,"isSessionRenewChallengePresented",!1),this.diskStorageService=e,this.apiService=t,this.userApiService=n,this.alertService=r,this.protocolService=i,this.challengeService=o,this.webSocketsService=a,this.httpService=s,this.internalEventBus=c,t.setInvalidSessionObserver((e=>{e?this.notifyEvent(H.Revoked):this.reauthenticateInvalidSession()}))}deinit(){this.protocolService=void 0,this.diskStorageService=void 0,this.apiService=void 0,this.alertService=void 0,this.challengeService=void 0,this.webSocketsService=void 0,this.user=void 0,super.deinit()}setUser(e){this.user=e,this.apiService.setUser(e)}async initializeFromDisk(){if(this.setUser(this.diskStorageService.getValue(o.StorageKey.User)),!this.user){const e=this.diskStorageService.getValue(o.StorageKey.LegacyUuid);e&&this.setUser({uuid:e,email:e})}const e=this.diskStorageService.getValue(o.StorageKey.Session);if(e){const t=j(e);this.setSession(t,!1),await this.webSocketsService.startWebSocketConnection()}}setSession(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.httpService.setAuthorizationToken(e.authorizationValue),this.apiService.setSession(e,t)}online(){return!this.offline()}offline(){return(0,d.isNullOrUndefined)(this.apiService.getSession())}getUser(){return this.user}getSureUser(){return this.user}getSession(){return this.apiService.getSession()}async signOut(){this.setUser(void 0);const e=this.apiService.getSession();e&&e.canExpire()&&(await this.apiService.signOut(),this.webSocketsService.closeWebSocketConnection())}isSignedIn(){return null!=this.getUser()}isSignedIntoFirstPartyServer(){return this.isSignedIn()&&!this.apiService.isThirdPartyHostUsed()}async reauthenticateInvalidSession(){var e;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1?arguments[1]:void 0;if(this.isSessionRenewChallengePresented)return;this.isSessionRenewChallengePresented=!0;const r=new o.Challenge([new o.ChallengePrompt(o.ChallengeValidation.None,void 0,o.SessionStrings.EmailInputPlaceholder,!1),new o.ChallengePrompt(o.ChallengeValidation.None,void 0,o.SessionStrings.PasswordInputPlaceholder)],o.ChallengeReason.Custom,t,o.SessionStrings.EnterEmailAndPassword,o.SessionStrings.RecoverSession(null===(e=this.getUser())||void 0===e?void 0:e.email));return new Promise((e=>{this.challengeService.addChallengeObserver(r,{onCancel:()=>{this.isSessionRenewChallengePresented=!1},onComplete:()=>{this.isSessionRenewChallengePresented=!1},onNonvalidatedSubmit:async t=>{const i=t.values[0].value,a=t.values[1].value,s=this.protocolService.getAccountKeyParams(),c=await this.signIn(i,a,!1,this.diskStorageService.isEphemeralSession(),null==s?void 0:s.version);c.response.error?(this.challengeService.setValidationStatusForChallenge(r,t.values[1],!1),null==n||n(c.response)):(e(),this.challengeService.completeChallenge(r),this.notifyEvent(H.Restored),this.alertService.alert(o.SessionStrings.SessionRestored))}}),this.challengeService.promptForChallengeResponse(r)}))}async getSubscription(){const e=await this.apiService.getSubscription(this.getSureUser().uuid);return e.error?p.ClientDisplayableError.FromError(e.error):e.data.subscription}async getAvailableSubscriptions(){const e=await this.apiService.getAvailableSubscriptions();return e.error?p.ClientDisplayableError.FromError(e.error):e.data}async promptForMfaValue(){const e=new o.Challenge([new o.ChallengePrompt(o.ChallengeValidation.None,o.ChallengePromptTitle.Mfa,o.SessionStrings.MfaInputPlaceholder,!1,o.ChallengeKeyboardType.Numeric)],o.ChallengeReason.Custom,!0,o.SessionStrings.EnterMfa),t=await this.challengeService.promptForChallengeResponse(e);if(t)return this.challengeService.completeChallenge(e),t.values[0].value}async register(e,t,n){if(t.length<B)throw new K.ApiCallError(K.ErrorMessage.InsufficientPasswordMessage.replace("%LENGTH%",B.toString()));const{wrappingKey:i,canceled:o}=await this.challengeService.getWrappingKeyIfApplicable();if(o)throw new K.ApiCallError(K.ErrorMessage.PasscodeRequired);e=z(e);const a=await this.protocolService.createRootKey(e,t,r.KeyParamsOrigination.Registration),s=a.serverPassword,c=a.keyParams,l=await this.userApiService.register({email:e,serverPassword:s,keyParams:c,ephemeral:n});if("error"in l.data)throw new K.ApiCallError(l.data.error.message);return await this.handleAuthResponse(l.data,a,i),l.data}async retrieveKeyParams(e,t,n){const r=await this.apiService.getAccountKeyParams({email:e,mfaKeyPath:t,mfaCode:n});if(r.error||(0,d.isNullOrUndefined)(r.data)){var i,a;if(n&&await this.alertService.alert(o.SignInStrings.IncorrectMfa),null!==(i=r.error)&&void 0!==i&&null!==(a=i.payload)&&void 0!==a&&a.mfa_key){const t=await this.promptForMfaValue();return t?this.retrieveKeyParams(e,r.error.payload.mfa_key,t):{response:this.apiService.createErrorResponse(o.SignInStrings.SignInCanceledMissingMfa,p.StatusCode.CanceledMfa)}}return{response:r}}const s=(0,x.KeyParamsFromApiResponse)(r,e);return s&&s.version?{keyParams:s,response:r,mfaKeyPath:t,mfaCode:n}:{response:this.apiService.createErrorResponse(o.API_MESSAGE_FALLBACK_LOGIN_FAIL)}}async signIn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0;const o=await this.performSignIn(e,t,n,r,i);if(o.response.error&&o.response.error.status!==p.StatusCode.LocalValidationError&&o.response.error.status!==p.StatusCode.CanceledMfa){const a=z(e);return a!==e?this.performSignIn(a,t,n,r,i):o}return o}async performSignIn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0;const s=await this.retrieveKeyParams(e);if(s.response.error)return{response:s.response};const c=s.keyParams;if(!this.protocolService.supportedVersions().includes(c.version))return this.protocolService.isVersionNewerThanLibraryVersion(c.version)?{response:this.apiService.createErrorResponse(o.UNSUPPORTED_PROTOCOL_VERSION)}:{response:this.apiService.createErrorResponse(o.EXPIRED_PROTOCOL_VERSION)};if(r.isProtocolVersionExpired(c.version)){const e=this.protocolService.costMinimumForVersion(c.version);if(c.content002.pw_cost<e)return{response:this.apiService.createErrorResponse(o.INVALID_PASSWORD_COST)};const t=T.Confirm.ProtocolVersionExpired(c.version);if(!await this.alertService.confirm(t.Message,t.Title,t.ConfirmButton))return{response:this.apiService.createErrorResponse(o.API_MESSAGE_FALLBACK_LOGIN_FAIL)}}if(!this.protocolService.platformSupportsKeyDerivation(c))return{response:this.apiService.createErrorResponse(o.UNSUPPORTED_KEY_DERIVATION)};if(n&&(a=this.protocolService.getLatestVersion()),!(0,d.isNullOrUndefined)(a)&&!r.leftVersionGreaterThanOrEqualToRight(c.version,a))return{response:this.apiService.createErrorResponse((0,o.StrictSignInFailed)(c.version,a))};const l=await this.protocolService.computeRootKey(t,c);return{response:await this.bypassChecksAndSignInWithRootKey(e,l,i)}}async bypassChecksAndSignInWithRootKey(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{wrappingKey:r,canceled:a}=await this.challengeService.getWrappingKeyIfApplicable();if(a)return this.apiService.createErrorResponse(o.SignInStrings.PasscodeRequired,p.StatusCode.LocalValidationError);const s=await this.apiService.signIn({email:e,serverPassword:t.serverPassword,ephemeral:n});if(s.error||!s.data)return s;const c=s.data.key_params,l=new x.SNRootKey((0,i.CopyPayloadWithContentOverride)(t.payload,{keyParams:c||t.keyParams.getPortableValue()}));return await this.handleSuccessAuthResponse(s,l,r),s}async changeCredentials(e){const t=this.user.uuid,n=await this.apiService.changeCredentials({userUuid:t,currentServerPassword:e.currentServerPassword,newServerPassword:e.newRootKey.serverPassword,newKeyParams:e.newRootKey.keyParams,newEmail:e.newEmail});return this.processChangeCredentialsResponse(n,e.newRootKey,e.wrappingKey)}async getSessionsList(){const e=await this.apiService.getSessionsList();return e.error||(0,d.isNullOrUndefined)(e.data)||(e.data=e.data.map((e=>U(U({},e),{},{updated_at:new Date(e.updated_at)}))).sort(((e,t)=>e.updated_at<t.updated_at?1:-1))),e}async revokeSession(e){return await this.apiService.deleteSession(e)}async revokeAllOtherSessions(){const e=await this.getSessionsList();var t,n;if(null!=e.error||null==e.data)throw new Error(null!==(t=null===(n=e.error)||void 0===n?void 0:n.message)&&void 0!==t?t:o.API_MESSAGE_GENERIC_SYNC_FAIL);const r=e.data.filter((e=>!e.current));await Promise.all(r.map((e=>this.revokeSession(e.uuid))))}async processChangeCredentialsResponse(e,t,n){var r;return!e.error&&e.data&&await this.handleSuccessAuthResponse(e,t,n),{response:e,keyParams:null===(r=e.data)||void 0===r?void 0:r.key_params}}async createDemoShareToken(){var e;const t=this.getSession();if(!t)return new p.ClientDisplayableError("Cannot generate share token without active session");if(!(t instanceof I))return new p.ClientDisplayableError("Cannot generate share token with non-token session");const n=await this.protocolService.getRootKeyParams(),r={accessToken:t.accessToken,refreshToken:t.refreshToken,accessExpiration:t.accessExpiration,refreshExpiration:t.refreshExpiration,readonlyAccess:!0,masterKey:null===(e=this.protocolService.getRootKey())||void 0===e?void 0:e.masterKey,keyParams:n.content,user:this.getSureUser(),host:this.apiService.getHost()};return this.protocolService.crypto.base64Encode(JSON.stringify(r))}decodeDemoShareToken(e){const t=this.protocolService.crypto.base64Decode(e);return JSON.parse(t)}async populateSessionFromDemoShareToken(e){const t=this.decodeDemoShareToken(e),n=(0,x.CreateNewRootKey)({masterKey:t.masterKey,keyParams:t.keyParams,version:t.keyParams.version}),r=t.user,i=new I(t.accessToken,t.accessExpiration,t.refreshToken,t.refreshExpiration,t.readonlyAccess);await this.populateSession(n,r,i,t.host)}async populateSession(e,t,n,r,i){await this.protocolService.setRootKey(e,i),this.setUser(t),this.diskStorageService.setValue(o.StorageKey.User,t),this.apiService.setHost(r),this.httpService.setHost(r),this.setSession(n),await this.webSocketsService.startWebSocketConnection()}async handleAuthResponse(e,t,n){const r=new I(e.session.access_token,e.session.access_expiration,e.session.refresh_token,e.session.refresh_expiration,e.session.readonly_access);await this.populateSession(t,e.user,r,this.apiService.getHost(),n)}async handleSuccessAuthResponse(e,t,n){const{data:r}=e,i=r.user;if(null!=r.token){const e=new F.j(r.token);await this.populateSession(t,i,e,this.apiService.getHost(),n)}else if(r.session){const r=I.FromApiResponse(e);await this.populateSession(t,i,r,this.apiService.getHost(),n)}}getDiagnostics(){return Promise.resolve({session:{isSessionRenewChallengePresented:this.isSessionRenewChallengePresented,online:this.online(),offline:this.offline(),isSignedIn:this.isSignedIn(),isSignedIntoFirstPartyServer:this.isSignedIntoFirstPartyServer()}})}}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.UserRoleMessageReceived="WebSocketMessageReceived"}(G||(G={}));class Y extends o.AbstractService{constructor(e,t,n,r){super(r),Q(this,"storageService",void 0),Q(this,"webSocketUrl",void 0),Q(this,"webSocketApiService",void 0),Q(this,"internalEventBus",void 0),Q(this,"webSocket",void 0),this.storageService=e,this.webSocketUrl=t,this.webSocketApiService=n,this.internalEventBus=r}setWebSocketUrl(e){this.webSocketUrl=e,this.storageService.setValue(o.StorageKey.WebSocketUrl,e)}loadWebSocketUrl(){const e=this.storageService.getValue(o.StorageKey.WebSocketUrl);this.webSocketUrl=e||this.webSocketUrl||window._websocket_url}async startWebSocketConnection(){const e=await this.createWebSocketConnectionToken();if(void 0!==e&&this.webSocketUrl)try{this.webSocket=new WebSocket("".concat(this.webSocketUrl,"?authToken=").concat(e)),this.webSocket.onmessage=this.onWebSocketMessage.bind(this),this.webSocket.onclose=this.onWebSocketClose.bind(this)}catch(e){console.error("Error starting WebSocket connection",e)}}closeWebSocketConnection(){var e;null===(e=this.webSocket)||void 0===e||e.close()}onWebSocketMessage(e){const t=JSON.parse(e.data);this.notifyEvent(G.UserRoleMessageReceived,t)}onWebSocketClose(){this.webSocket=void 0}async createWebSocketConnectionToken(){try{return(await this.webSocketApiService.createConnectionToken()).data.token}catch(e){return void console.error(e.message)}}deinit(){super.deinit(),this.storageService=void 0,this.webSocketApiService=void 0,this.closeWebSocketConnection()}}function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class J extends o.AbstractService{constructor(e,t){super(t),$(this,"application",void 0),$(this,"internalEventBus",void 0),$(this,"unsubApp",void 0),this.application=e,this.internalEventBus=t,this.addAppEventObserverAfterSubclassesFinishConstructing()}deinit(){this.application=void 0,this.unsubApp(),this.unsubApp=void 0,super.deinit()}addAppEventObserverAfterSubclassesFinishConstructing(){setTimeout((()=>{this.addAppEventObserver()}),0)}addAppEventObserver(){this.application.isStarted()&&this.onAppStart(),this.application.isLaunched()&&this.onAppLaunch(),this.unsubApp=this.application.addEventObserver((async e=>{await this.onAppEvent(e),e===o.ApplicationEvent.Started?this.onAppStart():e===o.ApplicationEvent.Launched?this.onAppLaunch():e===o.ApplicationEvent.CompletedFullSync?this.onAppFullSync():e===o.ApplicationEvent.CompletedIncrementalSync?this.onAppIncrementalSync():e===o.ApplicationEvent.KeyStatusChanged&&this.onAppKeyChange()}))}async onAppEvent(e){}async onAppStart(){}async onAppLaunch(){}async onAppKeyChange(){}onAppIncrementalSync(){}onAppFullSync(){}}function X(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Z{constructor(e,t,n){X(this,"challenge",void 0),X(this,"values",void 0),X(this,"artifacts",void 0),this.challenge=e,this.values=t,this.artifacts=n,Object.freeze(this)}getValueForType(e){const t=this.values.find((t=>t.prompt.validation===e));if((0,d.isNullOrUndefined)(t))throw Error("Could not find value for validation type "+e);return t}getDefaultValue(){if(this.values.length>1)throw Error("Attempting to retrieve default response value when more than one value exists");return this.values[0]}}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class te{constructor(e,t,n,r,i,o){ee(this,"challenge",void 0),ee(this,"onValidValue",void 0),ee(this,"onInvalidValue",void 0),ee(this,"onNonvalidatedSubmit",void 0),ee(this,"onComplete",void 0),ee(this,"onCancel",void 0),ee(this,"nonvalidatedValues",[]),ee(this,"validValues",[]),ee(this,"invalidValues",[]),ee(this,"artifacts",{}),this.challenge=e,this.onValidValue=t,this.onInvalidValue=n,this.onNonvalidatedSubmit=r,this.onComplete=i,this.onCancel=o}deinit(){this.challenge=void 0,this.onValidValue=void 0,this.onInvalidValue=void 0,this.onNonvalidatedSubmit=void 0,this.onComplete=void 0,this.onCancel=void 0,this.nonvalidatedValues=void 0,this.validValues=void 0,this.invalidValues=void 0,this.artifacts=void 0}complete(e){var t;e||(e=new Z(this.challenge,this.validValues,this.artifacts)),null===(t=this.onComplete)||void 0===t||t.call(this,e)}nonvalidatedSubmit(){var e;const t=new Z(this.challenge,this.nonvalidatedValues.slice(),this.artifacts);null===(e=this.onNonvalidatedSubmit)||void 0===e||e.call(this,t),this.nonvalidatedValues=[]}cancel(){var e;null===(e=this.onCancel)||void 0===e||e.call(this)}isFinished(){return this.validValues.length===this.challenge.prompts.length}nonvalidatedPrompts(){return this.challenge.prompts.filter((e=>!e.validates))}addNonvalidatedValue(e){const t=this.nonvalidatedValues,n=t.find((t=>t.prompt.id===e.prompt.id));n&&(0,d.removeFromArray)(t,n),t.push(e),this.nonvalidatedValues.length===this.nonvalidatedPrompts().length&&this.nonvalidatedSubmit()}setValueStatus(e,t,n){const r=t?this.validValues:this.invalidValues,i=r.find((t=>t.prompt.validation===e.prompt.validation));var o,a;i&&(0,d.removeFromArray)(r,i),r.push(e),Object.assign(this.artifacts,n),this.isFinished()?this.complete():t?null===(o=this.onValidValue)||void 0===o||o.call(this,e):null===(a=this.onInvalidValue)||void 0===a||a.call(this,e)}}var ne,re=n(44412);function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.UnprotectedSessionBegan="UnprotectedSessionBegan",e.UnprotectedSessionExpired="UnprotectedSessionExpired"}(ne||(ne={}));const oe=30;var ae;function se(e){return"number"==typeof e&&Object.values(ae).includes(e)}!function(e){e[e.OneMinute=60]="OneMinute",e[e.FiveMinutes=300]="FiveMinutes",e[e.OneHour=3600]="OneHour",e[e.OneWeek=604800]="OneWeek"}(ae||(ae={}));const ce=[{valueInSeconds:ae.OneMinute,label:"1 Minute"},{valueInSeconds:ae.FiveMinutes,label:"5 Minutes"},{valueInSeconds:ae.OneHour,label:"1 Hour"},{valueInSeconds:ae.OneWeek,label:"1 Week"}];class le extends o.AbstractService{constructor(e,t,n,r){super(r),ie(this,"protocolService",void 0),ie(this,"challengeService",void 0),ie(this,"storageService",void 0),ie(this,"internalEventBus",void 0),ie(this,"sessionExpiryTimeout",-1),ie(this,"mobilePasscodeTiming",o.MobileUnlockTiming.OnQuit),ie(this,"mobileBiometricsTiming",o.MobileUnlockTiming.OnQuit),this.protocolService=e,this.challengeService=t,this.storageService=n,this.internalEventBus=r}deinit(){clearTimeout(this.sessionExpiryTimeout),this.protocolService=void 0,this.challengeService=void 0,this.storageService=void 0,super.deinit()}handleApplicationStage(e){return e===o.ApplicationStage.LoadedDatabase_12&&(this.updateSessionExpiryTimer(this.getSessionExpiryDate()),this.mobilePasscodeTiming=this.getMobilePasscodeTiming(),this.mobileBiometricsTiming=this.getMobileBiometricsTiming()),Promise.resolve()}hasProtectionSources(){return this.protocolService.hasAccount()||this.protocolService.hasPasscode()||this.hasBiometricsEnabled()}hasUnprotectedAccessSession(){return!this.hasProtectionSources()||this.getSessionExpiryDate()>new Date}hasBiometricsEnabled(){const e=this.storageService.getValue(o.StorageKey.BiometricsState,o.StorageValueModes.Nonwrapped);return Boolean(e)}enableBiometrics(){return this.hasBiometricsEnabled()?(re.W.onError(Error("Tried to enable biometrics when they already are enabled.")),!1):(this.storageService.setValue(o.StorageKey.BiometricsState,!0,o.StorageValueModes.Nonwrapped),!0)}async disableBiometrics(){return this.hasBiometricsEnabled()?!!await this.validateOrRenewSession(o.ChallengeReason.DisableBiometrics)&&(this.storageService.setValue(o.StorageKey.BiometricsState,!1,o.StorageValueModes.Nonwrapped),!0):(re.W.onError(Error("Tried to disable biometrics when they already are disabled.")),!1)}createLaunchChallenge(){const e=[];return this.hasBiometricsEnabled()&&e.push(new o.ChallengePrompt(o.ChallengeValidation.Biometric)),this.protocolService.hasPasscode()&&e.push(new o.ChallengePrompt(o.ChallengeValidation.LocalPasscode)),e.length>0?new o.Challenge(e,o.ChallengeReason.ApplicationUnlock,!1):void 0}async authorizeProtectedActionForItems(e,t){let n;const r=[];for(const i of e){const e=i.protected&&!this.hasUnprotectedAccessSession();e&&!n&&(n=this.validateOrRenewSession(t)),e&&!await n||r.push(i)}return r}async authorizeItemAccess(e){return!e.protected||this.authorizeAction(e.content_type===r.ContentType.Note?o.ChallengeReason.AccessProtectedNote:o.ChallengeReason.AccessProtectedFile,{fallBackToAccountPassword:!0,requireAccountPassword:!1,forcePrompt:!1})}authorizeAddingPasscode(){return this.authorizeAction(o.ChallengeReason.AddPasscode,{fallBackToAccountPassword:!0,requireAccountPassword:!1,forcePrompt:!1})}authorizeChangingPasscode(){return this.authorizeAction(o.ChallengeReason.ChangePasscode,{fallBackToAccountPassword:!0,requireAccountPassword:!1,forcePrompt:!1})}authorizeRemovingPasscode(){return this.authorizeAction(o.ChallengeReason.RemovePasscode,{fallBackToAccountPassword:!0,requireAccountPassword:!1,forcePrompt:!1})}authorizeSearchingProtectedNotesText(){return this.authorizeAction(o.ChallengeReason.SearchProtectedNotesText,{fallBackToAccountPassword:!0,requireAccountPassword:!1,forcePrompt:!1})}authorizeFileImport(){return this.authorizeAction(o.ChallengeReason.ImportFile,{fallBackToAccountPassword:!0,requireAccountPassword:!1,forcePrompt:!1})}async authorizeBackupCreation(){return this.authorizeAction(o.ChallengeReason.ExportBackup,{fallBackToAccountPassword:!0,requireAccountPassword:!1,forcePrompt:!1})}async authorizeMfaDisable(){return this.authorizeAction(o.ChallengeReason.DisableMfa,{fallBackToAccountPassword:!0,requireAccountPassword:!0,forcePrompt:!1})}async authorizeAutolockIntervalChange(){return this.authorizeAction(o.ChallengeReason.ChangeAutolockInterval,{fallBackToAccountPassword:!0,requireAccountPassword:!1,forcePrompt:!1})}async authorizeSessionRevoking(){return this.authorizeAction(o.ChallengeReason.RevokeSession,{fallBackToAccountPassword:!0,requireAccountPassword:!1,forcePrompt:!1})}async authorizeListedPublishing(){return this.authorizeAction(o.ChallengeReason.AuthorizeNoteForListed,{fallBackToAccountPassword:!0,requireAccountPassword:!1,forcePrompt:!0})}async authorizeAction(e,t){return this.validateOrRenewSession(e,t)}getMobilePasscodeTimingOptions(){return[{title:"Immediately",key:o.MobileUnlockTiming.Immediately,selected:this.mobilePasscodeTiming===o.MobileUnlockTiming.Immediately},{title:"On Quit",key:o.MobileUnlockTiming.OnQuit,selected:this.mobilePasscodeTiming===o.MobileUnlockTiming.OnQuit}]}getMobileBiometricsTimingOptions(){return[{title:"Immediately",key:o.MobileUnlockTiming.Immediately,selected:this.mobileBiometricsTiming===o.MobileUnlockTiming.Immediately},{title:"On Quit",key:o.MobileUnlockTiming.OnQuit,selected:this.mobileBiometricsTiming===o.MobileUnlockTiming.OnQuit}]}getMobileBiometricsTiming(){return this.storageService.getValue(o.StorageKey.MobileBiometricsTiming,o.StorageValueModes.Nonwrapped,o.MobileUnlockTiming.OnQuit)}getMobilePasscodeTiming(){return this.storageService.getValue(o.StorageKey.MobilePasscodeTiming,o.StorageValueModes.Nonwrapped,o.MobileUnlockTiming.OnQuit)}setMobileBiometricsTiming(e){this.storageService.setValue(o.StorageKey.MobileBiometricsTiming,e,o.StorageValueModes.Nonwrapped),this.mobileBiometricsTiming=e}setMobilePasscodeTiming(e){this.storageService.setValue(o.StorageKey.MobilePasscodeTiming,e,o.StorageValueModes.Nonwrapped),this.mobilePasscodeTiming=e}setMobileScreenshotPrivacyEnabled(e){return this.storageService.setValue(o.StorageKey.MobileScreenshotPrivacyEnabled,e,o.StorageValueModes.Default)}getMobileScreenshotPrivacyEnabled(){return this.storageService.getValue(o.StorageKey.MobileScreenshotPrivacyEnabled,o.StorageValueModes.Default,!1)}async validateOrRenewSession(e){let{fallBackToAccountPassword:t=!0,requireAccountPassword:n=!1,forcePrompt:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.getSessionExpiryDate()>new Date&&!r)return!0;const i=[];if(this.hasBiometricsEnabled()&&i.push(new o.ChallengePrompt(o.ChallengeValidation.Biometric)),this.protocolService.hasPasscode()&&i.push(new o.ChallengePrompt(o.ChallengeValidation.LocalPasscode)),n){if(!this.protocolService.hasAccount())throw Error("Requiring account password for challenge with no account");i.push(new o.ChallengePrompt(o.ChallengeValidation.AccountPassword))}if(0===i.length){if(!t||!this.protocolService.hasAccount())return!0;i.push(new o.ChallengePrompt(o.ChallengeValidation.AccountPassword))}const a=this.getLastSessionLength(),s=se(a)?a:ae.OneMinute;i.push(new o.ChallengePrompt(o.ChallengeValidation.ProtectionSessionDuration,void 0,void 0,void 0,void 0,s));const c=await this.challengeService.promptForChallengeResponse(new o.Challenge(i,e,!0));if(c){var l;const e=null===(l=c.values.find((e=>e.prompt.validation===o.ChallengeValidation.ProtectionSessionDuration)))||void 0===l?void 0:l.value;return(0,d.isNullOrUndefined)(e)?re.W.error(Error("No valid protection session length found. Got "+e)):await this.setSessionLength(e),!0}return!1}getSessionExpiryDate(){const e=this.storageService.getValue(o.StorageKey.ProtectionExpirey);return e?new Date(e):new Date}clearSession(){return this.setSessionExpiryDate(new Date),this.notifyEvent(ne.UnprotectedSessionExpired)}setSessionExpiryDate(e){this.storageService.setValue(o.StorageKey.ProtectionExpirey,e)}getLastSessionLength(){return this.storageService.getValue(o.StorageKey.ProtectionSessionLength)}setSessionLength(e){this.storageService.setValue(o.StorageKey.ProtectionSessionLength,e);const t=new Date;t.setSeconds(t.getSeconds()+e),this.setSessionExpiryDate(t),this.updateSessionExpiryTimer(t),this.notifyEvent(ne.UnprotectedSessionBegan)}updateSessionExpiryTimer(e){clearTimeout(this.sessionExpiryTimeout),this.sessionExpiryTimeout=setTimeout((()=>{this.clearSession()}),e.getTime()-Date.now())}getDiagnostics(){return Promise.resolve({protections:{getSessionExpiryDate:this.getSessionExpiryDate(),getLastSessionLength:this.getLastSessionLength(),hasProtectionSources:this.hasProtectionSources(),hasUnprotectedAccessSession:this.hasUnprotectedAccessSession(),hasBiometricsEnabled:this.hasBiometricsEnabled()}})}}function ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const de=e=>{e.onCancel=void 0,e.onComplete=void 0,e.onValidValue=void 0,e.onInvalidValue=void 0,e.onNonvalidatedSubmit=void 0};class pe extends o.AbstractService{constructor(e,t,n){super(n),ue(this,"storageService",void 0),ue(this,"protocolService",void 0),ue(this,"internalEventBus",void 0),ue(this,"challengeOperations",{}),ue(this,"sendChallenge",void 0),ue(this,"challengeObservers",{}),this.storageService=e,this.protocolService=t,this.internalEventBus=n}deinit(){this.storageService=void 0,this.protocolService=void 0,this.sendChallenge=void 0,this.challengeOperations=void 0,this.challengeObservers=void 0,super.deinit()}promptForChallengeResponse(e){return new Promise((t=>{this.createOrGetChallengeOperation(e,t),this.sendChallenge(e)}))}createChallenge(e,t,n,r,i){return new o.Challenge(e,t,n,r,i)}async validateChallengeValue(e){switch(e.prompt.validation){case o.ChallengeValidation.LocalPasscode:return this.protocolService.validatePasscode(e.value);case o.ChallengeValidation.AccountPassword:return this.protocolService.validateAccountPassword(e.value);case o.ChallengeValidation.Biometric:return{valid:!0===e.value};case o.ChallengeValidation.ProtectionSessionDuration:return{valid:se(e.value)};default:throw Error("Unhandled validation mode ".concat(e.prompt.validation))}}async promptForCorrectPasscode(e){const t=new o.Challenge([new o.ChallengePrompt(o.ChallengeValidation.LocalPasscode)],e,!0),n=await this.promptForChallengeResponse(t);if(n)return n.getValueForType(o.ChallengeValidation.LocalPasscode).value}async getWrappingKeyIfApplicable(e){return this.protocolService.hasPasscode()?e||(e=await this.promptForCorrectPasscode(o.ChallengeReason.ResaveRootKey))?{wrappingKey:await this.protocolService.computeWrappingKey(e)}:{canceled:!0}:{}}isPasscodeLocked(){return this.protocolService.isPasscodeLocked()}addChallengeObserver(e,t){const n=this.challengeObservers[e.id]||[];return n.push(t),this.challengeObservers[e.id]=n,()=>{de(t),(0,d.removeFromArray)(n,t)}}createOrGetChallengeOperation(e,t){let n=this.getChallengeOperation(e);return n||(n=new te(e,(t=>{this.onChallengeValidValue(e,t)}),(t=>{this.onChallengeInvalidValue(e,t)}),(n=>{this.onChallengeNonvalidatedSubmit(e,n),t(n)}),(n=>{this.onChallengeComplete(e,n),t(n)}),(()=>{this.onChallengeCancel(e),t(void 0)})),this.challengeOperations[e.id]=n),n}performOnObservers(e,t){const n=this.challengeObservers[e.id]||[];for(const e of n)t(e)}onChallengeValidValue(e,t){this.performOnObservers(e,(e=>{var n;null===(n=e.onValidValue)||void 0===n||n.call(e,t)}))}onChallengeInvalidValue(e,t){this.performOnObservers(e,(e=>{var n;null===(n=e.onInvalidValue)||void 0===n||n.call(e,t)}))}onChallengeNonvalidatedSubmit(e,t){this.performOnObservers(e,(e=>{var n;null===(n=e.onNonvalidatedSubmit)||void 0===n||n.call(e,t)}))}onChallengeComplete(e,t){this.performOnObservers(e,(e=>{var n;null===(n=e.onComplete)||void 0===n||n.call(e,t)}))}onChallengeCancel(e){this.performOnObservers(e,(e=>{var t;null===(t=e.onCancel)||void 0===t||t.call(e)}))}getChallengeOperation(e){return this.challengeOperations[e.id]}deleteChallengeOperation(e){const t=e.challenge;e.deinit(),delete this.challengeOperations[t.id]}cancelChallenge(e){const t=this.challengeOperations[e.id];t.cancel(),this.deleteChallengeOperation(t)}completeChallenge(e){const t=this.challengeOperations[e.id];t.complete(),this.deleteChallengeOperation(t)}async submitValuesForChallenge(e,t){if(0===t.length)throw Error("Attempting to submit 0 values for challenge");for(const n of t)if(n.prompt.validates){const{valid:t,artifacts:r}=await this.validateChallengeValue(n);this.setValidationStatusForChallenge(e,n,t,r)}else this.getChallengeOperation(e).addNonvalidatedValue(n)}setValidationStatusForChallenge(e,t,n,r){const i=this.getChallengeOperation(e);if(i.setValueStatus(t,n,r),i.isFinished()){this.deleteChallengeOperation(i);const t=this.challengeObservers[e.id];t.forEach(de),t.length=0,delete this.challengeObservers[e.id]}}}var he=n(70295);const ye=Object.freeze([he.LegacyFileSafeIdentifier,he.FeatureIdentifier.DeprecatedFileSafe,he.FeatureIdentifier.DeprecatedBoldEditor]),fe=Object.freeze([r.ContentType.FilesafeCredentials,r.ContentType.FilesafeFileMetadata,r.ContentType.FilesafeIntegration]);var ve=n(3270),me=n.n(ve),ge=n(14293),Se=n.n(ge),be=n(1494),Pe=n.n(be),_e=n(49148);function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){Ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Oe=[he.ComponentAction.SaveItems,he.ComponentAction.AssociateItem,he.ComponentAction.DeassociateItem,he.ComponentAction.CreateItem,he.ComponentAction.CreateItems,he.ComponentAction.DeleteItems,he.ComponentAction.SetComponentData];class Ie{constructor(e,t,n,a,s,c,l,u,p,h,y,f){Ce(this,"component",void 0),Ce(this,"itemManager",void 0),Ce(this,"syncService",void 0),Ce(this,"alertService",void 0),Ce(this,"preferencesSerivce",void 0),Ce(this,"environment",void 0),Ce(this,"platform",void 0),Ce(this,"componentManagerFunctions",void 0),Ce(this,"url",void 0),Ce(this,"contextItemUuid",void 0),Ce(this,"streamItems",void 0),Ce(this,"streamContextItemOriginalMessage",void 0),Ce(this,"streamItemsOriginalMessage",void 0),Ce(this,"removeItemObserver",void 0),Ce(this,"loggingEnabled",!1),Ce(this,"identifier",(0,d.nonSecureRandomIdentifier)()),Ce(this,"actionObservers",[]),Ce(this,"overrideContextItem",void 0),Ce(this,"featureStatus",void 0),Ce(this,"removeFeaturesObserver",void 0),Ce(this,"eventObservers",[]),Ce(this,"dealloced",!1),Ce(this,"window",void 0),Ce(this,"hidden",!1),Ce(this,"readonly",!1),Ce(this,"lockReadonly",!1),Ce(this,"sessionKey",void 0),this.component=e,this.itemManager=t,this.syncService=n,this.alertService=a,this.preferencesSerivce=s,this.environment=l,this.platform=u,this.componentManagerFunctions=p,this.url=h,this.contextItemUuid=y,this.removeItemObserver=this.itemManager.addObserver(r.ContentType.Any,(e=>{let{changed:t,inserted:n,removed:r,source:i,sourceKey:o}=e;if(this.dealloced)return;const a=[...t,...n,...r];this.handleChangesInItems(a,i,o)})),f&&this.actionObservers.push(f),this.featureStatus=c.getFeatureStatus(e.identifier),this.removeFeaturesObserver=c.addEventObserver((t=>{if(!this.dealloced&&t===o.FeaturesEvent.FeaturesUpdated){const t=c.getFeatureStatus(e.identifier);t!==this.featureStatus&&(this.featureStatus=t,this.notifyEventObservers(i.ComponentViewerEvent.FeatureStatusUpdated))}})),this.log("Constructor",this)}get isDesktop(){return this.environment===i.Environment.Desktop}get isMobile(){return this.environment===i.Environment.Mobile}destroy(){this.log("Destroying",this),this.deinit()}deinit(){this.dealloced=!0,this.component=void 0,this.itemManager=void 0,this.syncService=void 0,this.alertService=void 0,this.preferencesSerivce=void 0,this.componentManagerFunctions=void 0,this.eventObservers.length=0,this.actionObservers.length=0,this.removeFeaturesObserver(),this.removeFeaturesObserver=void 0,this.removeItemObserver(),this.removeItemObserver=void 0}addEventObserver(e){this.eventObservers.push(e);const t=this.eventObservers;return()=>{(0,d.removeFromArray)(t,e)}}notifyEventObservers(e){for(const t of this.eventObservers)t(e)}addActionObserver(e){this.actionObservers.push(e);const t=this.actionObservers;return()=>{(0,d.removeFromArray)(t,e)}}setReadonly(e){if(this.lockReadonly)throw Error("Attempting to set readonly on lockedReadonly component viewer");this.readonly=e}get componentUuid(){return this.component.uuid}getFeatureStatus(){return this.featureStatus}isOfflineRestricted(){return this.component.offlineOnly&&!this.isDesktop}isNativeFeature(){return!!(0,he.FindNativeFeature)(this.component.identifier)}hasUrlError(){return!(this.isNativeFeature()||this.isDesktop&&this.component.local_url||this.component.hasValidHostedUrl())}shouldRender(){return null==this.getError()}getError(){return this.isOfflineRestricted()?o.ComponentViewerError.OfflineRestricted:this.hasUrlError()?o.ComponentViewerError.MissingUrl:void 0}updateOurComponentRefFromChangedItems(e){const t=e.find((e=>e.uuid===this.component.uuid));t&&(0,i.isDecryptedItem)(t)&&(this.component=t)}handleChangesInItems(e,t,n){const r=e.filter(i.isNotEncryptedItem),o=r.filter(i.isDecryptedItem);if(this.updateOurComponentRefFromChangedItems(o),!n||n!==this.component.uuid){if(this.streamItems){const e=r.filter((e=>{var t;return null===(t=this.streamItems)||void 0===t?void 0:t.includes(e.content_type)}));e.length>0&&this.sendManyItemsThroughBridge(e)}if(this.streamContextItemOriginalMessage){const e=me()(o,{uuid:this.contextItemUuid});e&&this.sendContextItemThroughBridge(e,t)}}}sendManyItemsThroughBridge(e){const t=[{name:he.ComponentAction.StreamItems,content_types:this.streamItems.sort()}];this.componentManagerFunctions.runWithPermissions(this.component.uuid,t,(()=>{this.sendItemsInReply(e,this.streamItemsOriginalMessage)}))}sendContextItemThroughBridge(e,t){const n=[{name:he.ComponentAction.StreamContextItem}];this.componentManagerFunctions.runWithPermissions(this.component.uuid,n,(()=>{this.log("Send context item in reply","component:",this.component,"item: ",e,"originalMessage: ",this.streamContextItemOriginalMessage);const n={item:this.jsonForItem(e,t)};this.replyToMessage(this.streamContextItemOriginalMessage,n)}))}log(e){if(this.loggingEnabled){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];(0,d.log)("ComponentViewer",e,n)}}sendItemsInReply(e,t,n){this.log("Send items in reply",this.component,e,t);const r={},i=e.map((e=>this.jsonForItem(e,n)));r.items=i,this.replyToMessage(t,r)}jsonForItem(e,t){const n=t===i.PayloadEmitSource.RemoteSaved||t===i.PayloadEmitSource.OfflineSyncSaved||t===i.PayloadEmitSource.PreSyncSave,r={uuid:e.uuid,content_type:e.content_type,created_at:e.created_at,updated_at:e.serverUpdatedAt,isMetadataUpdate:n};if((0,i.isDecryptedItem)(e)){r.content=this.contentForItem(e);const t=(e.getDomainData(i.ComponentDataDomain)||{})[this.component.getClientDataKey()]||{};r.clientData=t}else r.deleted=!0;return this.responseItemsByRemovingPrivateProperties([r])[0]}contentForItem(e){if((0,i.isNote)(e)){const t=e.content,n=null!=e.spellcheck?e.spellcheck:this.preferencesSerivce.getValue(i.PrefKey.EditorSpellcheck,!0);return Ee(Ee({},t),{},{spellcheck:n})}return e.content}replyToMessage(e,t){const n={action:he.ComponentAction.Reply,original:e,data:t};this.sendMessage(n)}sendMessage(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=[he.ComponentAction.ComponentRegistered,he.ComponentAction.ActivateThemes];if(this.hidden&&!n.includes(e.action))return void this.log("Component disabled for current item, ignoring messages.",this.component.name);if(!this.window&&e.action===he.ComponentAction.Reply)return void this.log("Component has been deallocated in between message send and reply",this.component,e);this.log("Send message to component",this.component,"message: ",e);let r=this.url;r&&this.window?(r.startsWith("http")||r.startsWith("file")||(r=window.location.href+r),this.window.postMessage(this.isMobile?JSON.stringify(e):e,r)):t&&this.alertService.alert("Standard Notes is trying to communicate with ".concat(this.component.name,", ")+"but an error is occurring. Please restart this extension and try again.")}responseItemsByRemovingPrivateProperties(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=["autoupdateDisabled","permissions","active"];return t&&(n=n.concat(["hosted_url","local_url"])),e.map((e=>{const r=n.slice();if(t&&r.push("url"),!e.content||(0,d.isString)(e.content))return e;let i={};for(const[t,n]of Object.entries(e.content))r.includes(t)||(i=Ee(Ee({},i),{},{[t]:n}));return Ee(Ee({},e),{},{content:i})}))}getWindow(){return this.window}setWindow(e){if(this.window)throw Error("Attempting to override component viewer window. Create a new component viewer instead.");this.log("setWindow","component: ",this.component,"window: ",e),this.window=e,this.sessionKey=d.UuidGenerator.GenerateUuid(),this.sendMessage({action:he.ComponentAction.ComponentRegistered,sessionKey:this.sessionKey,componentData:this.component.componentData,data:{uuid:this.component.uuid,environment:(0,_e.g)(this.environment),platform:(0,_e._e)(this.platform),activeThemeUrls:this.componentManagerFunctions.urlsForActiveThemes()}}),this.log("setWindow got new sessionKey",this.sessionKey),this.postActiveThemes()}postActiveThemes(){const e={themes:this.componentManagerFunctions.urlsForActiveThemes()},t={action:he.ComponentAction.ActivateThemes,data:e};this.sendMessage(t,!1)}setHidden(e){e?this.hidden=!0:this.hidden&&(this.hidden=!1,this.streamContextItemOriginalMessage&&this.handleStreamContextItemMessage(this.streamContextItemOriginalMessage),this.streamItems&&this.handleStreamItemsMessage(this.streamItemsOriginalMessage))}handleMessage(e){if(this.log("Handle message",e,this),!this.component)return this.log("Component not defined for message, returning",e),void this.alertService.alert("A component is trying to communicate with Standard Notes, but there is an error establishing a bridge. Please restart the app and try again.");if(this.readonly&&Oe.includes(e.action))return void this.alertService.alert("".concat(this.component.name," is trying to save, but it is in a locked state and cannot accept changes."));const t={[he.ComponentAction.StreamItems]:this.handleStreamItemsMessage.bind(this),[he.ComponentAction.StreamContextItem]:this.handleStreamContextItemMessage.bind(this),[he.ComponentAction.SetComponentData]:this.handleSetComponentDataMessage.bind(this),[he.ComponentAction.DeleteItems]:this.handleDeleteItemsMessage.bind(this),[he.ComponentAction.CreateItems]:this.handleCreateItemsMessage.bind(this),[he.ComponentAction.CreateItem]:this.handleCreateItemsMessage.bind(this),[he.ComponentAction.SaveItems]:this.handleSaveItemsMessage.bind(this),[he.ComponentAction.SetSize]:this.handleSetSizeEvent.bind(this)}[e.action];null==t||t(e);for(const t of this.actionObservers)t(e.action,e.data)}handleStreamItemsMessage(e){const t=e.data.content_types.filter((e=>fe.includes(e))).sort(),n=[{name:he.ComponentAction.StreamItems,content_types:t}];this.componentManagerFunctions.runWithPermissions(this.component.uuid,n,(()=>{this.streamItems||(this.streamItems=t,this.streamItemsOriginalMessage=e);const n=[];for(const e of t)(0,d.extendArray)(n,this.itemManager.getItems(e));this.sendItemsInReply(n,e)}))}handleStreamContextItemMessage(e){const t=[{name:he.ComponentAction.StreamContextItem}];this.componentManagerFunctions.runWithPermissions(this.component.uuid,t,(()=>{this.streamContextItemOriginalMessage||(this.streamContextItemOriginalMessage=e);const t=this.overrideContextItem||this.itemManager.findItem(this.contextItemUuid);t&&this.sendContextItemThroughBridge(t)}))}handleSaveItemsMessage(e){let t=e.data.items;const n=[],o=t.slice();for(const e of t.slice())if(e.uuid===this.contextItemUuid){n.push({name:he.ComponentAction.StreamContextItem}),(0,d.removeFromArray)(o,e);break}if(o.length>0){const e=Se()(o.map((e=>e.content_type))).sort();n.push({name:he.ComponentAction.StreamItems,content_types:e})}this.componentManagerFunctions.runWithPermissions(this.component.uuid,n,(async()=>{t=this.responseItemsByRemovingPrivateProperties(t,!0);const n=(0,d.Uuids)(t),o=this.itemManager.findItemsIncludingBlanks(n);let a=0,s=0;for(const e of o)e&&e.locked&&(Pe()(t,{uuid:e.uuid}),a++,e.content_type===r.ContentType.Note&&s++);if(1===s)return void this.alertService.alert("The note you are attempting to save has editing disabled","Note has Editing Disabled");if(a>0){const e=1===a?"item":s===a?"notes":"items",t=1===a?"has":"have";return void this.alertService.alert("".concat(a," ").concat(e," you are attempting to save ").concat(t," editing disabled."),"Items have Editing Disabled")}const c=t.map((e=>(0,i.CreateComponentRetrievedContextPayload)(e)));for(const e of c){const t=this.itemManager.findItem(e.uuid);if(t){if(e.content_type!==t.content_type)throw Error("Extension is trying to modify content type of item.")}else{const t=new i.DecryptedPayload(Ee(Ee({},(0,i.PayloadTimestampDefaults)()),e)),n=(0,i.CreateDecryptedItemFromPayload)(t);await this.itemManager.insertItem(n)}}await this.itemManager.changeItems(o.filter(d.isNotUndefined),(e=>{const n=(0,d.sureSearchArray)(c,{uuid:e.getUuid()});e.setCustomContent(n.content);const r=(0,d.sureSearchArray)(t,{uuid:e.getUuid()});if(r.clientData){const t=(0,d.Copy)(e.getItem().getDomainData(i.ComponentDataDomain)||{});t[this.component.getClientDataKey()]=r.clientData,e.setDomainData(t,i.ComponentDataDomain)}}),i.MutationType.UpdateUserTimestamps,i.PayloadEmitSource.ComponentRetrieved,this.component.uuid),this.syncService.sync({onPresyncSave:()=>{this.replyToMessage(e,{})}}).catch((()=>{this.replyToMessage(e,{error:"save-error"})}))}))}handleCreateItemsMessage(e){let t=e.data.item?[e.data.item]:e.data.items;const n=Se()(t.map((e=>e.content_type))),r=[{name:he.ComponentAction.StreamItems,content_types:n}];this.componentManagerFunctions.runWithPermissions(this.component.uuid,r,(async()=>{t=this.responseItemsByRemovingPrivateProperties(t);const n=[];for(const e of t){e.uuid||(e.uuid=d.UuidGenerator.GenerateUuid());const t=(0,i.createComponentCreatedContextPayload)(e),r=new i.DecryptedPayload(Ee(Ee({},(0,i.PayloadTimestampDefaults)()),t)),o=(0,i.CreateDecryptedItemFromPayload)(r),a=await this.itemManager.insertItem(o);await this.itemManager.changeItem(a,(t=>{if(e.clientData){const n=(0,d.Copy)(a.getDomainData(i.ComponentDataDomain)||{});n[this.component.getClientDataKey()]=e.clientData,t.setDomainData(n,i.ComponentDataDomain)}}),i.MutationType.UpdateUserTimestamps,i.PayloadEmitSource.ComponentCreated,this.component.uuid),n.push(a)}this.syncService.sync();const r=e.action===he.ComponentAction.CreateItem?{item:this.jsonForItem(n[0])}:{items:n.map((e=>this.jsonForItem(e)))};this.replyToMessage(e,r)}))}handleDeleteItemsMessage(e){const t=e.data.items.filter((e=>fe.includes(e.content_type))),n=Se()(t.map((e=>e.content_type))).sort(),r=[{name:he.ComponentAction.StreamItems,content_types:n}];this.componentManagerFunctions.runWithPermissions(this.component.uuid,r,(async()=>{const n=t,r=1===n.length?"item":"items";let o=null;if(await this.alertService.confirm("Are you sure you want to delete ".concat(n.length," ").concat(r,"?"))){for(const e of n){const t=this.itemManager.findItem(e.uuid);t?await this.itemManager.setItemToBeDeleted(t,i.PayloadEmitSource.ComponentRetrieved):this.alertService.alert("The item you are trying to delete cannot be found.")}this.syncService.sync(),o={deleted:!0}}else o={deleted:!1};this.replyToMessage(e,o)}))}handleSetComponentDataMessage(e){this.componentManagerFunctions.runWithPermissions(this.component.uuid,[],(async()=>{await this.itemManager.changeComponent(this.component,(t=>{t.componentData=e.data.componentData||{}})),this.syncService.sync()}))}handleSetSizeEvent(e){var t;if(this.component.area!==he.ComponentArea.EditorStack)return;const n=null===(t=this.getIframe())||void 0===t?void 0:t.parentElement;if(!n)return;const r=e.data,i=(0,d.isString)(r.width)?r.width:"".concat(r.width,"px"),o=(0,d.isString)(r.height)?r.height:"".concat(r.height,"px");n&&n.setAttribute("style","width:".concat(i,"; height:").concat(o,";"))}getIframe(){return Array.from(document.getElementsByTagName("iframe")).find((e=>e.dataset.componentViewerId===this.identifier))}}function Me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ae="localhost";var Te;!function(e){e.ViewerDidFocus="ViewerDidFocus"}(Te||(Te={}));class ke extends o.AbstractService{constructor(e,t,n,r,i,o,a,s,c){super(s),Me(this,"itemManager",void 0),Me(this,"syncService",void 0),Me(this,"featuresService",void 0),Me(this,"preferencesSerivce",void 0),Me(this,"alertService",void 0),Me(this,"environment",void 0),Me(this,"platform",void 0),Me(this,"internalEventBus",void 0),Me(this,"device",void 0),Me(this,"desktopManager",void 0),Me(this,"viewers",[]),Me(this,"removeItemObserver",void 0),Me(this,"permissionDialogs",[]),Me(this,"detectFocusChange",(()=>{const e=this.allComponentIframes();for(const t of e)if(document.activeElement===t)return void setTimeout((()=>{const e=this.findComponentViewer(t.dataset.componentViewerId);this.notifyEvent(Te.ViewerDidFocus,{componentViewer:e})}))})),Me(this,"onWindowMessage",(e=>{var t;e.data.sessionKey&&(this.log("Component manager received message",e.data),null===(t=this.componentViewerForSessionKey(e.data.sessionKey))||void 0===t||t.handleMessage(e.data))})),this.itemManager=e,this.syncService=t,this.featuresService=n,this.preferencesSerivce=r,this.alertService=i,this.environment=o,this.platform=a,this.internalEventBus=s,this.device=c,this.loggingEnabled=!1,this.addItemObserver(),window.addEventListener?window.addEventListener("focus",this.detectFocusChange,!0):window.attachEvent("onfocusout",this.detectFocusChange),window.addEventListener?window.addEventListener("blur",this.detectFocusChange,!0):window.attachEvent("onblur",this.detectFocusChange),window.addEventListener("message",this.onWindowMessage,!0)}get isDesktop(){return this.environment===i.Environment.Desktop}get isMobile(){return this.environment===i.Environment.Mobile}get components(){return this.itemManager.getDisplayableComponents()}componentsForArea(e){return this.components.filter((t=>t.area===e))}componentWithIdentifier(e){return this.components.find((t=>t.identifier===e))}deinit(){var e;super.deinit();for(const e of this.viewers)e.destroy();this.viewers.length=0,this.permissionDialogs.length=0,this.desktopManager=void 0,this.itemManager=void 0,this.featuresService=void 0,this.syncService=void 0,this.alertService=void 0,this.preferencesSerivce=void 0,null===(e=this.removeItemObserver)||void 0===e||e.call(this),this.removeItemObserver=void 0,window&&(window.removeEventListener("focus",this.detectFocusChange,!0),window.removeEventListener("blur",this.detectFocusChange,!0),window.removeEventListener("message",this.onWindowMessage,!0)),this.detectFocusChange=void 0,this.onWindowMessage=void 0}createComponentViewer(e,t,n,r){const i=new Ie(e,this.itemManager,this.syncService,this.alertService,this.preferencesSerivce,this.featuresService,this.environment,this.platform,{runWithPermissions:this.runWithPermissions.bind(this),urlsForActiveThemes:this.urlsForActiveThemes.bind(this)},r||this.urlForComponent(e),t,n);return this.viewers.push(i),i}destroyComponentViewer(e){e.destroy(),(0,d.removeFromArray)(this.viewers,e)}setDesktopManager(e){this.desktopManager=e,this.configureForDesktop()}handleChangedComponents(e,t){const n=[i.PayloadEmitSource.LocalChanged,i.PayloadEmitSource.RemoteRetrieved,i.PayloadEmitSource.LocalDatabaseLoaded,i.PayloadEmitSource.LocalInserted];if(0!==e.length&&n.includes(t)){if(this.isDesktop){const t=e.filter((e=>!(0,he.FindNativeFeature)(e.identifier)));var r;t.length>0&&(null===(r=this.desktopManager)||void 0===r||r.syncComponentsInstallation(t))}e.filter((e=>e.isTheme())).length>0&&this.postActiveThemesToAllViewers()}}addItemObserver(){this.removeItemObserver=this.itemManager.addObserver([r.ContentType.Component,r.ContentType.Theme],(e=>{let{changed:t,inserted:n,removed:r,source:i}=e;const a=[...t,...n];this.handleChangedComponents(a,i);const s=this.device;(0,o.isMobileDevice)(s)&&"addComponentUrl"in s&&(n.forEach((e=>{const t=this.urlForComponent(e);t&&s.addComponentUrl(e.uuid,t)})),r.forEach((e=>{s.removeComponentUrl(e.uuid)})))}))}configureForDesktop(){var e;null===(e=this.desktopManager)||void 0===e||e.registerUpdateObserver((e=>{e.active&&e.isTheme()&&this.postActiveThemesToAllViewers()}))}postActiveThemesToAllViewers(){for(const e of this.viewers)e.postActiveThemes()}getActiveThemes(){return this.componentsForArea(he.ComponentArea.Themes).filter((e=>e.active))}urlForComponent(e){const t=this.isDesktop;if(e.offlineOnly&&!t)return;const n=(0,he.FindNativeFeature)(e.identifier);if(this.isDesktop)return(0,d.assert)(this.desktopManager),n?"".concat(this.desktopManager.getExtServerHost(),"/components/").concat(e.identifier,"/").concat(n.index_path):e.local_url?e.local_url.replace("sn://",this.desktopManager.getExtServerHost()+"/"):e.hosted_url||e.legacy_url;const r=this.environment===i.Environment.Mobile;if(n){let t=window.location.origin;return r&&(t=window.location.href.split("/index.html")[0]),"".concat(t,"/components/assets/").concat(e.identifier,"/").concat(n.index_path)}let o=e.hosted_url||e.legacy_url;if(o){if(this.isMobile){const e=this.platform===i.Platform.Ios?Ae:"10.0.2.2";o=o.replace(Ae,e).replace("sn.local",e)}return o}}urlsForActiveThemes(){const e=this.getActiveThemes(),t=[];for(const n of e){const e=this.urlForComponent(n);e&&t.push(e)}return t}findComponent(e){return this.itemManager.findItem(e)}findComponentViewer(e){return this.viewers.find((t=>t.identifier===e))}componentViewerForSessionKey(e){return this.viewers.find((t=>t.sessionKey===e))}areRequestedPermissionsValid(e,t){for(const r of t)if(r.name===he.ComponentAction.StreamItems){var n;if(!ye.includes(e.identifier))return!1;if(null===(n=r.content_types)||void 0===n?void 0:n.some((e=>!fe.includes(e))))return!1}return!0}runWithPermissions(e,t,n){const r=this.findComponent(e);if(!r)return void this.alertService.alert("Unable to find component with ID ".concat(e,". Please restart the app and try again."),"An unexpected error occurred");if(!this.areRequestedPermissionsValid(r,t))return void console.error("Component is requesting invalid permissions",e,t);const i=(0,he.FindNativeFeature)(r.identifier),o=(null==i?void 0:i.component_permissions)||r.permissions;t=(0,d.Copy)(t);for(const e of t.slice()){const n=o.find((t=>t.name===e.name));if(!n)continue;const r=e.content_types;if(r){for(const e of n.content_types)(0,d.removeFromArray)(r,e);0===r.length&&(0,d.filterFromArray)(t,e)}else(0,d.filterFromArray)(t,e)}t.length>0?this.promptForPermissionsWithAngularAsyncRendering(r,t,(async e=>{e&&n()})):n()}promptForPermissionsWithAngularAsyncRendering(e,t,n){setTimeout((()=>{this.promptForPermissions(e,t,n)}))}promptForPermissions(e,t,n){const r={component:e,permissions:t,permissionsString:this.permissionsStringForPermissions(t,e),actionBlock:n,callback:async n=>{const i=this.findComponent(e.uuid);if(i){if(n){this.log("Changing component to expand permissions",e);const n=(0,d.Copy)(i.permissions);for(const e of t){const t=n.find((t=>t.name===e.name));if(t){const n=t.content_types||[];t.content_types=Se()(n.concat(e.content_types))}else n.push(e)}await this.itemManager.changeItem(e,(e=>{e.permissions=n})),this.syncService.sync()}this.permissionDialogs=this.permissionDialogs.filter((i=>{return i===r?(i.actionBlock&&i.actionBlock(n),!1):!!(i.component!==e||i.permissions!==t&&(o=t,i.permissions.some((e=>!o.find((t=>JSON.stringify(t)===JSON.stringify(e)))))))||(n&&i.actionBlock&&i.actionBlock(n),!1);var o})),this.permissionDialogs.length>0&&this.presentPermissionsDialog(this.permissionDialogs[0])}}},i=me()(this.permissionDialogs,{component:e});this.permissionDialogs.push(r),i?this.log("Existing dialog, not presenting."):this.presentPermissionsDialog(r)}presentPermissionsDialog(e){throw"Must override SNComponentManager.presentPermissionsDialog"}async toggleTheme(e){this.log("Toggling theme",e);const t=this.findComponent(e);if(t.active)await this.itemManager.changeComponent(t,(e=>{e.active=!1}));else{const e=this.getActiveThemes();if(await this.itemManager.changeComponent(t,(e=>{e.active=!0})),!t.isLayerable()){await(0,d.sleep)(10);for(const t of e)t&&!t.isLayerable()&&await this.itemManager.changeComponent(t,(e=>{e.active=!1}))}}}async toggleComponent(e){this.log("Toggling component",e);const t=this.findComponent(e);t&&await this.itemManager.changeComponent(t,(e=>{e.active=!e.getItem().active}))}isComponentActive(e){return e.active}allComponentIframes(){return Array.from(document.getElementsByTagName("iframe"))}iframeForComponentViewer(e){return e.getIframe()}editorForNote(e){return e.editorIdentifier?this.componentWithIdentifier(e.editorIdentifier):e.noteType!==he.NoteType.Plain?this.legacyGetEditorForNote(e):void 0}legacyGetEditorForNote(e){const t=this.componentsForArea(he.ComponentArea.Editor);for(const n of t)if(n.isExplicitlyEnabledForItem(e.uuid))return n;const n=this.getDefaultEditor();return n&&!n.isExplicitlyDisabledForItem(e.uuid)?n:void 0}getDefaultEditor(){return this.componentsForArea(he.ComponentArea.Editor).filter((e=>e.isDefaultEditor()))[0]}permissionsStringForPermissions(e,t){if(0===e.length)return".";let n=[],i=[];return e.forEach((e=>{switch(e.name){case he.ComponentAction.StreamItems:if(!e.content_types)return;e.content_types.forEach((e=>{const t=(0,r.DisplayStringForContentType)(e);t?n.push("".concat(t,"s")):n.push("items of type ".concat(e))}));break;case he.ComponentAction.StreamContextItem:{const e={[he.ComponentArea.EditorStack]:"working note",[he.ComponentArea.Editor]:"working note",[he.ComponentArea.Themes]:"Unknown"};i.push(e[t.area])}}})),n=Se()(n),i=Se()(i),0===n.length&&0===i.length?".":n.concat(i).join(", ")+"."}doesEditorChangeRequireAlert(e,t){const n=!e||!t,r="md"===(null==e?void 0:e.package_info.file_type)||"md"===(null==t?void 0:t.package_info.file_type),i="html"===(null==e?void 0:e.package_info.file_type)&&"html"===(null==t?void 0:t.package_info.file_type);return!(n||r||i)}async showEditorChangeAlert(){return await this.alertService.confirm("Doing so might result in minor formatting changes.","Are you sure you want to change this note's type?","Yes, change it")}}var De,Re=n(9382);function Ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Fe extends o.AbstractService{constructor(e,t,n,a,s,c,l,u,d,p,h){super(h),Ne(this,"storageService",void 0),Ne(this,"apiService",void 0),Ne(this,"itemManager",void 0),Ne(this,"webSocketsService",void 0),Ne(this,"settingsService",void 0),Ne(this,"userService",void 0),Ne(this,"syncService",void 0),Ne(this,"alertService",void 0),Ne(this,"sessionManager",void 0),Ne(this,"crypto",void 0),Ne(this,"internalEventBus",void 0),Ne(this,"deinited",!1),Ne(this,"roles",[]),Ne(this,"features",[]),Ne(this,"enabledExperimentalFeatures",[]),Ne(this,"removeWebSocketsServiceObserver",void 0),Ne(this,"removefeatureReposObserver",void 0),Ne(this,"removeSignInObserver",void 0),Ne(this,"needsInitialFeaturesUpdate",!0),Ne(this,"completedSuccessfulFeaturesRetrieval",!1),this.storageService=e,this.apiService=t,this.itemManager=n,this.webSocketsService=a,this.settingsService=s,this.userService=c,this.syncService=l,this.alertService=u,this.sessionManager=d,this.crypto=p,this.internalEventBus=h,this.removeWebSocketsServiceObserver=a.addEventObserver((async(e,t)=>{if(e===G.UserRoleMessageReceived){const{payload:{userUuid:e,currentRoles:n}}=t;await this.updateRolesAndFetchFeatures(e,n)}})),this.removefeatureReposObserver=this.itemManager.addObserver(r.ContentType.ExtensionRepo,(async e=>{let{changed:t,inserted:n,source:r}=e;if([i.PayloadEmitSource.InitialObserverRegistrationPush,i.PayloadEmitSource.LocalInserted,i.PayloadEmitSource.LocalDatabaseLoaded,i.PayloadEmitSource.RemoteRetrieved,i.PayloadEmitSource.FileImport].includes(r)){const e=[...t,...n];this.sessionManager.isSignedIntoFirstPartyServer()?await this.migrateFeatureRepoToUserSetting(e):await this.migrateFeatureRepoToOfflineEntitlements(e)}})),this.removeSignInObserver=this.userService.addEventObserver((e=>{if(e===o.AccountEvent.SignedInOrRegistered){const e=this.itemManager.getItems(r.ContentType.ExtensionRepo);this.apiService.isThirdPartyHostUsed()||this.migrateFeatureRepoToUserSetting(e)}}))}async handleEvent(e){if(e.type===o.ApiServiceEvent.MetaReceived){if(!this.syncService)return void this.log("[Features Service] Handling events interrupted. Sync service is not yet initialized.",e);if(!this.syncService.completedOnlineDownloadFirstSync)return;const{userUuid:t,userRoles:n}=e.payload;await this.updateRolesAndFetchFeatures(t,n.map((e=>e.name)))}}async handleApplicationStage(e){if(await super.handleApplicationStage(e),e===o.ApplicationStage.FullSyncCompleted_13&&(this.addDarkTheme(),!this.hasOnlineSubscription())){const e=this.getOfflineRepo();e&&this.downloadOfflineFeatures(e)}}async addDarkTheme(){const e=he.FindNativeFeature(he.FeatureIdentifier.DarkTheme);e&&await this.mapRemoteNativeFeaturesToItems([e])}enableExperimentalFeature(e){const t=this.getUserFeature(e);if(!t)throw Error("Attempting to enable a feature user does not have access to.");this.enabledExperimentalFeatures.push(e),this.storageService.setValue(o.StorageKey.ExperimentalFeatures,this.enabledExperimentalFeatures),this.mapRemoteNativeFeaturesToItems([t]),this.notifyEvent(o.FeaturesEvent.FeaturesUpdated)}disableExperimentalFeature(e){if(!this.getUserFeature(e))throw Error("Attempting to disable a feature user does not have access to.");(0,d.removeFromArray)(this.enabledExperimentalFeatures,e),this.storageService.setValue(o.StorageKey.ExperimentalFeatures,this.enabledExperimentalFeatures);const t=this.itemManager.getItems([r.ContentType.Component,r.ContentType.Theme]).find((t=>t.identifier===e));t&&(this.itemManager.setItemToBeDeleted(t).then((()=>{this.syncService.sync()})),this.notifyEvent(o.FeaturesEvent.FeaturesUpdated))}toggleExperimentalFeature(e){this.isExperimentalFeatureEnabled(e)?this.disableExperimentalFeature(e):this.enableExperimentalFeature(e)}getExperimentalFeatures(){return he.ExperimentalFeatures}isExperimentalFeature(e){return this.getExperimentalFeatures().includes(e)}getEnabledExperimentalFeatures(){return this.enabledExperimentalFeatures}isExperimentalFeatureEnabled(e){return this.enabledExperimentalFeatures.includes(e)}async setOfflineFeaturesCode(e){try{const t=e.replace(/\s/g,""),n=this.crypto.base64Decode(t),o=this.parseOfflineEntitlementsCode(n);if(o instanceof p.ClientDisplayableError)return o;const a=await this.itemManager.createItem(r.ContentType.ExtensionRepo,(0,i.FillItemContent)({offlineFeaturesUrl:o.featuresUrl,offlineKey:o.extensionKey,migratedToOfflineEntitlements:!0}),!0);return this.syncService.sync(),this.downloadOfflineFeatures(a)}catch(e){return new p.ClientDisplayableError(o.API_MESSAGE_FAILED_OFFLINE_ACTIVATION)}}getOfflineRepo(){return this.itemManager.getItems(r.ContentType.ExtensionRepo).filter((e=>e.migratedToOfflineEntitlements))[0]}hasOfflineRepo(){return null!=this.getOfflineRepo()}async deleteOfflineFeatureRepo(){const e=this.getOfflineRepo();e&&(await this.itemManager.setItemToBeDeleted(e),this.syncService.sync()),await this.storageService.removeValue(o.StorageKey.UserFeatures)}parseOfflineEntitlementsCode(e){try{const{featuresUrl:t,extensionKey:n}=JSON.parse(e);return{featuresUrl:t,extensionKey:n}}catch(e){return new p.ClientDisplayableError(o.API_MESSAGE_FAILED_OFFLINE_ACTIVATION)}}async downloadOfflineFeatures(e){const t=await this.apiService.downloadOfflineFeaturesFromRepo(e);if(t instanceof p.ClientDisplayableError)return t;await this.didDownloadFeatures(t.features)}async migrateFeatureRepoToUserSetting(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(const t of e)if(!t.migratedToUserSetting&&t.onlineUrl){const e=t.onlineUrl.match(/\w{32,64}/);if(e&&e.length>0){const n=e[0];await this.settingsService.updateSetting(Re.SettingName.ExtensionKey,n,!0),await this.itemManager.changeFeatureRepo(t,(e=>{e.migratedToUserSetting=!0}))}}}async migrateFeatureRepoToOfflineEntitlements(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(const t of e)if(!t.migratedToOfflineEntitlements&&t.onlineUrl){const e=t.onlineUrl,{origin:n}=new URL(e);if(!n.includes("https://extensions.standardnotes.org"))continue;const r=e.match(/\w{32,64}/);if(r&&r.length>0){const e=r[0],n=await this.itemManager.changeFeatureRepo(t,(t=>{t.offlineFeaturesUrl="https://api.standardnotes.com/v1/offline/features",t.offlineKey=e,t.migratedToOfflineEntitlements=!0}));await this.downloadOfflineFeatures(n)}}}initializeFromDisk(){this.roles=this.storageService.getValue(o.StorageKey.UserRoles,void 0,[]),this.features=this.storageService.getValue(o.StorageKey.UserFeatures,void 0,[]),this.enabledExperimentalFeatures=this.storageService.getValue(o.StorageKey.ExperimentalFeatures,void 0,[])}async updateRolesAndFetchFeatures(e,t){if((this.haveRolesChanged(t)||this.needsInitialFeaturesUpdate)&&(this.needsInitialFeaturesUpdate=!1,await this.setRoles(t),!this.hasOfflineRepo())){const t=await this.apiService.getUserFeatures(e);if(!t.error&&t.data&&!this.deinited){const e=t.data.features;await this.didDownloadFeatures(e)}}}async setRoles(e){this.roles=e,(0,d.arraysEqual)(this.roles,e)||this.notifyEvent(o.FeaturesEvent.UserRolesChanged),this.storageService.setValue(o.StorageKey.UserRoles,this.roles)}async didDownloadFeatures(e){e=e.filter((e=>!!he.FindNativeFeature(e.identifier))).map((e=>this.mapRemoteNativeFeatureToStaticFeature(e))),this.features=e,this.completedSuccessfulFeaturesRetrieval=!0,this.notifyEvent(o.FeaturesEvent.FeaturesUpdated),this.storageService.setValue(o.StorageKey.UserFeatures,this.features),await this.mapRemoteNativeFeaturesToItems(e)}isThirdPartyFeature(e){return!he.FindNativeFeature(e)}mapRemoteNativeFeatureToStaticFeature(e){const t=["expires_at","role_name","no_expire","permission_name"],n=he.FindNativeFeature(e.identifier);if(!n)throw Error("Attempting to map remote native to unfound static feature ".concat(e.identifier));const r=(0,d.Copy)(n);for(const n of t)r[n]=e[n];return r.expires_at&&(r.expires_at=(0,d.convertTimestampToMilliseconds)(r.expires_at)),r}getUserFeature(e){return this.features.find((t=>t.identifier===e))}hasOnlineSubscription(){const e=this.roles,t=[r.RoleName.CoreUser];return e.some((e=>!t.includes(e)))}hasPaidOnlineOrOfflineSubscription(){return this.hasOnlineSubscription()||this.hasOfflineRepo()}rolesBySorting(e){return Object.values(r.RoleName).filter((t=>e.includes(t)))}hasMinimumRole(e){const t=Object.values(r.RoleName),n=this.rolesBySorting(this.roles),i=t.indexOf((0,d.lastElement)(n));return t.indexOf(e)<=i}isFeatureDeprecated(e){var t;return!0===(null===(t=he.FindNativeFeature(e))||void 0===t?void 0:t.deprecated)}isFreeFeature(e){return[he.FeatureIdentifier.DarkTheme].includes(e)}getFeatureStatus(e){if(this.isFreeFeature(e))return o.FeatureStatus.Entitled;if(this.isFeatureDeprecated(e))return this.hasPaidOnlineOrOfflineSubscription()?o.FeatureStatus.Entitled:o.FeatureStatus.NoUserSubscription;if(null==he.FindNativeFeature(e)){const t=this.itemManager.getDisplayableComponents().find((t=>t.identifier===e));return t?t.isExpired?o.FeatureStatus.InCurrentPlanButExpired:o.FeatureStatus.Entitled:o.FeatureStatus.NoUserSubscription}if(!this.hasPaidOnlineOrOfflineSubscription())return o.FeatureStatus.NoUserSubscription;if(!(this.completedSuccessfulFeaturesRetrieval||this.features.length>0))return o.FeatureStatus.Entitled;const t=this.getUserFeature(e);return t?t.expires_at&&new Date(t.expires_at).getTime()<(new Date).getTime()?this.roles.includes(t.role_name)?o.FeatureStatus.InCurrentPlanButExpired:o.FeatureStatus.NotInCurrentPlan:o.FeatureStatus.Entitled:o.FeatureStatus.NotInCurrentPlan}haveRolesChanged(e){return e.some((e=>!this.roles.includes(e)))||this.roles.some((t=>!e.includes(t)))}componentContentForNativeFeatureDescription(e){const t={area:e.area,name:e.name,package_info:e,valid_until:new Date(e.expires_at||0)};return(0,i.FillItemContent)(t)}async mapRemoteNativeFeaturesToItems(e){const t=this.itemManager.getItems([r.ContentType.Component,r.ContentType.Theme]),n=[];let i=!1;for(const r of e)await this.mapNativeFeatureToItem(r,t,n)&&(i=!0);await this.itemManager.setItemsToBeDeleted(n),i&&this.syncService.sync()}async mapNativeFeatureToItem(e,t,n){if(!e.content_type)return!1;if(this.isExperimentalFeature(e.identifier)&&!this.isExperimentalFeatureEnabled(e.identifier))return!1;let i=!1;const o=new Date,a=!this.isFreeFeature(e.identifier)&&new Date(e.expires_at||0).getTime()<o.getTime(),s=t.find((t=>!!t.content.package_info&&t.content.package_info.identifier===e.identifier));if(e.deprecated&&!s)return!1;let c=s;if(s){const t=new Date(e.expires_at||0);JSON.stringify(e)!==JSON.stringify(s.package_info)||t.getTime()!==s.valid_until.getTime()?(c=await this.itemManager.changeComponent(s,(n=>{n.package_info=e,n.valid_until=t})),i=!0):c=s}else a&&e.content_type!==r.ContentType.Component||(c=await this.itemManager.createItem(e.content_type,this.componentContentForNativeFeatureDescription(e),!0),i=!0);return a&&c&&e.content_type!==r.ContentType.Component&&(n.push(c),i=!0),i}async downloadExternalFeature(e){let t=e;try{t=this.crypto.base64Decode(e)}catch(e){}try{const e=[...g,...b],{host:n}=new URL(t);if(e.includes(n))return this.performDownloadExternalFeature(t);if(await this.alertService.confirm(o.API_MESSAGE_UNTRUSTED_EXTENSIONS_WARNING,"Install extension from an untrusted source?","Proceed to install",o.ButtonType.Danger,"Cancel"))return this.performDownloadExternalFeature(t)}catch(e){this.alertService.alert(o.INVALID_EXTENSION_URL)}}async performDownloadExternalFeature(e){const t=await this.apiService.downloadFeatureUrl(e);if(t.error)return void await this.alertService.alert(o.API_MESSAGE_FAILED_DOWNLOADING_EXTENSION);let n=t.data;if((0,d.isString)(n))try{n=JSON.parse(n)}catch(e){}if(!n.content_type)return;if(![r.ContentType.Component,r.ContentType.Theme,r.ContentType.ActionsExtension,r.ContentType.ExtensionRepo].includes(n.content_type))return;if(he.FindNativeFeature(n.identifier))return void await this.alertService.alert(o.API_MESSAGE_FAILED_DOWNLOADING_EXTENSION);if(n.url)for(const e of he.GetFeatures())if(n.url.includes(e.identifier))return void await this.alertService.alert(o.API_MESSAGE_FAILED_DOWNLOADING_EXTENSION);const a=(0,i.FillItemContent)({area:n.area,name:n.name,package_info:n,valid_until:new Date(n.expires_at||0),hosted_url:n.url});return this.itemManager.createTemplateItem(n.content_type,a)}deinit(){super.deinit(),this.removeSignInObserver(),this.removeSignInObserver=void 0,this.removeWebSocketsServiceObserver(),this.removeWebSocketsServiceObserver=void 0,this.removefeatureReposObserver(),this.removefeatureReposObserver=void 0,this.roles=void 0,this.storageService=void 0,this.apiService=void 0,this.itemManager=void 0,this.webSocketsService=void 0,this.settingsService=void 0,this.userService=void 0,this.syncService=void 0,this.alertService=void 0,this.sessionManager=void 0,this.crypto=void 0,this.deinited=!0}getDiagnostics(){return Promise.resolve({features:{roles:this.roles,features:this.features,enabledExperimentalFeatures:this.enabledExperimentalFeatures,needsInitialFeaturesUpdate:this.needsInitialFeaturesUpdate,completedSuccessfulFeaturesRetrieval:this.completedSuccessfulFeaturesRetrieval}})}}function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){Ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Le extends o.AbstractService{constructor(e,t,n,i,o,a){super(a),Ke(this,"itemManager",void 0),Ke(this,"storageService",void 0),Ke(this,"apiService",void 0),Ke(this,"protocolService",void 0),Ke(this,"deviceInterface",void 0),Ke(this,"internalEventBus",void 0),Ke(this,"removeChangeObserver",void 0),Ke(this,"historyStaging",{}),Ke(this,"history",{}),Ke(this,"itemRevisionThreshold",20),this.itemManager=e,this.storageService=t,this.apiService=n,this.protocolService=i,this.deviceInterface=o,this.internalEventBus=a,this.removeChangeObserver=this.itemManager.addObserver(r.ContentType.Note,(e=>{let{changed:t,inserted:n}=e;this.recordNewHistoryForItems(t.concat(n))}))}deinit(){this.itemManager=void 0,this.storageService=void 0,this.history=void 0,this.removeChangeObserver&&(this.removeChangeObserver(),this.removeChangeObserver=void 0),super.deinit()}recordNewHistoryForItems(e){for(const t of e){const e=this.history[t.uuid]||[],n=i.historyMapFunctions.getNewestRevision(e),r=new i.DecryptedPayload(t.payload),o=i.CreateHistoryEntryForPayload(r,n);if(o.isDiscardable())continue;const a=this.historyStaging[t.uuid];this.historyStaging[t.uuid]=o,a&&(a.isSameAsEntry(o)||n&&a.isSameAsEntry(n)||(e.unshift(a),this.history[t.uuid]=e,this.optimizeHistoryForItem(t.uuid)))}}sessionHistoryForItem(e){return this.history[e.uuid]||[]}getHistoryMapCopy(){const e=Object.assign({},this.history);for(const[t,n]of Object.entries(e))e[t]=n.slice();return Object.freeze(e)}async remoteHistoryForItem(e){const t=await this.apiService.getItemRevisions(e.uuid);if(!t.error&&!(0,d.isNullOrUndefined)(t.data))return t.data}async fetchRemoteRevision(e,t){const n=await this.apiService.getRevision(t,e.uuid);if(n.error||(0,d.isNullOrUndefined)(n.data))return;const r=n.data,o=new i.EncryptedPayload(je(je(je({},(0,i.PayloadTimestampDefaults)()),r),{},{updated_at:new Date(r.updated_at),created_at:new Date(r.created_at),waitingForKey:!1,errorDecrypting:!1})),a=this.protocolService.getEmbeddedPayloadAuthenticatedData(o),s=null==a?void 0:a.u,c=o.copy({uuid:s||r.item_uuid});if(!i.isRemotePayloadAllowed(c))return void console.error("Remote payload is disallowed",c);const l=new i.EncryptedPayload(c),u=await this.protocolService.decryptSplitSingle({usesItemsKeyWithKeyLookup:{items:[l]}});return(0,i.isErrorDecryptingPayload)(u)?void 0:new i.HistoryEntry(u)}async deleteRemoteRevision(e,t){return await this.apiService.deleteRevision(e.uuid,t)}optimizeHistoryForItem(e){const t=this.history[e]||[];if(t.length<=this.itemRevisionThreshold)return;const n=e=>e.deltaSize()>25,r=[],i=(e,i,o)=>{if(o){if(r.unshift(e),n(e)&&-1===e.operationVector()){const e=t[i+1];e&&r.unshift(e)}}else(0,d.removeFromArray)(r,e)};for(let e=t.length-1;e>=0;e--){const r=t[e];i(r,e,0===e||e===t.length-1||n(r))}const o=t.filter((e=>r.includes(e)));this.history[e]=o}}class Ue{static isApplicableToCurrentData(e){const t=e.getItems(r.ContentType.Tag);for(const e of t)if(e.title.includes(i.TagFolderDelimitter)&&!e.parentId)return!0;return!1}static async run(e){const t=e.getItems(r.ContentType.Tag),n=(0,d.sortByKey)(t,"title");for(const t of n){const n=t.title.split(i.TagFolderDelimitter),r=1===n.length,o=!!t.parentId,a=n.some((e=>0===e.length));if(o||r||a)continue;const s=(0,d.withoutLastElement)(n),c=(0,d.lastElement)(n);if(!c)return;const l=await e.findOrCreateTagParentChain(s);await e.changeItem(t,(e=>{e.title=c,l&&e.makeChildOf(l)}))}}}function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){We(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function We(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ze extends o.AbstractService{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{supportsFileNavigation:!1},n=arguments.length>2?arguments[2]:void 0;super(n),We(this,"payloadManager",void 0),We(this,"options",void 0),We(this,"internalEventBus",void 0),We(this,"unsubChangeObserver",void 0),We(this,"observers",[]),We(this,"collection",void 0),We(this,"systemSmartViews",void 0),We(this,"tagItemsIndex",void 0),We(this,"navigationDisplayController",void 0),We(this,"tagDisplayController",void 0),We(this,"itemsKeyDisplayController",void 0),We(this,"componentDisplayController",void 0),We(this,"themeDisplayController",void 0),We(this,"fileDisplayController",void 0),We(this,"smartViewDisplayController",void 0),this.payloadManager=e,this.options=t,this.internalEventBus=n,this.payloadManager=e,this.systemSmartViews=this.rebuildSystemSmartViews({}),this.createCollection(),this.unsubChangeObserver=this.payloadManager.addObserver(r.ContentType.Any,this.setPayloads.bind(this))}rebuildSystemSmartViews(e){return this.systemSmartViews=i.BuildSmartViews(e,this.options),this.systemSmartViews}createCollection(){var e;this.collection=new i.ItemCollection,this.navigationDisplayController=new i.ItemDisplayController(this.collection,[r.ContentType.Note,r.ContentType.File],{sortBy:"created_at",sortDirection:"dsc",hiddenContentTypes:this.options.supportsFileNavigation?[]:[r.ContentType.File]}),this.tagDisplayController=new i.ItemDisplayController(this.collection,[r.ContentType.Tag],{sortBy:"title",sortDirection:"asc"}),this.itemsKeyDisplayController=new i.ItemDisplayController(this.collection,[r.ContentType.ItemsKey],{sortBy:"created_at",sortDirection:"asc"}),this.componentDisplayController=new i.ItemDisplayController(this.collection,[r.ContentType.Component],{sortBy:"created_at",sortDirection:"asc"}),this.themeDisplayController=new i.ItemDisplayController(this.collection,[r.ContentType.Theme],{sortBy:"title",sortDirection:"asc"}),this.smartViewDisplayController=new i.ItemDisplayController(this.collection,[r.ContentType.SmartView],{sortBy:"title",sortDirection:"asc"}),this.fileDisplayController=new i.ItemDisplayController(this.collection,[r.ContentType.File],{sortBy:"title",sortDirection:"asc"}),this.tagItemsIndex=new i.TagItemsIndex(this.collection,null===(e=this.tagItemsIndex)||void 0===e?void 0:e.observers)}get allDisplayControllers(){return[this.navigationDisplayController,this.tagDisplayController,this.itemsKeyDisplayController,this.componentDisplayController,this.themeDisplayController,this.smartViewDisplayController,this.fileDisplayController]}get invalidItems(){return this.collection.invalidElements()}createItemFromPayload(e){return i.CreateDecryptedItemFromPayload(e)}createPayloadFromObject(e){return new i.DecryptedPayload(e)}setPrimaryItemDisplayOptions(e){var t,n;const r={};e.views&&e.views.find((e=>e.uuid===i.SystemViewId.AllNotes))&&(void 0===e.includeArchived&&(r.includeArchived=!1),void 0===e.includeTrashed&&(r.includeTrashed=!1)),e.views&&e.views.find((e=>e.uuid===i.SystemViewId.ArchivedNotes))&&void 0===e.includeTrashed&&(r.includeTrashed=!1),e.views&&e.views.find((e=>e.uuid===i.SystemViewId.TrashedNotes))&&(e.includeArchived||(r.includeArchived=!0)),this.rebuildSystemSmartViews(Be(Be({},e),r));const o=null===(t=e.tags)||void 0===t?void 0:t.map((e=>this.collection.find(e.uuid))).filter((e=>null!=e)),a=null===(n=e.views)||void 0===n?void 0:n.map((e=>i.isSystemView(e)?this.systemSmartViews.find((t=>t.uuid===e.uuid)):this.collection.find(e.uuid))).filter((e=>null!=e)),s=Be(Be(Be({},e),r),{tags:o,views:a});s.sortBy===i.CollectionSort.Title&&(s.sortDirection="asc"===s.sortDirection?"dsc":"asc"),this.navigationDisplayController.setDisplayOptions(Be({customFilter:i.computeUnifiedFilterForDisplayOptions(s,this.collection)},s))}getDisplayableNotes(){return(0,d.assert)(2===this.navigationDisplayController.contentTypes.length),this.options.supportsFileNavigation?this.navigationDisplayController.items().filter(i.isNote):this.navigationDisplayController.items()}getDisplayableFiles(){return this.fileDisplayController.items()}getDisplayableNotesAndFiles(){return(0,d.assert)(this.options.supportsFileNavigation),this.navigationDisplayController.items()}getDisplayableTags(){return this.tagDisplayController.items()}getDisplayableItemsKeys(){return this.itemsKeyDisplayController.items()}getDisplayableComponents(){return[...this.componentDisplayController.items(),...this.themeDisplayController.items()]}deinit(){this.unsubChangeObserver(),this.options=void 0,this.unsubChangeObserver=void 0,this.payloadManager=void 0,this.collection=void 0,this.tagItemsIndex=void 0,this.tagDisplayController=void 0,this.navigationDisplayController=void 0,this.itemsKeyDisplayController=void 0,this.componentDisplayController=void 0,this.themeDisplayController=void 0,this.fileDisplayController=void 0,this.smartViewDisplayController=void 0}resetState(){this.createCollection()}findItem(e){return this.collection.findDecrypted(e)||this.findSystemSmartView(e)}findAnyItem(e){return this.collection.find(e)||this.findSystemSmartView(e)}findAnyItems(e){return this.collection.findAll(e)}findSystemSmartView(e){return this.systemSmartViews.find((t=>t.uuid===e))}findSureItem(e){return this.findItem(e)}findItems(e){return this.collection.findAllDecrypted(e)}findItemsIncludingBlanks(e){return this.collection.findAllDecryptedWithBlanks(e)}get items(){return this.collection.nondeletedElements().filter(i.isDecryptedItem)}allTrackedItems(){return this.collection.all()}hasTagsNeedingFoldersMigration(){return Ue.isApplicableToCurrentData(this)}addNoteCountChangeObserver(e){return this.tagItemsIndex.addCountChangeObserver(e)}allCountableNotesCount(){return this.tagItemsIndex.allCountableItemsCount()}countableNotesForTag(e){if(e instanceof i.SmartView){if(e.uuid===i.SystemViewId.AllNotes)return this.tagItemsIndex.allCountableItemsCount();throw Error("countableItemsForTag is not meant to be used for smart views.")}return this.tagItemsIndex.countableItemsForTag(e)}getNoteCount(){return this.noteCount}addObserver(e,t){Array.isArray(e)||(e=[e]);const n={contentType:e,callback:t};this.observers.push(n);const r=this.observers;return()=>{(0,d.removeFromArray)(r,n)}}itemsReferencingItem(e,t){const n=this.collection.uuidsThatReferenceUuid(e.uuid);let r=this.findItems(n);return t&&(r=r.filter((e=>(null==e?void 0:e.content_type)===t))),r}referencesForItem(e,t){const n=this.findSureItem(e.uuid).references.map((e=>e.uuid));let r=this.findItems(n);return t&&(r=r.filter((e=>(null==e?void 0:e.content_type)===t))),r}setPayloads(e){const{changed:t,inserted:n,discarded:r,ignored:o,unerrored:a,source:s,sourceKey:c}=e,l=e=>i.CreateItemFromPayload(e),u=new Set,d={changed:t.map((e=>(u.add(e.content_type),l(e)))),inserted:n.map((e=>(u.add(e.content_type),l(e)))),discarded:r.map((e=>(u.add(e.content_type),new i.DeletedItem(e)))),ignored:o.map((e=>(u.add(e.content_type),new i.EncryptedItem(e)))),unerrored:a.map((e=>(u.add(e.content_type),i.CreateDecryptedItemFromPayload(e))))};this.collection.onChange(d),this.tagItemsIndex.onChange(d);const p=Array.from(u.values());for(const e of this.allDisplayControllers)e.contentTypes.some((e=>p.includes(e)))&&e.onCollectionChange(d);this.notifyObserversByUiAdjustingDelta(d,s,c)}notifyObserversByUiAdjustingDelta(e,t,n){const r=[],o=[],a=[],s=[],c=[];for(const t of e.changed)i.isDeletedItem(t)?a.push(t):i.isDecryptedItem(t)?r.push(t):c.push(t);for(const t of e.inserted)i.isDeletedItem(t)?s.push(t):i.isDecryptedItem(t)&&o.push(t);const l=[...e.discarded,...a,...s,...c];this.notifyObservers(r,o,l,e.ignored,e.unerrored,t,n)}notifyObservers(e,t,n,i,o,a,s){const c=(e,t)=>e.filter((e=>t.includes(r.ContentType.Any)||t.includes(e.content_type))),l=this.observers.slice();for(const r of l){const l=c(e,r.contentType),u=c(t,r.contentType),d=c(n,r.contentType),p=c(i,r.contentType),h=c(o,r.contentType);0===l.length&&0===u.length&&0===d.length&&0===p.length&&0===h.length||r.callback({changed:l,inserted:u,removed:d,ignored:p,unerrored:h,source:a,sourceKey:s})}}async changeItem(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MutationType.UpdateUserTimestamps,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.PayloadEmitSource.LocalChanged,o=arguments.length>4?arguments[4]:void 0;return(await this.changeItems([e],t,n,r,o))[0]}async changeItems(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MutationType.UpdateUserTimestamps,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.PayloadEmitSource.LocalChanged,o=arguments.length>4?arguments[4]:void 0;const a=this.findItemsIncludingBlanks((0,d.Uuids)(e)),s=[];for(const e of a){if(!e)throw Error("Attempting to change non-existant item");const r=i.CreateDecryptedMutatorForItem(e,n);t&&t(r);const o=r.getResult();s.push(o)}return await this.payloadManager.emitPayloads(s,r,o),this.findItems(s.map((e=>e.uuid)))}async runTransactionalMutations(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.PayloadEmitSource.LocalChanged,n=arguments.length>2?arguments[2]:void 0;const r=[];for(const t of e){const e=this.findItem(t.itemUuid);if(!e)continue;const n=i.CreateDecryptedMutatorForItem(e,t.mutationType||i.MutationType.UpdateUserTimestamps);t.mutate(n);const o=n.getResult();r.push(o)}return await this.payloadManager.emitPayloads(r,t,n),this.findItems(r.map((e=>e.uuid)))}async runTransactionalMutation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.PayloadEmitSource.LocalChanged,n=arguments.length>2?arguments[2]:void 0;const r=this.findSureItem(e.itemUuid),o=i.CreateDecryptedMutatorForItem(r,e.mutationType||i.MutationType.UpdateUserTimestamps);e.mutate(o);const a=o.getResult();return await this.payloadManager.emitPayloads([a],t,n),this.findItem(a.uuid)}async changeNote(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MutationType.UpdateUserTimestamps,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.PayloadEmitSource.LocalChanged,o=arguments.length>4?arguments[4]:void 0;const a=this.findItem(e.uuid);if(!a)throw Error("Attempting to change non-existant note");const s=new i.NoteMutator(a,n);return this.applyTransform(s,t,r,o)}async changeTag(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MutationType.UpdateUserTimestamps,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.PayloadEmitSource.LocalChanged,o=arguments.length>4?arguments[4]:void 0;const a=this.findItem(e.uuid);if(!a)throw Error("Attempting to change non-existant tag");const s=new i.TagMutator(a,n);return await this.applyTransform(s,t,r,o),this.findSureItem(e.uuid)}async changeComponent(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MutationType.UpdateUserTimestamps,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.PayloadEmitSource.LocalChanged,o=arguments.length>4?arguments[4]:void 0;const a=this.findItem(e.uuid);if(!a)throw Error("Attempting to change non-existant component");const s=new i.ComponentMutator(a,n);return await this.applyTransform(s,t,r,o),this.findSureItem(e.uuid)}async changeFeatureRepo(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MutationType.UpdateUserTimestamps,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.PayloadEmitSource.LocalChanged,o=arguments.length>4?arguments[4]:void 0;const a=this.findItem(e.uuid);if(!a)throw Error("Attempting to change non-existant repo");const s=new i.FeatureRepoMutator(a,n);return await this.applyTransform(s,t,r,o),this.findSureItem(e.uuid)}async changeActionsExtension(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MutationType.UpdateUserTimestamps,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.PayloadEmitSource.LocalChanged,o=arguments.length>4?arguments[4]:void 0;const a=this.findItem(e.uuid);if(!a)throw Error("Attempting to change non-existant extension");const s=new i.ActionsExtensionMutator(a,n);return await this.applyTransform(s,t,r,o),this.findSureItem(e.uuid)}async changeItemsKey(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MutationType.UpdateUserTimestamps,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.PayloadEmitSource.LocalChanged,o=arguments.length>4?arguments[4]:void 0;const a=this.findItem(e.uuid);if(!a)throw Error("Attempting to change non-existant itemsKey");const s=new x.ItemsKeyMutator(a,n);return await this.applyTransform(s,t,r,o),this.findSureItem(e.uuid)}async applyTransform(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.PayloadEmitSource.LocalChanged,r=arguments.length>3?arguments[3]:void 0;t(e);const o=e.getResult();return this.payloadManager.emitPayload(o,n,r)}async setItemDirty(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(await this.setItemsDirty([e],t))[0]}async setItemsDirty(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.changeItems(e,void 0,t?i.MutationType.UpdateUserTimestamps:i.MutationType.NoUpdateUserTimestamps)}getDirtyItems(){return this.collection.dirtyElements().filter(i.isDecryptedOrDeletedItem)}async duplicateItem(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const r=this.findSureItem(e.uuid).payload.copy(),o=i.PayloadsByDuplicating({payload:r,baseCollection:this.payloadManager.getMasterCollection(),isConflict:t,additionalContent:n});return await this.payloadManager.emitPayloads(o,i.PayloadEmitSource.LocalChanged),this.findSureItem(o[0].uuid)}async createItem(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new i.DecryptedPayload(Be({uuid:d.UuidGenerator.GenerateUuid(),content_type:e,content:i.FillItemContent(t),dirty:n},i.PayloadTimestampDefaults()));return await this.payloadManager.emitPayload(r,i.PayloadEmitSource.LocalInserted),this.findSureItem(r.uuid)}createTemplateItem(e,t,n){const r=new i.DecryptedPayload(Be(Be({uuid:d.UuidGenerator.GenerateUuid(),content_type:e,content:i.FillItemContent(t||{})},i.PayloadTimestampDefaults()),n));return i.CreateDecryptedItemFromPayload(r)}isTemplateItem(e){return!this.findItem(e.uuid)}async insertItem(e){return this.emitItemFromPayload(e.payload,i.PayloadEmitSource.LocalChanged)}async insertItems(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.PayloadEmitSource.LocalInserted;return this.emitItemsFromPayloads(e.map((e=>e.payload)),t)}async emitItemFromPayload(e,t){return await this.payloadManager.emitPayload(e,t),this.findSureItem(e.uuid)}async emitItemsFromPayloads(e,t){await this.payloadManager.emitPayloads(e,t);const n=(0,d.Uuids)(e);return this.findItems(n)}async setItemToBeDeleted(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.PayloadEmitSource.LocalChanged;const n=this.collection.uuidsThatReferenceUuid(e.uuid),r=this.findAnyItem(e.uuid);if(!r)return;const o=new i.DeleteItemMutator(r,i.MutationType.UpdateUserTimestamps).getDeletedResult();await this.payloadManager.emitPayload(o,t);for(const e of n){const t=this.findItem(e);t&&await this.changeItem(t,(e=>{e.removeItemAsRelationship(r)}))}}async setItemsToBeDeleted(e){await Promise.all(e.map((e=>this.setItemToBeDeleted(e))))}getItems(e){return this.collection.allDecrypted(e)}getAnyItems(e){return this.collection.all(e)}itemsMatchingPredicate(e,t){return this.itemsMatchingPredicates(e,[t])}itemsMatchingPredicates(e,t){const n=this.getItems(e);return this.subItemsMatchingPredicates(n,t)}subItemsMatchingPredicates(e,t){return e.filter((e=>{for(const n of t)if(!e.satisfiesPredicate(n))return!1;return!0}))}getRootTags(){return this.getDisplayableTags().filter((e=>void 0===e.parentId))}findTagByTitle(e){const t=e.toLowerCase();return this.getDisplayableTags().find((e=>{var n;return(null===(n=e.title)||void 0===n?void 0:n.toLowerCase())===t}))}findTagByTitleAndParent(e,t){const n=e.toLowerCase();return(t?this.getTagChildren(t):this.getRootTags()).find((e=>{var t;return(null===(t=e.title)||void 0===t?void 0:t.toLowerCase())===n}))}searchTags(e,t){return(0,d.naturalSort)(this.getDisplayableTags().filter((n=>{const r=this.getTagLongTitle(n).toLowerCase().includes(e.toLowerCase()),i=!!t&&this.itemsReferencingItem(t).some((e=>(null==e?void 0:e.uuid)===n.uuid));return r&&!i})),"title")}getTagParent(e){const t=this.findItem(e.uuid);if(!t)return;const n=t.parentId;return n?this.findItem(n):void 0}getTagPrefixTitle(e){const t=this.getTagParentChain(e);if(0===t.length)return;const n=t.map((e=>e.title)).join("/");return"".concat(n,"/")}getTagLongTitle(e){return[...this.getTagParentChain(e),e].map((e=>e.title)).join("/")}getTagParentChain(e){const t=this.findItem(e.uuid);if(!t)return[];let n=t.parentId;const r=[];for(;n;){const e=this.findItem(n);if(!e)return r;r.unshift(e),n=e.parentId}return r}async findOrCreateTagParentChain(e){let t;for(const n of e)t=await this.findOrCreateTagByTitle(n,t);if(!t)throw new Error("Invalid tag hierarchy");return t}getTagChildren(e){const t=this.findItem(e.uuid);return t?this.collection.elementsReferencingElement(t,r.ContentType.Tag).filter((t=>t.parentId===e.uuid)):[]}isTagAncestor(e,t){const n=this.findItem(t.uuid);if(!n)return!1;let r=n.parentId;for(;r;){if(r===e.uuid)return!0;const t=this.findItem(r);if(!t)return!1;r=t.parentId}return!1}isValidTagParent(e,t){return e.uuid!==t.uuid&&!this.isTagAncestor(t,e)}setTagParent(e,t){if(e.uuid===t.uuid)throw new Error("Can not set a tag parent of itself");if(this.isTagAncestor(t,e))throw new Error("Can not set a tag ancestor of itself");return this.changeTag(t,(t=>{t.makeChildOf(e)}))}unsetTagParent(e){return this.getTagParent(e)?this.changeTag(e,(e=>{e.unsetParent()})):Promise.resolve(e)}async associateFileWithNote(e,t){return this.changeItem(e,(e=>{e.addNote(t)}))}async disassociateFileWithNote(e,t){return this.changeItem(e,(e=>{e.removeNote(t)}))}async addTagToNote(e,t,n){let r=[t];return n&&(r=[...this.getTagParentChain(t),t]),Promise.all(r.map((t=>this.changeTag(t,(t=>{t.addNote(e)})))))}async addTagToFile(e,t,n){let r=[t];return n&&(r=[...this.getTagParentChain(t),t]),Promise.all(r.map((t=>this.changeTag(t,(t=>{t.addFile(e)})))))}async linkNoteToNote(e,t){return this.changeItem(e,(e=>{e.addNote(t)}))}async linkFileToFile(e,t){return this.changeItem(e,(e=>{e.addFile(t)}))}async unlinkItems(e,t){const n=this.relationshipDirectionBetweenItems(e,t);if(n===o.ItemRelationshipDirection.NoRelationship)throw new Error("Trying to unlink already unlinked items");const r=n===o.ItemRelationshipDirection.AReferencesB?e:t,i=r===e?t:e;return this.changeItem(r,(e=>{e.removeItemAsRelationship(i)}))}getSortedTagsForItem(e){return(0,d.naturalSort)(this.itemsReferencingItem(e).filter((e=>(null==e?void 0:e.content_type)===r.ContentType.Tag)),"title")}async createTag(e,t){const n=await this.createItem(r.ContentType.Tag,i.FillItemContent({title:e}),!0);if(t){const e=this.findItem(t.uuid);if(!e)throw new Error("Invalid parent tag");return this.changeTag(n,(t=>{t.makeChildOf(e)}))}return n}async createSmartView(e,t){return this.createItem(r.ContentType.SmartView,i.FillItemContent({title:e,predicate:t.toJson()}),!0)}async createSmartViewFromDSL(e){let t=null;try{t=JSON.parse(e.substring(1,e.length))}catch(e){throw Error("Invalid smart view syntax")}const n=t[0],r=i.predicateFromDSLString(e);return this.createSmartView(n,r)}async createTagOrSmartView(e){return this.isSmartViewTitle(e)?this.createSmartViewFromDSL(e):this.createTag(e)}isSmartViewTitle(e){return e.startsWith(i.SMART_TAG_DSL_PREFIX)}async findOrCreateTagByTitle(e,t){return this.findTagByTitleAndParent(e,t)||this.createTag(e,t)}notesMatchingSmartView(e){const t={views:[e]};return i.itemsMatchingOptions(t,this.collection.allDecrypted(r.ContentType.Note),this.collection)}get allNotesSmartView(){return this.systemSmartViews.find((e=>e.uuid===i.SystemViewId.AllNotes))}get archivedSmartView(){return this.systemSmartViews.find((e=>e.uuid===i.SystemViewId.ArchivedNotes))}get trashSmartView(){return this.systemSmartViews.find((e=>e.uuid===i.SystemViewId.TrashedNotes))}get untaggedNotesSmartView(){return this.systemSmartViews.find((e=>e.uuid===i.SystemViewId.UntaggedNotes))}get trashedItems(){return this.notesMatchingSmartView(this.trashSmartView)}async emptyTrash(){const e=this.trashedItems;await this.setItemsToBeDeleted(e)}getSmartViews(){const e=this.smartViewDisplayController.items();return this.systemSmartViews.concat(e)}get noteCount(){return this.collection.all(r.ContentType.Note).length}async removeAllItemsFromMemory(){const e=(0,d.Uuids)(this.items),t=[];for(const n of e){const e=new i.DeleteItemMutator(this.findSureItem(n),i.MutationType.NonDirtying);t.push(e.getDeletedResult())}await this.payloadManager.emitPayloads(t,i.PayloadEmitSource.LocalChanged),this.resetState(),this.payloadManager.resetState()}removeItemLocally(e){this.collection.discard([e]),this.payloadManager.removePayloadLocally(e.payload);const t=i.CreateItemDelta({discarded:[e]});for(const n of this.allDisplayControllers)n.contentTypes.some((t=>t===e.content_type))&&n.onCollectionChange(t)}renameFile(e,t){return this.changeItem(e,(e=>{e.name=t}))}async setLastSyncBeganForItems(e,t,n){const r=(0,d.Uuids)(e),o=this.collection.findAll(r).filter(i.isDecryptedOrDeletedItem),a=[];for(const e of o){const r=new i.ItemMutator(e,i.MutationType.NonDirtying);r.setBeginSync(t,n);const o=r.getResult();a.push(o)}return await this.payloadManager.emitPayloads(a,i.PayloadEmitSource.PreSyncSave),this.findAnyItems(r)}relationshipDirectionBetweenItems(e,t){const n=!!e.references.find((e=>e.uuid===t.uuid)),r=!!t.references.find((t=>t.uuid===e.uuid));return n?o.ItemRelationshipDirection.AReferencesB:r?o.ItemRelationshipDirection.BReferencesA:o.ItemRelationshipDirection.NoRelationship}getDiagnostics(){return Promise.resolve({items:{allIds:(0,d.Uuids)(this.collection.all())}})}}function He(e,t){return(0,r.leftVersionGreaterThanOrEqualToRight)(e.version,t.version)}function Ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class qe{constructor(e,t,n,r,i,o){Ge(this,"queueItem",void 0),Ge(this,"itemManager",void 0),Ge(this,"protocolService",void 0),Ge(this,"challengeService",void 0),Ge(this,"clientParams",void 0),Ge(this,"serverParams",void 0),this.queueItem=e,this.itemManager=t,this.protocolService=n,this.challengeService=r,this.clientParams=i,this.serverParams=o}async run(){let e=!1;if(this.serverParams&&this.clientParams&&!this.clientParams.compare(this.serverParams)&&this.queueItem.keyParams.compare(this.serverParams)&&He(this.serverParams,this.clientParams)){const t=(0,d.dateSorted)(this.itemManager.getItems(r.ContentType.ItemsKey),"created_at",!1)[0];e=!t||this.queueItem.encryptedKey.created_at>t.created_at}const t=await(0,o.DecryptItemsKeyByPromptingUser)(this.queueItem.encryptedKey,this.protocolService,this.challengeService,this.queueItem.keyParams);return"aborted"===t?{aborted:!0}:"failed"===t?{aborted:!1}:{rootKey:t.rootKey,replaceLocalRootKeyWithResult:e,decryptedItemsKey:t.decryptedKey}}}function Qe(e){return"rootKey"in e}function Ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.KeysRecovered="KeysRecovered"}(De||(De={}));class $e extends o.AbstractService{constructor(e,t,n,o,a,s,c,l,u,d){super(d),Ye(this,"itemManager",void 0),Ye(this,"payloadManager",void 0),Ye(this,"apiService",void 0),Ye(this,"protocolService",void 0),Ye(this,"challengeService",void 0),Ye(this,"alertService",void 0),Ye(this,"storageService",void 0),Ye(this,"syncService",void 0),Ye(this,"userService",void 0),Ye(this,"internalEventBus",void 0),Ye(this,"removeItemObserver",void 0),Ye(this,"decryptionQueue",[]),Ye(this,"isProcessingQueue",!1),this.itemManager=e,this.payloadManager=t,this.apiService=n,this.protocolService=o,this.challengeService=a,this.alertService=s,this.storageService=c,this.syncService=l,this.userService=u,this.internalEventBus=d,this.removeItemObserver=this.payloadManager.addObserver([r.ContentType.ItemsKey],(e=>{let{changed:t,inserted:n,ignored:r,source:o}=e;if(o===i.PayloadEmitSource.LocalChanged)return;const a=t.concat(n).filter(i.isErrorDecryptingPayload);a.length>0&&this.handleUndecryptableItemsKeys(a),r.length>0&&this.handleIgnoredItemsKeys(r)}))}deinit(){this.itemManager=void 0,this.payloadManager=void 0,this.apiService=void 0,this.protocolService=void 0,this.challengeService=void 0,this.alertService=void 0,this.storageService=void 0,this.syncService=void 0,this.userService=void 0,this.removeItemObserver(),this.removeItemObserver=void 0,super.deinit()}async handleApplicationStage(e){super.handleApplicationStage(e),e===o.ApplicationStage.LoadedDatabase_12&&this.processPersistedUndecryptables()}async handleIgnoredItemsKeys(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.saveToUndecryptables(e),this.addKeysToQueue(e),await this.beginKeyRecovery()}async handleUndecryptableItemsKeys(e){this.addKeysToQueue(e),await this.beginKeyRecovery()}presentKeyRecoveryWizard(){const e=this.itemManager.invalidItems.filter((e=>e.content_type===r.ContentType.ItemsKey)).map((e=>e.payload));this.handleIgnoredItemsKeys(e,!1)}canAttemptDecryptionOfItem(e){const t=e.payload.items_key_id;return t?!!this.payloadManager.findOne(t)||new p.ClientDisplayableError("Unable to find key ".concat(t," for this item. You may try signing out and back in; if that doesn't help, check your backup files for a key with this ID and import it.")):new p.ClientDisplayableError("This item cannot be recovered.")}async processPersistedUndecryptables(){const e=this.getUndecryptables(),t=Object.values(e);if(0===t.length)return;const n=t.map((e=>new i.EncryptedPayload(e)));return this.handleIgnoredItemsKeys(n,!1)}getUndecryptables(){return this.storageService.getValue(o.StorageKey.KeyRecoveryUndecryptableItems,o.StorageValueModes.Default,{})}persistUndecryptables(e){this.storageService.setValue(o.StorageKey.KeyRecoveryUndecryptableItems,e)}saveToUndecryptables(e){const t=this.getUndecryptables();for(const n of e)t[n.uuid]=n.ejected();this.persistUndecryptables(t)}removeFromUndecryptables(e){const t=this.getUndecryptables();for(const n of e)delete t[n];this.persistUndecryptables(t)}getClientKeyParams(){return this.protocolService.getAccountKeyParams()}async performServerSignIn(){const e=new o.Challenge([new o.ChallengePrompt(o.ChallengeValidation.None,void 0,void 0,!0)],o.ChallengeReason.Custom,!0,x.KeyRecoveryStrings.KeyRecoveryLoginFlowReason),t=await this.challengeService.promptForChallengeResponse(e);if(!t)return;this.challengeService.completeChallenge(e);const n=t.values[0].value,r=this.getClientKeyParams(),i=await this.getLatestKeyParamsFromServer(r.identifier);if(!i||!He(i,r))return;const a=await this.protocolService.computeRootKey(n,i);return(await this.userService.correctiveSignIn(a)).error?(await this.alertService.alert(x.KeyRecoveryStrings.KeyRecoveryLoginFlowInvalidPassword),this.performServerSignIn()):(this.alertService.alert(x.KeyRecoveryStrings.KeyRecoveryRootKeyReplaced),a)}async getWrappingKeyIfApplicable(){if(!this.protocolService.hasPasscode())return;const{wrappingKey:e,canceled:t}=await this.challengeService.getWrappingKeyIfApplicable();return t?(await this.alertService.alert(x.KeyRecoveryStrings.KeyRecoveryPasscodeRequiredText,x.KeyRecoveryStrings.KeyRecoveryPasscodeRequiredTitle),this.getWrappingKeyIfApplicable()):e}addKeysToQueue(e){for(const t of e){const e=this.protocolService.getKeyEmbeddedKeyParams(t);if(!e)continue;const n={encryptedKey:t,keyParams:e};this.decryptionQueue.push(n)}}readdQueueItem(e){this.decryptionQueue.unshift(e)}async getLatestKeyParamsFromServer(e){const t=await this.apiService.getAccountKeyParams({email:e});return!t.error&&t.data?(0,x.KeyParamsFromApiResponse)(t):void 0}async beginKeyRecovery(){if(this.isProcessingQueue)return;this.isProcessingQueue=!0;const e=this.getClientKeyParams();let t;if(e&&(t=await this.getLatestKeyParamsFromServer(e.identifier)),null!=this.protocolService){if(!this.protocolService.hasAccount()&&!this.protocolService.hasPasscode()){const e=await this.performServerSignIn();if(e){const n=!0;await this.handleDecryptionOfAllKeysMatchingCorrectRootKey(e,n,t)}}await this.processQueue(t),t&&await this.potentiallyPerformFallbackSignInToUpdateOutdatedLocalRootKey(t),this.syncService.isOutOfSync()&&this.syncService.sync({checkIntegrity:!0})}}async potentiallyPerformFallbackSignInToUpdateOutdatedLocalRootKey(e){const t=this.getClientKeyParams();t&&!e.compare(t)&&He(e,t)&&await this.performServerSignIn()}async processQueue(e){let t=this.decryptionQueue[0];for(;t;){const n=await this.processQueueItem(t,e);if((0,d.removeFromArray)(this.decryptionQueue,t),!Qe(n)&&n.aborted)return void(this.isProcessingQueue=!1);t=this.decryptionQueue[0]}this.isProcessingQueue=!1}async processQueueItem(e,t){const n=this.getClientKeyParams(),r=new qe(e,this.itemManager,this.protocolService,this.challengeService,n,t),i=await r.run();return Qe(i)?(await this.handleDecryptionOfAllKeysMatchingCorrectRootKey(i.rootKey,i.replaceLocalRootKeyWithResult,t),i):(i.aborted||(await this.alertService.alert(x.KeyRecoveryStrings.KeyRecoveryUnableToRecover),this.readdQueueItem(e)),i)}async handleDecryptionOfAllKeysMatchingCorrectRootKey(e,t,n){if(t){const t=await this.getWrappingKeyIfApplicable();await this.protocolService.setRootKey(e,t)}const r=this.getClientKeyParams(),o=r&&n&&r.compare(n),a=this.removeElementsFromQueueForMatchingKeyParams(e.keyParams).map((e=>o&&!n.compare(e.keyParams)?e.encryptedKey.copy({dirty:!0,dirtyIndex:(0,i.getIncrementedDirtyIndex)()}):e.encryptedKey)),s=(await this.protocolService.decryptSplit({usesRootKey:{items:a,key:e}})).filter(i.isDecryptedPayload);this.payloadManager.emitPayloads(s,i.PayloadEmitSource.LocalChanged),await this.storageService.savePayloads(s),t?this.alertService.alert(x.KeyRecoveryStrings.KeyRecoveryRootKeyReplaced):this.alertService.alert(x.KeyRecoveryStrings.KeyRecoveryKeyRecovered),s.some((e=>e.dirty))&&await this.syncService.sync(),await this.notifyEvent(De.KeysRecovered,s),this.removeFromUndecryptables((0,d.Uuids)(s))}removeElementsFromQueueForMatchingKeyParams(e){const t=[],n=[];for(const r of this.decryptionQueue)r.keyParams.compare(e)?t.push(r):n.push(r);return this.decryptionQueue=n,t}getDiagnostics(){return Promise.resolve({keyRecovery:{queueLength:this.decryptionQueue.length,isProcessingQueue:this.isProcessingQueue}})}}function Je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Xe extends o.AbstractService{constructor(e,t,n,r,i,o,a){super(a),Je(this,"apiService",void 0),Je(this,"itemManager",void 0),Je(this,"settingsService",void 0),Je(this,"httpSerivce",void 0),Je(this,"protectionService",void 0),Je(this,"mutatorService",void 0),Je(this,"internalEventBus",void 0),this.apiService=e,this.itemManager=t,this.settingsService=n,this.httpSerivce=r,this.protectionService=i,this.mutatorService=o,this.internalEventBus=a}deinit(){this.itemManager=void 0,this.settingsService=void 0,this.apiService=void 0,this.httpSerivce=void 0,this.protectionService=void 0,this.mutatorService=void 0,super.deinit()}canRegisterNewListedAccount(){return null!=this.apiService.user}isNoteAuthorizedForListed(e){return e.authorizedForListed}async authorizeNoteForListed(e){return!1!==await this.protectionService.authorizeListedPublishing()&&(await this.mutatorService.changeAndSaveItem(e,(e=>{e.authorizedForListed=!0})),!0)}async requestNewListedAccount(){const e=await this.getSettingsBasedListedAccounts();if(!(await this.apiService.registerForListedAccount()).error)for(let t=0;t<4;t++){const t=await this.getSettingsBasedListedAccounts();if(t.length>e.length)return(0,d.lastElement)(t);await(0,d.sleep)(3e3,!1)}}async getListedAccounts(){return[...await this.getSettingsBasedListedAccounts(),...this.getLegacyListedAccounts()]}async getListedAccountInfo(e,t){const n=e.hostUrl;let r="".concat(n,"/authors/").concat(e.authorId,"/extension?secret=").concat(e.secret);t&&(r+="&item_uuid=".concat(t));const i=await this.httpSerivce.getAbsolute(r).catch((e=>{console.error(e)}));if(i&&!i.error&&i.data&&!(0,d.isString)(i.data))return i.data}async getSettingsBasedListedAccounts(){const e=await this.settingsService.getSetting(Re.SettingName.ListedAuthorSecrets);return e?JSON.parse(e):[]}getLegacyListedAccounts(){const e=this.itemManager.getItems(r.ContentType.ActionsExtension).filter((e=>e.isListedExtension)),t=[];for(const n of e){const e=n.url,r=new URL(e),i=r.pathname.split("/")[2],o=r.search.split("secret=")[1].split("&")[0];t.push({secret:o,authorId:i,hostUrl:r.origin})}return t}}function Ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class et extends o.AbstractService{constructor(e,t,n,r){super(r),Ze(this,"settingsService",void 0),Ze(this,"crypto",void 0),Ze(this,"featuresService",void 0),Ze(this,"internalEventBus",void 0),this.settingsService=e,this.crypto=t,this.featuresService=n,this.internalEventBus=r}async saveMfaSetting(e){return await this.settingsService.updateSetting(Re.SettingName.MfaSecret,e,!0)}async isMfaActivated(){return 0!=await this.settingsService.getDoesSensitiveSettingExist(Re.SettingName.MfaSecret)}async generateMfaSecret(){return this.crypto.generateOtpSecret()}async getOtpToken(e){return this.crypto.totpToken(e,Date.now(),6,30)}async enableMfa(e,t){if(null==t||t!==await this.getOtpToken(e))throw new Error(o.SignInStrings.IncorrectMfa);return this.saveMfaSetting(e)}async disableMfa(){return await this.settingsService.deleteSetting(Re.SettingName.MfaSecret)}isMfaFeatureAvailable(){var e;const t=this.featuresService.getUserFeature(he.FeatureIdentifier.TwoFactorAuth);return null!=t&&(!0===t.no_expire||(null!==(e=t.expires_at)&&void 0!==e?e:0)>Date.now())}deinit(){this.settingsService=void 0,this.crypto=void 0,this.featuresService=void 0,super.deinit()}}var tt=n(72186),nt=n(79437);function rt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class it extends o.AbstractService{constructor(e){super(e.internalEventBus),rt(this,"services",void 0),rt(this,"activeMigrations",void 0),rt(this,"baseMigration",void 0),this.services=e}deinit(){this.services=void 0,this.activeMigrations&&(this.activeMigrations.length=0),super.deinit()}async initialize(){await this.runBaseMigrationPreRun();const e=it.getRequiredMigrations(await this.getStoredSnjsVersion());this.activeMigrations=this.instantiateMigrationClasses(e),this.activeMigrations.length>0?(0,d.lastElement)(this.activeMigrations).onDone((async()=>{await this.markMigrationsAsDone()})):await this.services.deviceInterface.setRawStorageValue((0,o.namespacedKey)(this.services.identifier,o.RawStorageKey.SnjsVersion),h.in)}async markMigrationsAsDone(){await this.services.deviceInterface.setRawStorageValue((0,o.namespacedKey)(this.services.identifier,o.RawStorageKey.SnjsVersion),h.in)}async runBaseMigrationPreRun(){this.baseMigration=new tt._(this.services),await this.baseMigration.preRun()}async handleApplicationStage(e){await super.handleApplicationStage(e),await this.handleStage(e)}async handleApplicationEvent(e){e===o.ApplicationEvent.SignedIn&&await this.handleStage(o.ApplicationStage.SignedIn_30)}async hasPendingMigrations(){return it.getRequiredMigrations(await this.getStoredSnjsVersion()).length>0||await this.baseMigration.needsKeychainRepair()}async getStoredSnjsVersion(){const e=await this.services.deviceInterface.getRawStorageValue((0,o.namespacedKey)(this.services.identifier,o.RawStorageKey.SnjsVersion));if(!e)throw re.W.error(Error("Snjs version missing from storage, run base migration."));return e}static getRequiredMigrations(e){const t=[],n=nt.R_.sort(((e,t)=>(0,h.D8)(e.version(),t.version())));for(const r of n){const n=r.version();n!==e&&(0,h.jV)(e,n)&&t.push(r)}return t}instantiateMigrationClasses(e){return e.map((e=>new e(this.services)))}async handleStage(e){if(await this.baseMigration.handleStage(e),!this.activeMigrations)throw new Error("Invalid active migrations");for(const t of this.activeMigrations)await t.handleStage(e)}getDiagnostics(){return Promise.resolve({migrations:{activeMigrations:this.activeMigrations&&this.activeMigrations.map((e=>typeof e))}})}}function ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class at extends o.AbstractService{constructor(e,t,n,r,i,o,a,s,c){super(c),ot(this,"itemManager",void 0),ot(this,"syncService",void 0),ot(this,"protectionService",void 0),ot(this,"encryption",void 0),ot(this,"payloadManager",void 0),ot(this,"challengeService",void 0),ot(this,"componentManager",void 0),ot(this,"historyService",void 0),ot(this,"internalEventBus",void 0),this.itemManager=e,this.syncService=t,this.protectionService=n,this.encryption=r,this.payloadManager=i,this.challengeService=o,this.componentManager=a,this.historyService=s,this.internalEventBus=c}deinit(){super.deinit(),this.itemManager=void 0,this.syncService=void 0,this.protectionService=void 0,this.encryption=void 0,this.payloadManager=void 0,this.challengeService=void 0,this.componentManager=void 0,this.historyService=void 0}async insertItem(e){const t=(0,i.CreateDecryptedMutatorForItem)(e,i.MutationType.UpdateUserTimestamps).getResult();return await this.itemManager.emitItemFromPayload(t,i.PayloadEmitSource.LocalInserted)}async changeAndSaveItem(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;return await this.itemManager.changeItems([e],t,n?i.MutationType.UpdateUserTimestamps:i.MutationType.NoUpdateUserTimestamps,r),await this.syncService.sync(o),this.itemManager.findItem(e.uuid)}async changeAndSaveItems(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;await this.itemManager.changeItems(e,t,n?i.MutationType.UpdateUserTimestamps:i.MutationType.NoUpdateUserTimestamps,r),await this.syncService.sync(o)}async changeItem(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return await this.itemManager.changeItems([e],t,n?i.MutationType.UpdateUserTimestamps:i.MutationType.NoUpdateUserTimestamps),this.itemManager.findItem(e.uuid)}async changeItems(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.itemManager.changeItems(e,t,n?i.MutationType.UpdateUserTimestamps:i.MutationType.NoUpdateUserTimestamps)}async runTransactionalMutations(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.PayloadEmitSource.LocalChanged,n=arguments.length>2?arguments[2]:void 0;return this.itemManager.runTransactionalMutations(e,t,n)}async runTransactionalMutation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.PayloadEmitSource.LocalChanged,n=arguments.length>2?arguments[2]:void 0;return this.itemManager.runTransactionalMutation(e,t,n)}async protectItems(e){const t=await this.itemManager.changeItems(e,(e=>{e.protected=!0}),i.MutationType.NoUpdateUserTimestamps);return this.syncService.sync(),t}async unprotectItems(e,t){if(!await this.protectionService.authorizeAction(t,{fallBackToAccountPassword:!0,requireAccountPassword:!1,forcePrompt:!1}))return;const n=await this.itemManager.changeItems(e,(e=>{e.protected=!1}),i.MutationType.NoUpdateUserTimestamps);return this.syncService.sync(),n}async protectNote(e){return(await this.protectItems([e]))[0]}async unprotectNote(e){const t=await this.unprotectItems([e],o.ChallengeReason.UnprotectNote);return t?t[0]:void 0}async protectNotes(e){return this.protectItems(e)}async unprotectNotes(e){return await this.unprotectItems(e,o.ChallengeReason.UnprotectNote)||[]}async protectFile(e){return(await this.protectItems([e]))[0]}async unprotectFile(e){const t=await this.unprotectItems([e],o.ChallengeReason.UnprotectFile);return t?t[0]:void 0}async mergeItem(e,t){return this.itemManager.emitItemFromPayload(e.payloadRepresentation(),t)}createTemplateItem(e,t,n){return this.itemManager.createTemplateItem(e,t,n)}async setItemNeedsSync(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.itemManager.setItemDirty(e,t)}async setItemsNeedsSync(e){return this.itemManager.setItemsDirty(e)}async deleteItem(e){return this.deleteItems([e])}async deleteItems(e){await this.itemManager.setItemsToBeDeleted(e),await this.syncService.sync()}async emptyTrash(){await this.itemManager.emptyTrash(),await this.syncService.sync()}duplicateItem(e,t){const n=this.itemManager.duplicateItem(e,!1,t);return this.syncService.sync(),n}async migrateTagsToFolders(){return await Ue.run(this.itemManager),this.syncService.sync()}async setTagParent(e,t){await this.itemManager.setTagParent(e,t)}async unsetTagParent(e){await this.itemManager.unsetTagParent(e)}async findOrCreateTag(e){return this.itemManager.findOrCreateTagByTitle(e)}async createTagOrSmartView(e){return this.itemManager.createTagOrSmartView(e)}async toggleComponent(e){await this.componentManager.toggleComponent(e.uuid),await this.syncService.sync()}async toggleTheme(e){await this.componentManager.toggleTheme(e.uuid),await this.syncService.sync()}async importData(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.version){const t=e.version;if(!this.encryption.supportedVersions().includes(t))return{error:new p.ClientDisplayableError(o.InfoStrings.UnsupportedBackupFileVersion)};const n=this.encryption.getUserVersion();if(n&&1===(0,r.compareVersions)(t,n))return{error:new p.ClientDisplayableError(o.InfoStrings.BackupFileMoreRecentThanAccount)}}if(e.auth_params||e.keyParams){const e=new o.Challenge([new o.ChallengePrompt(o.ChallengeValidation.None,T.Input.FileAccountPassword,void 0,!0)],o.ChallengeReason.DecryptEncryptedFile,!0),n=await this.challengeService.promptForChallengeResponse(e);if(null==n)return{error:new p.ClientDisplayableError("Import aborted")};this.challengeService.completeChallenge(e),t=null==n?void 0:n.values[0].value}if(!await this.protectionService.authorizeFileImport())return{error:new p.ClientDisplayableError("Import aborted")};e.items=e.items.map((e=>(0,i.isEncryptedTransferPayload)(e)?(0,i.CreateEncryptedBackupFileContextPayload)(e):(0,i.CreateDecryptedBackupFileContextPayload)(e)));const a=await this.encryption.decryptBackupFile(e,t);if(a instanceof p.ClientDisplayableError)return{error:a};const s=a.filter(i.isDecryptedPayload).map((e=>{if(e.content_type===r.ContentType.Component&&e.content.active){const t=e;return(0,i.CopyPayloadWithContentOverride)(t,{active:!1})}return e})),c=await this.payloadManager.importPayloads(s,this.historyService.getHistoryMapCopy()),l=this.syncService.sync();return n&&await l,{affectedItems:this.itemManager.findItems(c),errorCount:a.length-s.length}}}function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){lt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ut extends o.AbstractService{constructor(e){super(e),lt(this,"internalEventBus",void 0),lt(this,"changeObservers",[]),lt(this,"collection",void 0),lt(this,"emitQueue",[]),this.internalEventBus=e,this.collection=new i.PayloadCollection}getMasterCollection(){return i.ImmutablePayloadCollection.FromCollection(this.collection)}deinit(){super.deinit(),this.changeObservers.length=0,this.resetState()}resetState(){this.collection=new i.PayloadCollection}find(e){return this.collection.findAll(e)}findOne(e){return this.collection.findAll([e])[0]}all(e){return this.collection.all(e)}get integrityPayloads(){return this.collection.integrityPayloads()}get nonDeletedItems(){return this.collection.nondeletedElements()}get invalidPayloads(){return this.collection.invalidElements()}async emitDeltaEmit(e,t){var n;return 0===e.emits.length&&0===(null===(n=e.ignored)||void 0===n?void 0:n.length)?[]:new Promise((n=>{const r={emit:e,sourceKey:t,resolve:n};this.emitQueue.push(r),1===this.emitQueue.length&&this.popQueue()}))}async emitPayload(e,t,n){return this.emitPayloads([e],t,n)}async emitPayloads(e,t,n){const r={emits:e,source:t};return this.emitDeltaEmit(r,n)}popQueue(){const e=this.emitQueue[0],{changed:t,inserted:n,discarded:r,unerrored:i}=this.applyPayloads(e.emit.emits);this.notifyChangeObservers(t,n,r,e.emit.ignored||[],i,e.emit.source,e.sourceKey),(0,d.removeFromArray)(this.emitQueue,e),e.resolve([...t,...n,...r]),this.emitQueue.length>0&&this.popQueue()}applyPayloads(e){const t=[],n=[],r=[],o=[];for(const a of e){if(!a.uuid||!a.content_type){console.error("Payload is corrupt",a);continue}this.log("applying payload",a.uuid,"globalDirtyIndexAtLastSync",a.globalDirtyIndexAtLastSync,"dirtyIndex",a.dirtyIndex,"dirty",a.dirty);const e=this.collection.find(a.uuid);(0,i.isDeletedPayload)(a)&&a.discardable?(this.collection.discard(a),r.push(a)):(this.collection.set(a),e?(t.push(a),(0,i.isEncryptedPayload)(e)&&(0,i.isDecryptedPayload)(a)&&o.push(a)):n.push(a))}return{changed:t,inserted:n,discarded:r,unerrored:o}}addObserver(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Array.isArray(e)||(e=[e]);const r={types:e,priority:n,callback:t};this.changeObservers.push(r);const i=this.changeObservers;return()=>{(0,d.removeFromArray)(i,r)}}notifyChangeObservers(e,t,n,i,o,a,s){const c=this.changeObservers.slice().sort(((e,t)=>e.priority<t.priority?-1:1)),l=(e,t)=>t.includes(r.ContentType.Any)?e.slice():e.slice().filter((e=>t.includes(e.content_type)));for(const r of c)r.callback({changed:l(e,r.types),inserted:l(t,r.types),discarded:l(n,r.types),ignored:l(i,r.types),unerrored:l(o,r.types),source:a,sourceKey:s})}async importPayloads(e,t){const n=e.map((e=>e.copy(void 0,i.PayloadSource.FileImport))),r=new i.DeltaFileImport(this.getMasterCollection(),n,t).result();return await this.emitDeltaEmit(r),(0,d.Uuids)(e)}removePayloadLocally(e){this.collection.discard(e)}erroredPayloadsForContentType(e){return this.collection.invalidElements().filter((t=>t.content_type===e))}async deleteErroredPayloads(e){const t=e.map((e=>new i.DeletedPayload(ct(ct({},e.ejected()),{},{deleted:!0,content:void 0,dirty:!0,dirtyIndex:(0,i.getIncrementedDirtyIndex)()}),e.source)));await this.emitPayloads(t,i.PayloadEmitSource.LocalChanged)}getDiagnostics(){return Promise.resolve({payloads:{integrityPayloads:this.integrityPayloads,nonDeletedItemCount:this.nonDeletedItems.length,invalidPayloadsCount:this.invalidPayloads.length}})}}function dt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class pt extends o.AbstractService{constructor(e,t,n,i){super(i),dt(this,"singletonManager",void 0),dt(this,"itemManager",void 0),dt(this,"syncService",void 0),dt(this,"internalEventBus",void 0),dt(this,"shouldReload",!0),dt(this,"reloading",!1),dt(this,"preferences",void 0),dt(this,"removeItemObserver",void 0),dt(this,"removeSyncObserver",void 0),this.singletonManager=e,this.itemManager=t,this.syncService=n,this.internalEventBus=i,this.removeItemObserver=t.addObserver(r.ContentType.UserPrefs,(()=>{this.shouldReload=!0})),this.removeSyncObserver=n.addEventObserver((e=>{e!==o.SyncEvent.SyncCompletedWithAllItemsUploaded&&e!==o.SyncEvent.LocalDataIncrementalLoad||this.reload()}))}deinit(){var e,t;null===(e=this.removeItemObserver)||void 0===e||e.call(this),null===(t=this.removeSyncObserver)||void 0===t||t.call(this),this.singletonManager=void 0,this.itemManager=void 0,super.deinit()}async handleApplicationStage(e){await super.handleApplicationStage(e),e===o.ApplicationStage.LoadedDatabase_12&&(this.preferences=this.singletonManager.findSingleton(r.ContentType.UserPrefs,i.SNUserPrefs.singletonPredicate),this.preferences&&this.notifyEvent(o.PreferencesServiceEvent.PreferencesChanged))}getValue(e,t){var n,r;return null!==(n=null===(r=this.preferences)||void 0===r?void 0:r.getPref(e))&&void 0!==n?n:t}async setValue(e,t){this.preferences&&(this.preferences=await this.itemManager.changeItem(this.preferences,(n=>{n.setPref(e,t)})),this.notifyEvent(o.PreferencesServiceEvent.PreferencesChanged),this.syncService.sync())}async reload(){if(this.shouldReload&&!this.reloading){this.reloading=!0;try{const e=this.preferences;this.preferences=await this.singletonManager.findOrCreateContentTypeSingleton(r.ContentType.UserPrefs,(0,i.FillItemContent)({})),((null==e?void 0:e.uuid)!==this.preferences.uuid||this.preferences.userModifiedDate>e.userModifiedDate)&&this.notifyEvent(o.PreferencesServiceEvent.PreferencesChanged),this.shouldReload=!1}finally{this.reloading=!1}}}}class ht{constructor(e){var t;t={},"map"in this?Object.defineProperty(this,"map",{value:t,enumerable:!0,configurable:!0,writable:!0}):this.map=t;for(const t of e)this.map[t.name]=t}getSettingValue(e,t){const n=this.map[e];return(null==n?void 0:n.value)||t}}function yt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ft{constructor(e,t){yt(this,"settingsApi",void 0),yt(this,"userProvider",void 0),this.settingsApi=e,this.userProvider=t}isReadyForModification(){return null!=this.getUser()}getUser(){return this.userProvider.getUser()}get userUuid(){const e=this.getUser();if(null==e||null==e.uuid)throw new Error(o.API_MESSAGE_INVALID_SESSION);return e.uuid}async listSettings(){const{error:e,data:t}=await this.settingsApi.listSettings(this.userUuid);if(null!=e)throw new Error(e.message);return null==t||null==t.settings?new ht([]):new ht(t.settings)}async getSetting(e){var t,n,r;const i=await this.settingsApi.getSetting(this.userUuid,e);if(i.status!==p.StatusCode.HttpBadRequest){if(null!=i.error)throw new Error(i.error.message);return null!==(t=null==i||null===(n=i.data)||void 0===n||null===(r=n.setting)||void 0===r?void 0:r.value)&&void 0!==t?t:void 0}}async getSubscriptionSetting(e){var t,n,r;const i=await this.settingsApi.getSubscriptionSetting(this.userUuid,e);if(i.status!==p.StatusCode.HttpBadRequest){if(null!=i.error)throw new Error(i.error.message);return null!==(t=null==i||null===(n=i.data)||void 0===n||null===(r=n.setting)||void 0===r?void 0:r.value)&&void 0!==t?t:void 0}}async getDoesSensitiveSettingExist(e){var t,n;const r=await this.settingsApi.getSetting(this.userUuid,e);if(r.status===p.StatusCode.HttpBadRequest)return!1;if(null!=r.error)throw new Error(r.error.message);return null!==(t=null===(n=r.data)||void 0===n?void 0:n.success)&&void 0!==t&&t}async updateSetting(e,t,n){const{error:r}=await this.settingsApi.updateSetting(this.userUuid,e,t,n);if(null!=r)throw new Error(r.message)}async deleteSetting(e){const{error:t}=await this.settingsApi.deleteSetting(this.userUuid,e);if(null!=t)throw new Error(t.message)}deinit(){this.settingsApi=void 0,this.userProvider=void 0}}function vt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class mt extends o.AbstractService{constructor(e,t,n){super(n),vt(this,"sessionManager",void 0),vt(this,"apiService",void 0),vt(this,"internalEventBus",void 0),vt(this,"provider",void 0),vt(this,"frequencyOptionsLabels",{[Re.EmailBackupFrequency.Disabled]:"No email backups",[Re.EmailBackupFrequency.Daily]:"Daily",[Re.EmailBackupFrequency.Weekly]:"Weekly"}),vt(this,"cloudProviderIntegrationUrlEndpoints",{[Re.CloudProvider.Dropbox]:"dropbox",[Re.CloudProvider.Google]:"gdrive",[Re.CloudProvider.OneDrive]:"onedrive"}),this.sessionManager=e,this.apiService=t,this.internalEventBus=n}initializeFromDisk(){this.provider=new ft(this.apiService,this.sessionManager)}async listSettings(){return this.provider.listSettings()}async getSetting(e){return this.provider.getSetting(e)}async getSubscriptionSetting(e){return this.provider.getSubscriptionSetting(e)}async updateSetting(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.provider.updateSetting(e,t,n)}async getDoesSensitiveSettingExist(e){return this.provider.getDoesSensitiveSettingExist(e)}async deleteSetting(e){return this.provider.deleteSetting(e)}getEmailBackupFrequencyOptionLabel(e){return this.frequencyOptionsLabels[e]}getCloudProviderIntegrationUrl(e,t){const{Dev:n,Prod:r}=S,i=t?n:r;return"".concat(i,"/").concat(this.cloudProviderIntegrationUrlEndpoints[e],"?redirect_url=").concat(i,"/components/cloudlink?")}deinit(){var e;null===(e=this.provider)||void 0===e||e.deinit(),this.provider=void 0,this.sessionManager=void 0,this.apiService=void 0}}function gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function St(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class bt extends o.AbstractService{constructor(e,t,n,r){super(r),St(this,"itemManager",void 0),St(this,"payloadManager",void 0),St(this,"syncService",void 0),St(this,"internalEventBus",void 0),St(this,"resolveQueue",[]),St(this,"removeItemObserver",void 0),St(this,"removeSyncObserver",void 0),this.itemManager=e,this.payloadManager=t,this.syncService=n,this.internalEventBus=r,this.addObservers()}deinit(){this.syncService=void 0,this.itemManager=void 0,this.payloadManager=void 0,this.resolveQueue.length=0,this.removeItemObserver(),this.removeItemObserver=void 0,this.removeSyncObserver(),this.removeSyncObserver=void 0,super.deinit()}popResolveQueue(){const e=this.resolveQueue.slice();return this.resolveQueue=[],e}addObservers(){this.removeItemObserver=this.itemManager.addObserver(r.ContentType.Any,(e=>{let{inserted:t,unerrored:n}=e;n.length>0&&(this.resolveQueue=this.resolveQueue.concat(n)),t.length>0&&(this.resolveQueue=this.resolveQueue.concat(t))})),this.removeSyncObserver=this.syncService.addEventObserver((async e=>{e!==o.SyncEvent.DownloadFirstSyncCompleted&&e!==o.SyncEvent.SyncCompletedWithAllItemsUploaded||await this.resolveSingletonsForItems(this.popResolveQueue(),e)}))}validItemsMatchingPredicate(e,t){return this.itemManager.itemsMatchingPredicate(e,t)}async resolveSingletonsForItems(e,t){if(0===e.length)return;const n=[];for(const t of e){if(n.includes(t)||!t.isSingleton)continue;const e=this.validItemsMatchingPredicate(t.content_type,t.singletonPredicate());(0,d.extendArray)(n,e||[]),!e||e.length<=1||await this.handleStrategy(e,t.singletonStrategy)}var r;n.length>0&&t===o.SyncEvent.SyncCompletedWithAllItemsUploaded&&await(null===(r=this.syncService)||void 0===r?void 0:r.sync())}async handleStrategy(e,t){if(t!==i.SingletonStrategy.KeepEarliest)throw"Unhandled singleton strategy";const n=e.sort(((e,t)=>e.created_at<t.created_at?-1:1)),r=(0,d.arrayByRemovingFromIndex)(n,0);await this.itemManager.setItemsToBeDeleted(r)}findSingleton(e,t){const n=this.validItemsMatchingPredicate(e,t);if(n.length>0)return n[0]}async findOrCreateContentTypeSingleton(e,t){const n=this.itemManager.getItems(e);if(n.length>0)return n[0];if(!this.syncService.getLastSyncDate()){let t;const n=this.itemManager.addObserver(e,(n=>{let{inserted:r}=n;if(r.length>0){const n=r.filter((t=>t.content_type===e));n.length>0&&(t=n[0])}}));if(await this.syncService.sync(),n(),t)return t;const r=this.itemManager.getItems(e);if(r.length>0)return r[0]}const r=this.payloadManager.erroredPayloadsForContentType(e);r.length&&await this.payloadManager.deleteErroredPayloads(r);const o=new i.DecryptedPayload(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(n),!0).forEach((function(t){St(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({uuid:d.UuidGenerator.GenerateUuid(),content_type:e,content:t,dirty:!0,dirtyIndex:(0,i.getIncrementedDirtyIndex)()},(0,i.PayloadTimestampDefaults)())),a=await this.itemManager.emitItemFromPayload(o,i.PayloadEmitSource.LocalInserted);return this.syncService.sync(),a}}var Pt,_t=n(70008);function wt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Et{constructor(e){var t,n;wt(this,"rawResponse",void 0),wt(this,"savedPayloads",void 0),wt(this,"retrievedPayloads",void 0),wt(this,"uuidConflictPayloads",void 0),wt(this,"dataConflictPayloads",void 0),wt(this,"rejectedPayloads",void 0),this.rawResponse=e,this.savedPayloads=(0,i.FilterDisallowedRemotePayloadsAndMap)((null===(t=e.data)||void 0===t?void 0:t.saved_items)||[]).map((e=>(0,i.CreateServerSyncSavedPayload)(e))),this.retrievedPayloads=(0,i.FilterDisallowedRemotePayloadsAndMap)((null===(n=e.data)||void 0===n?void 0:n.retrieved_items)||[]),this.dataConflictPayloads=(0,i.FilterDisallowedRemotePayloadsAndMap)(this.rawDataConflictItems),this.uuidConflictPayloads=(0,i.FilterDisallowedRemotePayloadsAndMap)(this.rawUuidConflictItems),this.rejectedPayloads=(0,i.FilterDisallowedRemotePayloadsAndMap)(this.rawRejectedPayloads),(0,d.deepFreeze)(this)}get error(){var e;return this.rawResponse.error||(null===(e=this.rawResponse.data)||void 0===e?void 0:e.error)}get status(){return this.rawResponse.status}get lastSyncToken(){var e;return null===(e=this.rawResponse.data)||void 0===e?void 0:e[p.ApiEndpointParam.LastSyncToken]}get paginationToken(){var e;return null===(e=this.rawResponse.data)||void 0===e?void 0:e[p.ApiEndpointParam.PaginationToken]}get numberOfItemsInvolved(){return this.allFullyFormedPayloads.length}get allFullyFormedPayloads(){return[...this.retrievedPayloads,...this.dataConflictPayloads,...this.uuidConflictPayloads,...this.rejectedPayloads]}get rawUuidConflictItems(){return this.rawConflictObjects.filter((e=>e.type===p.ConflictType.UuidConflict)).map((e=>e.unsaved_item||e.item))}get rawDataConflictItems(){return this.rawConflictObjects.filter((e=>e.type===p.ConflictType.ConflictingData)).map((e=>e.server_item||e.item))}get rawRejectedPayloads(){return this.rawConflictObjects.filter((e=>e.type===p.ConflictType.ContentTypeError||e.type===p.ConflictType.ContentError||e.type===p.ConflictType.ReadOnlyError)).map((e=>e.unsaved_item))}get rawConflictObjects(){var e,t;const n=(null===(e=this.rawResponse.data)||void 0===e?void 0:e.conflicts)||[],r=(null===(t=this.rawResponse.data)||void 0===t?void 0:t.unsaved)||[];return n.concat(r)}get hasError(){return!(0,d.isNullOrUndefined)(this.rawResponse.error)}}function Ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e[e.Response=1]="Response",e[e.StatusChanged=2]="StatusChanged"}(Pt||(Pt={}));const Ot=150;class It{constructor(e,t,n,r,i){Ct(this,"payloads",void 0),Ct(this,"receiver",void 0),Ct(this,"lastSyncToken",void 0),Ct(this,"paginationToken",void 0),Ct(this,"apiService",void 0),Ct(this,"id",(0,d.nonSecureRandomIdentifier)()),Ct(this,"pendingPayloads",void 0),Ct(this,"responses",[]),this.payloads=e,this.receiver=t,this.lastSyncToken=n,this.paginationToken=r,this.apiService=i,this.payloads=e,this.lastSyncToken=n,this.paginationToken=r,this.apiService=i,this.receiver=t,this.pendingPayloads=e.slice()}get payloadsSavedOrSaving(){return(0,d.arrayByDifference)(this.payloads,this.pendingPayloads)}popPayloads(e){const t=this.pendingPayloads.slice(0,e);return(0,d.subtractFromArray)(this.pendingPayloads,t),t}async run(){await this.receiver(Pt.StatusChanged,void 0,{completedUploadCount:this.totalUploadCount-this.pendingUploadCount,totalUploadCount:this.totalUploadCount});const e=this.popPayloads(this.upLimit),t=await this.apiService.sync(e,this.lastSyncToken,this.paginationToken,this.downLimit),n=new Et(t);this.responses.push(n),this.lastSyncToken=n.lastSyncToken,this.paginationToken=n.paginationToken;try{await this.receiver(Pt.Response,n)}catch(e){console.error("Sync handle response error",e)}if(!this.done)return this.run()}get done(){return 0===this.pendingPayloads.length&&!this.paginationToken}get pendingUploadCount(){return this.pendingPayloads.length}get totalUploadCount(){return this.payloads.length}get upLimit(){return Ot}get downLimit(){return Ot}get numberOfItemsInvolved(){let e=0;for(const t of this.responses)e+=t.numberOfItemsInvolved;return e}}class Mt{constructor(e){var t,n;n=void 0,(t="savedPayloads")in this?Object.defineProperty(this,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[t]=n,this.savedPayloads=e}}function At(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Tt{constructor(e,t){At(this,"payloads",void 0),At(this,"receiver",void 0),this.payloads=e,this.receiver=t}async run(){const e=this.payloads.map((e=>(0,i.CreateOfflineSyncSavedPayload)(e))),t=new Mt(e);await this.receiver(Pt.Response,t)}}function kt(e,t){return e.sort(((e,n)=>{const r=new Date(n.serverUpdatedAt).getTime()-new Date(e.serverUpdatedAt).getTime();let i=0,o=0;return i=t.indexOf(e.content_type),o=t.indexOf(n.content_type),-1===i&&(i=t.length),-1===o&&(o=t.length),i===o?r:i<o?-1:1}))}function Dt(e,t){return e.sort(((e,n)=>{const r=new Date(n.serverUpdatedAt).getTime()-new Date(e.serverUpdatedAt).getTime();let i=0,o=0;return i=t.indexOf(e.uuid),o=t.indexOf(n.uuid),-1===i&&(i=t.length),-1===o&&(o=t.length),i===o?r:i<o?-1:1}))}function Rt(e,t,n){const i=[],o=[],a=[];for(let n=0;n<e.length;n++){const s=e[n];s.content_type===r.ContentType.ItemsKey?i.push(s):t.includes(s.content_type)?o.push(s):a.push(s)}return{itemsKeyPayloads:i,contentTypePriorityPayloads:kt(o,t),remainingPayloads:Dt(a,n)}}function Nt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ft{constructor(e,t){Nt(this,"error",void 0),Nt(this,"interval",void 0),Nt(this,"receiver",void 0),Nt(this,"completedUpload",0),Nt(this,"totalUpload",0),Nt(this,"downloaded",0),Nt(this,"databaseLoadCurrent",0),Nt(this,"databaseLoadTotal",0),Nt(this,"databaseLoadDone",!1),Nt(this,"syncing",!1),Nt(this,"syncStart",void 0),Nt(this,"timingMonitor",void 0),this.interval=e,this.receiver=t}deinit(){this.stopTimingMonitor()}setUploadStatus(e,t){this.completedUpload=e,this.totalUpload=t,this.receiver(o.SyncEvent.StatusChanged)}setDownloadStatus(e){this.downloaded+=e,this.receiver(o.SyncEvent.StatusChanged)}setDatabaseLoadStatus(e,t,n){this.databaseLoadCurrent=e,this.databaseLoadTotal=t,this.databaseLoadDone=n,n?this.receiver(o.SyncEvent.LocalDataLoaded):this.receiver(o.SyncEvent.LocalDataIncrementalLoad)}getStats(){return{uploadCompletionCount:this.completedUpload,uploadTotalCount:this.totalUpload,downloadCount:this.downloaded,localDataDone:this.databaseLoadDone,localDataCurrent:this.databaseLoadCurrent,localDataTotal:this.databaseLoadTotal}}setDidBegin(){this.syncing=!0,this.syncStart=new Date}setDidEnd(){this.syncing=!1}get syncInProgress(){return!0===this.syncing}get secondsSinceSyncStart(){return((new Date).getTime()-this.syncStart.getTime())/1e3}startTimingMonitor(){this.timingMonitor&&this.stopTimingMonitor(),this.timingMonitor=this.interval((()=>{this.secondsSinceSyncStart>5&&(this.receiver(o.SyncEvent.SyncTakingTooLong),this.stopTimingMonitor())}),500)}stopTimingMonitor(){Object.prototype.hasOwnProperty.call(this.interval,"cancel")?this.interval.cancel(this.timingMonitor):clearInterval(this.timingMonitor),this.timingMonitor=null}hasError(){return!!this.error}setError(e){this.error=e}clearError(){this.error=null}reset(){this.downloaded=0,this.completedUpload=0,this.totalUpload=0,this.syncing=!1,this.error=null,this.stopTimingMonitor(),this.receiver(o.SyncEvent.StatusChanged)}}function xt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class jt{constructor(e,t,n,r){xt(this,"payloadSet",void 0),xt(this,"baseCollection",void 0),xt(this,"payloadsSavedOrSaving",void 0),xt(this,"historyMap",void 0),this.payloadSet=e,this.baseCollection=t,this.payloadsSavedOrSaving=n,this.historyMap=r}result(){const e=[];return e.push(this.processRetrievedPayloads()),e.push(this.processSavedPayloads()),e.push(this.processUuidConflictPayloads()),e.push(this.processDataConflictPayloads()),e.push(this.processRejectedPayloads()),e}processSavedPayloads(){return new i.DeltaRemoteSaved(this.baseCollection,this.payloadSet.savedPayloads).result()}processRetrievedPayloads(){const e=i.ImmutablePayloadCollection.WithPayloads(this.payloadSet.retrievedPayloads);return new i.DeltaRemoteRetrieved(this.baseCollection,e,this.payloadsSavedOrSaving,this.historyMap).result()}processDataConflictPayloads(){const e=i.ImmutablePayloadCollection.WithPayloads(this.payloadSet.dataConflictPayloads);return new i.DeltaRemoteDataConflicts(this.baseCollection,e,this.historyMap).result()}processUuidConflictPayloads(){const e=i.ImmutablePayloadCollection.WithPayloads(this.payloadSet.uuidConflictPayloads);return new i.DeltaRemoteUuidConflicts(this.baseCollection,e).result()}processRejectedPayloads(){const e=i.ImmutablePayloadCollection.WithPayloads(this.payloadSet.rejectedPayloads);return new i.DeltaRemoteRejected(this.baseCollection,e).result()}}function Kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(n),!0).forEach((function(t){Ut(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vt(e,t){if(e.deleted)return new i.DeletedPayload(Lt(Lt({},e),{},{content:void 0,deleted:!0}),t);if(null!=e.content)return new i.EncryptedPayload(Lt(Lt({},e),{},{items_key_id:e.items_key_id,content:e.content,deleted:!1,errorDecrypting:!1,waitingForKey:!1}),t);throw Error("Unhandled case in createPayloadFromRawItem")}function Bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bt(Object(n),!0).forEach((function(t){zt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ht extends o.AbstractService{constructor(e,t,n,i,o,a,s,c,l){super(l),zt(this,"itemManager",void 0),zt(this,"sessionManager",void 0),zt(this,"protocolService",void 0),zt(this,"storageService",void 0),zt(this,"payloadManager",void 0),zt(this,"apiService",void 0),zt(this,"historyService",void 0),zt(this,"options",void 0),zt(this,"internalEventBus",void 0),zt(this,"dirtyIndexAtLastPresyncSave",void 0),zt(this,"lastSyncDate",void 0),zt(this,"outOfSync",!1),zt(this,"opStatus",void 0),zt(this,"resolveQueue",[]),zt(this,"spawnQueue",[]),zt(this,"completedOnlineDownloadFirstSync",!1),zt(this,"majorChangeThreshold",15),zt(this,"clientLocked",!1),zt(this,"databaseLoaded",!1),zt(this,"syncToken",void 0),zt(this,"cursorToken",void 0),zt(this,"syncLock",!1),zt(this,"_simulate_latency",void 0),zt(this,"dealloced",!1),zt(this,"lastSyncInvokationPromise",void 0),zt(this,"currentSyncRequestPromise",void 0),zt(this,"localLoadPriorty",[r.ContentType.ItemsKey,r.ContentType.UserPrefs,r.ContentType.Component,r.ContentType.Theme]),this.itemManager=e,this.sessionManager=t,this.protocolService=n,this.storageService=i,this.payloadManager=o,this.apiService=a,this.historyService=s,this.options=c,this.internalEventBus=l,this.opStatus=this.initializeStatus()}async onNewDatabaseCreated(){await this.getLastSyncToken()&&await this.clearSyncPositionTokens()}get launchPriorityUuids(){var e;return null!==(e=this.storageService.getValue(o.StorageKey.LaunchPriorityUuids))&&void 0!==e?e:[]}setLaunchPriorityUuids(e){this.storageService.setValue(o.StorageKey.LaunchPriorityUuids,e)}deinit(){this.dealloced=!0,this.sessionManager=void 0,this.itemManager=void 0,this.protocolService=void 0,this.payloadManager=void 0,this.storageService=void 0,this.apiService=void 0,this.opStatus.reset(),this.opStatus=void 0,this.resolveQueue.length=0,this.spawnQueue.length=0,super.deinit()}initializeStatus(){return new Ft(setInterval,(e=>{this.notifyEvent(e)}))}lockSyncing(){this.clientLocked=!0}unlockSyncing(){this.clientLocked=!1}isOutOfSync(){return this.outOfSync}getLastSyncDate(){return this.lastSyncDate}getSyncStatus(){return this.opStatus}resetSyncState(){this.dirtyIndexAtLastPresyncSave=void 0,this.lastSyncDate=void 0,this.outOfSync=!1}isDatabaseLoaded(){return this.databaseLoaded}async getDatabasePayloads(){return this.storageService.getAllRawPayloads().catch((e=>{throw this.notifyEvent(o.SyncEvent.DatabaseReadError,e),e}))}async processItemsKeysFirstDuringDatabaseLoad(e){const t=e.filter(i.isEncryptedPayload),n=e.filter(i.isDecryptedPayload),r={usesRootKeyWithKeyLookup:{items:t}},o=await this.protocolService.decryptSplit(r);await this.payloadManager.emitPayloads([...n,...o],i.PayloadEmitSource.LocalDatabaseLoaded)}async loadDatabasePayloads(e){if(this.databaseLoaded)throw"Attempting to initialize already initialized local database.";if(0===e.length)return this.databaseLoaded=!0,void this.opStatus.setDatabaseLoadStatus(0,0,!0);const t=e.map((e=>{try{return(0,i.CreatePayload)(e,i.PayloadSource.Constructor)}catch(e){return void console.error("Creating payload fail+ed",e)}})).filter(d.isNotUndefined),{itemsKeyPayloads:n,contentTypePriorityPayloads:r,remainingPayloads:o}=Rt(t,this.localLoadPriorty,this.launchPriorityUuids);await this.processItemsKeysFirstDuringDatabaseLoad(n),await this.processPayloadBatch(r);const a=o.length,s=this.options.loadBatchSize,c=Math.ceil(a/s);for(let e=0;e<c;e++){const t=e*s,n=o.slice(t,t+s);await this.processPayloadBatch(n,t,a)}this.databaseLoaded=!0,this.opStatus.setDatabaseLoadStatus(0,0,!0)}async processPayloadBatch(e,t,n){const r=[],a=[];for(const t of e)(0,i.isEncryptedPayload)(t)?r.push(t):a.push(t);const s={usesItemsKeyWithKeyLookup:{items:r}},c=await this.protocolService.decryptSplit(s);await this.payloadManager.emitPayloads([...a,...c],i.PayloadEmitSource.LocalDatabaseLoaded),this.notifyEvent(o.SyncEvent.LocalDataIncrementalLoad),null!=t&&null!=n&&this.opStatus.setDatabaseLoadStatus(t,n,!1),await(0,d.sleep)(1,!1)}setLastSyncToken(e){return this.syncToken=e,this.storageService.setValue(o.StorageKey.LastSyncToken,e)}async setPaginationToken(e){return this.cursorToken=e,e?this.storageService.setValue(o.StorageKey.PaginationToken,e):this.storageService.removeValue(o.StorageKey.PaginationToken)}async getLastSyncToken(){return this.syncToken||(this.syncToken=await this.storageService.getValue(o.StorageKey.LastSyncToken)),this.syncToken}async getPaginationToken(){return this.cursorToken||(this.cursorToken=await this.storageService.getValue(o.StorageKey.PaginationToken)),this.cursorToken}async clearSyncPositionTokens(){this.syncToken=void 0,this.cursorToken=void 0,await this.storageService.removeValue(o.StorageKey.LastSyncToken),await this.storageService.removeValue(o.StorageKey.PaginationToken)}itemsNeedingSync(){return this.itemManager.getDirtyItems()}async markAllItemsAsNeedingSyncAndPersist(){this.log("Marking all items as needing sync");const e=this.itemManager.items.map((e=>new i.DecryptedPayload(Wt(Wt({},e.payload.ejected()),{},{dirty:!0,dirtyIndex:(0,i.getIncrementedDirtyIndex)()}))));await this.payloadManager.emitPayloads(e,i.PayloadEmitSource.LocalChanged),await this.persistPayloads(e)}popPayloadsNeedingPreSyncSave(e){const t=this.dirtyIndexAtLastPresyncSave;if(null==t)return e;const n=e.filter((e=>!e.dirtyIndex||e.dirtyIndex>t));return this.dirtyIndexAtLastPresyncSave=(0,i.getCurrentDirtyIndex)(),n}queueStrategyResolveOnNext(){return new Promise(((e,t)=>{this.resolveQueue.push({resolve:e,reject:t})}))}queueStrategyForceSpawnNew(e){return new Promise(((t,n)=>{this.spawnQueue.push({resolve:t,reject:n,options:e})}))}popSpawnQueue(){if(0===this.spawnQueue.length)return null;const e=this.spawnQueue[0];return(0,d.removeFromIndex)(this.spawnQueue,0),this.log("Syncing again from spawn queue"),this.sync(Wt({queueStrategy:o.SyncQueueStrategy.ForceSpawnNew,source:o.SyncSource.SpawnQueue},e.options)).then((()=>{e.resolve()})).catch((()=>{e.reject()}))}async payloadsByPreparingForServer(e){const t=(0,i.CreatePayloadSplit)(e),n=(0,x.SplitPayloadsByEncryptionType)(t.decrypted),r=(0,x.CreateEncryptionSplitWithKeyLookup)(n);return[...(await this.protocolService.encryptSplit(r)).map(i.CreateEncryptedServerSyncPushPayload),...t.deleted.map(i.CreateDeletedServerSyncPushPayload)]}async downloadFirstSync(e,t){for(let n=0;n<5;n++){if(await this.sync(Wt({mode:o.SyncMode.DownloadFirst,queueStrategy:o.SyncQueueStrategy.ForceSpawnNew,source:o.SyncSource.External},t)).catch(console.error),this.completedOnlineDownloadFirstSync)return;await(0,d.sleep)(e)}console.error("Failed downloadFirstSync after ".concat(5," tries"))}async awaitCurrentSyncs(){await this.lastSyncInvokationPromise,await this.currentSyncRequestPromise}async sync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.clientLocked)return void this.log("Sync locked by client");const t=Wt({source:o.SyncSource.External},e);return this.lastSyncInvokationPromise=this.performSync(t),this.lastSyncInvokationPromise}async prepareForSync(e){const t=this.itemsNeedingSync(),n=new Date,r=(0,i.getCurrentDirtyIndex)(),o=t.filter((e=>e.neverSynced&&(0,i.isDeletedItem)(e)));(0,d.subtractFromArray)(t,o);const a=t.map((e=>e.payloadRepresentation())),s=this.popPayloadsNeedingPreSyncSave(a);return await this.persistPayloads(s),e.onPresyncSave&&e.onPresyncSave(),{items:t,beginDate:n,frozenDirtyIndex:r,neverSyncedDeleted:o}}configureSyncLock(){const e=this.opStatus.syncInProgress,t=this.databaseLoaded,n=!this.syncLock,r=n&&t&&!e;return r?this.syncLock=!0:this.log(n?e?"Attempting to sync while existing sync in progress.":"Attempting to sync before local database has loaded.":"Another function call has begun preparing for sync."),{shouldExecuteSync:r,releaseLock:()=>{this.syncLock=!1}}}deferSyncRequest(e){const t=(0,d.isNullOrUndefined)(e.queueStrategy)?o.SyncQueueStrategy.ResolveOnNext:e.queueStrategy;if(t===o.SyncQueueStrategy.ResolveOnNext)return this.queueStrategyResolveOnNext();if(t===o.SyncQueueStrategy.ForceSpawnNew)return this.queueStrategyForceSpawnNew({mode:e.mode,checkIntegrity:e.checkIntegrity,source:e.source});throw Error("Unhandled timing strategy ".concat(t))}async prepareForSyncExecution(e,t,n,r){return this.opStatus.setDidBegin(),await this.notifyEvent(o.SyncEvent.SyncWillBegin),(0,d.subtractFromArray)(this.resolveQueue,t),e.length>0?this.itemManager.setLastSyncBeganForItems(e,n,r):e}getPendingRequestsMadeInTimeToPiggyBackOnCurrentRequest(){return this.resolveQueue.slice()}getOfflineSyncParameters(e){return{uploadPayloads:(arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.SyncMode.Default)===o.SyncMode.Default?e:[]}}createOfflineSyncOperation(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.SyncMode.Default;return this.log("Syncing offline user","source:",t,"mode:",n,"payloads:",e),new Tt(e,(async(e,t)=>{this.dealloced||e===Pt.Response&&t&&await this.handleOfflineResponse(t)}))}async getOnlineSyncParameters(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.SyncMode.Default;const n=this.completedOnlineDownloadFirstSync?t:o.SyncMode.DownloadFirst;if(n===o.SyncMode.Default&&!this.completedOnlineDownloadFirstSync)throw Error("Attempting to default mode sync without having completed initial.");return{uploadPayloads:n===o.SyncMode.Default?await this.payloadsByPreparingForServer(e):[],syncMode:n}}async createServerSyncOperation(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.SyncMode.Default;const i=await this.getLastSyncToken(),a=await this.getPaginationToken(),s=new It(e,(async(e,t,n)=>{switch(e){case Pt.Response:if(this.dealloced)return;null!=t&&t.hasError?this.handleErrorServerResponse(t):t&&await this.handleSuccessServerResponse(s,t);break;case Pt.StatusChanged:n&&this.opStatus.setUploadStatus(n.completedUploadCount,n.totalUploadCount)}}),i,a,this.apiService);return this.log("Syncing online user","source",o.SyncSource[n],"operation id",s.id,"integrity check",t,"mode",o.SyncMode[r],"syncToken",i,"cursorToken",a,"payloads",e),s}async createSyncOperation(e,t,n){if(t){const{uploadPayloads:t,syncMode:r}=await this.getOnlineSyncParameters(e,n.mode);return{operation:await this.createServerSyncOperation(t,(0,d.useBoolean)(n.checkIntegrity,!1),n.source,r),mode:r}}{const{uploadPayloads:t}=this.getOfflineSyncParameters(e,n.mode);return{operation:this.createOfflineSyncOperation(t,n.source,n.mode),mode:n.mode||o.SyncMode.Default}}}async performSync(e){const{shouldExecuteSync:t,releaseLock:n}=this.configureSyncLock(),{items:r,beginDate:i,frozenDirtyIndex:a,neverSyncedDeleted:s}=await this.prepareForSync(e),c=this.getPendingRequestsMadeInTimeToPiggyBackOnCurrentRequest();if(!t)return this.deferSyncRequest(e);if(this.dealloced)return;const l=await this.prepareForSyncExecution(r,c,i,a),u=this.sessionManager.online(),{operation:d,mode:p}=await this.createSyncOperation(l.map((e=>e.payloadRepresentation())),u,e),h=d.run();if(this.currentSyncRequestPromise=h,await h,this.dealloced)return;n();const{hasError:y}=await this.handleSyncOperationFinish(d,e,s,p);y||await this.potentiallySyncAgainAfterSyncCompletion(p,e,c,u)||(e.checkIntegrity&&await this.notifyEventSync(o.SyncEvent.SyncRequestsIntegrityCheck,{source:e.source}),await this.notifyEventSync(o.SyncEvent.SyncCompletedWithAllItemsUploadedAndDownloaded,{source:e.source}),this.resolvePendingSyncRequestsThatMadeItInTimeOfCurrentRequest(c))}async handleOfflineResponse(e){this.log("Offline Sync Response",e);const t=this.payloadManager.getMasterCollection(),n=new i.DeltaOfflineSaved(t,e.savedPayloads).result(),r=await this.payloadManager.emitDeltaEmit(n);await this.persistPayloads(r),this.opStatus.clearError(),await this.notifyEvent(o.SyncEvent.SingleRoundTripSyncCompleted,e)}handleErrorServerResponse(e){var t;this.log("Sync Error",e),401===e.status&&this.notifyEvent(o.SyncEvent.InvalidSession),null===(t=this.opStatus)||void 0===t||t.setError(e.error),this.notifyEvent(o.SyncEvent.SyncError,e)}async handleSuccessServerResponse(e,t){this._simulate_latency&&await(0,d.sleep)(this._simulate_latency.latency),this.opStatus.clearError(),this.opStatus.setDownloadStatus(t.retrievedPayloads.length);const n=this.payloadManager.getMasterCollection(),r=this.historyService.getHistoryMapCopy(),a=new jt({retrievedPayloads:await this.processServerPayloads(t.retrievedPayloads,i.PayloadSource.RemoteRetrieved),savedPayloads:t.savedPayloads,uuidConflictPayloads:await this.processServerPayloads(t.uuidConflictPayloads,i.PayloadSource.RemoteRetrieved),dataConflictPayloads:await this.processServerPayloads(t.dataConflictPayloads,i.PayloadSource.RemoteRetrieved),rejectedPayloads:await this.processServerPayloads(t.rejectedPayloads,i.PayloadSource.RemoteRetrieved)},n,e.payloadsSavedOrSaving,r);this.log("Online Sync Response","Operator ID",e.id,t.rawResponse.data,"Decrypted payloads",a.payloadSet);const s=a.result();for(const e of s){const t=await this.payloadManager.emitDeltaEmit(e);await this.persistPayloads(t)}await Promise.all([this.setLastSyncToken(t.lastSyncToken),this.setPaginationToken(t.paginationToken),this.notifyEvent(o.SyncEvent.SingleRoundTripSyncCompleted,t)])}async processServerPayloads(e,t){const n=e.map((e=>Vt(e,t))),{encrypted:r,deleted:o}=(0,i.CreateNonDecryptedPayloadSplit)(n),a=[...o],{rootKeyEncryption:s,itemsKeyEncryption:c}=(0,x.SplitPayloadsByEncryptionType)(r),{results:l,map:u}=await this.decryptServerItemsKeys(s||[]);if((0,d.extendArray)(a,l),c){const e=await this.decryptProcessedServerPayloads(c,u);(0,d.extendArray)(a,e)}return a}async decryptServerItemsKeys(e){const t={};if(0===e.length)return{results:[],map:t};const n={usesRootKeyWithKeyLookup:{items:e}},o=await this.protocolService.decryptSplit(n);return o.forEach((e=>{(0,i.isDecryptedPayload)(e)&&e.content_type===r.ContentType.ItemsKey&&(t[e.uuid]=e)})),{results:o,map:t}}async decryptProcessedServerPayloads(e,t){return Promise.all(e.map((async e=>{const n=t[e.items_key_id],r=n?(0,i.CreateDecryptedItemFromPayload)(n):void 0,o={};return r?o.usesItemsKey={items:[e],key:r}:o.usesItemsKeyWithKeyLookup={items:[e]},this.protocolService.decryptSplitSingle(o)})))}async handleSyncOperationFinish(e,t,n,r){return this.opStatus.setDidEnd(),this.opStatus.hasError()?{hasError:!0}:(this.opStatus.reset(),this.lastSyncDate=new Date,e instanceof It&&e.numberOfItemsInvolved>=this.majorChangeThreshold&&this.notifyEvent(o.SyncEvent.MajorDataChange),n.length>0&&await this.handleNeverSyncedDeleted(n),r!==o.SyncMode.DownloadFirst&&await this.notifyEvent(o.SyncEvent.SyncCompletedWithAllItemsUploaded,{source:t.source}),{hasError:!1})}async handleDownloadFirstCompletionAndSyncAgain(e,t){e&&(this.completedOnlineDownloadFirstSync=!0),await this.notifyEvent(o.SyncEvent.DownloadFirstSyncCompleted),await this.sync({source:o.SyncSource.AfterDownloadFirst,checkIntegrity:!0,awaitAll:t.awaitAll})}async syncAgainByHandlingRequestsWaitingInResolveQueue(e){this.log("Syncing again from resolve queue");const t=this.sync({source:o.SyncSource.ResolveQueue,checkIntegrity:e.checkIntegrity});e.awaitAll&&await t}async syncAgainByHandlingNewDirtyItems(e){await this.sync({source:o.SyncSource.MoreDirtyItems,checkIntegrity:e.checkIntegrity,awaitAll:e.awaitAll})}resolvePendingSyncRequestsThatMadeItInTimeOfCurrentRequest(e){for(const t of e)t.resolve()}async potentiallySyncAgainAfterSyncCompletion(e,t,n,r){if(e===o.SyncMode.DownloadFirst)return await this.handleDownloadFirstCompletionAndSyncAgain(r,t),this.resolvePendingSyncRequestsThatMadeItInTimeOfCurrentRequest(n),!0;const i=this.popSpawnQueue(),a=this.resolveQueue.length>0;return!i&&a?(await this.syncAgainByHandlingRequestsWaitingInResolveQueue(t),this.resolvePendingSyncRequestsThatMadeItInTimeOfCurrentRequest(n),!0):this.itemsNeedingSync().length>0&&(await this.syncAgainByHandlingNewDirtyItems(t),this.resolvePendingSyncRequestsThatMadeItInTimeOfCurrentRequest(n),!0)}async handleNeverSyncedDeleted(e){const t=e.map((e=>e.payloadRepresentation({dirty:!1})));await this.payloadManager.emitPayloads(t,i.PayloadEmitSource.LocalChanged),await this.persistPayloads(t)}async persistPayloads(e){if(0!==e.length&&!this.dealloced)return this.storageService.savePayloads(e).catch((e=>{this.notifyEvent(o.SyncEvent.DatabaseWriteError,e),re.W.error(e)}))}setInSync(e){e!==!this.outOfSync&&(e?(this.outOfSync=!1,this.notifyEvent(o.SyncEvent.ExitOutOfSync)):(this.outOfSync=!0,this.notifyEvent(o.SyncEvent.EnterOutOfSync)))}async handleEvent(e){e.type===o.IntegrityEvent.IntegrityCheckCompleted&&await this.handleIntegrityCheckEventResponse(e.payload)}async handleIntegrityCheckEventResponse(e){const t=e.rawPayloads;if(0===t.length)return void this.setInSync(!0);const n=(0,i.FilterDisallowedRemotePayloadsAndMap)(t).map((e=>Vt(e,i.PayloadSource.RemoteRetrieved))),r=(0,i.CreateNonDecryptedPayloadSplit)(n),a=(0,x.SplitPayloadsByEncryptionType)(r.encrypted),s=(0,x.CreateDecryptionSplitWithKeyLookup)(a),c=await this.protocolService.decryptSplit(s);this.setInSync(!1),await this.emitOutOfSyncRemotePayloads([...c,...r.deleted]);const l=e.source!==o.SyncSource.ResolveOutOfSync;await this.sync({checkIntegrity:l,source:o.SyncSource.ResolveOutOfSync})}async emitOutOfSyncRemotePayloads(e){const t=new i.DeltaOutOfSync(this.payloadManager.getMasterCollection(),i.ImmutablePayloadCollection.WithPayloads(e),this.historyService.getHistoryMapCopy()).result();await this.payloadManager.emitDeltaEmit(t),await this.persistPayloads(t.emits)}async getDiagnostics(){const e=(0,d.Uuids)(this.itemsNeedingSync());return{sync:{syncToken:await this.getLastSyncToken(),cursorToken:await this.getPaginationToken(),dirtyIndexAtLastPresyncSave:this.dirtyIndexAtLastPresyncSave,lastSyncDate:this.lastSyncDate,outOfSync:this.outOfSync,completedOnlineDownloadFirstSync:this.completedOnlineDownloadFirstSync,clientLocked:this.clientLocked,databaseLoaded:this.databaseLoaded,syncLock:this.syncLock,dealloced:this.dealloced,itemsNeedingSync:e,itemsNeedingSyncCount:e.length,pendingRequestCount:this.resolveQueue.length+this.spawnQueue.length}}}ut_setDatabaseLoaded(e){this.databaseLoaded=e}ut_clearLastSyncDate(){this.lastSyncDate=void 0}ut_beginLatencySimulator(e){this._simulate_latency={latency:e||1e3,enabled:!0}}ut_endLatencySimulator(){this._simulate_latency=void 0}}},10715:(e,t,n)=>{n.d(t,{D8:()=>c,DU:()=>o,Oq:()=>a,in:()=>i,jV:()=>s});var r=n(21503);const i="2.147.1",o="1.0.0",a="2.0.0";function s(e,t){return-1===c(e,t)}function c(e,t){return(0,r.eq)(e,t)?0:(0,r.gt)(e,t)?1:-1}},5056:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=void 0,t.Deferred=()=>{let e,t;const n=new Promise(((n,r)=>{e=n,t=r}));return{resolve:e,reject:t,promise:n}}},85485:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.isSameDay=t.assertUnreachable=t.sleep=t.truncateHexString=t.hasGetter=t.isValidUrl=t.deepFreeze=t.pickByCopy=t.deepMerge=t.Copy=t.joinPaths=t.omitByCopy=t.omitInPlace=t.withoutLastElement=t.jsonParseEmbeddedKeys=t.topLevelCompare=t.dateSorted=t.omitUndefinedCopy=t.sortByKey=t.sortedCopy=t.objectToValueArray=t.arrayByRemovingFromIndex=t.addAtIndex=t.removeFromIndex=t.compareValues=t.arrayByDifference=t.filterFromArray=t.addIfUnique=t.removeFromArray=t.subtractFromArray=t.extendArray=t.lastElement=t.uniqueArrayByKey=t.uniqueArray=t.uniqCombineObjArrays=t.greaterOfTwoDates=t.isString=t.isEmpty=t.isNotUndefined=t.isNullOrUndefined=t.isFunction=t.isObject=t.sureSearchArray=t.searchArray=t.findInArray=t.isReactNativeEnvironment=t.isWebCryptoAvailable=t.isWebEnvironment=t.dictToArray=t.getGlobalScope=void 0,t.useBoolean=t.assert=t.log=t.secondHalfOfString=t.firstHalfOfString=t.splitString=t.nonSecureRandomIdentifier=t.dateToLocalizedString=t.sanitizeHtmlString=t.convertTimestampToMilliseconds=t.arraysEqual=t.naturalSort=void 0;const i=n(66181),o=n(31773),a="undefined"!=typeof Intl?new Intl.Collator("en",{numeric:!0}):void 0;function s(){return"undefined"!=typeof window?window:void 0!==n.g?n.g:null}function c(){return null!==s()}function l(){return"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function u(e,t){return(0,o.find)(e,t)}function d(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function p(e){return null==e}function h(e,t){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}function y(e,t){e.splice(t,1)}function f(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function v(e){return e instanceof Date?new Date(e):d(e)?JSON.parse(JSON.stringify(e)):e}var m;let g;function S(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Function.prototype.apply.call(console.log,console,arguments)}t.getGlobalScope=s,t.dictToArray=function(e){return Object.values(e)},t.isWebEnvironment=c,t.isWebCryptoAvailable=function(){return c()&&!l()&&!(document&&document.documentMode)||/Edge/.test(navigator.userAgent)&&window.crypto&&!!window.crypto.subtle},t.isReactNativeEnvironment=l,t.findInArray=function(e,t,n){return e.find((e=>e[t]===n))},t.searchArray=u,t.sureSearchArray=function(e,t){return u(e,t)},t.isObject=d,t.isFunction=function(e){return null!==e&&"function"==typeof e},t.isNullOrUndefined=p,t.isNotUndefined=function(e){return null!=e},t.isEmpty=function(e){return!e||0===e.length},t.isString=function(e){return"string"==typeof e||e instanceof String},t.greaterOfTwoDates=function(e,t){return e>t?e:t},t.uniqCombineObjArrays=function(e,t,n){return(0,o.uniqWith)(e.concat(t),((e,t)=>{for(const r of n)if(e[r]!==t[r])return!1;return!0}))},t.uniqueArray=function(e){return(0,o.uniq)(e)},t.uniqueArrayByKey=function(e,t){return(0,o.uniqWith)(e,((e,n)=>e[t]===n[t]))},t.lastElement=function(e){return e[e.length-1]},t.extendArray=function(e,t){for(const n of t)e.push(n)},t.subtractFromArray=function(e,t){for(const n of t)h(e,n)},t.removeFromArray=h,t.addIfUnique=function(e,t){return!e.includes(t)&&(e.push(t),!0)},t.filterFromArray=function(e,t){(0,o.remove)(e,t)},t.arrayByDifference=function(e,t){return e.filter((e=>!t.includes(e))).concat(t.filter((t=>!e.includes(t))))},t.compareValues=function(e,t){return!(e&&!t||!e&&t)&&(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof String&&t instanceof String?e===t:f(e,t))},t.removeFromIndex=y,t.addAtIndex=function(e,t,n){e.splice(n,0,t)},t.arrayByRemovingFromIndex=function(e,t){const n=e.slice();return y(n,t),n},t.objectToValueArray=function(e){const t=[];for(const n of Object.keys(e))t.push(e[n]);return t},t.sortedCopy=function(e){const t=Object.keys(e).sort(),n={};for(const r of t)n[r]=e[r];return v(n)},t.sortByKey=(e,t)=>{const n=[...e];return n.sort(((e,n)=>{const r=e[t],i=n[t];return r<i?-1:r>i?1:0})),n},t.omitUndefinedCopy=function(e){const t={};for(const n of Object.keys(e))p(e[n])||(t[n]=e[n]);return t},t.dateSorted=function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.sort(((e,r)=>{const i=e[t].getTime(),o=r[t].getTime(),a=n?1:-1;return i<o?-1*a:i>o?1*a:0}))},t.topLevelCompare=f,t.jsonParseEmbeddedKeys=function(e){const t={};for(const n of Object.keys(e)){let r;try{r=JSON.parse(e[n])}catch(t){r=e[n]}t[n]=r}return t},t.withoutLastElement=e=>e.slice(0,-1),t.omitInPlace=function(e,t){if(e)for(const n of t)delete e[n]},t.omitByCopy=function(e,t){if(p(e))return;const n=Object.assign({},e);for(const e of t)delete n[e];return n},t.joinPaths=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map(((e,t)=>0===t?e.trim().replace(/[/]*$/g,""):e.trim().replace(/(^[/]*|[/]*$)/g,""))).filter((e=>e.length)).join("/")},t.Copy=v,t.deepMerge=function(e,t){if(!e||!t)throw"Attempting to deepMerge with null values";return(0,o.mergeWith)(e,t,((e,t)=>{if((0,o.isArray)(e))return t})),e},t.pickByCopy=function(e,t){const n={};for(const r of t)n[r]=e[r];return v(n)},t.deepFreeze=function e(t){const n=Object.getOwnPropertyNames(t);for(const r of n){const n=t[r];n&&"object"==typeof n&&!Object.isFrozen(n)?t[r]=e(n):t[r]=n}return Object.freeze(t)},t.isValidUrl=function(e){try{return new URL(e),!0}catch(e){return!1}},t.hasGetter=function(e,t){const n=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),t);return n&&!p(n.get)},t.truncateHexString=function(e,t){const n=t/4;return e.substring(0,n)},t.sleep=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return r(this,void 0,void 0,(function*(){return t&&console.warn("Sleeping for ".concat(e,"ms")),new Promise((t=>{setTimeout((function(){t()}),e)}))}))},t.assertUnreachable=function(e){throw Error("Unchecked case "+e)},t.isSameDay=function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},t.naturalSort=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"asc";switch(n){case"asc":return[...e].sort(a?(e,n)=>a.compare(e[t],n[t]):(e,n)=>e[t].localeCompare(n[t],"en",{numeric:!0}));case"desc":return[...e].sort(a?(e,n)=>a.compare(n[t],e[t]):(e,n)=>n[t].localeCompare(e[t],"en",{numeric:!0}))}},t.arraysEqual=function(e,t){return e.length===t.length&&e.every((e=>t.includes(e)))&&t.every((t=>e.includes(t)))},function(e){e[e.Seconds=10]="Seconds",e[e.Milliseconds=13]="Milliseconds",e[e.Microseconds=16]="Microseconds"}(m||(m={})),t.convertTimestampToMilliseconds=function(e){switch(String(e).length){case m.Seconds:return 1e3*e;case m.Milliseconds:return e;case m.Microseconds:return Math.floor(e/1e3);default:throw"Unhandled timestamp precision: ".concat(e)}},t.sanitizeHtmlString=function(e){return(0,i.sanitize)(e)},t.dateToLocalizedString=function(e){if("undefined"!=typeof Intl&&Intl.DateTimeFormat&&"undefined"!=typeof navigator){if(!g){const e=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language;g=new Intl.DateTimeFormat(e,{year:"numeric",month:"short",day:"2-digit",weekday:"long",hour:"2-digit",minute:"2-digit"})}return g.format(e)}return e.toDateString()+" "+e.toLocaleTimeString()},t.nonSecureRandomIdentifier=function(){return"".concat(100*Math.random()).replace(".","")},t.splitString=function(e,t){const n=e.length/t,r=[];for(let i=0;i<t;i++){const t=e.slice(n*i,n*(i+1));r.push(t)}return r},t.firstHalfOfString=function(e){return e.substring(0,e.length/2)},t.secondHalfOfString=function(e){return e.substring(e.length/2,e.length)},t.log=function(e){const t=new Date,n="".concat(t.toLocaleTimeString().replace(" PM","").replace(" AM",""),".").concat(t.getMilliseconds());for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];S("%c".concat(e,"%c").concat(n),"color: black; font-weight: bold; margin-right: 4px","color: gray",...i)},t.assert=function(e){if(void 0===e)throw new Error("Assertion failed; value must be defined")},t.useBoolean=function(e,t){return null!=e?e:t}},42414:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Uuids=void 0,t.Uuids=function(e){return e.map((e=>e.uuid))}},56221:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UuidGenerator=void 0,t.UuidGenerator=class{static SetGenerator(e){this.syncUuidFunc=e}static GenerateUuid(){return this.syncUuidFunc()}}},29308:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UuidMap=void 0;const r=n(85485);class i{constructor(){this.directMap={},this.inverseMap={}}makeCopy(){const e=new i;return e.directMap=Object.assign({},this.directMap),e.inverseMap=Object.assign({},this.inverseMap),e}getDirectRelationships(e){return this.directMap[e]||[]}getInverseRelationships(e){return this.inverseMap[e]||[]}establishRelationship(e,t){this.establishDirectRelationship(e,t),this.establishInverseRelationship(e,t)}deestablishRelationship(e,t){this.deestablishDirectRelationship(e,t),this.deestablishInverseRelationship(e,t)}setAllRelationships(e,t){const n=this.directMap[e]||[];this.directMap[e]=t;for(const t of n)this.deestablishInverseRelationship(e,t);for(const n of t)this.establishInverseRelationship(e,n)}removeFromMap(e){const t=this.directMap[e]||[];for(const n of t)(0,r.removeFromArray)(this.inverseMap[n]||[],e);delete this.directMap[e];const n=this.inverseMap[e]||[];for(const t of n)(0,r.removeFromArray)(this.directMap[t]||[],e);delete this.inverseMap[e]}establishDirectRelationship(e,t){const n=this.directMap[e]||[];(0,r.addIfUnique)(n,t),this.directMap[e]=n}establishInverseRelationship(e,t){const n=this.inverseMap[t]||[];(0,r.addIfUnique)(n,e),this.inverseMap[t]=n}deestablishDirectRelationship(e,t){const n=this.directMap[e]||[];(0,r.removeFromArray)(n,t),this.directMap[e]=n}deestablishInverseRelationship(e,t){const n=this.inverseMap[t]||[];(0,r.removeFromArray)(n,e),this.inverseMap[t]=n}}t.UuidMap=i},9314:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(85485),t),i(n(56221),t),i(n(29308),t),i(n(42414),t),i(n(5056),t)},64657:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(9314),t)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var r={};return(()=>{n.r(r),n.d(r,{AccountSyncOperation:()=>s.U8,AllowedBatchContentTypes:()=>s.Jg,AllowedBatchStreaming:()=>s.h6,ApplicationGroupEvent:()=>t.$,ApplicationService:()=>s.IX,BaseMigration:()=>a._r,ChallengeOperation:()=>s.ne,ChallengeResponse:()=>s.ap,ChallengeService:()=>s.PJ,ComponentManagerEvent:()=>s.VG,ComponentViewer:()=>s.SV,DiskStorageService:()=>s.e5,FileViewController:()=>i.rp,GetSortedPayloadsByPriority:()=>s.xO,HttpVerb:()=>s.FH,IconsController:()=>i.iB,ItemGroupController:()=>i.Jj,ItemManager:()=>s.A,JwtSession:()=>s.jW,ListedService:()=>s.o8,LiveItem:()=>e.J5,MINIMUM_PASSWORD_LENGTH:()=>s.aM,Migration2_0_0:()=>a.ce,Migration2_0_15:()=>a.ly,Migration2_20_0:()=>a.kK,Migration2_36_0:()=>a.qW,Migration2_42_0:()=>a.Ni,Migration2_7_0:()=>a.pI,MigrationClasses:()=>a.R_,MissingAccountParams:()=>s.Sn,MutatorService:()=>s.Vu,NoteViewController:()=>i._p,OfflineSyncOperation:()=>s.Bi,Paths:()=>s.nB,PayloadManager:()=>s.Ot,PreviousSnjsVersion1_0_0:()=>c.DU,PreviousSnjsVersion2_0_0:()=>c.Oq,ProposedSecondsToDeferUILevelSessionExpirationDuringActiveInteraction:()=>s.Ps,ProtectionEvent:()=>s.Hh,ProtectionSessionDurations:()=>s.jg,ReactNativeToWebEvent:()=>i.Zw,SNActionsService:()=>s.UP,SNApiService:()=>s.QL,SNApplication:()=>e.UC,SNApplicationGroup:()=>t.R,SNComponentManager:()=>s.bJ,SNFeaturesService:()=>s.sX,SNHistoryManager:()=>s.Cv,SNHttpService:()=>s.aJ,SNKeyRecoveryService:()=>s.Mj,SNLog:()=>o.W,SNMfaService:()=>s.P$,SNMigrationService:()=>s.FR,SNPreferencesService:()=>s.J_,SNProtectionService:()=>s.Xr,SNSessionManager:()=>s.Lb,SNSettingsService:()=>s.kf,SNSingletonManager:()=>s.c5,SNSyncService:()=>s.xu,SNWebSocketsService:()=>s.g7,ServerSyncResponse:()=>s.Fi,ServerSyncResponseResolver:()=>s.y0,Session:()=>s.z_,SessionEvent:()=>s.Px,SessionFromRawStorageValue:()=>s.d6,SnjsVersion:()=>c.in,SyncEvent:()=>e.wM,SyncOpStatus:()=>s.BU,SyncUpDownLimit:()=>s.jH,TokenSession:()=>s.NA,UnprotectedAccessSecondsDuration:()=>s.Fr,WebSocketsServiceEvent:()=>s.fA,applicationEventForSyncEvent:()=>e.ie,compareSemVersions:()=>c.D8,environmentToString:()=>e.g,isEnvironmentMobile:()=>e.Im,isEnvironmentWebOrDesktop:()=>e.Ak,isRightVersionGreaterThanLeft:()=>c.jV,isValidProtectionSessionLength:()=>s.z4,platformFromString:()=>e.FB,platformToString:()=>e._e});var e=n(58364),t=n(82698),i=n(78338),o=n(44412),a=n(24431),s=n(65432),c=n(10715),l=n(10256),u={};for(const e in l)["default","LiveItem","SNApplication","SyncEvent","applicationEventForSyncEvent","environmentToString","isEnvironmentMobile","isEnvironmentWebOrDesktop","platformFromString","platformToString","ApplicationGroupEvent","SNApplicationGroup","FileViewController","IconsController","ItemGroupController","NoteViewController","ReactNativeToWebEvent","SNLog","BaseMigration","Migration2_0_0","Migration2_0_15","Migration2_20_0","Migration2_36_0","Migration2_42_0","Migration2_7_0","MigrationClasses","AccountSyncOperation","AllowedBatchContentTypes","AllowedBatchStreaming","ApplicationService","ChallengeOperation","ChallengeResponse","ChallengeService","ComponentManagerEvent","ComponentViewer","DiskStorageService","GetSortedPayloadsByPriority","HttpVerb","ItemManager","JwtSession","ListedService","MINIMUM_PASSWORD_LENGTH","MissingAccountParams","MutatorService","OfflineSyncOperation","Paths","PayloadManager","ProposedSecondsToDeferUILevelSessionExpirationDuringActiveInteraction","ProtectionEvent","ProtectionSessionDurations","SNActionsService","SNApiService","SNComponentManager","SNFeaturesService","SNHistoryManager","SNHttpService","SNKeyRecoveryService","SNMfaService","SNMigrationService","SNPreferencesService","SNProtectionService","SNSessionManager","SNSettingsService","SNSingletonManager","SNSyncService","SNWebSocketsService","ServerSyncResponse","ServerSyncResponseResolver","Session","SessionEvent","SessionFromRawStorageValue","SyncOpStatus","SyncUpDownLimit","TokenSession","UnprotectedAccessSecondsDuration","WebSocketsServiceEvent","isValidProtectionSessionLength","PreviousSnjsVersion1_0_0","PreviousSnjsVersion2_0_0","SnjsVersion","compareSemVersions","isRightVersionGreaterThanLeft"].indexOf(e)<0&&(u[e]=()=>l[e]);n.d(r,u);var d=n(75082);u={};for(const e in d)["default","LiveItem","SNApplication","SyncEvent","applicationEventForSyncEvent","environmentToString","isEnvironmentMobile","isEnvironmentWebOrDesktop","platformFromString","platformToString","ApplicationGroupEvent","SNApplicationGroup","FileViewController","IconsController","ItemGroupController","NoteViewController","ReactNativeToWebEvent","SNLog","BaseMigration","Migration2_0_0","Migration2_0_15","Migration2_20_0","Migration2_36_0","Migration2_42_0","Migration2_7_0","MigrationClasses","AccountSyncOperation","AllowedBatchContentTypes","AllowedBatchStreaming","ApplicationService","ChallengeOperation","ChallengeResponse","ChallengeService","ComponentManagerEvent","ComponentViewer","DiskStorageService","GetSortedPayloadsByPriority","HttpVerb","ItemManager","JwtSession","ListedService","MINIMUM_PASSWORD_LENGTH","MissingAccountParams","MutatorService","OfflineSyncOperation","Paths","PayloadManager","ProposedSecondsToDeferUILevelSessionExpirationDuringActiveInteraction","ProtectionEvent","ProtectionSessionDurations","SNActionsService","SNApiService","SNComponentManager","SNFeaturesService","SNHistoryManager","SNHttpService","SNKeyRecoveryService","SNMfaService","SNMigrationService","SNPreferencesService","SNProtectionService","SNSessionManager","SNSettingsService","SNSingletonManager","SNSyncService","SNWebSocketsService","ServerSyncResponse","ServerSyncResponseResolver","Session","SessionEvent","SessionFromRawStorageValue","SyncOpStatus","SyncUpDownLimit","TokenSession","UnprotectedAccessSecondsDuration","WebSocketsServiceEvent","isValidProtectionSessionLength","PreviousSnjsVersion1_0_0","PreviousSnjsVersion2_0_0","SnjsVersion","compareSemVersions","isRightVersionGreaterThanLeft"].indexOf(e)<0&&(u[e]=()=>d[e]);n.d(r,u);var p=n(70295);u={};for(const e in p)["default","LiveItem","SNApplication","SyncEvent","applicationEventForSyncEvent","environmentToString","isEnvironmentMobile","isEnvironmentWebOrDesktop","platformFromString","platformToString","ApplicationGroupEvent","SNApplicationGroup","FileViewController","IconsController","ItemGroupController","NoteViewController","ReactNativeToWebEvent","SNLog","BaseMigration","Migration2_0_0","Migration2_0_15","Migration2_20_0","Migration2_36_0","Migration2_42_0","Migration2_7_0","MigrationClasses","AccountSyncOperation","AllowedBatchContentTypes","AllowedBatchStreaming","ApplicationService","ChallengeOperation","ChallengeResponse","ChallengeService","ComponentManagerEvent","ComponentViewer","DiskStorageService","GetSortedPayloadsByPriority","HttpVerb","ItemManager","JwtSession","ListedService","MINIMUM_PASSWORD_LENGTH","MissingAccountParams","MutatorService","OfflineSyncOperation","Paths","PayloadManager","ProposedSecondsToDeferUILevelSessionExpirationDuringActiveInteraction","ProtectionEvent","ProtectionSessionDurations","SNActionsService","SNApiService","SNComponentManager","SNFeaturesService","SNHistoryManager","SNHttpService","SNKeyRecoveryService","SNMfaService","SNMigrationService","SNPreferencesService","SNProtectionService","SNSessionManager","SNSettingsService","SNSingletonManager","SNSyncService","SNWebSocketsService","ServerSyncResponse","ServerSyncResponseResolver","Session","SessionEvent","SessionFromRawStorageValue","SyncOpStatus","SyncUpDownLimit","TokenSession","UnprotectedAccessSecondsDuration","WebSocketsServiceEvent","isValidProtectionSessionLength","PreviousSnjsVersion1_0_0","PreviousSnjsVersion2_0_0","SnjsVersion","compareSemVersions","isRightVersionGreaterThanLeft"].indexOf(e)<0&&(u[e]=()=>p[e]);n.d(r,u);var h=n(14581);u={};for(const e in h)["default","LiveItem","SNApplication","SyncEvent","applicationEventForSyncEvent","environmentToString","isEnvironmentMobile","isEnvironmentWebOrDesktop","platformFromString","platformToString","ApplicationGroupEvent","SNApplicationGroup","FileViewController","IconsController","ItemGroupController","NoteViewController","ReactNativeToWebEvent","SNLog","BaseMigration","Migration2_0_0","Migration2_0_15","Migration2_20_0","Migration2_36_0","Migration2_42_0","Migration2_7_0","MigrationClasses","AccountSyncOperation","AllowedBatchContentTypes","AllowedBatchStreaming","ApplicationService","ChallengeOperation","ChallengeResponse","ChallengeService","ComponentManagerEvent","ComponentViewer","DiskStorageService","GetSortedPayloadsByPriority","HttpVerb","ItemManager","JwtSession","ListedService","MINIMUM_PASSWORD_LENGTH","MissingAccountParams","MutatorService","OfflineSyncOperation","Paths","PayloadManager","ProposedSecondsToDeferUILevelSessionExpirationDuringActiveInteraction","ProtectionEvent","ProtectionSessionDurations","SNActionsService","SNApiService","SNComponentManager","SNFeaturesService","SNHistoryManager","SNHttpService","SNKeyRecoveryService","SNMfaService","SNMigrationService","SNPreferencesService","SNProtectionService","SNSessionManager","SNSettingsService","SNSingletonManager","SNSyncService","SNWebSocketsService","ServerSyncResponse","ServerSyncResponseResolver","Session","SessionEvent","SessionFromRawStorageValue","SyncOpStatus","SyncUpDownLimit","TokenSession","UnprotectedAccessSecondsDuration","WebSocketsServiceEvent","isValidProtectionSessionLength","PreviousSnjsVersion1_0_0","PreviousSnjsVersion2_0_0","SnjsVersion","compareSemVersions","isRightVersionGreaterThanLeft"].indexOf(e)<0&&(u[e]=()=>h[e]);n.d(r,u);var y=n(16418);u={};for(const e in y)["default","LiveItem","SNApplication","SyncEvent","applicationEventForSyncEvent","environmentToString","isEnvironmentMobile","isEnvironmentWebOrDesktop","platformFromString","platformToString","ApplicationGroupEvent","SNApplicationGroup","FileViewController","IconsController","ItemGroupController","NoteViewController","ReactNativeToWebEvent","SNLog","BaseMigration","Migration2_0_0","Migration2_0_15","Migration2_20_0","Migration2_36_0","Migration2_42_0","Migration2_7_0","MigrationClasses","AccountSyncOperation","AllowedBatchContentTypes","AllowedBatchStreaming","ApplicationService","ChallengeOperation","ChallengeResponse","ChallengeService","ComponentManagerEvent","ComponentViewer","DiskStorageService","GetSortedPayloadsByPriority","HttpVerb","ItemManager","JwtSession","ListedService","MINIMUM_PASSWORD_LENGTH","MissingAccountParams","MutatorService","OfflineSyncOperation","Paths","PayloadManager","ProposedSecondsToDeferUILevelSessionExpirationDuringActiveInteraction","ProtectionEvent","ProtectionSessionDurations","SNActionsService","SNApiService","SNComponentManager","SNFeaturesService","SNHistoryManager","SNHttpService","SNKeyRecoveryService","SNMfaService","SNMigrationService","SNPreferencesService","SNProtectionService","SNSessionManager","SNSettingsService","SNSingletonManager","SNSyncService","SNWebSocketsService","ServerSyncResponse","ServerSyncResponseResolver","Session","SessionEvent","SessionFromRawStorageValue","SyncOpStatus","SyncUpDownLimit","TokenSession","UnprotectedAccessSecondsDuration","WebSocketsServiceEvent","isValidProtectionSessionLength","PreviousSnjsVersion1_0_0","PreviousSnjsVersion2_0_0","SnjsVersion","compareSemVersions","isRightVersionGreaterThanLeft"].indexOf(e)<0&&(u[e]=()=>y[e]);n.d(r,u);var f=n(84945);u={};for(const e in f)["default","LiveItem","SNApplication","SyncEvent","applicationEventForSyncEvent","environmentToString","isEnvironmentMobile","isEnvironmentWebOrDesktop","platformFromString","platformToString","ApplicationGroupEvent","SNApplicationGroup","FileViewController","IconsController","ItemGroupController","NoteViewController","ReactNativeToWebEvent","SNLog","BaseMigration","Migration2_0_0","Migration2_0_15","Migration2_20_0","Migration2_36_0","Migration2_42_0","Migration2_7_0","MigrationClasses","AccountSyncOperation","AllowedBatchContentTypes","AllowedBatchStreaming","ApplicationService","ChallengeOperation","ChallengeResponse","ChallengeService","ComponentManagerEvent","ComponentViewer","DiskStorageService","GetSortedPayloadsByPriority","HttpVerb","ItemManager","JwtSession","ListedService","MINIMUM_PASSWORD_LENGTH","MissingAccountParams","MutatorService","OfflineSyncOperation","Paths","PayloadManager","ProposedSecondsToDeferUILevelSessionExpirationDuringActiveInteraction","ProtectionEvent","ProtectionSessionDurations","SNActionsService","SNApiService","SNComponentManager","SNFeaturesService","SNHistoryManager","SNHttpService","SNKeyRecoveryService","SNMfaService","SNMigrationService","SNPreferencesService","SNProtectionService","SNSessionManager","SNSettingsService","SNSingletonManager","SNSyncService","SNWebSocketsService","ServerSyncResponse","ServerSyncResponseResolver","Session","SessionEvent","SessionFromRawStorageValue","SyncOpStatus","SyncUpDownLimit","TokenSession","UnprotectedAccessSecondsDuration","WebSocketsServiceEvent","isValidProtectionSessionLength","PreviousSnjsVersion1_0_0","PreviousSnjsVersion2_0_0","SnjsVersion","compareSemVersions","isRightVersionGreaterThanLeft"].indexOf(e)<0&&(u[e]=()=>f[e]);n.d(r,u);var v=n(20819);u={};for(const e in v)["default","LiveItem","SNApplication","SyncEvent","applicationEventForSyncEvent","environmentToString","isEnvironmentMobile","isEnvironmentWebOrDesktop","platformFromString","platformToString","ApplicationGroupEvent","SNApplicationGroup","FileViewController","IconsController","ItemGroupController","NoteViewController","ReactNativeToWebEvent","SNLog","BaseMigration","Migration2_0_0","Migration2_0_15","Migration2_20_0","Migration2_36_0","Migration2_42_0","Migration2_7_0","MigrationClasses","AccountSyncOperation","AllowedBatchContentTypes","AllowedBatchStreaming","ApplicationService","ChallengeOperation","ChallengeResponse","ChallengeService","ComponentManagerEvent","ComponentViewer","DiskStorageService","GetSortedPayloadsByPriority","HttpVerb","ItemManager","JwtSession","ListedService","MINIMUM_PASSWORD_LENGTH","MissingAccountParams","MutatorService","OfflineSyncOperation","Paths","PayloadManager","ProposedSecondsToDeferUILevelSessionExpirationDuringActiveInteraction","ProtectionEvent","ProtectionSessionDurations","SNActionsService","SNApiService","SNComponentManager","SNFeaturesService","SNHistoryManager","SNHttpService","SNKeyRecoveryService","SNMfaService","SNMigrationService","SNPreferencesService","SNProtectionService","SNSessionManager","SNSettingsService","SNSingletonManager","SNSyncService","SNWebSocketsService","ServerSyncResponse","ServerSyncResponseResolver","Session","SessionEvent","SessionFromRawStorageValue","SyncOpStatus","SyncUpDownLimit","TokenSession","UnprotectedAccessSecondsDuration","WebSocketsServiceEvent","isValidProtectionSessionLength","PreviousSnjsVersion1_0_0","PreviousSnjsVersion2_0_0","SnjsVersion","compareSemVersions","isRightVersionGreaterThanLeft"].indexOf(e)<0&&(u[e]=()=>v[e]);n.d(r,u);var m=n(9382);u={};for(const e in m)["default","LiveItem","SNApplication","SyncEvent","applicationEventForSyncEvent","environmentToString","isEnvironmentMobile","isEnvironmentWebOrDesktop","platformFromString","platformToString","ApplicationGroupEvent","SNApplicationGroup","FileViewController","IconsController","ItemGroupController","NoteViewController","ReactNativeToWebEvent","SNLog","BaseMigration","Migration2_0_0","Migration2_0_15","Migration2_20_0","Migration2_36_0","Migration2_42_0","Migration2_7_0","MigrationClasses","AccountSyncOperation","AllowedBatchContentTypes","AllowedBatchStreaming","ApplicationService","ChallengeOperation","ChallengeResponse","ChallengeService","ComponentManagerEvent","ComponentViewer","DiskStorageService","GetSortedPayloadsByPriority","HttpVerb","ItemManager","JwtSession","ListedService","MINIMUM_PASSWORD_LENGTH","MissingAccountParams","MutatorService","OfflineSyncOperation","Paths","PayloadManager","ProposedSecondsToDeferUILevelSessionExpirationDuringActiveInteraction","ProtectionEvent","ProtectionSessionDurations","SNActionsService","SNApiService","SNComponentManager","SNFeaturesService","SNHistoryManager","SNHttpService","SNKeyRecoveryService","SNMfaService","SNMigrationService","SNPreferencesService","SNProtectionService","SNSessionManager","SNSettingsService","SNSingletonManager","SNSyncService","SNWebSocketsService","ServerSyncResponse","ServerSyncResponseResolver","Session","SessionEvent","SessionFromRawStorageValue","SyncOpStatus","SyncUpDownLimit","TokenSession","UnprotectedAccessSecondsDuration","WebSocketsServiceEvent","isValidProtectionSessionLength","PreviousSnjsVersion1_0_0","PreviousSnjsVersion2_0_0","SnjsVersion","compareSemVersions","isRightVersionGreaterThanLeft"].indexOf(e)<0&&(u[e]=()=>m[e]);n.d(r,u);var g=n(64657);u={};for(const e in g)["default","LiveItem","SNApplication","SyncEvent","applicationEventForSyncEvent","environmentToString","isEnvironmentMobile","isEnvironmentWebOrDesktop","platformFromString","platformToString","ApplicationGroupEvent","SNApplicationGroup","FileViewController","IconsController","ItemGroupController","NoteViewController","ReactNativeToWebEvent","SNLog","BaseMigration","Migration2_0_0","Migration2_0_15","Migration2_20_0","Migration2_36_0","Migration2_42_0","Migration2_7_0","MigrationClasses","AccountSyncOperation","AllowedBatchContentTypes","AllowedBatchStreaming","ApplicationService","ChallengeOperation","ChallengeResponse","ChallengeService","ComponentManagerEvent","ComponentViewer","DiskStorageService","GetSortedPayloadsByPriority","HttpVerb","ItemManager","JwtSession","ListedService","MINIMUM_PASSWORD_LENGTH","MissingAccountParams","MutatorService","OfflineSyncOperation","Paths","PayloadManager","ProposedSecondsToDeferUILevelSessionExpirationDuringActiveInteraction","ProtectionEvent","ProtectionSessionDurations","SNActionsService","SNApiService","SNComponentManager","SNFeaturesService","SNHistoryManager","SNHttpService","SNKeyRecoveryService","SNMfaService","SNMigrationService","SNPreferencesService","SNProtectionService","SNSessionManager","SNSettingsService","SNSingletonManager","SNSyncService","SNWebSocketsService","ServerSyncResponse","ServerSyncResponseResolver","Session","SessionEvent","SessionFromRawStorageValue","SyncOpStatus","SyncUpDownLimit","TokenSession","UnprotectedAccessSecondsDuration","WebSocketsServiceEvent","isValidProtectionSessionLength","PreviousSnjsVersion1_0_0","PreviousSnjsVersion2_0_0","SnjsVersion","compareSemVersions","isRightVersionGreaterThanLeft"].indexOf(e)<0&&(u[e]=()=>g[e]);n.d(r,u)})(),r})(),e.exports=t()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r={};return(()=>{"use strict";n.d(r,{default:()=>b});var e,t=n(109),i=new Uint8Array(16);function o(){if(!e&&!(e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(i)}const a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,s=function(e){return"string"==typeof e&&a.test(e)};for(var c=[],l=0;l<256;++l)c.push((l+256).toString(16).substr(1));const u=e=>{var n;const r={[t.Environment.Web]:"web",[t.Environment.Desktop]:"desktop",[t.Environment.Mobile]:"mobile"};return null!==(n=r[e])&&void 0!==n?n:r[t.Environment.Web]},d=()=>{};class p{static get isSupported(){return!(!window.console&&!console)}static get info(){return p.isSupported&&this.enabled?console.log.bind(console):d}static get error(){return p.isSupported?console.error.bind(console):d}}var h,y;let f,v;function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(y="enabled")in(h=p)?Object.defineProperty(h,y,{value:!1,enumerable:!0,configurable:!0,writable:!0}):h[y]=!1,function(e){e.Shift="Shift",e.Ctrl="Control",e.Meta="Meta"}(f||(f={})),function(e){e.Component="component"}(v||(v={}));class b{constructor(e){var t,n;if(S(this,"contentWindow",void 0),S(this,"component",{activeThemes:[],acceptsThemes:!0}),S(this,"sentMessages",[]),S(this,"messageQueue",[]),S(this,"lastStreamedItem",void 0),S(this,"pendingSaveItems",void 0),S(this,"pendingSaveTimeout",void 0),S(this,"pendingSaveParams",void 0),S(this,"messageHandler",void 0),S(this,"keyDownEventListener",void 0),S(this,"keyUpEventListener",void 0),S(this,"clickEventListener",void 0),S(this,"concernTimeouts",[]),S(this,"options",void 0),S(this,"params",void 0),!e||!e.targetWindow)throw new Error("contentWindow must be a valid Window object.");this.params=e,this.options=e.options||{},null==this.options.coallesedSaving&&(this.options.coallesedSaving=!0),null==this.options.coallesedSavingDelay&&(this.options.coallesedSavingDelay=250),null!=this.options.acceptsThemes&&(this.component.acceptsThemes=null===(n=this.options.acceptsThemes)||void 0===n||n),p.enabled=null!==(t=this.options.debug)&&void 0!==t&&t,this.contentWindow=e.targetWindow,this.registerMessageHandler(),this.registerKeyboardEventListeners(),this.registerMouseEventListeners()}deinit(){this.params.onReady=void 0,this.component={acceptsThemes:!0,activeThemes:[]},this.messageQueue=[],this.sentMessages=[],this.lastStreamedItem=void 0,this.pendingSaveItems=void 0,this.pendingSaveTimeout=void 0,this.pendingSaveParams=void 0,this.messageHandler&&(this.contentWindow.document.removeEventListener("message",this.messageHandler),this.contentWindow.removeEventListener("message",this.messageHandler)),this.keyDownEventListener&&this.contentWindow.removeEventListener("keydown",this.keyDownEventListener),this.keyUpEventListener&&this.contentWindow.removeEventListener("keyup",this.keyUpEventListener),this.clickEventListener&&this.contentWindow.removeEventListener("click",this.clickEventListener)}registerMessageHandler(){this.messageHandler=e=>{if(p.info("Components API Message received:",e.data),document.referrer&&new URL(document.referrer).origin!==new URL(e.origin).origin)return;const{data:n}=e,r=(e=>{if("string"!=typeof e)return!1;try{const t=JSON.parse(e),n=Object.prototype.toString.call(t);return"[object Object]"===n||"[object Array]"===n}catch(e){return!1}})(n)?JSON.parse(n):n;if(r){if(void 0===this.component.origin&&r.action===t.ComponentAction.ComponentRegistered)this.component.origin=e.origin;else if(e.origin!==this.component.origin)return;this.handleMessage(r)}else p.error("Invalid data received. Skipping...")},this.contentWindow.document.addEventListener("message",this.messageHandler,!1),this.contentWindow.addEventListener("message",this.messageHandler,!1),p.info("Waiting for messages...")}registerKeyboardEventListeners(){this.keyDownEventListener=e=>{p.info("A key has been pressed: ".concat(e.key)),e.ctrlKey?this.keyDownEvent(f.Ctrl):e.shiftKey?this.keyDownEvent(f.Shift):(e.metaKey||"Meta"===e.key)&&this.keyDownEvent(f.Meta)},this.keyUpEventListener=e=>{p.info("A key has been released: ".concat(e.key)),"Control"===e.key?this.keyUpEvent(f.Ctrl):"Shift"===e.key?this.keyUpEvent(f.Shift):"Meta"===e.key&&this.keyUpEvent(f.Meta)},this.contentWindow.addEventListener("keydown",this.keyDownEventListener,!1),this.contentWindow.addEventListener("keyup",this.keyUpEventListener,!1)}registerMouseEventListeners(){this.clickEventListener=e=>{p.info("A click has been performed."),this.mouseClickEvent()},this.contentWindow.addEventListener("click",this.clickEventListener,!1)}handleMessage(e){switch(e.action){case t.ComponentAction.ComponentRegistered:this.component.sessionKey=e.sessionKey,e.componentData&&(this.component.data=e.componentData),this.onReady(e.data),p.info("Component successfully registered with payload:",e);break;case t.ComponentAction.ActivateThemes:this.activateThemes(e.data.themes);break;default:{var n,r;if(!e.original)return;const t=null===(n=this.sentMessages)||void 0===n?void 0:n.filter((t=>{var n;return t.messageId===(null===(n=e.original)||void 0===n?void 0:n.messageId)}))[0];if(!t){const e=this.contentWindow.document.title,t=("The extension '".concat(e,"' is attempting to communicate with Standard Notes, ")+"but an error is preventing it from doing so. Please restart this extension and try again.").replace("  "," ");return void p.info(t)}null==t||null===(r=t.callback)||void 0===r||r.call(t,e.data);break}}}onReady(e){this.component.environment=e.environment,this.component.platform=e.platform,this.component.uuid=e.uuid;for(const e of this.messageQueue)this.postMessage(e.action,e.data,e.callback);this.messageQueue=[],p.info("Data passed to onReady:",e),this.activateThemes(e.activeThemeUrls||[]),this.postMessage(t.ComponentAction.ThemesActivated,{}),this.params.onReady&&this.params.onReady()}getSelfComponentUUID(){return this.component.uuid}isRunningInDesktopApplication(){return this.component.environment===u(t.Environment.Desktop)}isRunningInMobileApplication(){return this.component.environment===u(t.Environment.Mobile)}getComponentDataValueForKey(e){if(this.component.data)return this.component.data[e]}setComponentDataValueForKey(e,n){if(!this.component.data)throw new Error("The component has not been initialized.");if(!e||e&&0===e.length)throw new Error("The key for the data value should be a valid string.");this.component.data=g(g({},this.component.data),{},{[e]:n}),this.postMessage(t.ComponentAction.SetComponentData,{componentData:this.component.data})}clearComponentData(){this.component.data={},this.postMessage(t.ComponentAction.SetComponentData,{componentData:this.component.data})}postMessage(e,n,r){if(!this.component.sessionKey)return void this.messageQueue.push({action:e,data:n,api:v.Component,callback:r});e===t.ComponentAction.SaveItems&&(n.height=this.params.handleRequestForContentHeight());const i={action:e,data:n,messageId:this.generateUUID(),sessionKey:this.component.sessionKey,api:v.Component},o=JSON.parse(JSON.stringify(i));let a;o.callback=r,this.sentMessages.push(o),a=this.isRunningInMobileApplication()?JSON.stringify(i):i,p.info("Posting message:",a),this.contentWindow.parent.postMessage(a,this.component.origin)}activateThemes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!this.component.acceptsThemes)return;p.info("Incoming themes:",e);const{activeThemes:t}=this.component;if(t&&t.sort().toString()==e.sort().toString())return;let n=e;const r=[];for(const i of t)e.includes(i)?n=n.filter((e=>e!==i)):r.push(i);p.info("Deactivating themes:",r),p.info("Activating themes:",n);for(const e of r)this.deactivateTheme(e);this.component.activeThemes=e;for(const e of n){if(!e)continue;const t=this.contentWindow.document.createElement("link");t.id=btoa(e),t.href=e,t.type="text/css",t.rel="stylesheet",t.media="screen,print",t.className="custom-theme",this.contentWindow.document.getElementsByTagName("head")[0].appendChild(t)}this.params.onThemesChange&&this.params.onThemesChange()}themeElementForUrl(e){return Array.from(this.contentWindow.document.getElementsByClassName("custom-theme")).slice().find((t=>t.id==btoa(e)))}deactivateTheme(e){const t=this.themeElementForUrl(e);t&&t.parentNode&&(t.setAttribute("disabled","true"),t.parentNode.removeChild(t))}generateUUID(){return function(e,t,n){var r=(e=e||{}).random||(e.rng||o)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!s(n))throw TypeError("Stringified UUID is invalid");return n}(r)}()}get platform(){return this.component.platform}get environment(){return this.component.environment}streamItems(e,n){this.postMessage(t.ComponentAction.StreamItems,{content_types:e},(e=>{n(e.items)}))}streamContextItem(e){this.postMessage(t.ComponentAction.StreamContextItem,{},(t=>{const{item:n}=t;(!this.lastStreamedItem||this.lastStreamedItem.uuid!==n.uuid)&&this.pendingSaveTimeout&&(clearTimeout(this.pendingSaveTimeout),this.performSavingOfItems(this.pendingSaveParams),this.pendingSaveTimeout=void 0,this.pendingSaveParams=void 0),this.lastStreamedItem=n,e(this.lastStreamedItem)}))}selectItem(e){this.postMessage(t.ComponentAction.SelectItem,{item:this.jsonObjectForItem(e)})}clearSelection(){this.postMessage(t.ComponentAction.ClearSelection,{content_type:t.ContentType.Tag})}createItem(e,n){this.postMessage(t.ComponentAction.CreateItem,{item:this.jsonObjectForItem(e)},(e=>{let{item:t}=e;!t&&e.items&&e.items.length>0&&(t=e.items[0]),this.associateItem(t),n&&n(t)}))}createItems(e,n){const r=e.map((e=>this.jsonObjectForItem(e)));this.postMessage(t.ComponentAction.CreateItems,{items:r},(e=>{n&&n(e.items)}))}associateItem(e){this.postMessage(t.ComponentAction.AssociateItem,{item:this.jsonObjectForItem(e)})}deassociateItem(e){this.postMessage(t.ComponentAction.DeassociateItem,{item:this.jsonObjectForItem(e)})}deleteItem(e,t){this.deleteItems([e],t)}deleteItems(e,n){const r={items:e.map((e=>this.jsonObjectForItem(e)))};this.postMessage(t.ComponentAction.DeleteItems,r,(e=>{n&&n(e)}))}sendCustomEvent(e,t,n){this.postMessage(e,t,(e=>{n&&n(e)}))}saveItem(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.saveItems([e],t,n)}saveItemWithPresave(e,t,n){this.saveItemsWithPresave([e],t,n)}saveItemsWithPresave(e,t,n){this.saveItems(e,n,!1,t)}performSavingOfItems(e){let{items:n,presave:r,callback:i}=e;const o=setTimeout((()=>{this.concernTimeouts.forEach((e=>clearTimeout(e))),alert("This editor is unable to communicate with Standard Notes. Your changes may not be saved. Please backup your changes, then restart the application and try again.")}),5e3);this.concernTimeouts.push(o),r&&r();const a=[];for(const e of n)a.push(this.jsonObjectForItem(e));this.postMessage(t.ComponentAction.SaveItems,{items:a},(()=>{this.concernTimeouts.forEach((e=>clearTimeout(e))),null==i||i()}))}saveItems(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;if(this.pendingSaveItems||(this.pendingSaveItems=[]),this.options.coallesedSaving&&!n){this.pendingSaveTimeout&&clearTimeout(this.pendingSaveTimeout);const n=e.map((e=>e.uuid)),i=this.pendingSaveItems.filter((e=>!n.includes(e.uuid)));this.pendingSaveItems=i.concat(e),this.pendingSaveParams={items:this.pendingSaveItems,presave:r,callback:t},this.pendingSaveTimeout=setTimeout((()=>{this.performSavingOfItems(this.pendingSaveParams),this.pendingSaveItems=[],this.pendingSaveTimeout=void 0,this.pendingSaveParams=null}),this.options.coallesedSavingDelay)}else this.performSavingOfItems({items:e,presave:r,callback:t})}setSize(e,n){this.postMessage(t.ComponentAction.SetSize,{type:"container",width:e,height:n})}keyDownEvent(e){this.postMessage(t.ComponentAction.KeyDown,{keyboardModifier:e})}keyUpEvent(e){this.postMessage(t.ComponentAction.KeyUp,{keyboardModifier:e})}mouseClickEvent(){this.postMessage(t.ComponentAction.Click,{})}jsonObjectForItem(e){const t=Object.assign({},e);return t.children=null,t.parent=null,t}getItemAppDataValue(e,t){var n,r;const i=null==e||null===(n=e.content)||void 0===n||null===(r=n.appData)||void 0===r?void 0:r["org.standardnotes.sn"];return null==i?void 0:i[t]}}})(),r.default})(),e.exports=t()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(294),t=n(935),r=n(403),i=n.n(r);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}function l(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var p=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(d,t);var n,r,o,l=c(d);function d(e){var t,n,r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),t=l.call(this,e),n=u(t),i=function(){t.note&&t.saveSpreadsheet()},(r="onChange")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,t.state={},t.connectToBridge(),t.numRows=75,t.numColumns=26,t.sheetSizeUpdated=!1,t}return n=d,(r=[{key:"componentDidMount",value:function(){$(function(){var e=this;$("#spreadsheet").kendoSpreadsheet({rows:this.numRows,columns:this.numColumns,change:this.onChange,changeFormat:this.onChange,excelImport:function(t){confirm("Importing will completely overwrite any existing data. Are you sure you want to continue?")&&confirm("Note that importing from Excel may cause very large file sizes within Standard Notes, which may affect performance. You may continue with import, but if you notice performance issues, it is recommended you manually import data instead.")?t.promise.done((function(){console.log("Import complete"),e.onChange()})):t.preventDefault()},insertSheet:this.onChange,removeSheet:this.onChange,renameSheet:this.onChange,unhideColumn:this.onChange,unhideRow:this.onChange,hideColumn:this.onChange,hideRow:this.onChange,deleteColumn:this.onChange,deleteRow:this.onChange,insertColumn:function(t){e.numColumns++,e.sheetSizeUpdated=!0,e.onChange()},insertRow:function(){e.numRows++,e.sheetSizeUpdated=!0,e.onChange()},render:function(){e.sheetSizeUpdated&&(e.sheetSizeUpdated=!1,e.getSpreadsheet().fromJSON(e.getJSON()),e.onChange())}}),this.reloadSpreadsheetContent(),$(".k-item, .k-button").click((function(){setTimeout((function(){e.onChange()}),10)})),$(".k-upload-button").remove()}.bind(this))}},{key:"getSpreadsheet",value:function(){return $("#spreadsheet").getKendoSpreadsheet()}},{key:"saveSpreadsheet",value:function(){var e=this,t=this.note;this.componentRelay.saveItemWithPresave(t,(function(){t.content.preview_html=null,t.content.preview_plain="Created with Secure Spreadsheets";var n=e.getJSON(),r=JSON.stringify(n);t.content.text=r}))}},{key:"getJSON",value:function(){var e=this.getSpreadsheet().toJSON();return e.rows=this.numRows,e.columns=this.numColumns,e}},{key:"connectToBridge",value:function(){var e=this;this.componentRelay=new(i())({targetWindow:window,onReady:function(){var t=e.componentRelay.platform;t&&document.body.classList.add(t)},handleRequestForContentHeight:function(){var e,t,n,r,i,o=0;return o+=null===(e=document.querySelector(".k-spreadsheet-tabstrip"))||void 0===e?void 0:e.offsetHeight,o+=null===(t=document.querySelector(".k-spreadsheet-action-bar"))||void 0===t?void 0:t.offsetHeight,o+=null===(n=document.querySelector(".k-spreadsheet-view"))||void 0===n?void 0:n.offsetHeight,o+=null===(r=document.querySelector(".k-spreadsheet-sheets-bar"))||void 0===r?void 0:r.offsetHeight,o+=null===(i=document.querySelector(".k-spreadsheet-view-size"))||void 0===i?void 0:i.offsetHeight}}),this.componentRelay.streamContextItem((function(t){e.note=t,t.isMetadataUpdate||e.reloadSpreadsheetContent()}))}},{key:"reloadSpreadsheetContent",value:function(){if(this.note){var e=this.note.content.text;0===e.length&&this.saveSpreadsheet();var t=JSON.parse(e);t.rows&&(this.numRows=t.rows),t.columns&&(this.numColumns=t.columns),this.getSpreadsheet().fromJSON(t),this.getSpreadsheet().refresh()}}},{key:"render",value:function(){return e.createElement("div",null)}}])&&a(n.prototype,r),o&&a(n,o),Object.defineProperty(n,"prototype",{writable:!1}),d}(e.Component);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g(e);if(t){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}var S=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(a,t);var n,r,i,o=v(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,e)}return n=a,(r=[{key:"render",value:function(){return e.createElement("div",{className:"sn-component"},e.createElement(p,null))}}])&&y(n.prototype,r),i&&y(n,i),Object.defineProperty(n,"prototype",{writable:!1}),a}(e.Component);t.render(e.createElement(S,null),document.body.appendChild(document.createElement("div")))})()})();